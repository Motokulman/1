!function(t){var i=window.webpackHotUpdate;window.webpackHotUpdate=function(t,e){!function(t,i){if(!x[t]||!b[t])return;for(var e in b[t]=!1,i)Object.prototype.hasOwnProperty.call(i,e)&&(g[e]=i[e]);0==--v&&0===P&&M()}(t,e),i&&i(t,e)};var e,n=!0,s="a1efb9a5654638a5049d",r=1e4,o={},h=[],a=[];function c(t){var i=O[t];if(!i)return j;var n=function(n){return i.hot.active?(O[n]?-1===O[n].parents.indexOf(t)&&O[n].parents.push(t):(h=[t],e=n),-1===i.children.indexOf(n)&&i.children.push(n)):(console.warn("[HMR] unexpected require("+n+") from disposed module "+t),h=[]),j(n)},s=function(t){return{configurable:!0,enumerable:!0,get:function(){return j[t]},set:function(i){j[t]=i}}};for(var r in j)Object.prototype.hasOwnProperty.call(j,r)&&"e"!==r&&"t"!==r&&Object.defineProperty(n,r,s(r));return n.e=function(t){return"ready"===p&&d("prepare"),P++,j.e(t).then(i,function(t){throw i(),t});function i(){P--,"prepare"===p&&(w[t]||S(t),0===P&&0===v&&M())}},n.t=function(t,i){return 1&i&&(t=n(t)),j.t(t,-2&i)},n}function l(t){var i={_acceptedDependencies:{},_declinedDependencies:{},_selfAccepted:!1,_selfDeclined:!1,_disposeHandlers:[],_main:e!==t,active:!0,accept:function(t,e){if(void 0===t)i._selfAccepted=!0;else if("function"==typeof t)i._selfAccepted=t;else if("object"==typeof t)for(var n=0;n<t.length;n++)i._acceptedDependencies[t[n]]=e||function(){};else i._acceptedDependencies[t]=e||function(){}},decline:function(t){if(void 0===t)i._selfDeclined=!0;else if("object"==typeof t)for(var e=0;e<t.length;e++)i._declinedDependencies[t[e]]=!0;else i._declinedDependencies[t]=!0},dispose:function(t){i._disposeHandlers.push(t)},addDisposeHandler:function(t){i._disposeHandlers.push(t)},removeDisposeHandler:function(t){var e=i._disposeHandlers.indexOf(t);e>=0&&i._disposeHandlers.splice(e,1)},check:m,apply:C,status:function(t){if(!t)return p;u.push(t)},addStatusHandler:function(t){u.push(t)},removeStatusHandler:function(t){var i=u.indexOf(t);i>=0&&u.splice(i,1)},data:o[t]};return e=void 0,i}var u=[],p="idle";function d(t){p=t;for(var i=0;i<u.length;i++)u[i].call(null,t)}var f,g,y,v=0,P=0,w={},b={},x={};function _(t){return+t+""===t?+t:t}function m(t){if("idle"!==p)throw new Error("check() is only allowed in idle status");return n=t,d("check"),(i=r,i=i||1e4,new Promise(function(t,e){if("undefined"==typeof XMLHttpRequest)return e(new Error("No browser support"));try{var n=new XMLHttpRequest,r=j.p+""+s+".hot-update.json";n.open("GET",r,!0),n.timeout=i,n.send(null)}catch(t){return e(t)}n.onreadystatechange=function(){if(4===n.readyState)if(0===n.status)e(new Error("Manifest request to "+r+" timed out."));else if(404===n.status)t();else if(200!==n.status&&304!==n.status)e(new Error("Manifest request to "+r+" failed."));else{try{var i=JSON.parse(n.responseText)}catch(t){return void e(t)}t(i)}}})).then(function(t){if(!t)return d("idle"),null;b={},w={},x=t.c,y=t.h,d("prepare");var i=new Promise(function(t,i){f={resolve:t,reject:i}});g={};return S(0),"prepare"===p&&0===P&&0===v&&M(),i});var i}function S(t){x[t]?(b[t]=!0,v++,function(t){var i=document.createElement("script");i.charset="utf-8",i.src=j.p+""+t+"."+s+".hot-update.js",document.head.appendChild(i)}(t)):w[t]=!0}function M(){d("ready");var t=f;if(f=null,t)if(n)Promise.resolve().then(function(){return C(n)}).then(function(i){t.resolve(i)},function(i){t.reject(i)});else{var i=[];for(var e in g)Object.prototype.hasOwnProperty.call(g,e)&&i.push(_(e));t.resolve(i)}}function C(i){if("ready"!==p)throw new Error("apply() is only allowed in ready status");var e,n,r,a,c;function l(t){for(var i=[t],e={},n=i.slice().map(function(t){return{chain:[t],id:t}});n.length>0;){var s=n.pop(),r=s.id,o=s.chain;if((a=O[r])&&!a.hot._selfAccepted){if(a.hot._selfDeclined)return{type:"self-declined",chain:o,moduleId:r};if(a.hot._main)return{type:"unaccepted",chain:o,moduleId:r};for(var h=0;h<a.parents.length;h++){var c=a.parents[h],l=O[c];if(l){if(l.hot._declinedDependencies[r])return{type:"declined",chain:o.concat([c]),moduleId:r,parentId:c};-1===i.indexOf(c)&&(l.hot._acceptedDependencies[r]?(e[c]||(e[c]=[]),u(e[c],[r])):(delete e[c],i.push(c),n.push({chain:o.concat([c]),id:c})))}}}}return{type:"accepted",moduleId:t,outdatedModules:i,outdatedDependencies:e}}function u(t,i){for(var e=0;e<i.length;e++){var n=i[e];-1===t.indexOf(n)&&t.push(n)}}i=i||{};var f={},v=[],P={},w=function(){console.warn("[HMR] unexpected require("+m.moduleId+") to disposed module")};for(var b in g)if(Object.prototype.hasOwnProperty.call(g,b)){var m;c=_(b);var S=!1,M=!1,C=!1,I="";switch((m=g[b]?l(c):{type:"disposed",moduleId:b}).chain&&(I="\nUpdate propagation: "+m.chain.join(" -> ")),m.type){case"self-declined":i.onDeclined&&i.onDeclined(m),i.ignoreDeclined||(S=new Error("Aborted because of self decline: "+m.moduleId+I));break;case"declined":i.onDeclined&&i.onDeclined(m),i.ignoreDeclined||(S=new Error("Aborted because of declined dependency: "+m.moduleId+" in "+m.parentId+I));break;case"unaccepted":i.onUnaccepted&&i.onUnaccepted(m),i.ignoreUnaccepted||(S=new Error("Aborted because "+c+" is not accepted"+I));break;case"accepted":i.onAccepted&&i.onAccepted(m),M=!0;break;case"disposed":i.onDisposed&&i.onDisposed(m),C=!0;break;default:throw new Error("Unexception type "+m.type)}if(S)return d("abort"),Promise.reject(S);if(M)for(c in P[c]=g[c],u(v,m.outdatedModules),m.outdatedDependencies)Object.prototype.hasOwnProperty.call(m.outdatedDependencies,c)&&(f[c]||(f[c]=[]),u(f[c],m.outdatedDependencies[c]));C&&(u(v,[m.moduleId]),P[c]=w)}var D,A=[];for(n=0;n<v.length;n++)c=v[n],O[c]&&O[c].hot._selfAccepted&&A.push({module:c,errorHandler:O[c].hot._selfAccepted});d("dispose"),Object.keys(x).forEach(function(t){!1===x[t]&&function(t){delete installedChunks[t]}(t)});for(var k,R,L=v.slice();L.length>0;)if(c=L.pop(),a=O[c]){var T={},E=a.hot._disposeHandlers;for(r=0;r<E.length;r++)(e=E[r])(T);for(o[c]=T,a.hot.active=!1,delete O[c],delete f[c],r=0;r<a.children.length;r++){var z=O[a.children[r]];z&&((D=z.parents.indexOf(c))>=0&&z.parents.splice(D,1))}}for(c in f)if(Object.prototype.hasOwnProperty.call(f,c)&&(a=O[c]))for(R=f[c],r=0;r<R.length;r++)k=R[r],(D=a.children.indexOf(k))>=0&&a.children.splice(D,1);for(c in d("apply"),s=y,P)Object.prototype.hasOwnProperty.call(P,c)&&(t[c]=P[c]);var B=null;for(c in f)if(Object.prototype.hasOwnProperty.call(f,c)&&(a=O[c])){R=f[c];var H=[];for(n=0;n<R.length;n++)if(k=R[n],e=a.hot._acceptedDependencies[k]){if(-1!==H.indexOf(e))continue;H.push(e)}for(n=0;n<H.length;n++){e=H[n];try{e(R)}catch(t){i.onErrored&&i.onErrored({type:"accept-errored",moduleId:c,dependencyId:R[n],error:t}),i.ignoreErrored||B||(B=t)}}}for(n=0;n<A.length;n++){var V=A[n];c=V.module,h=[c];try{j(c)}catch(t){if("function"==typeof V.errorHandler)try{V.errorHandler(t)}catch(e){i.onErrored&&i.onErrored({type:"self-accept-error-handler-errored",moduleId:c,error:e,originalError:t}),i.ignoreErrored||B||(B=e),B||(B=t)}else i.onErrored&&i.onErrored({type:"self-accept-errored",moduleId:c,error:t}),i.ignoreErrored||B||(B=t)}}return B?(d("fail"),Promise.reject(B)):(d("idle"),new Promise(function(t){t(v)}))}var O={};function j(i){if(O[i])return O[i].exports;var e=O[i]={i:i,l:!1,exports:{},hot:l(i),parents:(a=h,h=[],a),children:[]};return t[i].call(e.exports,e,e.exports,c(i)),e.l=!0,e.exports}j.m=t,j.c=O,j.d=function(t,i,e){j.o(t,i)||Object.defineProperty(t,i,{enumerable:!0,get:e})},j.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},j.t=function(t,i){if(1&i&&(t=j(t)),8&i)return t;if(4&i&&"object"==typeof t&&t&&t.__esModule)return t;var e=Object.create(null);if(j.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:t}),2&i&&"string"!=typeof t)for(var n in t)j.d(e,n,function(i){return t[i]}.bind(null,n));return e},j.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return j.d(i,"a",i),i},j.o=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},j.p="build/",j.h=function(){return s},c(17)(j.s=17)}([function(t,i,e){"use strict";function n(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}e.d(i,"a",function(){return s});var s=function(){function t(i,e){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,t),this.type="MOBaza",this.typeNa="xz";var n=this;this.par=i,this.fun=e,this._active=!1,this.otstup=this.par.otstup,this.otstup1=this.par.otstup,this.wh=this.par.wh,this.width=4*(this.par.wh+this.otstup)+this.otstup,this.whSize=this.par.whSize,this.dCont=new DCont(i.dCont),this.dCont.visible=this._active,this.object=void 0,this.postSO=void 0,this.postIn=void 0,this.init=function(){null==this.window&&(this.whSize=this.par.whSize,this.window=new DWindow(this.dCont,0,0,"xz"),this.window.width=this.width,this.window.hasMinimizeButton=!1,this.window.dragBool=!1,this.buttonClose=new DButton(this.window,2,2,"",function(){n.active=!1,n.sp.setActive()},"resources/image/close.png"),this.buttonClose.width=this.buttonClose.height=28,this.buttonClose.x=this.width-this.buttonClose.width-2,this.buttonClose.boolFond=!1,null!=this.postIn&&this.postIn())},this.setObject=function(t){this.object=t,this.active=!0,this.init(),null!=this.postSO&&this.postSO()},this.sp=void 0,this.setSP=function(t){this.sp=t},this.drag=function(){},this.clear=function(){this.active=!1},this.deleteObj=function(){null!=this.object&&null!=this.object.clear&&(this.object.clear(),this.active=!1)}}var i,e,s;return i=t,(e=[{key:"active",set:function(t){this._active!=t&&(this._active=t,this.dCont.visible=t)},get:function(){return this._active}}])&&n(i.prototype,e),s&&n(i,s),t}()},function(t,i,e){"use strict";function n(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}e.d(i,"a",function(){return s});var s=function(){function t(){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,t),this.type="SpDebugPixi";this.content2d=new PIXI.Container,this.color=11184810,this.colorActiv=16711680,this.wL=10,this.al=1,this._alpha=1,this.contentDebag=new PIXI.Container,this.content2d.addChild(this.contentDebag);var i=new PIXI.Graphics;this.content2d.addChild(i),this.debagLine=function(t,i,e,n){this.graphics=new PIXI.Graphics,this.contentDebag.addChild(this.graphics),null==e&&(e=this.color),null==n&&(n=this.wL),this.graphics.lineStyle(n,e,n),this.graphics.moveTo(t.x,t.y),this.graphics.lineTo(i.x,i.y)},this.debagPoint=function(t,i,e,n,s){this.graphics=new PIXI.Graphics,this.contentDebag.addChild(this.graphics),i=i||50,null==e&&(e=this.color),n=n||this.wL,this.graphics.lineStyle(this.wL,e,n),this.graphics.beginFill(e,null==s?1:s),this.graphics.drawCircle(t.x,t.y,i)},this.clearD=function(){i.clear()},this.clear=function(){i.clear()};var e={x:0,y:0},n={x:0,y:0};this.dLineParam=function(t,i,s,r,o,h){e.x=t,e.y=i,n.x=s,n.y=r,this.dLine(e,n,o,h)},this.dLine=function(t,e,n,s){null==n&&(n=this.color),null==s&&(s=this.wL),i.endFill(),i.lineStyle(s,n,this.al),i.moveTo(t.x,t.y),i.lineTo(e.x,e.y),i.endFill()},this.dPointParam=function(t,i,n,s,r){e.x=t,e.y=i,this.dPoint(e,n,s,r)},this.dPoint=function(t,e,n,s){(e=e||50)>1e6?console.warn("Большой круг рисовать не буду",e):(null==n&&(n=this.color),s=s||this.wL,i.lineStyle(s,n,this.al),i.drawCircle(t.x,t.y,e),i.endFill())},this.dLinePosition=function(t,e){i.lineStyle(20.5,e,this.al),i.moveTo(t.p.x,t.p.y),i.lineTo(t.p1.x,t.p1.y),i.moveTo(t.p1.x,t.p1.y),i.lineTo(t.p2.x,t.p2.y),i.beginFill(e,.3),i.drawCircle(t.p.x,t.p.y,20.5),i.drawCircle(t.p1.x,t.p1.y,20.5),i.drawCircle(t.p2.x,t.p2.y,20.5),i.endFill()},this.dRect=function(t,i,e){if((t=t||50)>1e6)console.warn("Большой круг рисовать не буду",t);else{null==i&&(i=16777215*Math.random()),e=e||this.wL;var n=null==t.w?t.width:t.w,s=null==t.h?t.height:t.h,r={x:t.x,y:t.y},o={x:t.x+n,y:t.y},h={x:t.x+n,y:t.y+s},a={x:t.x,y:t.y+s};this.dLine(r,o,i,e),this.dLine(o,h,i,e),this.dLine(h,a,i,e),this.dLine(a,r,i,e)}}}var i,e,s;return i=t,(e=[{key:"alpha",set:function(t){this._alpha!=t&&(this._alpha=t,this.content2d.alpha=t)},get:function(){return this._alpha}}])&&n(i.prototype,e),s&&n(i,s),t}()},function(t,i,e){"use strict";e.d(i,"a",function(){return r});var n=e(5);function s(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var r=function(){function t(i,e){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,t),this.type="SobIndex";var s=this;this.par=i,this.fun=e,this._active=!1,this.funActive=void 0,this._mashtab=1,this._otstup=25,this._sah=0,this.color=16711680,this.activColor=65280;var r,o,h=new n.a;this.setActive=function(){this.par.floor.sp.activMouse=!0,this.par.floor.visiPoint=!0,this.par.floor.bazaMod.activMouse=!1,this.par.floor.bazaMod.activeRadius=!1},this.move=function(t){},this.out=function(t){},this.over=function(t){},this.down=function(t){},this.clear=function(){this._sah=0},this.clearActive=function(){!1,r=this.par.floor.sp.arrPoint,o=this.par.floor.sp.arrSplice;for(var t=0;t<r.length;t++)r[t].life&&!1!==r[t].active&&(r[t].active=!1);for(t=0;t<o.length;t++)o[t].life&&!1!==o[t].active&&(o[t].active=!1)},this.distSten=20,this.getPosEv3D=function(t){var i=new THREE.Vector3;return i.set(-this.par.whSize/2+this.par.whSize*t.uv.x,-(-this.par.whSize/2+this.par.whSize*t.uv.y),0),i};var a,c=new THREE.Vector2,l=new THREE.Vector2;this.getSten=function(t){return this.getParName(t,"sten")},this.getParName=function(t,i){return null!=t[i]?t[i]:null!=t.parent?this.getParName(t.parent,i):null},this.getPosEv3DSten=function(t){var i=new THREE.Vector3;return null==(a=this.getSten(t.target))?null:(i.z=2,l.x=t.point.x,l.y=t.point.z,h.getDistance(l,a.position)<25?(i.z=0,i.x=a.position.x,i.y=a.position.y,i):h.getDistance(l,a.position1)<25?(i.z=1,i.x=a.position1.x,i.y=a.position1.y,i):(c=h.isPointInLin(a.position,a.position1,l,100,100),i.z=2,i.x=c.x,i.y=c.y,i))};var u=new THREE.Vector3,p=[],d=[];this.startAP=function(t,i){t,t?(u.x=t.position.x,u.y=t.position.y):(u.x=9999999999,u.y=9999999999),p.length=0;for(var e=0;e<this.par.floor.sp.arrPoint.length;e++)this.par.floor.sp.arrPoint[e].life&&(t&&this.par.floor.sp.arrPoint[e]._uuid==t._uuid||i&&this.par.floor.sp.arrPoint[e]._uuid==i._uuid||p.push(this.par.floor.sp.arrPoint[e]));var n;d.length=0;for(e=0;e<this.par.floor.sp.arrSplice.length;e++)if(this.par.floor.sp.arrSplice[e].life){n=!0;for(var s=0;s<t.arrSHron.length;s++)t.arrSHron[s].sten._uuid==this.par.floor.sp.arrSplice[e]._uuid&&(n=!1);1==n&&d.push(this.par.floor.sp.arrSplice[e])}};l={x:0,y:0,o:null};this.getDistSten=function(t,i){return l.x=i.x,l.y=i.y,c=h.isPointInLin(t.position,t.position1,l,11111,0),h.getDistance(l,c)},this.pointOld=void 0;var f,g,y,v,P,w,b,x,_;this.korektAP=function(t,i){t.x=100*Math.round(t.x/100),t.y=100*Math.round(t.y/100),t.o=null,t.oy=null,t.ox=null,this._otstup=25,null!=s.pointOld&&(Math.abs(t.x-this.pointOld.x)<this._otstup/this._mashtab&&(t.x=this.pointOld.x),Math.abs(t.y-this.pointOld.y)<this._otstup/this._mashtab&&(t.y=this.pointOld.y)),g=this._otstup/this._mashtab,y=null,v=this._otstup/this._mashtab,P=null;for(var e=0;e<s.p20.sp.arrPoint.length;e++)if(s.p20.sp.arrPoint[e].life&&(!i||s.p20.sp.arrPoint[e]._uuid!=i._uuid)){if(this.pointOld&&null!=this.pointOld.uuidArr){w=!0;for(var n=0;n<this.pointOld.uuidArr.length;n++)this.pointOld.uuidArr[n]==s.p20.sp.arrPoint[e]._uuid&&(w=!1);if(!w)continue}(b=Math.abs(t.x-s.p20.sp.arrPoint[e].position.x))<g&&(g=b,y=s.p20.sp.arrPoint[e].position.x,x=s.p20.sp.arrPoint[e].position.y),(b=Math.abs(t.y-s.p20.sp.arrPoint[e].position.y))<v&&(v=b,P=s.p20.sp.arrPoint[e].position.y,_=s.p20.sp.arrPoint[e].position.x)}null!=y&&(t.x=y,t.oy=x),null!=P&&(t.y=P,t.ox=_);for(e=0;e<s.p20.sp.arrPoint.length;e++){if(s.p20.sp.arrPoint[e].life)if(!i||s.p20.sp.arrPoint[e]._uuid!=i._uuid)if(h.getDistance(s.p20.sp.arrPoint[e].position,t)<300)return t.x=s.p20.sp.arrPoint[e].position.x,t.y=s.p20.sp.arrPoint[e].position.y,void(t.o=s.p20.sp.arrPoint[e])}for(e=0;e<s.p20.sp.arrSplice.length;e++)if(s.p20.sp.arrSplice[e].life&&(null==i||s.p20.sp.arrSplice[e].addPoint._uuid!=i._uuid&&s.p20.sp.arrSplice[e].addPoint1._uuid!=i._uuid)&&(f=this.getDistSten(s.p20.sp.arrSplice[e],t),c&&-1!=f&&f<600))return t.x=c.x,t.y=c.y,void(t.o=s.p20.sp.arrSplice[e])},this.getPositPlan=function(t){return s.par.par.mGridDrag.getPositPlan(t)},this.downFont=function(t){s.par.par.mGridDrag.downFont(t)},this.helpDP=void 0,this.setP20=function(t){s.cont=t.cont2d,s.p20=t,s.helpDP=s.par.par.mCont2dHelp.helpDP},this.sp=void 0,this.setSP=function(t){this.sp=t,this.color=this.sp.convertC(dcmParam.color),this.activColor=this.sp.convertC(dcmParam.activButton)},this.render=function(){s.par.par.fun("render")},this.sobSP=function(t,i,e){trace(this.type+" sobSP >>",t,i,e)},this.sobMenu=function(t,i,e){trace(this.type+" sobMenu >>",t,i,e)},this.boolCTRL=!1,this.keydown=function(t){17==event.keyCode&&(s.boolCTRL=!0)},this.keyup=function(t){17==event.keyCode&&(s.boolCTRL=!1)}}var i,e,r;return i=t,(e=[{key:"active",set:function(t){this._active!=t&&(this._active=t,null!=this.funActive&&this.funActive(),this.helpDP&&this.helpDP.clear())},get:function(){return this._active}},{key:"mashtab",set:function(t){this._mashtab!=t&&(this._mashtab=t)},get:function(){return this._mashtab}}])&&s(i.prototype,e),r&&s(i,r),t}()},function(t,i,e){"use strict";function n(t,i,e){this._x=t||0,this._y=i||0,this._z=e||0,this.set=function(t,i,e){this._x=t||0,this._y=i||0,void 0!==e&&(this._z=e)},this.setPoint=function(t){this._x=t.x,this._y=t.y,void 0!==t.z&&(this._z=t.z)},this.getObj=function(){var t={};return t.x=this._x,t.y=this._y,t.z=this._z,t},this.copy=function(){return new n(this._x,this._y,this._z)}}e.d(i,"a",function(){return n}),n.prototype={set x(t){this._x=t},get x(){return this._x},set y(t){this._y=t},get y(){return this._y},set z(t){this._z=t},get z(){return this._z}}},function(t,i){var e;e=function(){return this}();try{e=e||new Function("return this")()}catch(t){"object"==typeof window&&(e=window)}t.exports=e},function(t,i,e){"use strict";function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function s(){var t,i,e,s,o=new THREE.Vector3(0,0,0),h=new THREE.Vector3(0,0,0),a=new THREE.Vector3(0,0,0),c=new THREE.Vector3(0,0,0);this.DEG2RAD=Math.PI/180,this.RAD2DEG=180/Math.PI,this.getAngle=function(t,i){return i=i||c,t=t||c,Math.atan2(i.y-t.y,i.x-t.x)};var l,u,p,d,f,g,y,v,P,w=0;this.getAngle2=function(t,i){return i=i||c,t=t||c,(w=Math.atan2(i.y-t.y,i.x-t.x))<0&&(w+=2*Math.PI),w},this.getDistance=function(t,i){return null==t?0:(null==i&&(i=c),i=i||c,Math.sqrt(Math.pow(t.x-i.x,2)+Math.pow(t.y-i.y,2)))},this.getVector=function(t,i,e){if(null==e)e=new THREE.Vector2(0,0);return t<0&&(i+=Math.PI),e.x=Math.abs(t)*Math.cos(i),e.y=Math.abs(t)*Math.sin(i),e},this.isPointInLin=function(t,e,n,r,o){return this.getTreeAngel(t,e,n),o<0&&2*Math.abs(o)>s?null:h.x<=s+o&&h.x>=-o&&Math.abs(h.y)<=r?((a=h.x<0?this.getVector(h.x,i-Math.PI):this.getVector(h.x,i)).x+=e.x,a.y+=e.y,a.z=h.y,a):null},this.okrugPoint=function(t,i){null==i&&(i=100),t.x=Math.round(t.x/i)*i,t.y=Math.round(t.y/i)*i},this.okrugNumber=function(t,i){null==i&&(i=100);var e=Math.round(t*i)/i;return t=e,e},this.isInTriangle=function(t,i,e,n){var s=(t.x-n.x)*(i.y-t.y)-(i.x-t.x)*(t.y-n.y),r=(i.x-n.x)*(e.y-i.y)-(e.x-i.x)*(i.y-n.y),o=(e.x-n.x)*(t.y-e.y)-(t.x-e.x)*(e.y-n.y);return s>=0&&r>=0&&o>=0||s<=0&&r<=0&&o<=0},this.getTreeAngel=function(t,n,r,o){return i=this.getAngle(n,t),e=this.getAngle(n,r),l=this.getDistance(n,r),s=this.getDistance(t,n),this.getVector(l,e-i,h),e=this.getAngle(c,h),null==o?e:e>0?e:2*Math.PI+e},this.getTreeAngelPI2=function(t,i,e){x1=t.x-i.x,x2=e.x-i.x,y1=t.y-i.y,y2=e.y-i.y,s=Math.sqrt(x1*x1+y1*y1),d2=Math.sqrt(x2*x2+y2*y2);var n=(x1*x2+y1*y2)/(s*d2);return n>1&&(n=1),n<-1&&(n=-1),Math.acos(n)},this.isLineInTriangle=function(i,e,n,s,r){return(t=this.getPointOfIntersection(i,e,s,r))?(o.x=t.x,o.y=t.y,o.z=0,o):(t=this.getPointOfIntersection(e,n,s,r))?(o.x=t.x,o.y=t.y,o.z=1,o):!!(t=this.getPointOfIntersection(n,i,s,r))&&(o.x=t.x,o.y=t.y,o.z=2,o)};var b,x,_,m,S=new THREE.Vector2(0,0);this.getPointOfIntersection=function(t,i,e,n){return l=(t.x-i.x)*(n.y-e.y)-(t.y-i.y)*(n.x-e.x),u=(t.x-e.x)*(n.y-e.y)-(t.y-e.y)*(n.x-e.x),p=(t.x-i.x)*(t.y-e.y)-(t.y-i.y)*(t.x-e.x),f=p/l,(d=u/l)>=0&&d<=1&&f>=0&&f<=1?(g=t.x+d*(i.x-t.x),y=t.y+d*(i.y-t.y),S.x=g,S.y=y,S):null},this.korektToLine=function(t,i,e,n,s){v=this.getDistance(t,i),P=null==s?this.getAngle(t,i):s,0!=n&&(S=n<0?this.getVector(-n,P-Math.PI/2):this.getVector(n,P+Math.PI/2),t.x+=S.x,t.y+=S.y,i.x+=S.x,i.y+=S.y),S=this.getVector(e,P),i.x+=S.x,i.y+=S.y,S=this.getVector(e,P+Math.PI),t.x+=S.x,t.y+=S.y},this.getProsent3Point=function(t,i,e){return u=this.getDistance(t,i),(p=this.getDistance(t,e))/u},this.povotorOtAngel=function(t,i,e){return P=this.getAngle(t,i),v=this.getDistance(t,i),this.getVector(v,P+e)},this.testPositPoint=function(t,i,e){return null==e&&(e=100),Math.round(t.x*e)/e==Math.round(i.x*e)/e&&Math.round(t.y*e)/e==Math.round(i.y*e)/e},this.okrugAngel=function(t,i,e){var n=t;b=1,t<0&&(b=-1),x=Math.abs(t),_=Math.round(x/i)+1,m=0;for(var s=_;s>=0;s--){if(x>s*i-e&&x<s*i+e)return n=s*i*b;if(3==++m)return n}return n};var M=new r,C=new r,O=[];this.getLineCircleIntersectionPoints=function(t,i,e,n,s){O.length=0;var r=i.x-t.x,o=i.y-t.y,h=e.x-t.x,a=e.y-t.y,c=r*r+o*o,l=(r*h+o*a)/c,u=l*l-(h*h+a*a-n*n)/c;if(u<0)return O;var p=Math.sqrt(u),d=-l+p,f=-l-p;return M.set(t.x-r*d,t.y-o*d),this.isPointInLine(t,i,M)&&O.push(M),0==u?O:(C.set(t.x-r*f,t.y-o*f),this.isPointInLine(t,i,C)&&O.push(C),s&&2==O.length&&(b=this.getDistance(t,O[0]),x=this.getDistance(t,O[1]),b>x&&O.reverse()),O)},this.isPointInLine=function(t,i,e){var n=calc.getDistance(t,i),s=calc.getDistance(t,e),r=calc.getDistance(i,e);return calc.okrugNumber(s+r)===calc.okrugNumber(n)},this.getDistancePointToLine=function(t,i,e){var n=((i.y-t.y)*e.x-(i.x-t.x)*e.y+i.x*t.y-i.y*t.x)/calc.getDistance(t,i);return-calc.okrugNumber(Number.isFinite(n)?n:0)},this.getCircleCircleIntersectionPoints=function(t,i,e,n){var s,r,o,h,a;return O.length=0,(o=Math.sqrt(Math.pow(Math.abs(t.x-e.x),2)+Math.pow(Math.abs(t.y-e.y),2)))>i+n?O:(h=(i*i-n*n+o*o)/(2*o),a=Math.sqrt(Math.pow(i,2)-Math.pow(h,2)),isNaN(a)?O:(s=t.x+h*(e.x-t.x)/o,r=t.y+h*(e.y-t.y)/o,M.x=s+a*(e.y-t.y)/o,M.y=r-a*(e.x-t.x)/o,O.push(M),h==i?O:(C.x=s-a*(e.y-t.y)/o,C.y=r+a*(e.x-t.x)/o,O.push(C),O)))};var j=[new r,new r,new r,new r],I=[new r,new r,new r,new r];this.isIntersectionRect=function(t,i){return j[0].set(t.x,t.y),j[1].set(t.x+t.width,t.y),j[2].set(t.x+t.width,t.y+t.height),j[3].set(t.x,t.y+t.height),I[0].set(i.x,i.y),I[1].set(i.x+i.width,i.y),I[2].set(i.x+i.width,i.y+i.height),I[3].set(i.x,i.y+i.height),this.isIntersectionFromPoint(j,I)},this.isIntersectionFromPoint=function(t,i){for(var e=0;e<t.length-2;e++)for(var n=0;n<i.length-2;n++)if(calc.getPointOfIntersection(t[e],t[(e+2)%t.length],i[n],i[(n+2)%i.length]))return!0;for(e=0;e<t.length;e++)for(n=0;n<i.length;n++)if(calc.getPointOfIntersection(t[e],t[(e+1)%t.length],i[n],i[(n+1)%i.length]))return!0;for(e=0;e<i.length;e+=2)if(calc.contains(i[e].x,i[e].y,t))return!0;for(e=0;e<t.length;e+=2)if(calc.contains(t[e].x,t[e].y,i))return!0;return!1},this.isParalel=function(t,i,e,n,s){s=s||0;var r=Math.abs(calc.getAngle(t,i)%Math.PI),o=Math.abs(calc.getAngle(i,t)%Math.PI),h=Math.abs(calc.getAngle(e,n)%Math.PI),a=Math.abs(calc.getAngle(n,e)%Math.PI);return Math.min(Math.abs(r-h),Math.abs(o-a),Math.abs(r-a),Math.abs(o-h))<=s},this.rotationPoint=function(t,i,e){var n=0,s=0;e?(n=e.x+(t.x-e.x)*Math.cos(i)-(t.y-e.y)*Math.sin(i),s=e.y+(t.y-e.y)*Math.cos(i)+(t.x-e.x)*Math.sin(i)):(n=t.x*Math.cos(i)-t.y*Math.sin(i),s=t.y*Math.cos(i)+t.x*Math.sin(i)),t.x=n,t.y=s},this.rotationPointByLength=function(t,i,e){e=e||c;var n=calc.getDistance(t,e),s=calc.getLenghtCircle(n),r=i*(2*Math.PI/s);calc.rotationPoint(t,r,e)},this.isIntersectionTriangle=function(t,i,e,n,s,r){for(var o=!1,h=[t,i,e],a=[n,s,r],c=0;c<h.length&&!o;c++)o=calc.isInTriangle(n,s,r,h[c]);for(c=0;c<a.length&&!o;c++)o=calc.isInTriangle(t,i,e,a[c]);if(!o)for(c=0;c<h.length;c++)for(var l=0;l<a.length&&!o;l++)o=calc.getPointOfIntersection(h[c],h[(c+1)%h.length],a[l],a[(l+1)%a.length]);return o},this.getArrPointCircle=function(t,i,e,n,s,o,h){var a,c=calc.getAngle(e,t)-Math.PI,l=calc.getAngle(n,t)-Math.PI;a=h||[new r],s=s||5,!(o=o||!1)&&l<=c?l+=2*Math.PI:o&&c<=l&&(c+=2*Math.PI);var u=o?-1*(c-l):l-c,p=Math.ceil(Math.abs(u)/(2*Math.PI))*(s-1),d=u/(2*p),f=2*d,g=Math.cos(d),y=Math.sin(d),v=p-1,P=v%1/v,w=0,b=0,x=0,_=0,m=0;a[0].x=t.x+Math.cos(c)*i,a[0].y=t.y+Math.sin(c)*i;for(var S=0;S<=v;S++)w=d+c+(f*S+P*S),_=(g*(b=Math.cos(w))+y*(x=-Math.sin(w)))*i+t.x,m=(g*-x+y*b)*i+t.y,a[S+1]?(a[S+1].x=_,a[S+1].y=m):a.push(new r(_,m));return a},this.getLenghtCircle=function(t,i,e,n,s){i||(i=e=n=c);var r=calc.getAngle(e,i)-Math.PI,o=calc.getAngle(n,i)-Math.PI;return r===o&&e!==n?0:(!(s=s||!1)&&o<=r?o+=2*Math.PI:s&&r<=o&&(r+=2*Math.PI),Math.PI*t*(s?r-o:o-r)/Math.PI)},this.getLengthByWidth=function(t,i){var e=new r(0,0),n=new r(t,0),s=calc.getVector(i,.5*Math.PI);s.x=t/2;var o=calc.getCenterCircle(e,n,s);return o?calc.getLenghtCircle(calc.getDistance(o,e),o,e,n,i>0):t},this.getCenterCircle=function(t,i,e){var n=i.x-t.x,s=i.y-t.y,o=e.x-t.x,h=e.y-t.y,a=n*(t.x+i.x)+s*(t.y+i.y),c=o*(t.x+e.x)+h*(t.y+e.y),l=2*(n*(e.y-i.y)-s*(e.x-i.x));return 0===l?null:new r((h*a-s*c)/l,(n*c-o*a)/l)},this.getArcPoint=function(t,i,e,n,s){n=n||5;var o=calc.getAngle(t,i)+90*calc.DEG2RAD,h=calc.getVector(e,o),a=new r((t.x+i.x)/2,(t.y+i.y)/2);a.x+=h.x,a.y+=h.y;var c=calc.getCenterCircle(t,a,i);return c?calc.getArrPointCircle(c,calc.getDistance(c,t),t,i,n,e>0,s):[t,i]},this.getArea=function(t){for(var i=t.length,e=0,n=i-1,s=0;s<i;n=s++)e+=t[n].x*t[s].y-t[s].x*t[n].y;return.5*e||0},this.generateUUID=function(){for(var t=[],i=0;i<256;i++)t[i]=(i<16?"0":"")+i.toString(16);return function(){var i=4294967295*Math.random()|0,e=4294967295*Math.random()|0,n=4294967295*Math.random()|0,s=4294967295*Math.random()|0;return(t[255&i]+t[i>>8&255]+t[i>>16&255]+t[i>>24&255]+"-"+t[255&e]+t[e>>8&255]+"-"+t[e>>16&15|64]+t[e>>24&255]+"-"+t[63&n|128]+t[n>>8&255]+"-"+t[n>>16&255]+t[n>>24&255]+t[255&s]+t[s>>8&255]+t[s>>16&255]+t[s>>24&255]).toUpperCase()}}(),this.diffNum=function(t,i){return t>=0&&i>=0?Math.abs(t-i):t<=0&&i<=0?Math.abs(Math.abs(t)-Math.abs(i)):t<=0&&i>=0?Math.abs(t)+i:t>=0&&i<=0?t+Math.abs(i):void 0},this.getPercentNum=function(t,i,e){return((t=null!=t?t:0)-(i=null!=i?i:0))/((e=null!=e?e:100)-i)*100},this.getValueNum=function(t,i,e){return(t=null!=t?t:0)/100*((e=null!=e?e:100)-(i=null!=i?i:0))+i},this.getValueBetween=function(t,i,e){var n=Math.max(i,e),s=Math.min(i,e);return Math.max(Math.min(t,n),s)},this.contains=function(t,i,e){for(var n=!1,s=e.length,r=0,o=s-1;r<s;o=r++){if(e[r].x===t&&e[r].y===i)return!0;var h=e[r].x,a=e[r].y,c=e[o].x,l=e[o].y;a>i!=l>i&&t<(c-h)*(i-a)/(l-a)+h&&(n=!n)}return n};var D={maxX:0,minX:0,maxY:0,minY:0},A=new r,k=[new r,new r,new r,new r],R=new r;this.getBoundsRect=function(t,i){R.set(t.width/2,t.height/2),k[0].set(0,0),k[1].set(t.width,0),k[2].set(t.width,t.height),k[3].set(0,t.height);for(var e=0;e<k.length;e++)this.rotationPoint(k[e],i,R);D.maxX=-t.width,D.minX=t.width,D.maxY=-t.height,D.minY=t.height;for(e=0;e<k.length;e++)D.maxX=Math.max(D.maxX,k[e].x),D.minX=Math.min(D.minX,k[e].x),D.maxY=Math.max(D.maxY,k[e].y),D.minY=Math.min(D.minY,k[e].y);return A.x=D.minX,A.y=D.minY,A.width=D.maxX-D.minX,A.height=D.maxY-D.minY,A},this.getCurvatureByWidth=function(t,i){if(Math.abs(t)>2*i)return null;var e=Math.pow(Math.abs(t),2),n=Math.pow(i,2),s=Math.acos((n+n-e)/(2*n));return i*(1-Math.cos(s/2))*(t<0?-1:1)},this.getWidthByCurvature=function(t,i){return 2*i*Math.sin(Math.acos(1-2*Math.abs(t)/(2*i)))*(t<0?-1:1)};function L(t){return t!==Object(t)}this.compare=function t(i,e){if(L(i)&&L(e))return i===e;for(var s in i){if(i.hasOwnProperty(s)!==e.hasOwnProperty(s))return!1;switch(n(i[s])){case"object":if(!t(i[s],e[s]))return!1;break;case"function":if(void 0===e[s]||"compare"!==s&&i[s].toString()!==e[s].toString())return!1;break;case"number":if(Number(Number(i[s]).toFixed(3))!==Number(Number(e[s]).toFixed(3)))return!1;break;default:if(i[s]!==e[s])return!1}}for(var s in e)if(i.hasOwnProperty(s)!==e.hasOwnProperty(s))return!1;return!0}}function r(t,i,e){this._x=t||0,this._y=i||0,this._z=e||0,this.set=function(t,i,e){this._x=t||0,this._y=i||0,void 0!==e&&(this._z=e)},this.setPoint=function(t){this._x=t.x,this._y=t.y,void 0!==t.z&&(this._z=t.z)},this.getObj=function(){var t={};return t.x=this._x,t.y=this._y,t.z=this._z,t},this.copy=function(){return new r(this._x,this._y,this._z)}}e.d(i,"a",function(){return s}),r.prototype={set x(t){this._x=t},get x(){return this._x},set y(t){this._y=t},get y(){return this._y},set z(t){this._z=t},get z(){return this._z}}},function(t,i,e){"use strict";function n(t){var i=this;this.type="SpPoint",this.tipe="SpPoint",this.stage=t,this._life=!0,this.size2=10,this.size3=.001,this._uuid=calc.generateUUID(),this.arrSHronBaza=[],this.arrSHron=[],this.arrPol=[],this.arrIdSten=[],this.arrSten=[],this.arrayClass=[];var e,n,r=0;function o(t,i){if(t)for(var e=0;e<t.arrSHron.length;e++)i.push(t.arrSHron[e].sten)}function h(t,i){if(t)for(var e=0;e<t.arrSHron.length;e++)t.arrSHron[e].sten._addPoint&&i.push(t.arrSHron[e].sten._addPoint),t.arrSHron[e].sten._addPoint1&&i.push(t.arrSHron[e].sten._addPoint1)}function a(t){for(var i=0;i<t.length;i++){for(var e=!1,n=0;n<t.length;n++)if(i!==n&&t[n].uuid===t[i].uuid){e=!0;break}e&&t.splice(i--,1)}}this.creatSHron=function(){for(var t=0;t<this.arrSHronBaza.length;t++)if(0==this.arrSHronBaza[t].life)return this.arrSHronBaza[t].life=!0,this.arrSHronBaza[t];return this.arrSHronBaza.push(new s(this)),this.arrSHronBaza[this.arrSHronBaza.length-1]},this.addSplice=function(t,s){n=99999;for(var r=0;r<this.arrSHron.length;r++)this.arrSHron[r].sten.idArr==t.idArr&&(n=r);99999==n&&((e=this.creatSHron()).sten=t,e.storona=s,this.arrSHron.push(e),i.arrIdSten.push(t.idArr),1==s?t.addPoint=this:t.addPoint1=this,this.life=!0,this.drag()),this.stage.render(),null!=i.doFunRend&&i.doFunRend()},this.removeSplice=function(t){n=-1;for(var e=0;e<this.arrSHron.length;e++)this.arrSHron[e].sten.idArr==t.idArr&&(n=e);if(-1!=n){var s=this.arrSHron[n];return this.arrSHron.splice(n,1),s.clear(),this.arrIdSten.splice(n,1),this.drag(),s}return this.stage.render(),null!=i.doFunRend&&i.doFunRend(),null},this.addPol=function(t){this.arrPol.push(t),this.stage.render()},this.removePol=function(t){for(var i=null,e=0;e<this.arrPol.length;e++)t.idArr==this.arrPol[e].idArr&&(this.arrPol.splice(e,1),null==i&&(i=0),i++,t.removePoint(this),e=0);return 0==this.arrSHron.length&&0==this.arrPol.length&&this.clear(),this.stage.render(),i},this._heightNew=0,this.dragHeight,this.drag=function(){r=this.arrSHron.length;for(var t=0;t<r;t++)this.arrSHron[t].sten.calculateOld=this.arrSHron[t].sten.calculate,this.arrSHron[t].sten.calculate=!0,this.arrSHron[t].sten.height>this._heightNew&&(this._heightNew=this.arrSHron[t].sten.height);this.setPointNotDrag(this.position);for(var i=this.getConectedPoint(),e=0;e<i.length;e++)i[e].korektSH();this.dragView();for(t=0;t<r;t++)this.arrSHron[t].sten.calculate=this.arrSHron[t].sten.calculateOld,this.arrSHron[t].sten.drag();for(e=0;e<this.arrPol.length;e++)this.arrPol[e].drag(),this.arrPol[e].height>this._heightNew&&(this._heightNew=this.arrPol[e].height);this.dragHeight&&this.dragGG(),this.stage.render()},this.dragGG=function(){this._heightNew=0;for(var t=0;t<r;t++)this.arrSHron[t].sten.height>this._heightNew&&(this._heightNew=this.arrSHron[t].sten.height);for(var i=0;i<this.arrPol.length;i++)this.arrPol[i].height>this._heightNew&&(this._heightNew=this.arrPol[i].height);this.dragHeight&&this.dragHeight()},this.dragView=function(){for(var t=0;t<this.arrayClass.length;t++)this.arrayClass[t].drag&&this.arrayClass[t].drag()};var c=!1;this.korektSH=function(){if(!c){c=!0,g(!0);for(var t=0;t<this.arrSHron.length;t++)this.arrSHron[t].korektAngel();this.arrSHron.sort(y);for(t=0;t<this.arrSHron.length;t++)this.stage.spCalc.korektSHObject(this,t);g(!1),c=!1}};var l,u,p,d,f=null;function g(t){if(t)f=i.arrSHron.slice(),i.arrSHron=i.arrSHron.filter(function(t){var i=0===t.sten.tip?t.sten._delph/2:t.sten._delph;return t.sten.visible=t.sten._distans>i,t.sten.visible});else{i.arrSHron=f;for(var e=0;e<i.arrSHron.length;e++){var n=0===i.arrSHron[e].sten.tip?i.arrSHron[e].sten._delph/2:i.arrSHron[e].sten._delph;i.arrSHron[e].sten.visible=i.arrSHron[e].sten._distans>n}f=null}}function y(t,i){return t.rotation-i.rotation}this.setPointNotDrag=function(t){r=i.arrSHron.length,i.position._x=t.x,i.position._y=t.y;for(var e=0;e<r;e++){var n=i.arrSHron[e].sten.calculate;i.arrSHron[e].sten.calculate=!0,1==i.arrSHron[e].storona?(i.arrSHron[e].sten.position._x=t.x,i.arrSHron[e].sten.position._y=t.y):(i.arrSHron[e].sten.position1._x=t.x,i.arrSHron[e].sten.position1._y=t.y),i.arrSHron[e].sten.drag(),i.arrSHron[e].sten.calculate=n}},this.getConectedPoint=function(t){t=t||[this];for(var i=[],e=0;e<t.length;e++)h(t[e],i);return a(i),i},this.getConectedSten=function(t){t=t||[this];for(var i=[],e=0;e<t.length;e++)o(t[e],i);return a(i),i},this.funDragVokrug,this.dragVokrug=function(){for(var t=this.getConectedPoint(),i=this.getConectedSten(t),e=0;e<t.length;e++)t[e].korektSH(),t[e].dragView();for(e=0;e<i.length;e++)i[e].drag();this.funDragVokrug&&this.funDragVokrug(t,i)},this.doFunRend,this.drawposit=function(){null!=i.doFunRend&&i.doFunRend(),i.calculate||i.drag()},this.position=new PositionFun(0,0,this.drawposit),this.restart=function(){},this.clear=function(){if(this.life){if(2==this.arrSHron.length){this.arrStep=[];var t=this.stage.spCalc.getSten2AddPoint(this.arrSHron[0].sten,this),i=this.stage.spCalc.getSten2AddPoint(this.arrSHron[1].sten,this);if(-1!=this.getClonSten(-1,t,i))e=this.removeSplice(this.arrSHron[1].sten),n=this.removeSplice(this.arrSHron[0].sten),e.sten.clear(),n.sten.clear();else{t=this.arrSHron[0].sten._addPoint.idArr==this.idArr?this.arrSHron[0].sten._addPoint1:this.arrSHron[0].sten._addPoint;var e=this.removeSplice(this.arrSHron[1].sten),n=this.removeSplice(this.arrSHron[0].sten);e.sten._addPoint.idArr==this.idArr?(t.addSplice(e.sten,!0),1===e.sten.tip&&1===n.sten.tip&&e.sten.lineRange.p2.setPoint(n.sten._addPoint1.position)):(t.addSplice(e.sten,!1),1===e.sten.tip&&1===n.sten.tip&&e.sten.lineRange.p2.setPoint(n.sten._addPoint.position)),e.sten.addPoint1.drag(),e.sten.addPoint.drag(),this.life=!1,n.sten.clear()}}else{this.arrStep=[];for(var s=this.arrSHron.length-1;s>=0;s--){null!=(n=this.removeSplice(this.arrSHron[s].sten)).sten&&(n.sten.addPoint.idArr!=this.idArr&&n.sten.addPoint1.idArr!=this.idArr||(n.life=!1,n.sten.clear()))}}for(var r=0;r<this.arrayClass.length;r++)"function"==typeof this.arrayClass[r].clear&&this.arrayClass[r].clear();for(s=0;s<this.arrPol.length;s++)this.arrPol[s]&&this.removePol(this.arrPol[s]);this.life=!1,this.stage.render()}},this.clearFree=function(){0==this.arrSHron.length&&0==this.arrPol.length&&this.clear()},this.getClonSten=function(t,i,e){if(i&&e)for(var n=0;n<this.stage.arrSplice.length;n++){var s=this.stage.arrSplice[n];if(s.life&&(s.idArr!==t&&s.addPoint&&s.addPoint1)){if(s.addPoint.idArr===i.idArr&&s.addPoint1.idArr===e.idArr)return n;if(s.addPoint1.idArr===i.idArr&&s.addPoint.idArr===e.idArr)return n}}return-1},this.slitie=function(t){if(0!=this.life&&0!=t.life){for(var i=null,e=t.arrSHron.length-1;e>=0;e--)for(var n=0;n<this.arrSHron.length;n++)if(this.arrSHron[n].sten.idArr==t.arrSHron[e].sten.idArr&&this.arrSHron[n].sten._distans<2){i=this.arrSHron[n].sten;break}if(i){var s={};for(e=t.arrSHron.length-1;e>=0;e--)i.idArr==t.arrSHron[e].sten.idArr&&(s.sten=t.arrSHron[e].sten,s.storona=t.arrSHron[e].storona);t.removeSplice(i);for(e=this.arrSHron.length-1;e>=0;e--)i.idArr==this.arrSHron[e].sten.idArr&&(s.sten=this.arrSHron[e].sten,s.storona=this.arrSHron[e].storona);this.removeSplice(i)}var r=[];for(e=t.arrSHron.length-1;e>=0;e--)r.push(t.arrSHron[e]);for(e=0;e<r.length;e++)t.removeSplice(r[e].sten);for(e=0;e<r.length;e++)this.addSplice(r[e].sten,r[e].storona);i&&i.clear(),t.clear()}},this.arrDistRadom=[],this.miniDist=-1,this.miniId=-1,this.miniOkSlit=-1,this.testDistRadom=function(t){this.arrDistRadom=[],this.miniDist=1e17,this.miniId=-1,this.miniOkSlit=-1;for(var i=0;i<this.stage.arrPoint.length;i++){if(t){for(var e=!1,n=0;n<t.length;n++)if(t[n].idArr==this.stage.arrPoint[i].idArr){e=!0;break}if(e)continue}this.idArr==i?this.arrDistRadom.push(-1):0==this.stage.arrPoint[i].life?this.arrDistRadom.push(-1):(this.arrDistRadom.push(calc.getDistance(this.position,this.stage.arrPoint[i].position)),this.miniDist>this.arrDistRadom[this.arrDistRadom.length-1]&&(this.miniDist=this.arrDistRadom[this.arrDistRadom.length-1],this.miniId=i,this.miniDist<aidPointStatic.radius&&(this.miniOkSlit=i)))}},this.isGroup=function(t){for(var i=0;i<this.arrSHron.length;i++){if(this.arrSHron[i].sten.addPoint&&this.arrSHron[i].sten.addPoint.idArr==this.idArr&&this.arrSHron[i].sten.addPoint1&&this.arrSHron[i].sten.addPoint1.idArr==t)return!0;if(this.arrSHron[i].sten.addPoint1&&this.arrSHron[i].sten.addPoint1.idArr==this.idArr&&this.arrSHron[i].sten.addPoint&&this.arrSHron[i].sten.addPoint.idArr==t)return!0}return!1},this.finaldrag=function(){for(var t=this.arrSHron.slice(),i=t.length-1;i>=0;i--)for(var e=0;e<this.arrSHron.length;e++)if(this.arrSHron[e].sten.idArr==t[i].sten.idArr){t[i].sten.life&&this.stage.korektSplice.paralelSten(t[i].sten);break}},this.rectangle=new Rectangle,this.getRect=function(){return this.rectangle.x=this.position.x-10,this.rectangle.y=this.position.y-10,this.rectangle.width=20,this.rectangle.height=20,this.rectangle},this.compare=function(t){return l=!0,u=this.getObj(),p=t,calc.getDistance(u.position,p.position)>.1&&(l=!1),l},this.rememberState=function(){(d=this.getObj()).life=this.life},this.saveChanges=function(){d&&(!this.compare(d)||(this.life,d.life)),d=null};var v=new Rectangle(-1/0,-1/0,1/0,1/0);this.getBoundRect=function(){return v.x=this.position.x-this.size3,v.y=this.position.y-this.size3,v.width=2*this.size3,v.height=2*this.size3,v}}function s(t){this.life=!0,this.sten=void 0,this.storona=!0,this.aidPoint=t,this.rotation=0,this.bp=0,this.bp1=0,this.linePosition=new LinePosition,this.korektAngel=function(){this.linePosition.p.setPoint(this.aidPoint.position),1==this.storona?this.linePosition.p1.setPoint(this.sten.position1):this.linePosition.p1.setPoint(this.sten.position),this.linePosition.angel=calc.getAngle(this.linePosition.p,this.linePosition.p1),this.rotation=this.linePosition.angel+Math.PI},this.clear=function(){this.life=!1}}function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(){var t,i,e,n,s=new THREE.Vector3(0,0,0),o=new THREE.Vector3(0,0,0),h=new THREE.Vector3(0,0,0),c=new THREE.Vector3(0,0,0);this.DEG2RAD=Math.PI/180,this.RAD2DEG=180/Math.PI,this.getAngle=function(t,i){return i=i||c,t=t||c,Math.atan2(i.y-t.y,i.x-t.x)};var l,u,p,d,f,g,y,v,P,w=0;this.getAngle2=function(t,i){return i=i||c,t=t||c,(w=Math.atan2(i.y-t.y,i.x-t.x))<0&&(w+=2*Math.PI),w},this.getDistance=function(t,i){return null==t?0:(null==i&&(i=c),i=i||c,Math.sqrt(Math.pow(t.x-i.x,2)+Math.pow(t.y-i.y,2)))},this.getVector=function(t,i,e){if(null==e)e=new THREE.Vector2(0,0);return t<0&&(i+=Math.PI),e.x=Math.abs(t)*Math.cos(i),e.y=Math.abs(t)*Math.sin(i),e},this.isPointInLin=function(t,e,s,r,a){return this.getTreeAngel(t,e,s),a<0&&2*Math.abs(a)>n?null:o.x<=n+a&&o.x>=-a&&Math.abs(o.y)<=r?((h=o.x<0?this.getVector(o.x,i-Math.PI):this.getVector(o.x,i)).x+=e.x,h.y+=e.y,h.z=o.y,h):null},this.okrugPoint=function(t,i){null==i&&(i=100),t.x=Math.round(t.x/i)*i,t.y=Math.round(t.y/i)*i},this.okrugNumber=function(t,i){null==i&&(i=100);var e=Math.round(t*i)/i;return t=e,e},this.isInTriangle=function(t,i,e,n){var s=(t.x-n.x)*(i.y-t.y)-(i.x-t.x)*(t.y-n.y),r=(i.x-n.x)*(e.y-i.y)-(e.x-i.x)*(i.y-n.y),o=(e.x-n.x)*(t.y-e.y)-(t.x-e.x)*(e.y-n.y);return s>=0&&r>=0&&o>=0||s<=0&&r<=0&&o<=0},this.getTreeAngel=function(t,s,r,h){return i=this.getAngle(s,t),e=this.getAngle(s,r),l=this.getDistance(s,r),n=this.getDistance(t,s),this.getVector(l,e-i,o),e=this.getAngle(c,o),null==h?e:e>0?e:2*Math.PI+e},this.getTreeAngelPI2=function(t,i,e){x1=t.x-i.x,x2=e.x-i.x,y1=t.y-i.y,y2=e.y-i.y,n=Math.sqrt(x1*x1+y1*y1),d2=Math.sqrt(x2*x2+y2*y2);var s=(x1*x2+y1*y2)/(n*d2);return s>1&&(s=1),s<-1&&(s=-1),Math.acos(s)},this.isLineInTriangle=function(i,e,n,r,o){return(t=this.getPointOfIntersection(i,e,r,o))?(s.x=t.x,s.y=t.y,s.z=0,s):(t=this.getPointOfIntersection(e,n,r,o))?(s.x=t.x,s.y=t.y,s.z=1,s):!!(t=this.getPointOfIntersection(n,i,r,o))&&(s.x=t.x,s.y=t.y,s.z=2,s)};var b,x,_,m,S=new THREE.Vector2(0,0);this.getPointOfIntersection=function(t,i,e,n){return l=(t.x-i.x)*(n.y-e.y)-(t.y-i.y)*(n.x-e.x),u=(t.x-e.x)*(n.y-e.y)-(t.y-e.y)*(n.x-e.x),p=(t.x-i.x)*(t.y-e.y)-(t.y-i.y)*(t.x-e.x),f=p/l,(d=u/l)>=0&&d<=1&&f>=0&&f<=1?(g=t.x+d*(i.x-t.x),y=t.y+d*(i.y-t.y),S.x=g,S.y=y,S):null},this.korektToLine=function(t,i,e,n,s){v=this.getDistance(t,i),P=null==s?this.getAngle(t,i):s,0!=n&&(S=n<0?this.getVector(-n,P-Math.PI/2):this.getVector(n,P+Math.PI/2),t.x+=S.x,t.y+=S.y,i.x+=S.x,i.y+=S.y),S=this.getVector(e,P),i.x+=S.x,i.y+=S.y,S=this.getVector(e,P+Math.PI),t.x+=S.x,t.y+=S.y},this.getProsent3Point=function(t,i,e){return u=this.getDistance(t,i),(p=this.getDistance(t,e))/u},this.povotorOtAngel=function(t,i,e){return P=this.getAngle(t,i),v=this.getDistance(t,i),this.getVector(v,P+e)},this.testPositPoint=function(t,i,e){return null==e&&(e=100),Math.round(t.x*e)/e==Math.round(i.x*e)/e&&Math.round(t.y*e)/e==Math.round(i.y*e)/e},this.okrugAngel=function(t,i,e){var n=t;b=1,t<0&&(b=-1),x=Math.abs(t),_=Math.round(x/i)+1,m=0;for(var s=_;s>=0;s--){if(x>s*i-e&&x<s*i+e)return n=s*i*b;if(3==++m)return n}return n};var M=new a,C=new a,O=[];this.getLineCircleIntersectionPoints=function(t,i,e,n,s){O.length=0;var r=i.x-t.x,o=i.y-t.y,h=e.x-t.x,a=e.y-t.y,c=r*r+o*o,l=(r*h+o*a)/c,u=l*l-(h*h+a*a-n*n)/c;if(u<0)return O;var p=Math.sqrt(u),d=-l+p,f=-l-p;return M.set(t.x-r*d,t.y-o*d),this.isPointInLine(t,i,M)&&O.push(M),0==u?O:(C.set(t.x-r*f,t.y-o*f),this.isPointInLine(t,i,C)&&O.push(C),s&&2==O.length&&(b=this.getDistance(t,O[0]),x=this.getDistance(t,O[1]),b>x&&O.reverse()),O)},this.isPointInLine=function(t,i,e){var n=calc.getDistance(t,i),s=calc.getDistance(t,e),r=calc.getDistance(i,e);return calc.okrugNumber(s+r)===calc.okrugNumber(n)},this.getDistancePointToLine=function(t,i,e){var n=((i.y-t.y)*e.x-(i.x-t.x)*e.y+i.x*t.y-i.y*t.x)/calc.getDistance(t,i);return-calc.okrugNumber(Number.isFinite(n)?n:0)},this.getCircleCircleIntersectionPoints=function(t,i,e,n){var s,r,o,h,a;return O.length=0,(o=Math.sqrt(Math.pow(Math.abs(t.x-e.x),2)+Math.pow(Math.abs(t.y-e.y),2)))>i+n?O:(h=(i*i-n*n+o*o)/(2*o),a=Math.sqrt(Math.pow(i,2)-Math.pow(h,2)),isNaN(a)?O:(s=t.x+h*(e.x-t.x)/o,r=t.y+h*(e.y-t.y)/o,M.x=s+a*(e.y-t.y)/o,M.y=r-a*(e.x-t.x)/o,O.push(M),h==i?O:(C.x=s-a*(e.y-t.y)/o,C.y=r+a*(e.x-t.x)/o,O.push(C),O)))};var j=[new a,new a,new a,new a],I=[new a,new a,new a,new a];this.isIntersectionRect=function(t,i){return j[0].set(t.x,t.y),j[1].set(t.x+t.width,t.y),j[2].set(t.x+t.width,t.y+t.height),j[3].set(t.x,t.y+t.height),I[0].set(i.x,i.y),I[1].set(i.x+i.width,i.y),I[2].set(i.x+i.width,i.y+i.height),I[3].set(i.x,i.y+i.height),this.isIntersectionFromPoint(j,I)},this.isRectS=function(t,i){return 1==this.colisiLine2D(t.x,t.x+(null==t.w?t.width:t.w),i.x,i.x+(null==i.w?i.width:i.w))&&1==this.colisiLine2D(t.y,t.y+(null==t.h?t.height:t.h),i.y,i.y+(null==i.h?i.height:i.h))},this.colisiLine2D=function(t,i,e,n){return e>=t&&e<=i||t>=e&&t<=n},this.isRectPoint=function(t,i){return i.x>=t.x&&i.y>=t.y&&i.x<=t.x+(null==t.w?t.width:t.w)&&i.y<=t.y+(null==t.h?t.height:t.h)};var D=new a,A=new a;this.isRectLine=function(t,i,e){return 1==this.isRectPoint(t,i)||(1==this.isRectPoint(t,e)||(D.set(t.x,t.y),A.set(t.x+(null==t.w?t.width:t.w),t.y),null!=this.getPointOfIntersection(D,A,i,e)||(D.set(t.x+(null==t.w?t.width:t.w),t.y),A.set(t.x+(null==t.w?t.width:t.w),t.y+(null==t.h?t.height:t.h)),null!=this.getPointOfIntersection(D,A,i,e)||(D.set(t.x+(null==t.w?t.width:t.w),t.y+(null==t.h?t.height:t.h)),A.set(t.x,t.y+(null==t.h?t.height:t.h)),null!=this.getPointOfIntersection(D,A,i,e)||(D.set(t.x,t.y+(null==t.h?t.height:t.h)),A.set(t.x,t.y),null!=this.getPointOfIntersection(D,A,i,e))))))},this.isIntersectionFromPoint=function(t,i){for(var e=0;e<t.length-2;e++)for(var n=0;n<i.length-2;n++)if(calc.getPointOfIntersection(t[e],t[(e+2)%t.length],i[n],i[(n+2)%i.length]))return!0;for(e=0;e<t.length;e++)for(n=0;n<i.length;n++)if(calc.getPointOfIntersection(t[e],t[(e+1)%t.length],i[n],i[(n+1)%i.length]))return!0;for(e=0;e<i.length;e+=2)if(calc.contains(i[e].x,i[e].y,t))return!0;for(e=0;e<t.length;e+=2)if(calc.contains(t[e].x,t[e].y,i))return!0;return!1},this.isParalel=function(t,i,e,n,s){s=s||0;var r=Math.abs(calc.getAngle(t,i)%Math.PI),o=Math.abs(calc.getAngle(i,t)%Math.PI),h=Math.abs(calc.getAngle(e,n)%Math.PI),a=Math.abs(calc.getAngle(n,e)%Math.PI);return Math.min(Math.abs(r-h),Math.abs(o-a),Math.abs(r-a),Math.abs(o-h))<=s},this.rotationPoint=function(t,i,e){var n=0,s=0;e?(n=e.x+(t.x-e.x)*Math.cos(i)-(t.y-e.y)*Math.sin(i),s=e.y+(t.y-e.y)*Math.cos(i)+(t.x-e.x)*Math.sin(i)):(n=t.x*Math.cos(i)-t.y*Math.sin(i),s=t.y*Math.cos(i)+t.x*Math.sin(i)),t.x=n,t.y=s},this.rotationPointByLength=function(t,i,e){e=e||c;var n=calc.getDistance(t,e),s=calc.getLenghtCircle(n),r=i*(2*Math.PI/s);calc.rotationPoint(t,r,e)},this.isIntersectionTriangle=function(t,i,e,n,s,r){for(var o=!1,h=[t,i,e],a=[n,s,r],c=0;c<h.length&&!o;c++)o=calc.isInTriangle(n,s,r,h[c]);for(c=0;c<a.length&&!o;c++)o=calc.isInTriangle(t,i,e,a[c]);if(!o)for(c=0;c<h.length;c++)for(var l=0;l<a.length&&!o;l++)o=calc.getPointOfIntersection(h[c],h[(c+1)%h.length],a[l],a[(l+1)%a.length]);return o},this.getArrPointCircle=function(t,i,e,n,s,r,o){var h,c=calc.getAngle(e,t)-Math.PI,l=calc.getAngle(n,t)-Math.PI;h=o||[new a],s=s||5,!(r=r||!1)&&l<=c?l+=2*Math.PI:r&&c<=l&&(c+=2*Math.PI);var u=r?-1*(c-l):l-c,p=Math.ceil(Math.abs(u)/(2*Math.PI))*(s-1),d=u/(2*p),f=2*d,g=Math.cos(d),y=Math.sin(d),v=p-1,P=v%1/v,w=0,b=0,x=0,_=0,m=0;h[0].x=t.x+Math.cos(c)*i,h[0].y=t.y+Math.sin(c)*i;for(var S=0;S<=v;S++)w=d+c+(f*S+P*S),_=(g*(b=Math.cos(w))+y*(x=-Math.sin(w)))*i+t.x,m=(g*-x+y*b)*i+t.y,h[S+1]?(h[S+1].x=_,h[S+1].y=m):h.push(new a(_,m));return h},this.getLenghtCircle=function(t,i,e,n,s){i||(i=e=n=c);var r=calc.getAngle(e,i)-Math.PI,o=calc.getAngle(n,i)-Math.PI;return r===o&&e!==n?0:(!(s=s||!1)&&o<=r?o+=2*Math.PI:s&&r<=o&&(r+=2*Math.PI),Math.PI*t*(s?r-o:o-r)/Math.PI)},this.getLengthByWidth=function(t,i){var e=new a(0,0),n=new a(t,0),s=calc.getVector(i,.5*Math.PI);s.x=t/2;var r=calc.getCenterCircle(e,n,s);return r?calc.getLenghtCircle(calc.getDistance(r,e),r,e,n,i>0):t},this.getCenterCircle=function(t,i,e){var n=i.x-t.x,s=i.y-t.y,r=e.x-t.x,o=e.y-t.y,h=n*(t.x+i.x)+s*(t.y+i.y),c=r*(t.x+e.x)+o*(t.y+e.y),l=2*(n*(e.y-i.y)-s*(e.x-i.x));return 0===l?null:new a((o*h-s*c)/l,(n*c-r*h)/l)},this.getArcPoint=function(t,i,e,n,s){n=n||5;var r=calc.getAngle(t,i)+90*calc.DEG2RAD,o=calc.getVector(e,r),h=new a((t.x+i.x)/2,(t.y+i.y)/2);h.x+=o.x,h.y+=o.y;var c=calc.getCenterCircle(t,h,i);return c?calc.getArrPointCircle(c,calc.getDistance(c,t),t,i,n,e>0,s):[t,i]},this.getArea=function(t){for(var i=t.length,e=0,n=i-1,s=0;s<i;n=s++)e+=t[n].x*t[s].y-t[s].x*t[n].y;return.5*e||0},this.generateUUID=function(){for(var t=[],i=0;i<256;i++)t[i]=(i<16?"0":"")+i.toString(16);return function(){var i=4294967295*Math.random()|0,e=4294967295*Math.random()|0,n=4294967295*Math.random()|0,s=4294967295*Math.random()|0;return(t[255&i]+t[i>>8&255]+t[i>>16&255]+t[i>>24&255]+"-"+t[255&e]+t[e>>8&255]+"-"+t[e>>16&15|64]+t[e>>24&255]+"-"+t[63&n|128]+t[n>>8&255]+"-"+t[n>>16&255]+t[n>>24&255]+t[255&s]+t[s>>8&255]+t[s>>16&255]+t[s>>24&255]).toUpperCase()}}(),this.generateRendom=function(t){null==t&&(t=2);for(var i,e="",n="",s=0;s<t;s++){if((n=(255&(i=4294967295*Math.random()|0)).toString(16)+(i>>8&255).toString(16)+(i>>16&255).toString(16)+(i>>24&255).toString(16)).length<8)for(var r=0;r<8-n.length+1;r++)n+="Z";e+=n,s!=t-1&&(e+="-")}return e},this.diffNum=function(t,i){return t>=0&&i>=0?Math.abs(t-i):t<=0&&i<=0?Math.abs(Math.abs(t)-Math.abs(i)):t<=0&&i>=0?Math.abs(t)+i:t>=0&&i<=0?t+Math.abs(i):void 0},this.getPercentNum=function(t,i,e){return((t=null!=t?t:0)-(i=null!=i?i:0))/((e=null!=e?e:100)-i)*100},this.getValueNum=function(t,i,e){return(t=null!=t?t:0)/100*((e=null!=e?e:100)-(i=null!=i?i:0))+i},this.getValueBetween=function(t,i,e){var n=Math.max(i,e),s=Math.min(i,e);return Math.max(Math.min(t,n),s)},this.contains=function(t,i,e){for(var n=!1,s=e.length,r=0,o=s-1;r<s;o=r++){if(e[r].x===t&&e[r].y===i)return!0;var h=e[r].x,a=e[r].y,c=e[o].x,l=e[o].y;a>i!=l>i&&t<(c-h)*(i-a)/(l-a)+h&&(n=!n)}return n};var k={maxX:0,minX:0,maxY:0,minY:0},R=new a,L=[new a,new a,new a,new a],T=new a;this.getBoundsRect=function(t,i){T.set(t.width/2,t.height/2),L[0].set(0,0),L[1].set(t.width,0),L[2].set(t.width,t.height),L[3].set(0,t.height);for(var e=0;e<L.length;e++)this.rotationPoint(L[e],i,T);k.maxX=-t.width,k.minX=t.width,k.maxY=-t.height,k.minY=t.height;for(e=0;e<L.length;e++)k.maxX=Math.max(k.maxX,L[e].x),k.minX=Math.min(k.minX,L[e].x),k.maxY=Math.max(k.maxY,L[e].y),k.minY=Math.min(k.minY,L[e].y);return R.x=k.minX,R.y=k.minY,R.width=k.maxX-k.minX,R.height=k.maxY-k.minY,R},this.getCurvatureByWidth=function(t,i){if(Math.abs(t)>2*i)return null;var e=Math.pow(Math.abs(t),2),n=Math.pow(i,2),s=Math.acos((n+n-e)/(2*n));return i*(1-Math.cos(s/2))*(t<0?-1:1)},this.getWidthByCurvature=function(t,i){return 2*i*Math.sin(Math.acos(1-2*Math.abs(t)/(2*i)))*(t<0?-1:1)};function E(t){return t!==Object(t)}this.compare=function t(i,e){if(E(i)&&E(e))return i===e;for(var n in i){if(i.hasOwnProperty(n)!==e.hasOwnProperty(n))return!1;switch(r(i[n])){case"object":if(!t(i[n],e[n]))return!1;break;case"function":if(void 0===e[n]||"compare"!==n&&i[n].toString()!==e[n].toString())return!1;break;case"number":if(Number(Number(i[n]).toFixed(3))!==Number(Number(e[n]).toFixed(3)))return!1;break;default:if(i[n]!==e[n])return!1}}for(var n in e)if(i.hasOwnProperty(n)!==e.hasOwnProperty(n))return!1;return!0}}function h(t,i){this.p=t||new a,this.p1=i||new a,this.p2=new a,this.status=0,this.perpendik=!0,this.angel=0,this.set=function(t,i){this.p=t||0,this.p1=i||0}}function a(t,i,e){this._x=t||0,this._y=i||0,this._z=e||0,this.set=function(t,i,e){this._x=t||0,this._y=i||0,void 0!==e&&(this._z=e)},this.setPoint=function(t){this._x=t.x,this._y=t.y,void 0!==t.z&&(this._z=t.z)},this.getObj=function(){var t={};return t.x=this._x,t.y=this._y,t.z=this._z,t},this.copy=function(){return new a(this._x,this._y,this._z)}}function c(t,i,e,n){this._x=t||0,this._y=i||0,this._z="function"!=typeof e&&e||0,this.fun="function"==typeof e?e:n,this.set=function(t,i,e){this._x=t||0,this._y=i||0,this._z=e||0,this.fun&&this.fun()},this.setPoint=function(t){this._x=t.x,this._y=t.y,this._z=t.z,this.fun&&this.fun()},this.getObj=function(){var t={};return t.x=this._x,t.y=this._y,t.z=this._z,t},this.copy=function(){return new c(this._x,this._y,this._z)}}function l(t,i,e,n,s){this._x=t||0,this._y=i||0,this._width=void 0!==e?e:100,this._height=void 0!==n?n:100,this.angel=0,this.p=new a,this.fun,this.set=function(t,i,e,n){this._x=t||0,this._y=i||0,this._width=void 0!==e?e:100,this._height=void 0!==n?n:100},this.setRect=function(t){this._x=t.x,this._y=t.y,this._width=t.width,this._height=t.height,this.p.setPoint(t.p),this.angel=t.angel}}function u(t){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function p(t){var i,e,s,r=this;this.type="Splice",this.tipe="Splice",this.stage=t,this.idArr=-1,this._life=!0,this._delph=20,this.delphMin=1,this.delphMax=1e7,this._tip=0,this.arrOpor=[],this._uuid=t.spCalc.generateUUID(),this.arrayClass=[],this.arrPosit=[new a,new a,new a,new a,new a,new a],this.arrPosit1=[new a,new a,new a,new a,new a,new a],this.bolPosit=!1,this.bolPosit1=!1,this._addPoint,this._addPoint1,this._rotation=0,this._distans=0,this._oporPointVisi=!0,this.rectangle=new l,this.drawposit=function(){r.drag()},this.position=new c(0,0,this.drawposit),this.position1=new c(0,0,this.drawposit),this._distans0=0,this._distans1=0,this.dL0=0,this.dL1=0,this.dR0=0,this.dR1=0,this.updateDistans01=function(){if(1===this.tip){this.lineRange.korectPoint2(this._delph/2,this.arrPosit[5],this.arrPosit1[5]),this._distans0=0;for(var t=1;t<this.lineRange.sahAngel;t++)this._distans0+=calc.getDistance(this.lineRange.arrPosit[t-1],this.lineRange.arrPosit[t]);this.lineRange.korectPoint2(this._delph/2,this.arrPosit[0],this.arrPosit1[0]),this._distans1=0;for(t=1;t<this.lineRange.sahAngel;t++)this._distans1+=calc.getDistance(this.lineRange.arrPosit[t-1],this.lineRange.arrPosit[t])}else this.dL0=this.arrPosit[0].x,this.dL0<this.arrPosit[1].x&&(this.dL0=this.arrPosit[1].x),this.dL1=this.arrPosit1[5].x,this.dL1<this.arrPosit1[4].x&&(this.dL1=this.arrPosit1[4].x),this.dR0=this.arrPosit[5].x,this.dR0<this.arrPosit[4].x&&(this.dR0=this.arrPosit[4].x),this.dR1=this.arrPosit1[0].x,this.dR1<this.arrPosit1[1].x&&(this.dR1=this.arrPosit1[1].x),this._distans0=this._distans+this.dL0+this.dL1,this._distans1=this._distans+this.dR0+this.dR1},this.clear=function(){this.arrState.length=0,this.addPoint&&(this.addPoint.removeSplice(this),this.addPoint.clearFree()),this.addPoint1&&(this.addPoint1.removeSplice(this),this.addPoint1.clearFree()),this.addPoint=void 0,this.addPoint1=void 0,o("clear"),this.life=!1,this.stage.render()};function o(t,i,e,n,s){for(var o=0;o<r.arrayClass.length;o++)"function"==typeof r.arrayClass[o][t]&&r.arrayClass[o][t](i,e,n,s)}this.dividedSten=function(t,r){if(!t||t instanceof n){if(t&&0==t.life)return t;if(null==t){var a=position2dFlor.getLocalIsStage();0==this._tip?(h=calc.isPointInLin(this.position,this.position1,a,9e6,9e6),(t=this.stage.craetPoint()).position.x=h.x,t.position.y=h.y):1==this._tip&&((t=this.stage.craetPoint()).position.x=a.x,t.position.y=a.y,s=this.isPointInLin(t.position),t.position.x=s.x,t.position.y=s.y)}if(o("beforDivid"),0==this._tip)(i=this.addPoint1).removeSplice(this),t.addSplice(this,!1),(e=this.stage.craetSplice()).setSten(this),t.addSplice(e,!0),i.addSplice(e,!1),t.drag();else if(1==this._tip){var c=this.lineRange.getLR(t.position,0),l=this.lineRange.getLR(t.position,1);(i=this.addPoint1).removeSplice(this),t.addSplice(this,!1),this.lineRange.setLR(c),(e=this.stage.craetSplice()).setSten(this),t.addSplice(e,!0),i.addSplice(e,!1),e.lineRange.setLR(l),t.position.x+=1e-6,t.dragVokrug()}return o("afterDivid",e),this.stage.render(),1==r?e:t}},this.restartTip=function(){1==this._tip&&(this.lineRange||(this.lineRange=new LineRange(40)),0==this.arrOpor.length&&this.arrOpor.push(new a),this.lineRange.p.setPoint(this.position),this.lineRange.p1.setPoint(this.position1),this.lineRange.upDate(),this.arrOpor[0].setPoint(this.lineRange.p2)),2==this._tip&&(this.arrOpor[0]||(this.arrOpor[0]=new a),this.arrOpor[1]||(this.arrOpor[1]=new a))},this._setAllParam=function(t,i){for(var e=0;e<r.arrayClass.length;e++)t in r.arrayClass[e]&&(r.arrayClass[e][t]=i)},this._callAllFun=o,this.isPointInLin=function(t,i,e,n){i=void 0===i?9e6:i,e=void 0===e?9e6:e;var s=null;if(0==this._tip)if(n){s=calc.isPointInLin(this.position,this.position1,t,i,0);var r=new a;r.setPoint(t),s&&r.setPoint(s),s||(s=calc.getDistance(this.position,r)<calc.getDistance(this.position1,r)?this.position:this.position1)}else s=calc.isPointInLin(this.position,this.position1,t,i,e);else 1==this._tip?s=this.lineRange.getPointInLineRange(t,i,e,n):window.console.warn("хз как isPointInLin",this._tip);return o("isPointInLin",t,i,e,s),s},this.getBoundRect=this.getRect=function(){if(this.rectangle.x=1/0,this.rectangle.y=1/0,this.rectangle.width=-1/0,this.rectangle.height=-1/0,0==this._tip){for(var t=0;t<this.arrPosit.length;t++)b(-this.arrPosit[t].x,this.arrPosit[t].y,!1);for(t=0;t<this.arrPosit1.length;t++)b(this.arrPosit1[t].x+this._distans,this.arrPosit1[t].y,!1)}else if(1==this._tip){this.lineRange.korectPoint2(this._delph/2),b(this.lineRange.arrPosit[0].x,this.lineRange.arrPosit[0].y,!0);for(t=1;t<this.lineRange.sahAngel;t++)b(this.lineRange.arrPosit[t].x,this.lineRange.arrPosit[t].y,!0);for(1==this.bolPosit1&&(b(this.arrPosit1[4].x,this.arrPosit1[4].y,!0),b(this.arrPosit1[3].x,this.arrPosit1[3].y,!0),b(this.arrPosit1[2].x,this.arrPosit1[2].y,!0),b(this.arrPosit1[1].x,this.arrPosit1[1].y,!0),b(this.arrPosit1[0].x,this.arrPosit1[0].y,!0)),this.lineRange.korectPoint2(-this._delph/2),t=this.lineRange.sahAngel-1;t>=0;t--)b(this.lineRange.arrPosit[t].x,this.lineRange.arrPosit[t].y,!0);1==this.bolPosit&&(b(this.arrPosit[0].x,this.arrPosit[0].y,!0),b(this.arrPosit[1].x,this.arrPosit[1].y,!0),b(this.arrPosit[2].x,this.arrPosit[2].y,!0),b(this.arrPosit[3].x,this.arrPosit[3].y,!0),b(this.arrPosit[4].x,this.arrPosit[4].y,!0))}else window.console.warn("хз как getRect",this._tip);return this.rectangle.width=this.rectangle.width-this.rectangle.x,this.rectangle.height=this.rectangle.height-this.rectangle.y,o("getRect",this.rectangle),this.rectangle},this.isColLine=function(t,i){if(0==this._tip)return calc.getPointOfIntersection(this.position,this.position1,t,i);if(1==this._tip){this.lineRange.korectPoint2(0);for(var e=1;e<this.lineRange.sahAngel-1;e++)if(calc.getPointOfIntersection(this.lineRange.arrPosit[e],this.lineRange.arrPosit[e+1],t,i))return!0}else window.console.warn("хз как isColLine",this._tip);return!1};var h,u=[new a,new a,new a,new a];this.isColRect=function(t){if(u[0].set(t.x,t.y),u[1].set(t.x+t.width,t.y),u[2].set(t.x+t.width,t.y+t.height),u[3].set(t.x,t.y+t.height),calc.isInTriangle(u[0],u[1],u[2],this.position))return!0;if(calc.isInTriangle(u[0],u[3],u[2],this.position))return!0;if(calc.isInTriangle(u[0],u[1],u[2],this.position1))return!0;if(calc.isInTriangle(u[0],u[3],u[2],this.position1))return!0;for(var i=0;i<u.length;i++)if(this.isColLine(u[i],u[(i+1)%u.length]))return!0;return!1},this.arrState=[],this.rememberState=function(){this.startObj=this.getObj(),calc.compare(this.startObj,this.arrState[this.arrState.length-1]||{})||this.arrState.push(this.startObj)},this.getLastState=function(){return this.arrState.pop()},this.saveChanges=function(){return h=!1},this.compareLastState=function(){};var p,d,f,g,y,v=new a,P=new a,w=new a;function b(t,i,e){0==e?(v.x=t,v.y=i,f=calc.getDistance(w,v),g=calc.getAngle(w,v),y=g+r._rotation,calc.getVector(f,y,P),P.x+=r.position.x,P.y+=r.position.y,p=P.x,d=P.y):(p=t,d=i),r.rectangle.x=Math.min(r.rectangle.x,p),r.rectangle.y=Math.min(r.rectangle.y,d),r.rectangle.width=Math.max(r.rectangle.width,p),r.rectangle.height=Math.max(r.rectangle.height,d)}function x(t,i){if(t)for(var e=0;e<t.arrSHron.length;e++)t.arrSHron[e].sten._addPoint&&i.push(t.arrSHron[e].sten._addPoint),t.arrSHron[e].sten._addPoint1&&i.push(t.arrSHron[e].sten._addPoint1)}function _(t,i){if(t)for(var e=0;e<t.arrSHron.length;e++)i.push(t.arrSHron[e].sten)}function m(t){for(var i=0;i<t.length;i++){for(var e=!1,n=0;n<t.length;n++)if(i!==n&&t[n].uuid===t[i].uuid){e=!0;break}e&&t.splice(i--,1)}}function S(t){for(var i=[],e=0;e<t.arrSHron.length;e++){var n=t.arrSHron[e].sten;i.push(n.uuid)}return i}this.dragVokrug=function(){var t=[],i=[];x(this._addPoint,t),x(this._addPoint1,t),m(t);for(var e=0;e<t.length;e++)_(t[e],i);m(i);for(e=0;e<i.length;e++)i[e].calculate=!0;for(e=0;e<t.length;e++)t[e].drag();for(e=0;e<t.length;e++)t[e].drag();for(e=0;e<i.length;e++)i[e].calculate=!1,i[e].drag()},this.getArrConectedSplice=function(){var t={};return t.arr=S(this.addPoint),t.arr1=S(this.addPoint1),t}}function d(t){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function f(){var t,i,e,n,s=new THREE.Vector3(0,0,0),r=new THREE.Vector3(0,0,0),o=new THREE.Vector3(0,0,0),h=new THREE.Vector3(0,0,0);this.DEG2RAD=Math.PI/180,this.RAD2DEG=180/Math.PI,this.getAngle=function(t,i){return i=i||h,t=t||h,Math.atan2(i.y-t.y,i.x-t.x)};var a,c,l,u,p,f,y,v,P,w=0;this.getAngle2=function(t,i){return i=i||h,t=t||h,(w=Math.atan2(i.y-t.y,i.x-t.x))<0&&(w+=2*Math.PI),w},this.getDistance=function(t,i){return null==t?0:(null==i&&(i=h),i=i||h,Math.sqrt(Math.pow(t.x-i.x,2)+Math.pow(t.y-i.y,2)))},this.getVector=function(t,i,e){if(null==e)e=new THREE.Vector2(0,0);return t<0&&(i+=Math.PI),e.x=Math.abs(t)*Math.cos(i),e.y=Math.abs(t)*Math.sin(i),e},this.isPointInLin=function(t,e,s,h,a){return this.getTreeAngel(t,e,s),a<0&&2*Math.abs(a)>n?null:r.x<=n+a&&r.x>=-a&&Math.abs(r.y)<=h?((o=r.x<0?this.getVector(r.x,i-Math.PI):this.getVector(r.x,i)).x+=e.x,o.y+=e.y,o.z=r.y,o):null},this.okrugPoint=function(t,i){null==i&&(i=100),t.x=Math.round(t.x/i)*i,t.y=Math.round(t.y/i)*i},this.okrugNumber=function(t,i){null==i&&(i=100);var e=Math.round(t*i)/i;return t=e,e},this.isInTriangle=function(t,i,e,n){var s=(t.x-n.x)*(i.y-t.y)-(i.x-t.x)*(t.y-n.y),r=(i.x-n.x)*(e.y-i.y)-(e.x-i.x)*(i.y-n.y),o=(e.x-n.x)*(t.y-e.y)-(t.x-e.x)*(e.y-n.y);return s>=0&&r>=0&&o>=0||s<=0&&r<=0&&o<=0},this.getTreeAngel=function(t,s,o,c){return i=this.getAngle(s,t),e=this.getAngle(s,o),a=this.getDistance(s,o),n=this.getDistance(t,s),this.getVector(a,e-i,r),e=this.getAngle(h,r),null==c?e:e>0?e:2*Math.PI+e},this.getTreeAngelPI2=function(t,i,e){x1=t.x-i.x,x2=e.x-i.x,y1=t.y-i.y,y2=e.y-i.y,n=Math.sqrt(x1*x1+y1*y1),d2=Math.sqrt(x2*x2+y2*y2);var s=(x1*x2+y1*y2)/(n*d2);return s>1&&(s=1),s<-1&&(s=-1),Math.acos(s)},this.isLineInTriangle=function(i,e,n,r,o){return(t=this.getPointOfIntersection(i,e,r,o))?(s.x=t.x,s.y=t.y,s.z=0,s):(t=this.getPointOfIntersection(e,n,r,o))?(s.x=t.x,s.y=t.y,s.z=1,s):!!(t=this.getPointOfIntersection(n,i,r,o))&&(s.x=t.x,s.y=t.y,s.z=2,s)};var b,x,_,m,S=new THREE.Vector2(0,0);this.getPointOfIntersection=function(t,i,e,n){return a=(t.x-i.x)*(n.y-e.y)-(t.y-i.y)*(n.x-e.x),c=(t.x-e.x)*(n.y-e.y)-(t.y-e.y)*(n.x-e.x),l=(t.x-i.x)*(t.y-e.y)-(t.y-i.y)*(t.x-e.x),p=l/a,(u=c/a)>=0&&u<=1&&p>=0&&p<=1?(f=t.x+u*(i.x-t.x),y=t.y+u*(i.y-t.y),S.x=f,S.y=y,S):null},this.korektToLine=function(t,i,e,n,s){v=this.getDistance(t,i),P=null==s?this.getAngle(t,i):s,0!=n&&(S=n<0?this.getVector(-n,P-Math.PI/2):this.getVector(n,P+Math.PI/2),t.x+=S.x,t.y+=S.y,i.x+=S.x,i.y+=S.y),S=this.getVector(e,P),i.x+=S.x,i.y+=S.y,S=this.getVector(e,P+Math.PI),t.x+=S.x,t.y+=S.y},this.getProsent3Point=function(t,i,e){return c=this.getDistance(t,i),(l=this.getDistance(t,e))/c},this.povotorOtAngel=function(t,i,e){return P=this.getAngle(t,i),v=this.getDistance(t,i),this.getVector(v,P+e)},this.testPositPoint=function(t,i,e){return null==e&&(e=100),Math.round(t.x*e)/e==Math.round(i.x*e)/e&&Math.round(t.y*e)/e==Math.round(i.y*e)/e},this.okrugAngel=function(t,i,e){var n=t;b=1,t<0&&(b=-1),x=Math.abs(t),_=Math.round(x/i)+1,m=0;for(var s=_;s>=0;s--){if(x>s*i-e&&x<s*i+e)return n=s*i*b;if(3==++m)return n}return n};var M=new g,C=new g,O=[];this.getLineCircleIntersectionPoints=function(t,i,e,n,s){O.length=0;var r=i.x-t.x,o=i.y-t.y,h=e.x-t.x,a=e.y-t.y,c=r*r+o*o,l=(r*h+o*a)/c,u=l*l-(h*h+a*a-n*n)/c;if(u<0)return O;var p=Math.sqrt(u),d=-l+p,f=-l-p;return M.set(t.x-r*d,t.y-o*d),this.isPointInLine(t,i,M)&&O.push(M),0==u?O:(C.set(t.x-r*f,t.y-o*f),this.isPointInLine(t,i,C)&&O.push(C),s&&2==O.length&&(b=this.getDistance(t,O[0]),x=this.getDistance(t,O[1]),b>x&&O.reverse()),O)},this.isPointInLine=function(t,i,e){var n=this.getDistance(t,i),s=this.getDistance(t,e),r=this.getDistance(i,e);return this.okrugNumber(s+r)===this.okrugNumber(n)},this.getDistancePointToLine=function(t,i,e){var n=((i.y-t.y)*e.x-(i.x-t.x)*e.y+i.x*t.y-i.y*t.x)/this.getDistance(t,i);return-this.okrugNumber(Number.isFinite(n)?n:0)},this.getCircleCircleIntersectionPoints=function(t,i,e,n){var s,r,o,h,a;return O.length=0,(o=Math.sqrt(Math.pow(Math.abs(t.x-e.x),2)+Math.pow(Math.abs(t.y-e.y),2)))>i+n?O:(h=(i*i-n*n+o*o)/(2*o),a=Math.sqrt(Math.pow(i,2)-Math.pow(h,2)),isNaN(a)?O:(s=t.x+h*(e.x-t.x)/o,r=t.y+h*(e.y-t.y)/o,M.x=s+a*(e.y-t.y)/o,M.y=r-a*(e.x-t.x)/o,O.push(M),h==i?O:(C.x=s-a*(e.y-t.y)/o,C.y=r+a*(e.x-t.x)/o,O.push(C),O)))};var j=[new g,new g,new g,new g],I=[new g,new g,new g,new g];this.isIntersectionRect=function(t,i){return j[0].set(t.x,t.y),j[1].set(t.x+t.width,t.y),j[2].set(t.x+t.width,t.y+t.height),j[3].set(t.x,t.y+t.height),I[0].set(i.x,i.y),I[1].set(i.x+i.width,i.y),I[2].set(i.x+i.width,i.y+i.height),I[3].set(i.x,i.y+i.height),this.isIntersectionFromPoint(j,I)},this.isIntersectionFromPoint=function(t,i){for(var e=0;e<t.length-2;e++)for(var n=0;n<i.length-2;n++)if(this.getPointOfIntersection(t[e],t[(e+2)%t.length],i[n],i[(n+2)%i.length]))return!0;for(e=0;e<t.length;e++)for(n=0;n<i.length;n++)if(this.getPointOfIntersection(t[e],t[(e+1)%t.length],i[n],i[(n+1)%i.length]))return!0;for(e=0;e<i.length;e+=2)if(this.contains(i[e].x,i[e].y,t))return!0;for(e=0;e<t.length;e+=2)if(this.contains(t[e].x,t[e].y,i))return!0;return!1},this.isParalel=function(t,i,e,n,s){s=s||0;var r=Math.abs(this.getAngle(t,i)%Math.PI),o=Math.abs(this.getAngle(i,t)%Math.PI),h=Math.abs(this.getAngle(e,n)%Math.PI),a=Math.abs(this.getAngle(n,e)%Math.PI);return Math.min(Math.abs(r-h),Math.abs(o-a),Math.abs(r-a),Math.abs(o-h))<=s},this.rotationPoint=function(t,i,e){var n=0,s=0;e?(n=e.x+(t.x-e.x)*Math.cos(i)-(t.y-e.y)*Math.sin(i),s=e.y+(t.y-e.y)*Math.cos(i)+(t.x-e.x)*Math.sin(i)):(n=t.x*Math.cos(i)-t.y*Math.sin(i),s=t.y*Math.cos(i)+t.x*Math.sin(i)),t.x=n,t.y=s},this.rotationPointByLength=function(t,i,e){e=e||h;var n=this.getDistance(t,e),s=this.getLenghtCircle(n),r=i*(2*Math.PI/s);this.rotationPoint(t,r,e)},this.isIntersectionTriangle=function(t,i,e,n,s,r){for(var o=!1,h=[t,i,e],a=[n,s,r],c=0;c<h.length&&!o;c++)o=this.isInTriangle(n,s,r,h[c]);for(c=0;c<a.length&&!o;c++)o=this.isInTriangle(t,i,e,a[c]);if(!o)for(c=0;c<h.length;c++)for(var l=0;l<a.length&&!o;l++)o=this.getPointOfIntersection(h[c],h[(c+1)%h.length],a[l],a[(l+1)%a.length]);return o},this.getArrPointCircle=function(t,i,e,n,s,r,o){var h,a=this.getAngle(e,t)-Math.PI,c=this.getAngle(n,t)-Math.PI;h=o||[new g],s=s||5,!(r=r||!1)&&c<=a?c+=2*Math.PI:r&&a<=c&&(a+=2*Math.PI);var l=r?-1*(a-c):c-a,u=Math.ceil(Math.abs(l)/(2*Math.PI))*(s-1),p=l/(2*u),d=2*p,f=Math.cos(p),y=Math.sin(p),v=u-1,P=v%1/v,w=0,b=0,x=0,_=0,m=0;h[0].x=t.x+Math.cos(a)*i,h[0].y=t.y+Math.sin(a)*i;for(var S=0;S<=v;S++)w=p+a+(d*S+P*S),_=(f*(b=Math.cos(w))+y*(x=-Math.sin(w)))*i+t.x,m=(f*-x+y*b)*i+t.y,h[S+1]?(h[S+1].x=_,h[S+1].y=m):h.push(new g(_,m));return h},this.getLenghtCircle=function(t,i,e,n,s){i||(i=e=n=h);var r=this.getAngle(e,i)-Math.PI,o=this.getAngle(n,i)-Math.PI;return r===o&&e!==n?0:(!(s=s||!1)&&o<=r?o+=2*Math.PI:s&&r<=o&&(r+=2*Math.PI),Math.PI*t*(s?r-o:o-r)/Math.PI)},this.getLengthByWidth=function(t,i){var e=new g(0,0),n=new g(t,0),s=this.getVector(i,.5*Math.PI);s.x=t/2;var r=this.getCenterCircle(e,n,s);return r?this.getLenghtCircle(this.getDistance(r,e),r,e,n,i>0):t},this.getCenterCircle=function(t,i,e){var n=i.x-t.x,s=i.y-t.y,r=e.x-t.x,o=e.y-t.y,h=n*(t.x+i.x)+s*(t.y+i.y),a=r*(t.x+e.x)+o*(t.y+e.y),c=2*(n*(e.y-i.y)-s*(e.x-i.x));return 0===c?null:new g((o*h-s*a)/c,(n*a-r*h)/c)},this.getArcPoint=function(t,i,e,n,s){n=n||5;var r=this.getAngle(t,i)+90*this.DEG2RAD,o=this.getVector(e,r),h=new g((t.x+i.x)/2,(t.y+i.y)/2);h.x+=o.x,h.y+=o.y;var a=this.getCenterCircle(t,h,i);return a?this.getArrPointCircle(a,this.getDistance(a,t),t,i,n,e>0,s):[t,i]},this.getArea=function(t){for(var i=t.length,e=0,n=i-1,s=0;s<i;n=s++)e+=t[n].x*t[s].y-t[s].x*t[n].y;return.5*e||0},this.generateUUID=function(){for(var t=[],i=0;i<256;i++)t[i]=(i<16?"0":"")+i.toString(16);return function(){var i=4294967295*Math.random()|0,e=4294967295*Math.random()|0,n=4294967295*Math.random()|0,s=4294967295*Math.random()|0;return(t[255&i]+t[i>>8&255]+t[i>>16&255]+t[i>>24&255]+"-"+t[255&e]+t[e>>8&255]+"-"+t[e>>16&15|64]+t[e>>24&255]+"-"+t[63&n|128]+t[n>>8&255]+"-"+t[n>>16&255]+t[n>>24&255]+t[255&s]+t[s>>8&255]+t[s>>16&255]+t[s>>24&255]).toUpperCase()}}(),this.generateRendom=function(t){null==t&&(t=2);for(var i,e="",n="",s=0;s<t;s++){if((n=(255&(i=4294967295*Math.random()|0)).toString(16)+(i>>8&255).toString(16)+(i>>16&255).toString(16)+(i>>24&255).toString(16)).length<8)for(var r=0;r<8-n.length+1;r++)n+="Z";e+=n,s!=t-1&&(e+="-")}return e},this.diffNum=function(t,i){return t>=0&&i>=0?Math.abs(t-i):t<=0&&i<=0?Math.abs(Math.abs(t)-Math.abs(i)):t<=0&&i>=0?Math.abs(t)+i:t>=0&&i<=0?t+Math.abs(i):void 0},this.getPercentNum=function(t,i,e){return((t=null!=t?t:0)-(i=null!=i?i:0))/((e=null!=e?e:100)-i)*100},this.getValueNum=function(t,i,e){return(t=null!=t?t:0)/100*((e=null!=e?e:100)-(i=null!=i?i:0))+i},this.getValueBetween=function(t,i,e){var n=Math.max(i,e),s=Math.min(i,e);return Math.max(Math.min(t,n),s)},this.contains=function(t,i,e){for(var n=!1,s=e.length,r=0,o=s-1;r<s;o=r++){if(e[r].x===t&&e[r].y===i)return!0;var h=e[r].x,a=e[r].y,c=e[o].x,l=e[o].y;a>i!=l>i&&t<(c-h)*(i-a)/(l-a)+h&&(n=!n)}return n};var D={maxX:0,minX:0,maxY:0,minY:0},A=new g,k=[new g,new g,new g,new g],R=new g;this.getBoundsRect=function(t,i){R.set(t.width/2,t.height/2),k[0].set(0,0),k[1].set(t.width,0),k[2].set(t.width,t.height),k[3].set(0,t.height);for(var e=0;e<k.length;e++)this.rotationPoint(k[e],i,R);D.maxX=-t.width,D.minX=t.width,D.maxY=-t.height,D.minY=t.height;for(e=0;e<k.length;e++)D.maxX=Math.max(D.maxX,k[e].x),D.minX=Math.min(D.minX,k[e].x),D.maxY=Math.max(D.maxY,k[e].y),D.minY=Math.min(D.minY,k[e].y);return A.x=D.minX,A.y=D.minY,A.width=D.maxX-D.minX,A.height=D.maxY-D.minY,A},this.getCurvatureByWidth=function(t,i){if(Math.abs(t)>2*i)return null;var e=Math.pow(Math.abs(t),2),n=Math.pow(i,2),s=Math.acos((n+n-e)/(2*n));return i*(1-Math.cos(s/2))*(t<0?-1:1)},this.getWidthByCurvature=function(t,i){return 2*i*Math.sin(Math.acos(1-2*Math.abs(t)/(2*i)))*(t<0?-1:1)};function L(t){return t!==Object(t)}this.compare=function t(i,e){if(L(i)&&L(e))return i===e;for(var n in i){if(i.hasOwnProperty(n)!==e.hasOwnProperty(n))return!1;switch(d(i[n])){case"object":if(!t(i[n],e[n]))return!1;break;case"function":if(void 0===e[n]||"compare"!==n&&i[n].toString()!==e[n].toString())return!1;break;case"number":if(Number(Number(i[n]).toFixed(3))!==Number(Number(e[n]).toFixed(3)))return!1;break;default:if(i[n]!==e[n])return!1}}for(var n in e)if(i.hasOwnProperty(n)!==e.hasOwnProperty(n))return!1;return!0}}function g(t,i,e){this._x=t||0,this._y=i||0,this._z=e||0,this.set=function(t,i,e){this._x=t||0,this._y=i||0,void 0!==e&&(this._z=e)},this.setPoint=function(t){this._x=t.x,this._y=t.y,void 0!==t.z&&(this._z=t.z)},this.getObj=function(){var t={};return t.x=this._x,t.y=this._y,t.z=this._z,t},this.copy=function(){return new g(this._x,this._y,this._z)}}function y(t,i,e,n){this._x=t||0,this._y=i||0,this._z="function"!=typeof e&&e||0,this.fun="function"==typeof e?e:n,this.set=function(t,i,e){this._x=t||0,this._y=i||0,this._z=e||0,this.fun&&this.fun()},this.setPoint=function(t){this._x=t.x,this._y=t.y,this._z=t.z,this.fun&&this.fun()},this.getObj=function(){var t={};return t.x=this._x,t.y=this._y,t.z=this._z,t},this.copy=function(){return new y(this._x,this._y,this._z)}}function v(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}n.prototype={set uuid(t){this._uuid!==t&&(this.funUpdateUuid&&this.funUpdateUuid(this._uuid,t),this._uuid=t)},get uuid(){return this._uuid},getObj:function(){var t={};return t.type=this.type,t.idArr=this.idArr,t.position=this.position.getObj(),t},setObj:function(t){this.position.setPoint(t.position)},restart:function(t){},set life(t){if(this._life!=t){this._life=t;for(var i=0;i<this.arrayClass.length;i++)null!=this.arrayClass[i].life&&(this.arrayClass[i].life=this._life)}},get life(){return this._life}},a.prototype={set x(t){this._x=t},get x(){return this._x},set y(t){this._y=t},get y(){return this._y},set z(t){this._z=t},get z(){return this._z}},c.prototype={set x(t){this._x=t,this.fun&&this.fun()},get x(){return this._x},set y(t){this._y=t,this.fun&&this.fun()},get y(){return this._y},set z(t){this._z=t,this.fun&&this.fun()},get z(){return this._z}},l.prototype={set x(t){this._x!==t&&(this._x=t)},get x(){return this._x},set y(t){this._y!==t&&(this._y=t)},get y(){return this._y},set width(t){this._width!==t&&(this._width=t)},get width(){return this._width},set height(t){this._height!==t&&(this._height=t)},get height(){return this._height}},p.prototype={set uuid(t){this._uuid!==t&&(this.funUpdateUuid&&this.funUpdateUuid(this._uuid,t),this._uuid=t)},get uuid(){return this._uuid},getObj:function(){var t={};if(t.type=this.type,t.idArr=this.idArr,t.delph=this.delph,t.tip=this.tip,t.position=this.addPoint?this.addPoint.position.getObj():this.position.getObj(),t.position1=this.addPoint1?this.addPoint1.position.getObj():this.position1.getObj(),t.connected=this.getArrConectedSplice(),this.lineRange&&(t.position2=this.lineRange.p2.getObj()),0!=this.tip){t.arrOpor=[];for(var i=0;i<this.arrOpor.length;i++)t.arrOpor.push({x:this.arrOpor[i].x,y:this.arrOpor[i].y})}return t.uuid=this.uuid,t},setObj:function(t){if(void 0!==t.uuid&&(this.uuid=t.uuid),this.clear(),void 0!==t.delph&&(this._delph=t.delph),void 0!==t.position&&this.position.setPoint(t.position),void 0!==t.position1&&this.position1.setPoint(t.position1),void 0!==t.connected&&(this.connected=t.connected),this.stage.stenInPoint(this),void 0!==t.curve&&(this.tip=t.curve?1:0),void 0!==t.tip&&(this.tip=t.tip),t.position2&&1===this.tip&&(this.lineRange.setTwoPoint(this.position,this.position1),this.lineRange.setCurvFromPoint(t.position2)),null!=t.arrOpor)for(var i=0;i<t.arrOpor.length;i++)this.arrOpor[i]||(this.arrOpor[i]=new a),this.arrOpor[i].set(t.arrOpor[i].x,t.arrOpor[i].y);null!=this._addPoint&&this._addPoint.drag(),null!=this._addPoint1&&this._addPoint1.drag(),this.life=!0,this.drag()},setSten:function(t){void 0!==t.tip&&(this.tip=t.tip),void 0!==t.lineRange&&void 0!==this.lineRange&&this.lineRange.setLR(t.lineRange),void 0!==t.position&&this.position.setPoint(t.position),void 0!==t.position1&&this.position1.setPoint(t.position1),void 0!==t.delph&&(this.delph=t.delph)},restart:function(t){},compare:function(t,i){return rez=!0,s1=t.getObj(),s2=i,t.delph!=s2.delph&&(rez=!1),calc.getDistance(s1.position,s2.position)>.1&&(rez=!1),s1.position2&&s2.position2&&calc.getDistance(s1.position2,s2.position2)>.1&&(rez=!1),t.tip!=s2.tip&&(rez=!1),rez},drag:function(){this._rotation=this.stage.spCalc.getAngle(this.position,this.position1),this._distans=this.stage.spCalc.getDistance(this.position,this.position1),1==this.tip&&(this.lineRange.p.setPoint(this.position),this.lineRange.p1.setPoint(this.position1),this.lineRange.upDate(),this.arrOpor[0].set(this.lineRange.pint90.x,this.lineRange.pint90.y)),this.calculate||(this._callAllFun("drag"),this.funDragOne&&this.funDragOne())},clone:function(t){var i=this.stage.craetSplice(),e=this.stage.craetPoint(),n=this.stage.craetPoint();e.position.set(this.position.x,this.position.y),n.position.set(this.position1.x,this.position1.y);var s=this.getObj();return function t(i){void 0!==i.uuid&&(i.uuid=calc.generateUUID());for(var e in i)"object"===u(i[e])&&t(i[e])}(s),s.uuid=i.uuid,i.setObj(s),i.addPoint.removeSplice(i),i.addPoint1.removeSplice(i),e.addSplice(i,!0),n.addSplice(i,!1),t&&(e.position.x+=t.x,e.position.y+=t.y,n.position.x+=t.x,n.position.y+=t.y),i},set addPoint(t){this._addPoint!=t&&(this._addPoint=t,null!=this._addPoint1&&null!=this._addPoint&&this._addPoint1.idArr==this._addPoint.idArr&&this.clear())},get addPoint(){return this._addPoint},set addPoint1(t){this._addPoint1!=t&&(this._addPoint1=t,null!=this._addPoint&&null!=this._addPoint1&&this._addPoint.idArr==this._addPoint1.idArr&&this.clear())},get addPoint1(){return this._addPoint1},set delph(t){this._delph!=t&&(this._delph=t,this._setAllParam("delph",this._delph),null!=this._addPoint&&this._addPoint.drag(),null!=this._addPoint1&&this._addPoint1.drag())},get delph(){return this._delph},set tip(t){this._tip!=t&&(this._tip=t,this.calculate=!0,this.restartTip(),this._setAllParam("tip",this._tip),null!=this._addPoint&&this._addPoint.drag(),null!=this._addPoint1&&this._addPoint1.drag(),this.calculate=!1,this.drag())},get tip(){return this._tip},set life(t){this._life!=t&&(this._life=t,this._setAllParam("life",this._life))},get life(){return this._life},set activMouse(t){this._activMouse!=t&&(this._activMouse=t,this._setAllParam("activMouse",this._activMouse))},get activMouse(){return this._activMouse},set oporPointVisi(t){this._oporPointVisi!=t&&(this._oporPointVisi=t,this._setAllParam("oporPointVisi",this._oporPointVisi))},get oporPointVisi(){return this._oporPointVisi},set distans0(t){if(this._distans0!==t){var i=this.position.copy(),e=this.position1.copy();calc.korektToLine(i,e,(t-this._distans0)/2,0),this.addPoint&&(this.addPoint.position.setPoint(i),this.addPoint1.position.setPoint(e),this.addPoint.dragVokrug(),this.addPoint1.dragVokrug())}},get distans0(){return this.updateDistans01(),this._distans0},set distans1(t){if(this._distans1!==t){var i=this.position.copy(),e=this.position1.copy();calc.korektToLine(i,e,(t-this._distans1)/2,0),this.addPoint&&(this.addPoint.position.setPoint(i),this.addPoint1.position.setPoint(e),this.addPoint.dragVokrug(),this.addPoint1.dragVokrug())}},get distans1(){return this.updateDistans01(),this._distans1},set visible(t){this._visible!==t&&(this._visible=t,this._setAllParam("visible",this._visible))},get visible(){return this._visible}},g.prototype={set x(t){this._x=t},get x(){return this._x},set y(t){this._y=t},get y(){return this._y},set z(t){this._z=t},get z(){return this._z}},y.prototype={set x(t){this._x=t,this.fun&&this.fun()},get x(){return this._x},set y(t){this._y=t,this.fun&&this.fun()},get y(){return this._y},set z(t){this._z=t,this.fun&&this.fun()},get z(){return this._z}};var P=function t(i,e){v(this,t),this.type="Line";this.p=i,this.p1=e,this.p2=i+"1",this.array=[],this.arrayCheh=[];var n,s,r,o,h,a,c,l,u,p,d,f,g,y=[],P=[],b=[];this.maxP=0,this.getP=function(){return null==this.arrayCheh[this.array.length]&&(this.arrayCheh[this.array.length]=new w(this.p,this.p1)),this.arrayCheh[this.array.length]},this.set=function(t,i,e){if(this.dragArray(t,i,e),this.array.length=0,0==y.length)this.array[0]=this.getP(),this.array[0][this.p]=t[this.p],this.array[0][this.p1]=t[this.p1],this.array[0][this.p2]=t[this.p]+t[this.p1];else{o=t[this.p],l=0;for(var n=0;n<y.length;n+=2)this.array[l]=this.getP(),this.array[l][this.p]=o,this.array[l][this.p1]=y[n]-o,this.array[l][this.p2]=this.array[l][this.p]+this.array[l][this.p1],o=y[n+1],l++;this.array[l]=this.getP(),this.array[l][this.p]=o,this.array[l][this.p1]=t[this.p1]-o+t[this.p],this.array[l][this.p2]=t[this.p1]}for(this.maxP=0,n=0;n<this.array.length;n++)this.array[n][this.p1]>this.maxP&&(this.maxP=this.array[n][this.p1])},this.dragArray=function(t,i,e){if(y.length=0,0!=i.length){if(null==e)b=i;else if(b=[],null!=e[0])for(s=0;s<i.length;s++){for(n=!0,r=0;r<e.length;r++)e[r].uuid==i[s].uuid&&(n=!1,r=9999);n&&b.push(i[s])}else for(s=0;s<i.length;s++)n=!0,e.uuid==i[s].uuid&&(n=!1),n&&b.push(i[s]);for(P.length=0,s=0;s<b.length;s++)for(p=b[s],r=0;r<p.children.length;r++)u=p.children[r],P.push(p.position[this.p]+u.rect[this.p],p.position[this.p]+u.rect[this.p]+u.rect[this.p1]);0!=P.length&&(this.sort(P,y),this.sort2(y))}},this.sort=function(t,i){if(0!=t.length){for(d=1e20,f=-1,s=0;s<t.length;s+=2)t[s]<d&&(d=t[s],f=s);if(-1!=f){if(2!=(g=t.splice(f,2)).length)return;if(1==isNaN(g[0]))return;for(s=0;s<2;s++)i.push(g[s]);this.sort(t,i,2)}}},this.sort2=function(t){if(2!=t.length){r=t.length-2;for(var i=0;i<r;i+=2)if(t[i+1]>=t[i+2])return t[i+1]>=t[i+3]?(t.splice(i+2,2),void this.sort2(t)):(t[i+1]=t[i+3],t.splice(i+2,2),void this.sort2(t))}},this.isBlokPlace=function(t){return trace(t.rect[this.p1]+"     "+this.maxP),t.rect[this.p1]<this.maxP};var x=[],_=[];this.korektPosition=function(t){for(x.length=0,s=0;s<this.array.length;s++)this.array[s][this.p1]>=t.rect[this.p1]&&x.push(this.array[s]);for(s=0;s<x.length;s++)if(t.rect[this.p]+t.position[this.p]>x[s][this.p]&&t.rect[this.p]+t.rect[this.p1]+t.position[this.p]<x[s][this.p]+x[s][this.p1])return;for(_.length=0,s=0;s<x.length;s++)_.push(x[s][this.p]-t.rect[this.p]),_.push(x[s][this.p]+x[s][this.p1]-t.rect[this.p]-t.rect[this.p1]);for(r=1e18,a=1e18,o=0,s=0;s<_.length;s++)(a=Math.abs(_[s]-t.position["_"+this.p]))<r&&(r=a,o=s);t.position["_"+this.p]=_[o]};var m=[];this.naLineRect=function(t,i){for(m.length=0,a=t[this.p],c=t[this.p]+t[this.p1],s=0;s<i.length;s++)o=i[s].rect[this.p]+i[s].position[this.p],h=i[s].rect[this.p]+i[s].position[this.p]+i[s].rect[this.p1],o>=a&&h<=c||m.push(i[s]);return m}},w=function t(i,e){v(this,t),this.type="LPosition";this.p=i,this.p1=e,this.p2=i+"1",this[i]=0,this[e]=0,this[i+"1"]=0};function b(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var x=function(){function t(i){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,t),this.type="World";var e=this;this.fun=i,this.children=[];var n;this.rect={x:-999,y:-999,z:-999,w:1998,h:1998,d:1998},this.calc=new f,this.line_x=new P("x","w"),this.add=function(t){this.children.push(t),t.parent=this,this.korekt()},this.remove=function(t){var i=this.getId(t);return-1!=i&&(this.children.splice(i,1),this.korekt(),t.parent=void 0,this.remove(t)),null},this.getId=function(t){for(var i=0;i<this.children.length;i++)if(this.children[i].uuid==t.uuid)return i;return-1},this.korekt=function(){this.line_x.set(this.rect,this.children),this.drawDeb()},this.korektPosition=function(t){this.line_x.set(this.rect,this.children,t),this.line_x.korektPosition(t),e.korekt(),e.drawDeb(),e.fun("korektPosition",t)},this.dragRect=function(){0!=(n=this.line_x.naLineRect(this.rect,this.children)).length&&i("clearBodys",n);for(var t=0;t<n.length;t++)this.remove(n[t]);this.korekt()},this.deb=void 0;var s={x:0,y:0,z:0,w:100,h:100,d:100};this.drawDeb=function(){if(null!=this.deb){this.deb.clear(),this.deb.dRect(this.rect,16711680,20);for(var t=0;t<this.children.length;t++)this.drawCild(this.children[t]);for(t=0;t<this.line_x.array.length;t++)s.x=this.line_x.array[t][this.line_x.p],s.w=this.line_x.array[t][this.line_x.p1],s.y=-1e3,s.h=1e3,this.deb.dRect(s,255,20)}},this.drawCild=function(t){for(var i=0;i<t.children.length;i++)s.x=t.position.x+t.children[i].rect.x,s.y=t.position.z+t.children[i].rect.z,s.w=t.children[i].rect.w,s.h=t.children[i].rect.d,this.deb.dRect(s,65280,20)}}var i,e,n;return i=t,(e=[{key:"parent",set:function(t){this._parent!=t&&(this._parent=t)},get:function(){return this._parent}}])&&b(i.prototype,e),n&&b(i,n),t}(),_=e(1);function m(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var S=function(){function t(i,e){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,t);var n,s,r,o=this;this.type="SPLWindow",this.uuid=calc.generateRendom(2),this.par=i,this.fun=e,this._delph=i._delph,this.content2d=new PIXI.Container,this.par.cont2dOfset.addChild(this.content2d),this.world=new x(function(t,i){if("korektPosition"==t&&o.par.draw1(!0),"clearBodys"==t)for(var e=0;e<i.length;e++)o.removeBlok(i[e].target)}),this.deb=new _.a,this.content2d.addChild(this.deb.content2d),this.deb.al=.3,this.array=[],this.addBlok=function(t){return null!=t.parent&&t.parent.removeBlok(t),this.delph=i._delph,t.delph=this._delph,this.array.push(t),this.world.add(t.body),t.parent=this,this.content2d.addChild(t.content2d),this.par.draw1(!0),-1},this.removeBlok=function(t){return-1!=(s=this.isArrPos(t))?(n=this.array[s],this.array.splice(s,1),this.content2d.removeChild(n.content2d),n.parent=void 0,this.removeBlok(t),this.world.remove(t.body),this.par.draw1(!0),n):s},this.isArrPos=function(t){for(var i=0;i<this.array.length;i++)if(this.array[i].uuid==t.uuid)return i;return-1},this.isBlokPlace=function(t){return!(!t||!t.body)&&this.world.line_x.isBlokPlace(t.body)},this.vector=new THREE.Vector3,this.vr=new THREE.Vector3,this.getGlob=function(t,i,e,n){return this.vector.set(t,i,e),r=calc.getDistance(this.vector,this.par.position),this.vr.x=r,this.vr.y=0,this.vr.z=0,this.vr};var h,a,c,l=[],u=[];this.getNumBlok=function(){if(u.length=0,l.length=0,0!=this.array.length){for(var t=0;t<this.array.length;t++)l.push(this.array[t]);l.sort(function(t,i){return t.body.position.x-i.body.position.x});for(t=0;t<l.length;t++)u.push(l[t].body.position.x+l[t].rect1.x),u.push(l[t].body.position.x+l[t].rect1.x+l[t].rect1.w)}return u},this.draw=function(){h=this.par.arrPosit[1].x<this.par.arrPosit[4].x?-this.par.arrPosit[1].x:-this.par.arrPosit[4].x,a=this.par.arrPosit1[1].x<this.par.arrPosit1[4].x?this.par.arrPosit1[1].x:this.par.arrPosit1[4].x,c=-h+a+this.par._distans,this.world.rect.x=h,this.world.rect.w=c,this.world.rect.y=-this._delph/2,this.world.rect.h=this._delph,this.world.dragRect(),this.drawDeb()},this.drawDeb=function(){this.deb&&this.world.drawDeb()},this.setObj=function(t){for(var i=0;i<t.array.length;i++){var e=this.par.par.worldBlok.getBlok(t.array[i].id);e&&(e.setObj(t.array[i]),this.addBlok(e))}},this.getObj=function(){for(var t={array:[]},i=0;i<this.array.length;i++)t.array.push(this.array[i].getObj());return t}}var i,e,n;return i=t,(e=[{key:"delph",set:function(t){if(this._delph!=t){this._delph=t;for(var i=0;i<this.array.length;i++)this.array[i].delph=t}},get:function(){return this._delph}}])&&m(i.prototype,e),n&&m(i,n),t}();function M(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var C=function(){function t(i,e){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,t),this.type="SS2D",this.typeNa="SS2D";var n=this;this.par=i,this._life=i._life;var s,r=0;this.aVKol=0,this._mashtabText=8,this._distans=0,this._delph=0,this._rotation=0,this.content2d=new PIXI.Container,this.par.content2d.addChild(this.content2d),this.graphics=new PIXI.Graphics,this.content2d.addChild(this.graphics),this.graphics1=new PIXI.Graphics,this.par.content2d1.addChild(this.graphics1),this.onDragStart=function(t){null!=n.par.par.par.sobSP&&n.par.par.par.sobSP("downSten",n.par,t)},this.graphics.interactive=!0,this.graphics.on("mousedown",this.onDragStart),this.graphics.on("mouseover",function(t){n.stAct.sahPlus=10}),this.graphics.on("mouseout",function(t){n.stAct.sahPlus=0}),this.stAct=new O(this),this.arrVorur=i.arrVorur,this.arrPosit=i.arrPosit,this.arrPosit1=i.arrPosit1,this.cont2dDeb=void 0,this.cont2dOfset=new PIXI.Container,this.par.cont2dOfset.addChild(this.cont2dOfset),this.c2dt=new PIXI.Container,this.text=new PIXI.Text("345634634",{fontFamily:"Arial"}),this.c2dt.addChild(this.text),this.text.scale.x=this.text.scale.y=this._mashtabText,this.cont2dOfset.addChild(this.c2dt),this.c2dt.visible=!1,this.c2dt1=new PIXI.Container,this.text1=new PIXI.Text("345634634",{fontFamily:"Arial"}),this.c2dt1.addChild(this.text1),this.text1.scale.x=this.text1.scale.y=this._mashtabText,this.cont2dOfset.addChild(this.c2dt1),this.draw1=function(){if(this._distans=this.par._distans,this._delph=this.par._delph,this._rotation=this.par._rotation,r=0,this.plusVor(-this.arrPosit[2].x,this.arrPosit[2].y),this.plusVor(-this.arrPosit[1].x,this.arrPosit[1].y),this.plusVor(-this.arrPosit[0].x,this.arrPosit[0].y),this.plusVor(this.arrPosit1[5].x+this._distans,this.arrPosit1[5].y),this.plusVor(this.arrPosit1[4].x+this._distans,this.arrPosit1[4].y),this.plusVor(this.arrPosit1[3].x+this._distans,this.arrPosit1[3].y),this.plusVor(this.arrPosit1[2].x+this._distans,this.arrPosit1[2].y),this.plusVor(this.arrPosit1[1].x+this._distans,this.arrPosit1[1].y),this.plusVor(this.arrPosit1[0].x+this._distans,this.arrPosit1[0].y),this.plusVor(-this.arrPosit[5].x,this.arrPosit[5].y),this.plusVor(-this.arrPosit[4].x,this.arrPosit[4].y),this.plusVor(-this.arrPosit[3].x,this.arrPosit[3].y),this.par.aVKol=this.aVKol,null!=this.graphDeb&&(this.graphDeb.clear(),this.graphDeb.lineStyle(5,16711680,1),this.graphDeb.drawRect(this.par.rectBig.x,this.par.rectBig.y,this.par.rectBig.w,this.par.rectBig.h)),s=this.par.windows.getNumBlok(),this.graphics.clear(),this.graphics.beginFill(0==this._adjacent?this.par.par._colorC0_:this.par.par._colorC1_,1),0==s.length){this.graphics.moveTo(this.arrVorur[0].x,this.arrVorur[0].y);for(var t=0;t<this.aVKol;t++)this.graphics.lineTo(this.arrVorur[t].x,this.arrVorur[t].y);this.graphics.lineTo(this.arrVorur[0].x,this.arrVorur[0].y)}else{this.graphics.moveTo(-this.arrPosit[2].x,this.arrPosit[2].y),this.graphics.lineTo(-this.arrPosit[1].x,this.arrPosit[1].y),this.graphics.lineTo(-this.arrPosit[0].x,this.arrPosit[0].y),this.graphics.lineTo(s[0],this.arrPosit[0].y),this.graphics.lineTo(s[0],this.arrPosit[5].y),this.graphics.lineTo(-this.arrPosit[5].x,this.arrPosit[5].y),this.graphics.lineTo(-this.arrPosit[4].x,this.arrPosit[4].y),this.graphics.lineTo(-this.arrPosit[3].x,this.arrPosit[3].y);for(t=0;t<s.length;t+=2)t!=s.length-2?(this.graphics.moveTo(s[t+1],this.arrPosit[0].y),this.graphics.lineTo(s[t+1],this.arrPosit[5].y),this.graphics.lineTo(s[t+2],this.arrPosit[5].y),this.graphics.lineTo(s[t+2],this.arrPosit[0].y),this.graphics.lineTo(s[t+1],this.arrPosit[0].y)):(this.graphics.moveTo(this.arrPosit1[5].x+this._distans,this.arrPosit1[5].y),this.graphics.lineTo(this.arrPosit1[4].x+this._distans,this.arrPosit1[4].y),this.graphics.lineTo(this.arrPosit1[3].x+this._distans,this.arrPosit1[3].y),this.graphics.lineTo(this.arrPosit1[2].x+this._distans,this.arrPosit1[2].y),this.graphics.lineTo(this.arrPosit1[1].x+this._distans,this.arrPosit1[1].y),this.graphics.lineTo(this.arrPosit1[0].x+this._distans,this.arrPosit1[0].y),this.graphics.lineTo(s[t+1],this.arrPosit1[0].y),this.graphics.lineTo(s[t+1],this.arrPosit1[5].y))}this.graphics.beginFill(255,.1),this.graphics.drawCircle(200,0,50),this.graphics1.clear();var i=2*this.par.par._sizeLine;if(this.graphics1.lineStyle(i,this.par.par._colorLine_,1),0==s)for(t=0;t<this.aVKol;t++)this.graphics1.moveTo(this.arrVorur[t].x,this.arrVorur[t].y),t!=this.aVKol-1?this.graphics1.lineTo(this.arrVorur[t+1].x,this.arrVorur[t+1].y):this.graphics1.lineTo(this.arrVorur[0].x,this.arrVorur[0].y);else{this.drawGrah(this.graphics1,-this.arrPosit[2].x,this.arrPosit[2].y,!0),this.drawGrah(this.graphics1,-this.arrPosit[1].x,this.arrPosit[1].y,!1),this.drawGrah(this.graphics1,-this.arrPosit[0].x,this.arrPosit[0].y,!1),this.drawGrah(this.graphics1,s[0],this.arrPosit[0].y,!1),this.drawGrah(this.graphics1,s[0],this.arrPosit[5].y,!1),this.drawGrah(this.graphics1,-this.arrPosit[5].x,this.arrPosit[5].y,!1),this.drawGrah(this.graphics1,-this.arrPosit[4].x,this.arrPosit[4].y,!1),this.drawGrah(this.graphics1,-this.arrPosit[3].x,this.arrPosit[3].y,!1),this.drawGrah(this.graphics1,-this.arrPosit[2].x,this.arrPosit[2].y,!1);for(t=0;t<s.length;t+=2)t!=s.length-2?(this.drawGrah(this.graphics1,s[t+1],this.arrPosit[0].y,!0),this.drawGrah(this.graphics1,s[t+1],this.arrPosit[5].y,!1),this.drawGrah(this.graphics1,s[t+2],this.arrPosit[5].y,!1),this.drawGrah(this.graphics1,s[t+2],this.arrPosit[0].y,!1),this.drawGrah(this.graphics1,s[t+1],this.arrPosit[0].y,!1)):(this.drawGrah(this.graphics1,this.arrPosit1[5].x+this._distans,this.arrPosit1[5].y,!0),this.drawGrah(this.graphics1,this.arrPosit1[4].x+this._distans,this.arrPosit1[4].y,!1),this.drawGrah(this.graphics1,this.arrPosit1[3].x+this._distans,this.arrPosit1[3].y,!1),this.drawGrah(this.graphics1,this.arrPosit1[2].x+this._distans,this.arrPosit1[2].y,!1),this.drawGrah(this.graphics1,this.arrPosit1[1].x+this._distans,this.arrPosit1[1].y,!1),this.drawGrah(this.graphics1,this.arrPosit1[0].x+this._distans,this.arrPosit1[0].y,!1),this.drawGrah(this.graphics1,s[t+1],this.arrPosit1[0].y,!1),this.drawGrah(this.graphics1,s[t+1],this.arrPosit1[5].y,!1),this.drawGrah(this.graphics1,this.arrPosit1[5].x+this._distans,this.arrPosit1[5].y,!1))}this.stAct.draw1();var e=!0;this._rotation>-Math.PI/2&&this._rotation<Math.PI/2&&(e=!1);var n=this._distans-this.arrPosit[0].x+this.arrPosit1[5].x;n<1e3?this.c2dt.visible=!1:(this.c2dt.visible=!0,this.text.text=Math.round(n)+"",0==e?(this.c2dt.x=(n-this.text.width)/2,this.c2dt.y=this._delph/2,this.c2dt.rotation=0):(this.c2dt.x=n/2+this.text.width/2,this.c2dt.y=this._delph/2+32*this._mashtabText,this.c2dt.rotation=Math.PI)),(n=this._distans-this.arrPosit[5].x+this.arrPosit1[0].x)<1e3?this.c2dt1.visible=!1:(this.c2dt1.visible=!0,this.text1.text=Math.round(n)+"",0==e?(this.c2dt1.x=(n-this.text1.width)/2,this.c2dt1.y=-this._delph/2-32*this._mashtabText,this.c2dt1.rotation=0):(this.c2dt1.x=n/2+this.text1.width/2,this.c2dt1.y=-this._delph/2,this.c2dt1.rotation=Math.PI))};var o={x:0,y:0};this.drawGrah=function(t,i,e,n){n?(o.x=i,o.y=e,t.moveTo(i,e)):i==o.x&&e==o.y||(o.x=i,o.y=e,t.lineTo(i,e))},this.plusVor=function(t,i){0==r?(this.arrVorur[r].set(t,i),r++):this.arrVorur[r-1].x==t&&this.arrVorur[r-1].y==i||this.arrVorur[0].x==t&&this.arrVorur[0].y==i||r<this.arrVorur.length&&(this.arrVorur[r].set(t,i),r++,this.aVKol=r)},this.tween=void 0,this.animat=function(t){null==this.tween&&(this.tween=new TWEEN.Tween(this.graphics),this.tween.onUpdate(function(){n.par.par.render()})),this.graphics.alpha=0,this.tween.to({alpha:1},t).start()}}var i,e,n;return i=t,(e=[{key:"active",set:function(t){this._active!=t&&(this._active=t,this.stAct.sahAct=t?40:0)},get:function(){return this._active}},{key:"life",set:function(t){this._life!=t&&(this._life=t,null!=this.cont2dDeb&&(1==this._life?this.par.stage.content2d2.addChild(this.cont2dDeb):null!=this.cont2dDeb.parent&&this.cont2dDeb.parent.removeChild(this.cont2dDeb)))},get:function(){return this._life}}])&&M(i.prototype,e),n&&M(i,n),t}();function O(t){this.type="STAct",this.par=t,this._sahAct=0,this._sahPlus=0,this.arrVorur=this.par.arrVorur,this.graphics=new PIXI.Graphics,this.par.content2d.addChild(this.graphics),this.graphics.alpha=this._sahAct/100,this.draw1=function(){this.graphics.clear(),this.graphics.beginFill(t.par.colorUI),this.graphics.moveTo(this.par.arrVorur[0].x,this.par.arrVorur[0].y);for(var i=1;i<this.par.aVKol;i++)this.graphics.lineTo(this.par.arrVorur[i].x,this.par.arrVorur[i].y);this.graphics.lineTo(this.par.arrVorur[0].x,this.par.arrVorur[0].y)},this.corektSetGet=function(){this.graphics.alpha=(this._sahAct+this._sahPlus)/100,this.par.par.par.render()}}O.prototype={set sahAct(t){this._sahAct!==t&&(this._sahAct=t,this.corektSetGet())},get sahAct(){return this._sahAct},set sahPlus(t){this._sahPlus!==t&&(this._sahPlus=t,this.corektSetGet())},get sahPlus(){return this._sahPlus}};var j=function t(i,e){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,t);var n,s;this.type="SSMatematik",this.par=i,this.fun=e,this.position=i.position,this.position1=i.position1,this.arrGran=i.arrGran,this.arrPosit=i.arrPosit,this.arrPosit1=i.arrPosit1,this.rectBig=i.rectBig,this.uuid=i.rectBig;var r,o,h=new Position;this.poiskGran=function(){p=calc.getAngle(this.position,this.position1),this.arrGran[0].set(this.arrPosit[0].x,this.arrPosit[0].y),n=calc.getAngle(h,this.arrGran[0]),s=calc.getDistance(h,this.arrGran[0]),calc.getVector(s,p-n-Math.PI,this.arrGran[0]),this.arrGran[0].x+=this.position.x,this.arrGran[0].y+=this.position.y,this.arrGran[1].set(this.arrPosit1[5].x,this.arrPosit1[5].y),n=calc.getAngle(h,this.arrGran[1]),s=calc.getDistance(h,this.arrGran[1]),calc.getVector(s,p+n,this.arrGran[1]),this.arrGran[1].x+=this.position1.x,this.arrGran[1].y+=this.position1.y,this.arrGran[2].set(-this.arrPosit1[0].x,this.arrPosit1[0].y),n=calc.getAngle(h,this.arrGran[2]),s=calc.getDistance(h,this.arrGran[2]),calc.getVector(s,p-n+Math.PI,this.arrGran[2]),this.arrGran[2].x+=this.position1.x,this.arrGran[2].y+=this.position1.y,this.arrGran[3].set(-this.arrPosit[5].x,this.arrPosit[5].y),n=calc.getAngle(h,this.arrGran[3]),s=calc.getDistance(h,this.arrGran[3]),calc.getVector(s,p+n,this.arrGran[3]),this.arrGran[3].x+=this.position.x,this.arrGran[3].y+=this.position.y,this.rectBig.x=99999999999,this.rectBig.y=99999999999,this.rectBig.x1=-29999999999,this.rectBig.y1=-29999999999;for(var t=0;t<this.arrGran.length;t++)this.rectBig.x>this.arrGran[t].x&&(this.rectBig.x=this.arrGran[t].x),this.rectBig.x1<this.arrGran[t].x&&(this.rectBig.x1=this.arrGran[t].x),this.rectBig.y>this.arrGran[t].y&&(this.rectBig.y=this.arrGran[t].y),this.rectBig.y1<this.arrGran[t].y&&(this.rectBig.y1=this.arrGran[t].y);this.rectBig.w=this.rectBig.x1-this.rectBig.x,this.rectBig.h=this.rectBig.y1-this.rectBig.y};var a,c,l,u,p,d,f,g,y,v=[];this.isRect=function(t,i){if(null==i&&this.poiskGran(),1==calc.isRectS(t,this.rectBig)){if(v.length=0,r=calc.isRectPoint(t,this.position),o=calc.isRectPoint(t,this.position1),1!=r&&1!=o||(1==r&&v.push(this.par.addPoint),1==o&&v.push(this.par.addPoint1)),trace(v),0!=v.length&&v[0].uuid!=this.uuid&&v.unshift(this.par),0==v.length)for(var e=0;e<this.arrGran.length;e+=2)if(1==calc.isRectLine(t,this.arrGran[e],this.arrGran[e+1])){v.unshift(this);break}if(0!=v.length){for(e=0;e<this.par.windows.array.length;e++)v.push(this.par.windows.array[e]);return v}}return null},this.korectOffset=function(){if(-1!=this.par.sUi){if(u=!1,this.par.offset=0,null!=f&&f.uuid==this.par.sUi&&1==f.life&&(u=!0),null==this.par._addPoint)return;if(null==this.par._addPoint1)return;if(0==u&&null==f)for(var t=0;t<this.par.stage.arrSplice.length;t++)0!=this.par.stage.arrSplice[t].life&&this.par.stage.arrSplice[t].uuid==this.par.sUi&&(f=this.par.stage.arrSplice[t],u=!0);1==u&&(a=null,c=null,l=null,this.par._addPoint._uuid==f._addPoint._uuid&&(a=this.par._addPoint1,c=this.par._addPoint,l=f._addPoint1),this.par._addPoint1._uuid==f._addPoint._uuid&&(a=this.par._addPoint,c=this.par._addPoint1,l=f._addPoint1),this.par._addPoint._uuid==f._addPoint1._uuid&&(a=this.par._addPoint1,c=this.par._addPoint,l=f._addPoint),this.par._addPoint1._uuid==f._addPoint1._uuid&&(a=this.par._addPoint,c=this.par._addPoint1,l=f._addPoint),null!=a&&(p=calc.getTreeAngel(a.position,c.position,l.position,!0),d=(p-Math.PI)/Math.PI,0==this.par._bChaz?(1==d&&(d=-1),g=this.par.delph/2-f.delph/2,y=f.delph,this.par.offset=d<=0?g-d*y:g):(g=-(this.par.delph/2-f.delph/2),y=f.delph,this.par.offset=d>=0?g-d*y:g)))}}};function I(t){p.call(this,t);this.type="SpliceSten",this.tipe="SpliceSten",this.stage=t,this.par=t,this._boolText=!0,this._active=!1,this.idUi=Math.round(1e3*Math.random()),this.sUi=-1,this._offset=0,this._bChaz=!1,this._delph=t._delph,this._uuid=calc.generateRendom(2),this._carrier=t.carrier,this._out=t.out,this._adjacent=t.adjacent,this._carrier&&(1==this._carrier?this._delph=t._delphC1:this._delph=t._delphC0),this.alpha=t._alpha,this.colorP=t._colorP,this.colorP1=t._colorP1,this._height=this.stage._height,this.aVKol=0,this.arrVorur=[new Position,new Position,new Position,new Position,new Position,new Position,new Position,new Position],this.arrGran=[new Position,new Position,new Position,new Position],this.rectBig={x:0,y:0,x1:0,y1:0,w:0,h:0,o:null},this.content2d1=new PIXI.Container,t.content2d1.addChild(this.content2d1),this.content2d=new PIXI.Container,t.content2d2.addChild(this.content2d),this.cont2dOfset=new PIXI.Container,this.content2d.addChild(this.cont2dOfset),this.matematik=new j(this),this.ss2d=new C(this),this.arrayClass.push(this.ss2d),this.windows=new S(this),this.arrayClass.push(this.windows),this.addBlok=function(t){return null==t?-1:this.windows.addBlok(t)},this.removeBlok=function(t){return null==t?-1:this.windows.removeBlok(t)},this.numBlok=0,this.draw1=function(t){null==t&&this.windows.draw(),this.ss2d.draw1(),this.par.render()},this.dragPost=function(){this.content2d.x=this.position.x,this.content2d.y=this.position.y,this.content2d.rotation=this._rotation,this.content2d1.x=this.position.x,this.content2d1.y=this.position.y,this.content2d1.rotation=this._rotation,this.draw1(),this.stage.render(),this.poiskGran()};new Position;this.poiskGran=function(){this.matematik.poiskGran()};this.isRect=function(t,i){return this.matematik.isRect(t,i)},this.animat=function(t){this.ss2d.animat(t)},this.korectOffset=function(){this.matematik.korectOffset()}}function D(t){n.call(this);var i=this;this.type="SpPointSten",this.tipe="SpPointSten",this.stage=t,this.par=t,this._height=300,this._active=!1,this.content2d=new PIXI.Container,this.stage.content2dPoint.addChild(this.content2d),this.graphics=new PIXI.Graphics,this.content2d.addChild(this.graphics),this.graphics.interactive=!0,this.stAct=new A(this),this.graphics.beginFill(16711680,.3),this.graphics.drawCircle(0,0,150),this.funDragMenu=void 0,this.onDragStart=function(e){null!=t.par.sobSP&&t.par.sobSP("downPoint",i,e)},this.graphics.interactive=!0,this.graphics.on("mousedown",this.onDragStart),this.graphics.on("mouseover",function(t){i.stAct.sahPlus=10}),this.graphics.on("mouseout",function(t){i.stAct.sahPlus=0}),this.funDragVokrug=function(t,i){for(var e=0;e<i.length;e++)i[e].dragPost()},this.dragPost=function(){this.dragVokrug(),this.content2d.x=this.position.x,this.content2d.y=this.position.y,null!=this.funDragMenu&&this.funDragMenu()},this.doFunRend=function(){this.par.addObjFun(this)},this.getTypeConnect=function(){var t=["AidPoint"];return this.arrIdSten.length>0&&t.push("Sten"),t}}function A(t){this.type="PTAct",this.par=t,this._sahAct=0,this._sahPlus=0,this.arrVorur=this.par.arrVorur,this.graphics=new PIXI.Graphics,this.par.content2d.addChild(this.graphics),this.graphics.alpha=this._sahAct/100,this.graphics.beginFill(t.par.colorUI),this.graphics.drawCircle(0,0,150),this.corektSetGet=function(){this.graphics.alpha=(this._sahAct+this._sahPlus)/100,this.par.par.render()}}function k(){this.type="SpUtility";var t=[],i=[];this.connectLines=function(e){t.length=0,i.length=0,t=this.tune(e);for(var n=0;n<t.length;n++)i[n]=e.stage.arrSplice[t[n]];return i};var e,n,s=[],r=[];function o(t,i){for(var e=0;e<t.length;e++)if(t[e]==i)return!1;return!0}function h(t){if(n=[],t._addPoint)for(var i=0;i<t._addPoint.arrSHron.length;i++)t.idArr!=t._addPoint.arrSHron[i].sten.idArr&&n.push(t._addPoint.arrSHron[i].sten.idArr);if(t._addPoint1)for(i=0;i<t._addPoint1.arrSHron.length;i++)t.idArr!=t._addPoint1.arrSHron[i].sten.idArr&&n.push(t._addPoint1.arrSHron[i].sten.idArr);return n}this.tune=function(t){arrSplice=t.stage.arrSplice,s.length=0,r.length=0,s.push(t.idArr),e=h(t);for(var i=0;i<e.length;i++)r.push(e[i]);for(i=0;i<r.length;i++)if(1==o(s,r[i])){s.push(r[i]),e=h(arrSplice[r[i]]);for(var n=0;n<e.length;n++)r.push(e[n])}return s}}function R(t){var i=this;this.sahAngel=t||10;var e=.1;this.radius=1,this.curvature=e,this.p=new a,this.p1=new a(1,0),this.p2=new a(.5,.5),this.pOCent=new a,this.pint90=new a,this.arrPosit=[];for(var n=0;n<this.sahAngel;n++)this.arrPosit[n]=new a;function s(t,i,e){calc.getVector(calc.getDistance(t,i)+e,calc.getAngle(i,t),t),t.x+=i.x,t.y+=i.y}this.moveLineRange=function(t){s(this.p,this.pOCent,t),s(this.p1,this.pOCent,t),s(this.p2,this.pOCent,t),this.updateFromCurvature(this.getCurrentCurvature())},this.setTwoPoint=function(t,i){this.p.setPoint(t),this.p1.setPoint(i),this.upDate()},this.getLR=function(t,i){this.upDate();var e=new R(this.sahAngel);0===i&&(e.p.setPoint(this.p),e.p1.setPoint(t)),1===i&&(e.p.setPoint(t),e.p1.setPoint(this.p1)),e.p2.set((e.p.x+e.p1.x)/2,(e.p.y+e.p1.y)/2);var n=calc.getAngle(this.pOCent,e.p2);return calc.getVector(this.radius,n,e.p2),e.p2.x+=this.pOCent.x,e.p2.y+=this.pOCent.y,e.updateFromCurvature(e.getCurrentCurvature()),e},this.setLR=function(t){this.p.setPoint(t.p),this.p1.setPoint(t.p1),this.p2.setPoint(t.p2),this.updateFromCurvature(this.getCurrentCurvature())},this.setCurvFromPoint=function(t){this.p2.setPoint(t),this.updateFromCurvature(this.getCurrentCurvature())},this.getCurrentCurvature=function(){return calc.getDistancePointToLine(this.p,this.p1,this.p2)},this.korectPoint2=function(t,i,e){t=t||0,i=i||this.p,e=e||this.p1,calc.getArrPointCircle(this.pOCent,this.radius+t,i,e,this.sahAngel,this.curvature>0,this.arrPosit)},this.upDate=function(){this.updateFromCurvature()};var r=new a;this.getPointInLineRange=function(t,i,e,n){e=e||0;var s=calc.getDistance(t,this.pOCent);if(calc.diffNum(s,this.radius)>i)return null;var o=this.getLengthPoint(t),h=this.getLenght();if(o<0||o>h){var a=Math.min(calc.diffNum(o,0),calc.diffNum(o,h));if(!n&&e<a)return null;if(n)return calc.diffNum(o,0)<calc.diffNum(o,h)?(r.setPoint(this.p),r):(r.setPoint(this.p1),r)}return calc.getVector(this.radius,calc.getAngle(this.pOCent,t),r),r.x+=this.pOCent.x,r.y+=this.pOCent.y,r},this.updateFromCurvature=function(t){var n,s,r,h;this.curvature=function(t){var n=calc.getDistance(i.p,i.p1)/2;(t=calc.getValueBetween(t,-n,n))<=0&&t>=-e?t=-e:t>=0&&t<=e&&(t=e);return t}(t||this.curvature),this.pint90.setPoint((n=this.p,s=this.p1,r=this.curvature,h=calc.getAngle(n,s)+90*calc.DEG2RAD,calc.getVector(r,h,o),o.x+=(n.x+s.x)/2,o.y+=(n.y+s.y)/2,o.x=calc.okrugNumber(o.x),o.y=calc.okrugNumber(o.y),o)),this.p2.setPoint(this.pint90);var a=calc.getCenterCircle(this.p,this.p1,this.p2);a&&this.pOCent.setPoint(a),this.radius=calc.getDistance(this.pOCent,this.p),this.korectPoint2()};var o=new a;this.getLengthPoint=function(t,i){i&&(t=new a(t.x,t.y),calc.rotationPointByLength(t,i*(this.curvature>0?-1:1),this.pOCent));var e=calc.getLenghtCircle(this.radius,this.pOCent,this.p,t,this.curvature>0),n=this.getLenght();if(e>n){var s=calc.getLenghtCircle(this.radius,this.pOCent);e>n+(s-n)/2&&(e-=s)}return e},this.getPositionByLength=function(t){var i=new a(this.p.x,this.p.y);return calc.rotationPointByLength(i,t*(this.curvature>0?-1:1),this.pOCent),i},this.getAngleByPoint=function(t,i){i*=this.curvature>0?-1:1;var e=calc.getCircleCircleIntersectionPoints(this.pOCent,this.radius,t,Math.abs(i)),n=i<0?e[0]:e[1];return calc.getAngle(t,n)},this.getLenght=function(){return calc.getLenghtCircle(this.radius,this.pOCent,this.p,this.p1,this.curvature>0)},this.getCurvatureByWidth=function(t){var i=calc.getCurvatureByWidth(t,this.radius);return null===i&&(i=calc.getCurvatureByWidth(2*this.radius*(t<0?-1:1),this.radius)),(i||0)*(this.curvature<0?-1:1)},this.getWidthByLengthTo=function(t){var i=new a(this.radius,0),e=new a(this.radius,0);return calc.rotationPointByLength(i,t),calc.getDistance(i,e)},this.getLengthByWidth=function(t){return calc.getLengthByWidth(t,i.getCurvatureByWidth(t))}}function L(t){this.otstup=t||50,this.tip=0,this.p=new a,this.p1=new a,this.p2=new a,this.maxp=new a,this.maxp1=new a,this.maxSp1=new a,this.maxp2=new a,this.p3=new a,this.dist01=0,this.dist12=0,this.p4=new a,this.lineRange=new R(20),this.lineRange1=new R(20),this.angel=0;var i,e;this.restertTip=function(t,n,s,r,o,h){null!=o&&0!==o._offset&&(h=(i=calc.getDistance(n,o.position))<o.delph,this.angel=calc.getAngle(n,s),1!=h?calc.getVector(o._offset,this.angel-Math.PI/2,this.p):calc.getVector(o._offset,this.angel+Math.PI/2,this.p),n.x+=this.p.x,n.y+=this.p.y,s.x+=this.p.x,s.y+=this.p.y,r.x+=this.p.x,r.y+=this.p.y,o.arrPosit[2].y=o.arrPosit[3].y=0,o.arrPosit1[2].y=o.arrPosit1[3].y=0),this.tip=t,0==t&&(this.p.setPoint(n),this.p1.setPoint(s),this.p2.setPoint(r),this.angel=calc.getAngle(n,s),calc.getVector(2e4,this.angel+Math.PI,this.maxp),this.maxp.x+=n.x,this.maxp.y+=n.y,calc.getVector(this.otstup,this.angel,this.maxp1),this.maxp1.x+=s.x,this.maxp1.y+=s.y,this.dist01=calc.getDistance(this.p,this.p1),this.dist12=calc.getDistance(this.p1,this.p2),calc.getVector(2e4,this.angel,this.maxSp1),this.maxSp1.x+=s.x,this.maxSp1.y+=s.y,i=calc.getDistance(this.p1,this.p2),e=calc.getAngle(this.p1,this.p2),calc.getVector(2*i,e,this.p3),this.p3.x+=this.p.x,this.p3.y+=this.p.y),1==t&&(this.dist12=Math.abs(s),null!=r?(this.lineRange.p.setPoint(n.p1),this.lineRange.p1.setPoint(n.p),this.lineRange.p2.setPoint(n.p2),this.lineRange.updateFromCurvature(this.lineRange.getCurrentCurvature()),this.lineRange1.p.setPoint(n.p1),this.lineRange1.p1.setPoint(n.p),this.lineRange1.p2.setPoint(n.p2),this.lineRange1.updateFromCurvature(this.lineRange1.getCurrentCurvature()),this.lineRange.moveLineRange(s)):(this.lineRange.setLR(n),this.lineRange.moveLineRange(s),this.lineRange1.setLR(n)))},this.dragOtstup=function(t){0==this.tip&&(calc.getVector(t,this.angel,this.maxp1),this.maxp1.x+=this.p1.x,this.maxp1.y+=this.p1.y)},this.drawDebag=function(t,i,e){null!=t&&0==this.tip&&(t.dLine(this.p,this.maxp,e),t.dLine(this.p1,this.maxp1,e),t.dLine(this.maxSp1,this.maxp1,e,10),t.dLine(this.p,this.p3,i,10),t.dPoint(this.p3,10,i),t.dLine(this.p,this.p1,i),t.dLine(this.p1,this.p2,i),t.dPoint(this.p,10,i),t.dPoint(this.p1,10,i),t.dPoint(this.p2,10,i))}}function T(t){var i,e,n,s,r,o,h;this.setDebug=function(t){t},this.getPeresek=function(t,a){if(0==t.tip&&0==a.tip)return function(t,n){var o=new z;if(0==t.tip&&0==n.tip)return o.p.setPoint(t.p1),o.p1.setPoint(t.p1),o.p2.setPoint(t.p2),(r=t.otstup)<2*t.dist12&&(r=2*t.dist12),r<2*n.dist12&&(r=2*n.dist12),t.dragOtstup(r),n.dragOtstup(r),s=calc.getTreeAngel(t.p,t.p1,n.p),314==Math.abs(Math.round(100*s))?(o.p.setPoint(t.p1),o):0==Math.abs(Math.round(100*(t.angel-n.angel)))?(o.p.setPoint(t.p1),o):null!=(i=calc.getPointOfIntersection(t.p,t.maxp1,n.maxp,n.maxp1))?null!=(e=calc.getPointOfIntersection(t.p,t.p1,n.p,n.p3))?(o.p.setPoint(e),o.p1.setPoint(e),o):(o.p.setPoint(i),o.p1.setPoint(i),o):t.dist12>n.dist12&&null!=(i=calc.getPointOfIntersection(t.p,t.maxp,n.p,n.maxp))?(o.p1.setPoint(t.p2),o):null!=(i=calc.getPointOfIntersection(t.p1,t.p2,n.maxp,n.maxp1))?(o.p1.setPoint(i),o.p.setPoint(t.p1),o):null!=(e=calc.getPointOfIntersection(t.p,t.p1,n.p,n.p3))?(o.p.setPoint(e),o.p1.setPoint(e),o):null!=(i=calc.getPointOfIntersection(t.p,t.maxSp1,n.p1,n.p2))?(o.p.setPoint(i),o.p1.setPoint(i),o):null!=(i=calc.getPointOfIntersection(t.p,t.maxSp1,n.p1,n.maxp1))?(o.p.setPoint(i),o.p1.setPoint(i),o):null!=(i=calc.getPointOfIntersection(t.p,t.maxSp1,n.p1,n.maxSp1))?(o.p.setPoint(t.maxp1),o.p1.set((t.maxp1.x+n.maxp1.x)/2,(t.maxp1.y+n.maxp1.y)/2),null!=(e=calc.getPointOfIntersection(t.p1,t.maxp1,n.p1,n.maxp1))&&(o.p1.setPoint(e),o.p.setPoint(e)),o):o}(t,a);if(0==t.tip&&1==a.tip)return function(t,i){var e=Math.min(t.dis/2,i.dis/2),s=new z;if(0==t.tip&&1==i.tip){if(s.p.setPoint(t.p),s.p1.setPoint(t.p1),s.p2.setPoint(t.p2),(r=t.otstup)<2*t.dist12&&(r=2*t.dist12),r<2*i.dist12&&(r=2*i.dist12),t.dragOtstup(r),(n=calc.getLineCircleIntersectionPoints(t.maxp1,t.p,i.lineRange.pOCent,i.lineRange.radius)).length>1&&calc.getDistance(s.p1,n[0])>calc.getDistance(s.p1,n[1])&&n.reverse(),0!=n.length&&calc.getDistance(n[0],s.p1)<e)return s.p.setPoint(n[0]),s.p1.setPoint(n[0]),s;s.p.setPoint(t.p1)}return s}(t,a);if(1==t.tip&&0==a.tip)return function(t,i){var e=Math.min(t.dis/2,i.dis/2),s=new z;if(1==t.tip&&0==i.tip){if(s.p.setPoint(i.p),s.p1.setPoint(i.p1),s.p2.setPoint(i.p2),(r=i.otstup)<2*t.dist12&&(r=2*t.dist12),r<2*i.dist12&&(r=2*i.dist12),i.dragOtstup(r),(n=calc.getLineCircleIntersectionPoints(i.maxp1,i.p,t.lineRange.pOCent,t.lineRange.radius,!0)).length>1&&calc.getDistance(s.p1,n[0])>calc.getDistance(s.p1,n[1])&&n.reverse(),0!=n.length&&calc.getDistance(n[0],s.p1)<e)return s.p.setPoint(n[0]),s.p1.setPoint(n[0]),s;s.p.setPoint(i.p1)}return s}(t,a);if(1==t.tip&&1==a.tip)return function(t,e){var s=Math.min(t.dis/2,e.dis/2),a=new z;if(1==t.tip&&1==e.tip){if((r=e.otstup)<2*t.dist12&&(r=2*t.dist12),r<2*e.dist12&&(r=2*e.dist12),a.p.setPoint(t.lineRange.p),a.p1.setPoint(t.lineRange.p),a.p2.setPoint(t.lineRange1.p),0!=(n=calc.getCircleCircleIntersectionPoints(t.lineRange.pOCent,t.lineRange.radius,e.lineRange.pOCent,e.lineRange.radius)).length){if(1==n.length)return a.p.setPoint(n[0]),a.p1.setPoint(n[0]),a;o=calc.getDistance(a.p2,n[0]),h=calc.getDistance(a.p2,n[1]),o<h?(dis=o,i=n[0]):(dis=h,i=n[1]),dis<t.delph+e.delph&&dis<s&&(a.p.setPoint(i),a.p1.setPoint(i))}t.dist12,e.dist12}return a}(t,a);throw new Error("err type bla="+t.tip+" blaX="+a.tip)}}function E(){var t,i=!1,e=new L(20),n=new L(20);this.korektPoint=new T(this),this.generateUUID=function(){for(var t=[],i=0;i<256;i++)t[i]=(i<16?"0":"")+i.toString(16);return function(){var i=4294967295*Math.random()|0,e=4294967295*Math.random()|0,n=4294967295*Math.random()|0,s=4294967295*Math.random()|0;return(t[255&i]+t[i>>8&255]+t[i>>16&255]+t[i>>24&255]+"-"+t[255&e]+t[e>>8&255]+"-"+t[e>>16&15|64]+t[e>>24&255]+"-"+t[63&n|128]+t[n>>8&255]+"-"+t[n>>16&255]+t[n>>24&255]+t[255&s]+t[s>>8&255]+t[s>>16&255]+t[s>>24&255]).toUpperCase()}}();i=void 0;this.setDebug=function(t){i=t,this.korektPoint.setDebug(t)},this.getAngle=function(t,i){return i=i||rezNull,t=t||rezNull,Math.atan2(i.y-t.y,i.x-t.x)},this.getDistance=function(t,i){return null==t?0:(null==i&&(i=rezNull),i=i||rezNull,Math.sqrt(Math.pow(t.x-i.x,2)+Math.pow(t.y-i.y,2)))};var s,r,o,h=[new THREE.Vector2(0,0),new THREE.Vector2(0,0),new THREE.Vector2(0,0),new THREE.Vector2(0,0),new THREE.Vector2(0,0),new THREE.Vector2(0,0),new THREE.Vector2(0,0),new THREE.Vector2(0,0),new THREE.Vector2(0,0),new THREE.Vector2(0,0),new THREE.Vector2(0,0),new THREE.Vector2(0,0)];this.creatGrani2=function(i,e,n){if(t=i.sten,0==i.storona)if(h[0].x=e.p.x,h[0].y=e.p.y,h[1].x=e.p1.x,h[1].y=e.p1.y,h[2].x=e.p2.x,h[2].y=e.p2.y,h[3].x=n.p2.x,h[3].y=n.p2.y,h[4].x=n.p1.x,h[4].y=n.p1.y,h[5].x=n.p.x,h[5].y=n.p.y,s=i.sten.position1,r=-t._rotation,i.sten.bolPosit1=!0,0==i.sten.tip){for(var o=0;o<6;o++)h[o]=calc.povotorOtAngel(s,h[o],r);for(o=0;o<6;o++)i.sten.arrPosit1[o].set(h[o].x,h[o].y)}else if(1==i.sten.tip)if(i.sten.lineRange.curvature>0)for(o=0;o<6;o++)i.sten.arrPosit1[o].set(h[o].x,h[o].y);else for(o=0;o<6;o++)i.sten.arrPosit1[o].set(h[5-o].x,h[5-o].y);else window.console.warn("непонял как считить  ",i.sten.tip);else if(h[0].x=e.p.x,h[0].y=e.p.y,h[1].x=e.p1.x,h[1].y=e.p1.y,h[2].x=e.p2.x,h[2].y=e.p2.y,h[3].x=n.p2.x,h[3].y=n.p2.y,h[4].x=n.p1.x,h[4].y=n.p1.y,h[5].x=n.p.x,h[5].y=n.p.y,s=i.sten.position,r=-t._rotation,i.sten.bolPosit=!0,0==i.sten.tip){for(o=0;o<6;o++)h[o]=calc.povotorOtAngel(s,h[o],r);for(o=0;o<6;o++)i.sten.arrPosit[o].set(-h[o].x,h[o].y)}else if(1==i.sten.tip)if(i.sten.lineRange.curvature>0)for(o=0;o<6;o++)i.sten.arrPosit[o].set(h[5-o].x,h[5-o].y);else for(o=0;o<6;o++)i.sten.arrPosit[o].set(h[o].x,h[o].y);else window.console.warn("непонял как считить  ",i.sten.tip);0!=i.sten.offset&&(i.sten.arrPosit[2].y=i.sten.arrPosit[3].y=0,i.sten.arrPosit1[2].y=i.sten.arrPosit1[3].y=0)};var a,c,l,u,p,d,f,g=0,y=(new z,new z),v=new z;this.korektSHObject=function(t,i){if(p=(d=t).arrSHron.length,l=d.arrSHron[i],1==p&&(l.sten.korectOffset(),0==l.sten.tip?(f=l.sten.offset,1==l.storona?(l.sten.bolPosit=!1,l.sten.arrPosit[0].set(0,l.sten.delph/2+f),l.sten.arrPosit[1].set(0,l.sten.delph/2+f),l.sten.arrPosit[2].set(0,f),l.sten.arrPosit[3].set(0,f),l.sten.arrPosit[4].set(0,-l.sten.delph/2+f),l.sten.arrPosit[5].set(0,-l.sten.delph/2+f)):(l.sten.bolPosit1=!1,l.sten.arrPosit1[0].set(0,-l.sten.delph/2+f),l.sten.arrPosit1[1].set(0,-l.sten.delph/2+f),l.sten.arrPosit1[2].set(0,f),l.sten.arrPosit1[3].set(0,f),l.sten.arrPosit1[4].set(0,l.sten.delph/2+f),l.sten.arrPosit1[5].set(0,l.sten.delph/2+f))):1==l.sten.tip?1==l.storona?(l.sten.bolPosit=!0,l.sten.arrPosit[0].setPoint(l.sten.lineRange.p),l.sten.arrPosit[1].setPoint(l.sten.lineRange.p),l.sten.arrPosit[2].setPoint(l.sten.lineRange.p),l.sten.arrPosit[3].setPoint(l.sten.lineRange.p),l.sten.arrPosit[4].setPoint(l.sten.lineRange.p),l.sten.arrPosit[5].setPoint(l.sten.lineRange.p)):(l.sten.bolPosit1=!0,l.sten.arrPosit1[0].setPoint(l.sten.lineRange.p1),l.sten.arrPosit1[1].setPoint(l.sten.lineRange.p1),l.sten.arrPosit1[2].setPoint(l.sten.lineRange.p1),l.sten.arrPosit1[3].setPoint(l.sten.lineRange.p1),l.sten.arrPosit1[4].setPoint(l.sten.lineRange.p1),l.sten.arrPosit1[5].setPoint(l.sten.lineRange.p1)):window.console.warn("непонял как считить  ",l.sten.tip)),p>1){var e=0,n=0;e=0==i?d.arrSHron.length-1:i-1,n=i>=d.arrSHron.length-1?0:i+1,c=d.arrSHron[e],l=d.arrSHron[i],u=d.arrSHron[n],c.sten.korectOffset(),l.sten.korectOffset(),u.sten.korectOffset();var s=!1;p>2?(u=d.arrSHron[e],l=d.arrSHron[i],c=d.arrSHron[n]):(c=d.arrSHron[e],l=d.arrSHron[i],u=d.arrSHron[n]),y=this.getLineStan2(l,c,s),s=!s,v=this.getLineStan2(l,u,s),this.creatGrani2(l,y,v)}for(var r=0;r>d.arrSHron.length;r++)(a=d.arrSHron[r]).sten.arrPosit[2].y=0,a.sten.arrPosit[3].y=0,a.sten.arrPosit1[2].y=0,a.sten.arrPosit1[3].y=0},this.getSten2AddPoint=function(t,i){return null!=t.addPoint&&t.addPoint.idArr==i.idArr&&null!=t.addPoint1?t.addPoint1:null!=t.addPoint1&&t.addPoint1.idArr==i.idArr&&null!=t.addPoint?t.addPoint:null};var P=new THREE.Vector3(0,0);this.testAngel=function(t){if((p=t.arrSHron.length)<=1)return null;for(var i=0;i<t.arrSHron.length;i++)for(var e=i+1;e<t.arrSHron.length;e++)if(c=t.arrSHron[i],l=t.arrSHron[e],0==c.storona?(h[0].x=c.sten.position.x,h[0].y=c.sten.position.y,h[1].x=c.sten.position1.x,h[1].y=c.sten.position1.y):(h[0].x=c.sten.position1.x,h[0].y=c.sten.position1.y,h[1].x=c.sten.position.x,h[1].y=c.sten.position.y),0==l.storona?(h[2].x=l.sten.position.x,h[2].y=l.sten.position.y):(h[2].x=l.sten.position1.x,h[2].y=l.sten.position1.y),r=calc.getTreeAngel(h[0],h[1],h[2]),Math.abs(r)>3&&null!=(P=calc.isPointInLin(h[0],h[2],h[1],5,5)))return P;return null},this.getLineStan2=function(t,s,r,a,c){return e.delph=t.sten.delph+(a||0),n.delph=s.sten.delph+(c||0),e.dis=calc.getDistance(t.sten.position,t.sten.position1),n.dis=calc.getDistance(s.sten.position,s.sten.position1),g=5,e.delph/2+1>g&&(g=e.delph+1),n.delph/2+1>g&&(g=n.delph+1),o=1,1==r&&(o=-1),0==t.sten.tip?(0==t.storona?(h[0].x=h[2].x=h[4].x=t.sten.position.x,h[0].y=h[2].y=h[4].y=t.sten.position.y,h[1].x=h[3].x=h[5].x=t.sten.position1.x,h[1].y=h[3].y=h[5].y=t.sten.position1.y):(h[0].x=h[2].x=h[4].x=t.sten.position1.x,h[0].y=h[2].y=h[4].y=t.sten.position1.y,h[1].x=h[3].x=h[5].x=t.sten.position.x,h[1].y=h[3].y=h[5].y=t.sten.position.y),calc.korektToLine(h[0],h[1],0,-e.delph/2*o),e.restertTip(0,h[0],h[1],h[3],t.sten),i&&0!=t.sten.offset&&(i.clearD(),e.drawDebag(i))):1==t.sten.tip?1==r?1==t.storona?t.sten.lineRange.curvature>0?e.restertTip(1,t.sten.lineRange,-e.delph/2):e.restertTip(1,t.sten.lineRange,e.delph/2):t.sten.lineRange.curvature>0?e.restertTip(1,t.sten.lineRange,e.delph/2,!0):e.restertTip(1,t.sten.lineRange,-e.delph/2,!0):1==t.storona?t.sten.lineRange.curvature>0?e.restertTip(1,t.sten.lineRange,e.delph/2):e.restertTip(1,t.sten.lineRange,-e.delph/2):t.sten.lineRange.curvature>0?e.restertTip(1,t.sten.lineRange,-e.delph/2,!0):e.restertTip(1,t.sten.lineRange,e.delph/2,!0):window.console.warn("непонял как считить  ",t.sten.tip),0==s.sten.tip?(0==s.storona?(h[6].x=h[8].x=h[10].x=s.sten.position.x,h[6].y=h[8].y=h[10].y=s.sten.position.y,h[7].x=h[9].x=h[11].x=s.sten.position1.x,h[7].y=h[9].y=h[11].y=s.sten.position1.y):(h[6].x=h[8].x=h[10].x=s.sten.position1.x,h[6].y=h[8].y=h[10].y=s.sten.position1.y,h[7].x=h[9].x=h[11].x=s.sten.position.x,h[7].y=h[9].y=h[11].y=s.sten.position.y),calc.korektToLine(h[6],h[7],0,n.delph/2*o),n.restertTip(0,h[6],h[7],h[9],s.sten)):1==s.sten.tip?1==r?0==s.storona?s.sten.lineRange.curvature>0?n.restertTip(1,s.sten.lineRange,-n.delph/2,!0):n.restertTip(1,s.sten.lineRange,n.delph/2,!0):s.sten.lineRange.curvature>0?n.restertTip(1,s.sten.lineRange,n.delph/2):n.restertTip(1,s.sten.lineRange,-n.delph/2):0==s.storona?s.sten.lineRange.curvature>0?n.restertTip(1,s.sten.lineRange,n.delph/2,!0):n.restertTip(1,s.sten.lineRange,-n.delph/2,!0):s.sten.lineRange.curvature>0?n.restertTip(1,s.sten.lineRange,-n.delph/2):n.restertTip(1,s.sten.lineRange,n.delph/2):window.console.warn("непонял как считить  ",s.sten.tip),this.korektPoint.getPeresek(e,n)}}function z(t,i){this.p=t||new B,this.p1=i||new B,this.p2=new B,this.status=0,this.perpendik=!0,this.angel=0,this.set=function(t,i){this.p=t||0,this.p1=i||0}}function B(t,i,e){this._x=t||0,this._y=i||0,this._z=e||0,this.set=function(t,i,e){this._x=t||0,this._y=i||0,void 0!==e&&(this._z=e)},this.setPoint=function(t){this._x=t.x,this._y=t.y,void 0!==t.z&&(this._z=t.z)},this.getObj=function(){var t={};return t.x=this._x,t.y=this._y,t.z=this._z,t},this.copy=function(){return new B(this._x,this._y,this._z)}}function H(t){var i=this;this.filterRect=void 0,this.stage=t;var e=new l;function n(t){return f().filter(p).filter(s,t)}function s(t){return calc.isParalel(this.position,this.position1,t.position,t.position1,3*calc.DEG2RAD)}function r(t,i){return t.addPoint.idArr===i.addPoint.idArr&&t.addPoint1.idArr===i.addPoint1.idArr||t.addPoint.idArr===i.addPoint1.idArr&&t.addPoint1.idArr===i.addPoint.idArr}function o(t,i){for(var e=0;e<i.length;e++)if(r(t,i[e]))return!0}function h(t,i){for(var e=0;e<i.length;e++)if(t.idArr===i[e].idArr)return!0}function a(t,i,e){return e.indexOf(t)===i}this.filterRect=void 0,this.paralelSten=function(t){i.filterRect=void 0,t&&(e.setRect(t.getRect()),i.filterRect=e);var s=function(t,e){for(var n=new DataChangeSp,s=0;s<t.length;s++){var r=i.setPointWalls(t[s].position,i.filterRect,e);n.add(r)}return n}(function(t){for(var i=[],e=0;e<t.length;e++)t[e].addPoint&&i.push(t[e].addPoint),t[e].addPoint1&&i.push(t[e].addPoint1);return i.filter(a)}(n(t)),t),c=function(t){for(var i=[],e=n(t),s=0;s<e.length;s++)for(var o=0;o<e.length;o++)e[s].idArr!==e[o].idArr&&r(e[s],e[o])&&i.push(e[s]);return i}(t);if(c.length<=1)return s;var l=function(t,i){for(var e=[],n=0;n<t.length;n++)h(t[n],i)||-1===e.indexOf(t[n])&&(t[n].rememberState(),t[n].clear(),e.push(t[n]));return e}(c,function(t,i){for(var e=[],n=0;n<t.length;n++)i.idArr!==t[n].idArr&&(o(t[n],e)||e.push(t[n]));return e}(c,t));return s.arrClearSplice=l,s};var c=5;function u(t,i){var e=!0;return e&&t.idArr==i.idArr&&(e=!1),!e||t.addPoint&&t.addPoint1&&i.addPoint&&i.addPoint1||(e=!1),!e||t.addPoint.idArr!=i.addPoint.idArr&&t.addPoint.idArr!=i.addPoint1.idArr||(e=!1),!e||t.addPoint1.idArr!=i.addPoint.idArr&&t.addPoint1.idArr!=i.addPoint1.idArr||(e=!1),e}function p(t){return!!t.life&&!(i.filterRect&&!calc.isIntersectionRect(i.filterRect,t.getRect()))}function d(t){var e=i.stage.spRelief.snappingPoint;i.stage.spRelief.snappingPoint=1,i.stage.spRelief.slitTestPoint(t),i.stage.spRelief.snappingPoint=e}function f(){return i.stage.arrSplice}function g(){return i.stage.arrPoint}function y(t,e){return i.stage.spRelief.getRadiusPoint(t,e)}function v(t,i){var e=[],n=null;if(0==t.tip&&0==i.tip)null!=(n=calc.getPointOfIntersection(t.addPoint.position,t.addPoint1.position,i.addPoint.position,i.addPoint1.position))&&e.push(new Position(n.x,n.y));else if(1==t.tip&&0==i.tip)for(var s=t.lineRange.arrPosit,r=0;r<s.length-1;r++)null!=(n=calc.getPointOfIntersection(s[r],s[r+1],i.addPoint.position,i.addPoint1.position))&&e.push(new Position(n.x,n.y));else if(0==t.tip&&1==i.tip)for(s=i.lineRange.arrPosit,r=0;r<s.length-1;r++)null!=(n=calc.getPointOfIntersection(t.addPoint.position,t.addPoint1.position,s[r],s[r+1]))&&e.push(new Position(n.x,n.y));else if(1==t.tip&&1==i.tip){s=t.lineRange.arrPosit;var o=i.lineRange.arrPosit;for(r=0;r<s.length-1;r++)for(var h=0;h<o.length-1;h++)null!=(n=calc.getPointOfIntersection(o[h],o[h+1],s[r],s[r+1]))&&e.push(new Position(n.x,n.y))}return(t.tip>1||i.tip>1)&&window.console.warn("нужно добавить для этого типа пересечения",t.tip,i.tip),e}this.setIntersectStenPoint=function(t){for(var e=new DataChangeSp,n=this.getPointOfIntersectionSten(t),s=0;s<n.length;s++){var r=i.setPointWalls(n[s],t);e.add(r)}return e},this.getPointOfIntersectionSten=function(t){i.filterRect=t;for(var e=f().filter(p),n=[],s=0;s<e.length;s++)for(var r=s;r<e.length;r++)u(e[s],e[r])&&(n=v(e[s],e[r]).concat(n));return function(t){for(var i=0;i<t.length;i++)for(var e=0;e<t.length;e++)if(i!=e&&calc.getDistance(t[i],t[e])<c){t.splice(i,1),i=0;break}for(var n=-1,i=0;i<t.length;i++)-1!=(n=y(t[i],c))&&t[i].set(g()[n].position.x,g()[n].position.y)}(n),n},this.setPointWalls=function(t,e,n){var s=null,r=new DataChangeSp;i.filterRect=e;var o=i.stage.craetPoint();o.position.set(t.x,t.y);for(var h=f().filter(p).filter(function(t){return null!=t.isPointInLin(o.position,t.delph/4,t.delph/4)&&calc.getDistance(o.position,t.addPoint.position)>c&&calc.getDistance(o.position,t.addPoint1.position)>c}),a=0;a<h.length;a++)h[a].rememberState(),s=h[a].dividedSten(o,!0),r.arrNewSplice.push(s),r.arrDividedSplice.push(h[a]),d(o);return o.clearFree(),r.update(),r}}function V(t){this.type="SpPol",this.tipe="SpPol",this.stage=t,this.par=t,this._life=!0,this.idArr=-1,this._uuid=calc.generateUUID(),this.array=[];this.addPoint=function(t,i){var e=this.array.length;null!=i&&i<e&&(e=i),this.array.splice(e,0,t),t.addPol(this),this.drag(),this.stage.render()},this.removePoint=function(t){for(var i=0,e=0;e<this.array.length;e++)this.array[e].idArr==t.idArr&&(e,this.array.splice(e,1),t.removePol(this),i++);return 0!=i&&(this.drag(),this.testKill()),this.stage.render(),i},this.drag=function(){},this.clear=function(){for(var t=this.array.length-1;t>=0;t--)this.array[t]&&this.array[t].removePol(this);this.life=!1,this.stage.render()},this.testKill=function(){this.array.length<=1&&this.clear()}}function G(){var t=this;this.type="SpStage",this._delph=20,this.tipPoint="SpPoint",this.tipSplice="Splice",this.arrSplice=[],this.arrPoint=[],this.arrPol=[],this.arrayClass=[],this.arrCreat=[],this.arrClear=[],this.arrClearState=[],this.objBase=void 0,this.configData={delph:20},this.spUtility=new k,this.spCalc=new E,window.calc=new o,window.PositionFun=c,window.Position=a,window.Rectangle=l,window.LinePosition=h,this.korektSplice=new H(this),this._activMouse=!0,this._pointVisi=!0,this._oporPointVisi=!0,this._visiDimensioOnObj=!1,this.hesh={},this.getPoint=function(){return new n(this)},this.getSplice=function(){return new p(this)},this.getPol=function(){return new V(this)},this.render=function(){},this.funUpdateUuid=function(i,e){t.hesh[i]&&(t.hesh[i]!==this&&window.console.error("",t.hesh[i],this),delete t.hesh[i]),t.hesh[e]&&(t.hesh[e]!==this&&window.console.error("этот uuid уже испольузутся",t.hesh[e],this),delete t.hesh[i]),t.hesh[e]=this}}I.prototype=Object.create(p.prototype),I.prototype.constructor=I,I.prototype.getObj=function(){var t=p.prototype.getObj.call(this);return t.type=this.type,t.windows=this.windows.getObj(),t.colorSten=this.colorSten,t.height=this.height,t.sUi=this.sUi,t.idUi=this.idUi,t.offset=this.offset,t.bChaz=this.bChaz,t.carrier=this.carrier,t.out=this.out,t.adjacent=this.adjacent,t},I.prototype.setObj=function(t){p.prototype.setObj.call(this,t),void 0!==t.windows&&this.windows.setObj(t.windows),void 0!==t.boolText&&(this.boolText=t.boolText),void 0!==t.height&&(this.height=t.height),void 0!==t.idUi&&(this.idUi=t.idUi),void 0!==t.sUi&&(this.sUi=t.sUi),void 0!==t.offset&&(this.offset=t.offset),void 0!==t.bChaz&&(this.bChaz=t.bChaz),void 0!==t.carrier&&(this.carrier=t.carrier),void 0!==t.out&&(this.out=t.out),void 0!==t.adjacent&&(this.adjacent=t.adjacent)},I.prototype.compare=function(t){var i=!0;return p.prototype.compare(this,t)||(i=!1),i},I.prototype.setSten=function(t){p.prototype.setSten.call(this,t)},I.prototype.restart=function(){p.prototype.restart(this)},I.prototype.drag=function(){p.prototype.drag.call(this),this.stage.addObjFun(this)},Object.defineProperties(I.prototype,{height:{set:function(t){this._height!==t&&(this._height=t,this._setAllParam("height",this._height))},get:function(){return this._height}},boolText:{set:function(t){this._boolText!==t&&(this._boolText=t,this._setAllParam("boolText",this._boolText))},get:function(){return this._boolText}},active:{set:function(t){this._active!==t&&(this._active=t,this._setAllParam("active",this._active))},get:function(){return this._active}},activMouse:{set:function(t){if(this._activMouse!=t){this._activMouse=t;for(var i=0;i<this.arrayClass.length;i++)"activMouse"in this.arrayClass[i]&&(this.arrayClass[i].activMouse=this._activMouse)}},get:function(){return this._activMouse}},life:{set:function(t){if(this._life!=t){this._life=t;for(var i=0;i<this.arrayClass.length;i++)"life"in this.arrayClass[i]&&(this.arrayClass[i].life=this._life);1==this._life?this.stage.content2d2.addChild(this.content2d):null!=this.content2d.parent&&this.content2d.parent.removeChild(this.content2d),1==this._life?this.stage.content2d1.addChild(this.content2d1):null!=this.content2d1.parent&&this.content2d1.parent.removeChild(this.content2d1)}},get:function(){return this._life}},carrier:{set:function(t){this._carrier!==t&&(this._carrier=t,this.delph=this.par.getDelphToBoolS(this._carrier,this._out,this._adjacent),this.draw1())},get:function(){return this._carrier}},out:{set:function(t){this._out!==t&&(this._out=t,this.delph=this.par.getDelphToBoolS(this._carrier,this._out,this._adjacent),this.draw1())},get:function(){return this._out}},adjacent:{set:function(t){this._adjacent!==t&&(this._adjacent=t,this.delph=this.par.getDelphToBoolS(this._carrier,this._out,this._adjacent),this.draw1())},get:function(){return this._adjacent}},offset:{set:function(t){this._offset!==t&&(this._offset=t,this.cont2dOfset.position.y=this._offset,this._setAllParam("offset",this._offset),null!=this.funDragMenu&&this.funDragMenu(),this.stage.render())},get:function(){return this._offset}},bChaz:{set:function(t){this._bChaz!==t&&(this._bChaz=t,this._setAllParam("bChaz",this._bChaz),null!=this.funDragMenu&&this.funDragMenu(),this.stage.render())},get:function(){return this._bChaz}}}),D.prototype=Object.create(n.prototype),D.prototype.constructor=D,D.prototype.getObj=function(){var t=n.prototype.getObj.call(this);return t.type=this.type,t},D.prototype.setObj=function(t){n.prototype.setObj.call(this,t)},Object.defineProperties(D.prototype,{active:{set:function(t){if(this._active!=t){this._active=t,this.stAct.sahAct=t?40:0;for(var i=0;i<this.arrayClass.length;i++)"active"in this.arrayClass[i]&&(this.arrayClass[i].active=this._active)}},get:function(){return this._active}},height:{set:function(t){if(this._height!=t){this._height=t;for(var i=0;i<this.arrayClass.length;i++)"height"in this.arrayClass[i]&&(this.arrayClass[i].height=this._height)}},get:function(){return this._height}},activMouse:{set:function(t){if(this._activMouse!=t){this._activMouse=t;for(var i=0;i<this.arrayClass.length;i++)"activMouse"in this.arrayClass[i]&&(this.arrayClass[i].activMouse=this._activMouse)}},get:function(){return this._activMouse}},life:{set:function(t){this._life!=t&&(this._life=t,1==this._life?this.stage.content2dPoint.addChild(this.content2d):null!=this.content2d.parent&&this.content2d.parent.removeChild(this.content2d))},get:function(){return this._life}}}),A.prototype={set sahAct(t){this._sahAct!==t&&(this._sahAct=t,this.corektSetGet())},get sahAct(){return this._sahAct},set sahPlus(t){this._sahPlus!==t&&(this._sahPlus=t,this.corektSetGet())},get sahPlus(){return this._sahPlus}},B.prototype={set x(t){this._x=t},get x(){return this._x},set y(t){this._y=t},get y(){return this._y},set z(t){this._z=t},get z(){return this._z}},V.prototype={set uuid(t){this._uuid},get uuid(){return this._uuid},getObj:function(){for(var t={array:[]},i=0;i<this.array.length;i++)t.array.push({x:this.array[i].position.x,y:this.array[i].position.y});return t},setObj:function(t){for(var i=0;i<t.array.length;i++){var e=this.stage.getPointXY(t.array[i]);this.addPoint(e)}this.drag()},set life(t){this._life!=t&&(this._life=t)},get life(){return this._life}},G.prototype={craetPoint:function(){for(var t=0;t<this.arrPoint.length;t++)if(0==this.arrPoint[t].life)return this.arrPoint[t].life=!0,this.arrPoint[t];var i=this.getPoint();return this.arrPoint.push(i),this.arrPoint[this.arrPoint.length-1].idArr=this.arrPoint.length-1,this.arrPoint[this.arrPoint.length-1]},craetSplice1:function(){for(var t=0;t<this.arrSplice.length;t++)if(0==this.arrSplice[t].life)return this.arrSplice[t].life=!0,this.arrSplice[t].delph=this._delph,this.arrSplice[t];var i=this.getSplice();return this.arrSplice.push(i),this.arrSplice[this.arrSplice.length-1].idArr=this.arrSplice.length-1,this.arrSplice[this.arrSplice.length-1].funUpdateUuid=this.funUpdateUuid,this.arrSplice[this.arrSplice.length-1].restart(),this.arrSplice[this.arrSplice.length-1].delph=this._delph,this.hesh[this.arrSplice[this.arrSplice.length-1].uuid]=this.arrSplice[this.arrSplice.length-1],this.arrSplice[this.arrSplice.length-1]},craetSplice:function(t,i){return this.create(t,i)},create:function(t,i){if(t=t||{},!(i=i||t.uuid))return this.craetSplice1();this.hesh[i]||(this.craetSplice1().uuid=i);return t&&this.hesh[i].setObj(t),this.hesh[i]},craetPol:function(){for(var t=0;t<this.arrPol.length;t++)if(0==this.arrPol[t].life)return this.arrPol[t].life=!0,this.arrPol[t];var i=this.getPol();return this.arrPol.push(i),this.arrPol[this.arrPol.length-1].idArr=this.arrPol.length-1,this.hesh[this.arrPol[this.arrPol.length-1].uuid]=this.arrPol[this.arrPol.length-1],this.arrPol[this.arrPol.length-1]},render:function(){},getIdPositon:function(t,i){for(var e=0;e<this.arrPoint.length;e++)if(0!=this.arrPoint[e].life&&calc.testPositPoint(this.arrPoint[e].position,t)&&n(this.arrPoint[e],i))return e;function n(t,i){if(!i)return!0;for(var e=t.getConectedSten(),n=0;n<e.length;n++)if(-1!==i.indexOf(e[n].uuid))return!0;return!1}return-1},getPointXY:function(t){for(var i=0;i<this.arrPoint.length;i++)if(this.arrPoint[i].life&&Math.round(t.x)==Math.round(this.arrPoint[i].position.x)&&Math.round(t.y)==Math.round(this.arrPoint[i].position.y))return this.arrPoint[i];var e=this.craetPoint();return e.position.setPoint(t),e},stenInPoint:function(t){var i,e=t.connected?t.connected.arr:void 0,n=this.getIdPositon(t.position,e);(i=-1==n?this.craetPoint():this.arrPoint[n]).position.setPoint(t.position),i.addSplice(t,!0),e=t.connected?t.connected.arr1:void 0,(i=-1==(n=this.getIdPositon(t.position1,e))?this.craetPoint():this.arrPoint[n]).position.setPoint(t.position1),i.addSplice(t,!1)},getObj:function(t){var i={};i.type=this.type,i.tipPoint=this.tipPoint,i.tipSplice=this.tipSplice,i.arrPoint=[],i.arrSplice=[],i.arrPol=[];for(var e=0;e<this.arrPoint.length;e++)this.arrPoint[e].life&&i.arrPoint.push(this.arrPoint[e].getObj());for(e=0;e<this.arrSplice.length;e++)this.arrSplice[e].life&&i.arrSplice.push(this.arrSplice[e].getObj());for(e=0;e<this.arrPol.length;e++)this.arrPol[e].life&&i.arrPol.push(this.arrPol[e].getObj());return i},setObj:function(t){var i;if(null!=t.tipPoint&&(this.tipPoint=t.tipPoint),null!=t.tipSplice&&(this.tipSplice=t.tipSplice),this.arrCreat.length=0,null!=t.arrSplice)for(var e=0;e<t.arrSplice.length;e++)(i=this.craetSplice()).setObj(t.arrSplice[e]),this.arrCreat.push(i);if(null!=t.arrPol)for(e=0;e<t.arrPol.length;e++)(i=this.craetPol()).setObj(t.arrPol[e]);!function(t){for(var i=0;i<t.length;i++)t[i].clearFree()}(this.arrPoint);for(e=0;e<this.arrPoint.length;e++)this.arrPoint[e].life&&this.arrPoint[e].dragGG()},clear:function(){for(var t=0;t<this.arrPoint.length;t++)this.arrPoint[t].clear();for(t=0;t<this.arrSplice.length;t++)this.arrSplice[t].clear();for(t=0;t<this.arrPol.length;t++)this.arrPol[t].clear()}},Object.defineProperties(G.prototype,{delph:{set:function(t){this._delph=t},get:function(){return this._delph}}});e(3);function X(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var Y=function(){function t(i,e){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,t),this.type="SPLine";var n,s,r,o=this;this.par=i,this.fun=e,this._life=!0,this._visible=!0,this._otstup=0,this.sah=100,this.colol=4085598,this.colol_="#3e575e",this.array=[],this.uuid=calc.generateUUID(),this._activeMouse=!this.par.activeMouse,this._mashtabText=8,this.content2d=new PIXI.Container,i.content2d.addChild(this.content2d),this.graphics=new PIXI.Graphics,this.content2d.addChild(this.graphics),this.text=new PIXI.Text("345634634",{fontFamily:"Arial"}),this.content2d.addChild(this.text),this.text.scale.x=this.text.scale.y=this._mashtabText,this.onDragStart=function(t){null!=o.par.sobSP&&o.par.sobSP("downLine",o,t)},this.onDragStart1=function(t){null!=o.par.sobSP&&o.par.sobSP("downLine1",o,t)},this.onDragStart2=function(t){null!=o.par.sobSP&&o.par.sobSP("downLine2",o,t)},this.g=new PIXI.Graphics,this.g.name="0",this.g.beginFill(16777215,.01),this.g.drawCircle(0,0,50),this.g1=new PIXI.Graphics,this.g1.beginFill(16777215,.01),this.g1.drawCircle(0,0,50),this.g1.name="1",this.g2=new PIXI.Graphics,this.g2.name="1",this.render=this.par.render,this.activeMouse=this.par.activeMouse,this.clear=function(){this.life=!1,this._otstup=0,this.render&&this.render()},this.drawposit=function(){o.drag()},this.position=new PositionFun(0,0,this.drawposit),this.position1=new PositionFun(0,0,this.drawposit),this.p=new Position,this.p1=new Position,this.pNull=new Position(0,0),this.drag=function(){n=calc.getAngle(this.position,this.position1),s=calc.getDistance(this.position,this.position1),calc.getVector(this._otstup,n+Math.PI/2,this.p),this.p.x+=this.position.x,this.p.y+=this.position.y,calc.getVector(this._otstup,n+Math.PI/2,this.p1),this.p1.x+=this.position1.x,this.p1.y+=this.position1.y,this.content2d.x=this.position.x,this.content2d.y=this.position.y,this.content2d.rotation=n,this.graphics.clear(),this.graphics.lineStyle(10,this.colol,1),this.graphics.moveTo(0,0),this.graphics.lineTo(0,this._otstup+(this._otstup>0?this.sah:-this.sah)),this.graphics.moveTo(0,this._otstup),this.graphics.lineTo(s,this._otstup),this.graphics.moveTo(s,0),this.graphics.lineTo(s,this._otstup+(this._otstup>0?this.sah:-this.sah)),this.graphics.lineStyle(15,this.colol,1),this.graphics.moveTo(-this.sah/2,this._otstup+(this._otstup>0?.5*this.sah:.5*-this.sah)),this.graphics.lineTo(this.sah/2,this._otstup+(this._otstup>0?.5*-this.sah:.5*this.sah)),this.graphics.moveTo(s-this.sah/2,this._otstup+(this._otstup>0?.5*this.sah:.5*-this.sah)),this.graphics.lineTo(s+this.sah/2,this._otstup+(this._otstup>0?.5*-this.sah:.5*this.sah)),this.g2.clear(),this.g2.beginFill(16777215,.01),this.g2.drawRect(0,0,s,32*this._mashtabText),this.g2.y=this._otstup,this.g1.x=s,n>-Math.PI/2&&n<Math.PI/2?(this.text.text=""+Math.round(s),this.text.x=s/2-this.text.width/2,this.text.y=this._otstup,this.text.rotation=0):(this.text.text=""+Math.round(s),this.text.x=s/2+this.text.width/2,this.text.y=this._otstup+32*this._mashtabText,this.text.rotation=Math.PI),this.render&&this.render()},this.poiskOt=function(t){(r=calc.isPointInLin(this.position1,this.position,t,111111111,111111111))&&(this.otstup=r.z)},this.setObj=function(t){this.position.set(t.position.x,t.position.y),this.position1.set(t.position1.x,t.position1.y),this.otstup=t.otstup},this.getObj=function(){var t={};return t.position={x:this.position.x,y:this.position.y},t.position1={x:this.position1.x,y:this.position1.y},t.otstup=this.otstup,t}}var i,e,n;return i=t,(e=[{key:"activeMouse",set:function(t){this._activeMouse!=t&&(this._activeMouse=t,t?(this.content2d.addChild(this.g2),this.content2d.addChild(this.g),this.content2d.addChild(this.g1),this.g.interactive=!0,this.g1.interactive=!0,this.g2.interactive=!0,this.g.on("mousedown",this.onDragStart),this.g1.on("mousedown",this.onDragStart1),this.g2.on("mousedown",this.onDragStart2)):(this.content2d.removeChild(this.g2),this.content2d.removeChild(this.g),this.content2d.removeChild(this.g1),this.g.interactive=!1,this.g1.interactive=!1,this.g2.interactive=!1,this.g.off("mousedown",this.onDragStart),this.g1.off("mousedown",this.onDragStart1),this.g2.off("mousedown",this.onDragStart2)))},get:function(){return this._activeMouse}},{key:"visible",set:function(t){this._visible!=t&&(this._visible=t,this.content2d.visible=t)},get:function(){return this._visible}},{key:"otstup",set:function(t){this._otstup!=t&&(this._otstup=t,this.drag())},get:function(){return this._otstup}},{key:"life",set:function(t){this._life!=t&&(this._life=t,1==this._life?this.par.content2d.addChild(this.content2d):null!=this.content2d.parent&&this.content2d.parent.removeChild(this.content2d))},get:function(){return this._life}}])&&X(i.prototype,e),n&&X(i,n),t}();function W(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var N=function(){function t(i,e){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,t),this.type="SPLine";var n=this;this.par=i,this.fun=e,this.sp=i.par,this._activeMouse=!0,this.array=[],this.arrayPosit=[],this.arrayPosit1=[],this.kol=0,this.content2d=new PIXI.Container,this.clear=function(){n.sp.render();for(var t=0;t<this.array.length;t++)this.array[t].visible=!1},this.craetLine=function(){var t=new Y(this);return t.life=!1,this.content2d.addChild(t.content2d),t.content2d.alpha=.5,t.render=n.sp.render(),t},this.visiOtstup=function(t,i){var e,s=this.pointOld.x-t.x,r=this.pointOld.y-t.y;Math.round(i)==-Math.round(Math.PI/2)&&(e=-s),Math.round(i)==-Math.round(Math.PI)&&(e=r);for(var o=0;o<this.arrayPosit1.length-1;o++)this.array[o].visible=!0,this.array[o].otstup=e;n.sp.render()},this.creatReal=function(){for(var t={array:[]},i=0;i<this.arrayPosit1.length-1;i++)t.array.push(this.array[i].getObj());n.par.setObj(t),n.sp.render()};new Position;var s,r=new Position;this.pointOld=new THREE.Vector3,this.visiPoint=function(t,i,e){this.clear(),this.pointOld.x=t.x,this.pointOld.y=t.y,calc.getVector(9999999,i,r),r.x+=t.x,r.y+=t.y,this.kol=0;for(var o=0;o<this.sp.arrSplice.length;o++)if(this.sp.arrSplice[o].life)for(var h=0;h<n.sp.arrSplice[o].arrGran.length;h+=2)(s=calc.getPointOfIntersection(n.sp.arrSplice[o].arrGran[h],n.sp.arrSplice[o].arrGran[h+1],t,r))&&(null==this.arrayPosit[this.kol]&&(this.arrayPosit[this.kol]=new THREE.Vector3),this.arrayPosit[this.kol].x=s.x,this.arrayPosit[this.kol].y=s.y,this.arrayPosit[this.kol].z=calc.getDistance(this.arrayPosit[this.kol],t),this.kol++);if(!(this.kol<2)){this.arrayPosit1.length=0;for(o=0;o<this.kol;o++)null==e?this.arrayPosit1.push(this.arrayPosit[o]):this.arrayPosit[o].x>=e.x&&this.arrayPosit[o].x<=e.x1&&this.arrayPosit[o].y>=e.y&&this.arrayPosit[o].y<=e.y1&&this.arrayPosit1.push(this.arrayPosit[o]);if(!(this.arrayPosit1.length<2)){this.arrayPosit1.sort(function(t,i){return t.z-i.z});for(o=0;o<this.arrayPosit1.length-1;o++)null==this.array[o]&&(this.array[o]=this.craetLine()),this.array[o].position.set(this.arrayPosit1[o].x,this.arrayPosit1[o].y),this.array[o].position1.set(this.arrayPosit1[o+1].x,this.arrayPosit1[o+1].y),this.array[o].visible=!0,this.array[o].otstup=0;n.sp.render()}}}}var i,e,n;return i=t,(e=[{key:"activeMouse",set:function(t){this._activeMouse!=t&&(this._activeMouse=t)},get:function(){return this._activeMouse}}])&&W(i.prototype,e),n&&W(i,n),t}();function F(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var U=function(){function t(i,e){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,t),this.type="SPLine";var n=this;this.par=i,this.fun=e,this._activeMouse=!0,this.array=[],this.content2d=new PIXI.Container,this.par.cont2dLine.addChild(this.content2d),this.debugPixi=new _.a,this.content2d.addChild(this.debugPixi.content2d),this.visiLine=new N(this,function(t,i,e){}),this.par.cont2dLine.addChild(this.visiLine.content2d),this.sobSP=function(t,i,e){n.par.par.sobSP(t,i,e)},this.craetLine=function(){for(var t=0;t<this.array.length;t++)if(0==this.array[t].life)return this.array[t].life=!0,this.array[t];return this.array.push(new Y(this)),this.array[this.array.length-1].idArr=this.array.length-1,this.array[this.array.length-1]};var s,r,o,h={x:0,y:0,d:0,o:null};this.getPoint=function(t,i){s=99999999999999,o=-1;for(var e=0;e<this.array.length;e++)0!=this.array[e].life&&(i&&this.array[e].idArr==i.idArr||(r=calc.getDistance(t,this.array[e].p1),s>r&&(h.x=this.array[e].p.x,h.y=this.array[e].p.y,s=r,o=e),r=calc.getDistance(t,this.array[e].p),s>r&&(h.x=this.array[e].p1.x,h.y=this.array[e].p1.y,s=r,o=e)));return-1!=o?(h.d=s,h.o=this.array[o],h):null},this.render=function(){this.par.render()},this.setObj=function(t){for(var i=0;i<t.array.length;i++){this.craetLine().setObj(t.array[i])}},this.getObj=function(){for(var t={array:[]},i=0;i<this.array.length;i++)0!=this.array[i].life&&t.array.push(this.array[i].getObj());return t}}var i,e,n;return i=t,(e=[{key:"activeMouse",set:function(t){if(this._activeMouse!=t){this._activeMouse=t;for(var i=0;i<this.array.length;i++)this.array[i].activeMouse=t}},get:function(){return this._activeMouse}}])&&F(i.prototype,e),n&&F(i,n),t}();function q(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var K=function(){function t(){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,t),this.type="Body";var i=this;this.drag=void 0,this.target,this.rect={x:0,y:0,z:0,w:0,h:0,d:0,x1:0,y1:0,z1:0},this.dragFun=function(){i._parent&&i._parent.korektPosition(i),null!=i.drag&&i.drag()},this.position=new y(0,0,0,this.dragFun),this.children=this.array=[],this.uuid=1*(Math.round(1e11*Math.random())+""+Math.round(1e11*Math.random())),this.addShape=function(t){this.children.push(t),t.parent=this,this.korekt()},this.removeShape=function(t){},this.korekt=function(){if(0!=this.children.length){this.rect.x=this.rect.y=this.rect.z=999999999999999,this.rect.x1=this.rect.y1=this.rect.z1=-999999999999999,this.rect.w=this.rect.h=this.rect.d=0;for(var t=0;t<this.children.length;t++)this.rect.x>this.children[t].rect.x&&(this.rect.x=this.children[t].rect.x),this.rect.y>this.children[t].rect.y&&(this.rect.y=this.children[t].rect.y),this.rect.z>this.children[t].rect.z&&(this.rect.z=this.children[t].rect.z),this.rect.x1<this.children[t].rect.x+this.children[t].rect.w&&(this.rect.x1=this.children[t].rect.x+this.children[t].rect.w),this.rect.y1<this.children[t].rect.y+this.children[t].rect.h&&(this.rect.y1=this.children[t].rect.y+this.children[t].rect.h),this.rect.z1<this.children[t].rect.z+this.children[t].rect.d&&(this.rect.z1=this.children[t].rect.z+this.children[t].rect.d);this.rect.w=this.rect.x1-this.rect.x,this.rect.h=this.rect.y1-this.rect.y,this.rect.d=this.rect.z1-this.rect.z}else this.rect.x=this.rect.y=this.rect.z=this.rect.x1=this.rect.y1=this.rect.z1=this.rect.w=this.rect.h=this.rect.d=0}}var i,e,n;return i=t,(e=[{key:"parent",set:function(t){this._parent!=t&&(this._parent=t)},get:function(){return this._parent}}])&&q(i.prototype,e),n&&q(i,n),t}();function J(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var Z=function(){function t(){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,t),this.type="Shape";this.name="rect",this.rect=[0,0,0,100,100,100],this.uuid=1*(Math.round(1e11*Math.random())+""+Math.round(1e11*Math.random()));this.rect={x:-100,y:-100,z:-100,w:200,h:200,d:200},this.setRect=function(t){this.rect.x=t[0],this.rect.y=t[1],this.rect.z=t[2],this.rect.w=t[3],this.rect.h=t[4],this.rect.d=t[5],null!=this._parent&&this._parent.korekt()}}var i,e,n;return i=t,(e=[{key:"parent",set:function(t){this._parent!=t&&(this._parent=t)},get:function(){return this._parent}}])&&J(i.prototype,e),n&&J(i,n),t}();function Q(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var tt=function(){function t(i,e,n){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,t),this.type="Blok";var s=this;this.par=i,this.obj=e,this.fun=n,this.id=e.id,this.icon=e.icon,this.typeStr=e.str[0],this.typeStr1=e.str[1],this.idArr=-1,this._active=!1,this._width=100,this._height=100,this._delph=100,this._boolSten=!1,this._rotation=0,this.boxHelper=void 0,this._life=!0,this._parent=void 0,this.uuid=calc.generateRendom(2),this.content2d=new PIXI.Container,this.funInit=void 0,this.body=void 0,this.shape=void 0,this.init=function(){this.body=new K,this.body.target=this,this.body.drag=this.drag,this.shape=new Z,this.shape.setRect(e.rect),this.body.addShape(this.shape),this._width=e.rect[3],this._height=e.rect[5],this._delph=e.rect[4],this.dragWHD(),null!=this.funInit&&this.funInit()},this.clear=function(){null!=this._parent&&this._parent.removeBlok(this),this.life=!1},this.vector,this.setPosition=function(t,i,e){null!=s._parent&&"SPLWindow"==s._parent.type&&(this.vector=s._parent.getGlob(t,i,e,this),this.setReal(this.vector.x,this.vector.y,this.vector.z),this.render())},this._x=0,this._y=0,this._z=0,this.setReal=function(t,i,e){this._x=t,this._y=i,this._z=e,this.body.position.set(t,0),this._parent&&this._parent.drawDeb()},this.drag=function(){s.content2d.x=s.body.position.x,s.content2d.y=0},this.render=function(){this.par.render()},this.dragWHD=function(t,i,e){void 0!==t&&(this._width=t,this._height=i,this._delph=e)},this.funSetObj=void 0,this.funGetObj=void 0,this.setObj=function(t){this._width=t.w,this._height=t.h,this._delph=t.d,this.setReal(t.x,t.y,t.z),this.dragWHD(),this.funSetObj&&this.funSetObj(t)},this.getObj=function(){var t={};return t.id=this.id,t.x=this._x,t.y=this._y,t.z=this._z,t.w=this._width,t.h=this._height,t.d=this._delph,this.funGetObj&&this.funGetObj(t),t},this.drawActive=void 0}var i,e,n;return i=t,(e=[{key:"active",set:function(t){this._active!=t&&(this._active=t,null!=this.drawActive&&this.drawActive())},get:function(){return this._active}},{key:"width",set:function(t){this._width!=t&&(this._width=t,this.dragWHD())},get:function(){return this._width}},{key:"height",set:function(t){this._height!=t&&(this._height=t,this.dragWHD())},get:function(){return this._height}},{key:"delph",set:function(t){this._delph!=t&&(this._delph=t,this.dragWHD())},get:function(){return this._delph}},{key:"life",set:function(t){this._life!=t&&(this._life=t,null!=this._parent&&null!=this._parent.removeBlok&&this._parent.removeBlok(this),this.par.render())},get:function(){return this._life}},{key:"parent",set:function(t){this._parent!=t&&(this.parentOld=this._parent,this._parent=t,this._life=null!=t,this.par.render())},get:function(){return this._parent}}])&&Q(i.prototype,e),n&&Q(i,n),t}();function it(t){return(it="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function et(t){return(et=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function nt(t,i){return(nt=Object.setPrototypeOf||function(t,i){return t.__proto__=i,t})(t,i)}function st(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var rt=function(t){function i(t,e,n){var s;!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,i),(s=function(t,i){return!i||"object"!==it(i)&&"function"!=typeof i?st(t):i}(this,et(i).call(this,t,e,n))).type="BInSten";var r=st(st(s));return s.par,s.graphics=new PIXI.Graphics,s.content2d.addChild(s.graphics),s.graphics.beginFill(65280,.5),s.graphics.drawCircle(0,0,150),s.stAct=new ot(st(st(s))),s.onDragStart=function(t){null!=r.par.par.par.sobSP&&r.par.par.par.sobSP("downBlok",r,t)},s.graphics.interactive=!0,s.graphics.on("mousedown",s.onDragStart),s.graphics.on("mouseover",function(t){r.stAct.sahPlus=10}),s.graphics.on("mouseout",function(t){r.stAct.sahPlus=0}),s.rect1={},s.funInit=function(){this.rect1.x=-this._width/2,this.rect1.y=-this._height/2,this.rect1.z=-this._delph/2,this.rect1.w=this._width,this.rect1.h=this._height,this.rect1.d=this._delph,null!=this.obj.rect1&&(this.rect1.x=this.obj.rect1[0],this.rect1.y=this.obj.rect1[1],this.rect1.z=this.obj.rect1[2],this.rect1.w=this.obj.rect1[3],this.rect1.h=this.obj.rect1[4],this.rect1.d=this.obj.rect1[5]),trace(this.rect1)},s.dragWHD=function(t,i,e){void 0!==t&&(this._width=t,this._height=i,this._delph=e),this.graphics.clear(),this.graphics.beginFill(2236962,.01),this.graphics.drawRect(-this._width/2,-this._delph/2,this._width,this._delph),this.graphics.endFill();var n=this.par._sizeLine,s=this.par._colorLine_;if("Window"==this.typeStr1&&(this.graphics.lineStyle(n,s,1),this.graphics.drawRect(this.rect1.x,-this._delph/2-n/2,this.rect1.w,this._delph+n),this.graphics.lineStyle(n/2,s,1),this.graphics.drawRect(this.rect1.x,-40,this.rect1.w,80)),"Door"==this.typeStr1){this.graphics.lineStyle(n,s,1),this.graphics.drawRect(this.rect1.x,-this._delph/2-n/2,this.rect1.w,this._delph+n),this.graphics.lineStyle(n/2,s/2,1);var r=calc.getVector(-this._delph/2-this._delph/2,0),o=calc.getVector(this.rect1.x-this.rect1.w/5,90),h=calc.getVector(Math.abs(this.rect1.x-this.rect1.w/5),45);this.graphics.moveTo(this.rect1.x,r.y),this.graphics.lineTo(this.rect1.w/2,r.y),this.graphics.moveTo(this.rect1.x,r.y),this.graphics.lineTo(o.x,o.y),this.graphics.moveTo(o.x,o.y),this.graphics.quadraticCurveTo(h.x+h.x/4,-h.y+h.y/4,this.rect1.w/2,r.y)}this.stAct.draw1()},s.drawActive=function(){this.stAct.sahAct=this._active?40:0},s.init(),s}return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&nt(t,i)}(i,tt),i}();function ot(t){this.type="BTAct",this.par=t,this._sahAct=0,this._sahPlus=0,this.graphics=new PIXI.Graphics,this.par.content2d.addChild(this.graphics),this.graphics.alpha=this._sahAct/100,this.draw1=function(){this.graphics.clear(),this.graphics.clear(),this.graphics.beginFill(t.par.par.colorUI),this.graphics.drawRect(-this.par._width/2,-this.par._delph/2,this.par._width,this.par._delph),this.graphics.endFill()},this.corektSetGet=function(){this.graphics.alpha=(this._sahAct+this._sahPlus)/100,this.par.par.render()}}function ht(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}ot.prototype={set sahAct(t){this._sahAct!==t&&(this._sahAct=t,this.corektSetGet())},get sahAct(){return this._sahAct},set sahPlus(t){this._sahPlus!==t&&(this._sahPlus=t,this.corektSetGet())},get sahPlus(){return this._sahPlus}};var at=function(){function t(i,e){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,t),this.type="WorldBlok";this.par=i,this.fun=e,this._sizeLine=this.par._sizeLine,this._colorLine_=this.par._colorLine_,this.uuid=calc.generateRendom(2),this.array=[],this.content2d=new PIXI.Container,this.par.cont2dBlok.addChild(this.content2d),this.arrBD=[],this.arrObj={},this.arrBD.push({id:0,icon:"resources/image/w0.png",rect:[-1e3,-1e3,-100,2e3,2e3,200],str:["BInSten","Window","","","",""]}),this.arrBD.push({id:1,icon:"resources/image/w1.png",rect:[-1500,-1500,-100,3e3,3e3,200],rect1:[-1300,-1500,-100,2600,3e3,200],str:["BInSten","Door","","","",""]}),this.arrBD.push({id:4,icon:"resources/image/w1.png",rect:[-2500,-1500,-100,5e3,3e3,200],rect1:[-2300,-1500,-100,4600,3e3,200],str:["BInSten","Door","","","",""]}),this.arrBD.push({id:2,icon:"resources/image/w2.png",rect:[-1e3,-1e3,-100,2e3,2e3,200],str:["BInSten","Not","","","",""]}),this.arrBD.push({id:3,icon:"resources/image/w0.png",rect:[-3e3,-3e3,-200,6e3,6e3,400],str:["BWord","xz","","","",""]});for(var n=0;n<this.arrBD.length;n++)this.arrObj[this.arrBD[n].id]=this.arrBD[n];this.sobBlok=function(t,i,e){},this.getBlok=function(t){for(var i=this.arrObj[t],e=0;e<this.array.length;e++)if(1!=this.array[e].life&&this.array[e].id==t)return this.array[e];var n=void 0;return"BInSten"==i.str[0]&&(n=new rt(this,i,this.sobBlok)),null==n&&(n=new tt(this,i,this.sobBlok)),n.idArr=this.array.length,this.array.push(n),n},this.render=function(){this.par.render()},this.setObj=function(t){trace(">>>>",t);for(var i=0;i<t.array.length;i++);},this.getObj=function(){for(var t={array:[]},i=0;i<this.array.length;i++)0!=this.array[i].life&&this.array[i].parent.uuid==this.uuid&&t.array.push(this.array[i].getObj());return t}}var i,e,n;return i=t,(e=[{key:"activeMouse",set:function(t){if(this._activeMouse!=t){this._activeMouse=t;for(var i=0;i<this.array.length;i++)this.array[i].activeMouse=t}},get:function(){return this._activeMouse}},{key:"colorLine",set:function(t){if(this._colorLine!=t){this._colorLine=t;for(var i=0;i<this.array.length;i++)this.array[i].dragWHD()}},get:function(){return this._colorLine}},{key:"sizeLine",set:function(t){if(this._sizeLine!=t){this._sizeLine=t;for(var i=0;i<this.array.length;i++)this.array[i].dragWHD()}},get:function(){return this._sizeLine}}])&&ht(i.prototype,e),n&&ht(i,n),t}();function ct(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var lt=function(){function t(i,e){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,t),this.type="SPGroup";var n,s,r,o=this;this.par=i,this.fun=e,this.uuid=calc.generateRendom(2),this.funDragMenu=void 0,this._colorUI=this.par._colorUI,this._active=!1,this.array=[],this.content2d=new PIXI.Container,this.par.cont2dGroup.addChild(this.content2d),this.graphics=new PIXI.Graphics,this.content2d.addChild(this.graphics),this.graphicsBig=new PIXI.Graphics,this.content2d.addChild(this.graphicsBig),this.graphicsEvent=new PIXI.Graphics,this.par.contNiz.addChild(this.graphicsEvent),this.onDragStart=function(t){null!=o.par.par.sobSP&&o.par.par.sobSP("downGroup",o,t)},this.graphicsEvent.interactive=!0,this.graphicsEvent.on("mousedown",this.onDragStart),this.rectBig={x:0,y:0,x1:0,y1:0,w:0,h:0,o:null},this.addObj=function(t){for(var i=0;i<this.array.length;i++)if(this.array[i].uuid==t.uuid)return!1;return this.array.push(t),this.korektRect(),this.drawRect(),null!=this.funDragMenu&&this.funDragMenu(),!0},this.removeObj=function(t){for(var i=!1,e=this.array.length-1;e>=0;e--)this.array[e].uuid==t.uuid&&(this.array.splice(e,1),i=!0);return 1==i&&(this.korektRect(),this.drawRect()),null!=this.funDragMenu&&this.funDragMenu(),i},this.korektRect=function(t){this.rectBig.x=99999999999,this.rectBig.y=99999999999,this.rectBig.x1=-29999999999,this.rectBig.y1=-29999999999;for(var i=0;i<this.array.length;i++)"SpliceSten"==this.array[i].type&&(1==t&&this.array[i].korectOffset(),r=this.array[i].rectBig,this.rectBig.x>r.x&&(this.rectBig.x=r.x),this.rectBig.x1<r.x+r.w&&(this.rectBig.x1=r.x+r.w),this.rectBig.y>r.y&&(this.rectBig.y=r.y),this.rectBig.y1<r.y+r.h&&(this.rectBig.y1=r.y+r.h));for(i=0;i<this.array.length;i++)"SpPointSten"==this.array[i].type&&(r=this.array[i].position,this.rectBig.x>r.x&&(this.rectBig.x=r.x),this.rectBig.x1<r.x&&(this.rectBig.x1=r.x),this.rectBig.y>r.y&&(this.rectBig.y=r.y),this.rectBig.y1<r.y&&(this.rectBig.y1=r.y));this.rectBig.w=this.rectBig.x1-this.rectBig.x,this.rectBig.h=this.rectBig.y1-this.rectBig.y,99999999999==this.rectBig.x&&(this.rectBig.x=this.rectBig.y=this.rectBig.w=this.rectBig.h=0),1==t&&this.drawRect()},this.drawRect=function(){this.graphicsBig.clear(),this.graphicsBig.lineStyle(10,this._colorUI,.75),this.graphicsBig.beginFill(this._colorUI,.1),this.graphicsBig.drawRect(this.rectBig.x,this.rectBig.y,this.rectBig.w,this.rectBig.h),this.graphicsEvent.clear(),this.graphicsEvent.beginFill(16777215,.1),this.graphicsEvent.drawRect(this.rectBig.x,this.rectBig.y,this.rectBig.w,this.rectBig.h),this.par.render()},this.clear=function(){for(var t=0;t<this.array.length;t++)this.array[t].clear();this.array.length=0,this.par.render(),this.active=!1},this.setPosOffset=function(t,i){for(var e=0;e<this.array.length;e++)"SpPointSten"==this.array[e].type&&((r=this.array[e].position).set(r.x+t,r.y+i),this.array[e].doFunRend());this.korektRect(!0)},this.addRect=function(t){if(n=this.par.getRect(),1==calc.isRectS(n,t))for(var i=0;i<this.par.arrSplice.length;i++)if(0!=this.par.arrSplice[i].life&&null!=(s=this.par.arrSplice[i].isRect(t,!1)))for(var e=0;e<s.length;e++)this.addObj(s[e])},this.setRect=function(t){this.graphics.clear(),null!=t&&(this.graphics.lineStyle(10,this._colorUI,.3),this.graphics.beginFill(this._colorUI,.01),this.graphics.drawRect(t.x,t.y,t.w,t.h)),this.par.render()}}var i,e,n;return i=t,(e=[{key:"active",set:function(t){this._active!=t&&(this._active=t,this.array.length=0,this.graphicsBig.clear(),this.graphicsEvent.clear(),this.setRect(),this.graphicsEvent.visible=t,this.content2d.visible=t,this.par.render())},get:function(){return this._active}}])&&ct(i.prototype,e),n&&ct(i,n),t}();function ut(t,i){G.call(this);var e=this;function n(t,i){t.x>i.x&&(t.x=i.x),t.y>i.y&&(t.y=i.y),t.x1<i.x&&(t.x1=i.x),t.y1<i.y&&(t.y1=i.y)}this.type="SpStageSten",this.par=t,this.tipSplice="SpliceSten",this.tipPoint="SpPointSten",this.fun=i,this.uuid=calc.generateRendom(2),this._delph=500,this._colorUI=36026,this._colorUIActive=15892548,this._color="#c5d6e0",this._colorP=12965600,this._colorP1=12965600,this._carrier=!0,this._out=!0,this._adjacent=!0,this._colorC0="#222222",this._colorC1="#222222",this._colorC0_=2236962,this._colorC1_=2236962,this._delphC0=100,this._delphC1=100,this._delphPlus=0,this._mashtab=t._mashtab,this._amSten=!1,this._amPoint=!1,this._amPol=!1,this._activMouse=!1,this._colorLine="#000000",this._colorLine_=0,this._sizeLine=10,this._activeSten=-1,this._activePoint=-1,this._activePol=-1,this._height=300,this._alpha=1,this._status=2,this.boolText=!0,this.content2d=new PIXI.Container,this.contNiz=new PIXI.Container,this.content2d1=new PIXI.Container,this.content2d2=new PIXI.Container,this.content2dPoint=new PIXI.Container,this.cont2dLine=new PIXI.Container,this.cont2dBlok=new PIXI.Container,this.cont2dGroup=new PIXI.Container,this.content2d.addChild(this.contNiz),this.content2d.addChild(this.content2d1),this.content2d.addChild(this.content2d2),this.content2d.addChild(this.content2dPoint),this.content2d.addChild(this.cont2dBlok),this.content2d.addChild(this.cont2dLine),this.content2d.addChild(this.cont2dGroup),this.lineWord=new U(this),this.worldBlok=new at(this),this.group=new lt(this),this.colorT=new THREE.Color,this.convertC=function(t,i){return this.colorT.set(t),null!=i&&(this.colorT.r*=i[0],this.colorT.g*=i[1],this.colorT.b*=i[2]),this.colorT.getHex()},this.getPoint=function(){return new D(this)},this.getSplice=function(){return new I(this)},this.arrFun=[],this.arrObj=[],this.render=function(){this.par.renderDebag&&this.par.renderDebag()},this.getRect=function(t,i){if(null==t){t=[];for(var e=0;e<this.arrPoint.length;e++)0!=this.arrPoint[e].life&&t.push(this.arrPoint[e])}if(null==i){i=[];for(e=0;e<this.arrSplice.length;e++)0!=this.arrSplice[e].life&&i.push(this.arrSplice[e])}var s={x:9999999,y:999999,x1:-9999999,y1:-9999999,w:0,h:0};for(e=0;e<t.length;e++)n(s,t[e].position);for(e=0;e<i.length;e++)i[e].poiskGran(),n(s,i[e].arrGran[0]),n(s,i[e].arrGran[1]),n(s,i[e].arrGran[2]),n(s,i[e].arrGran[3]);return s.w=s.x1-s.x,s.h=s.y1-s.y,s},this.dragStyleObj=function(t){for(var i in t)null!=this[i]&&(this[i]=t[i]);this.bigDrag()},this.getDelphToBoolS=function(t,i,e){var n=this._delphC0;return 1==t&&(n=this._delphC1),1==i&&1==t&&(n+=this._delphPlus),n};var s=[];this.setActive=function(t){if(s.length=0,null!=t)if(null!=t[0])for(var i=0;i<t.length;i++)s.push(t[i]);else s.push(t);null==t&&(this.group.active=!1);for(i=0;i<this.arrPoint.length;i++)0!=this.arrPoint[i].life&&(1==this.testSetActive(this.arrPoint[i])?this.arrPoint[i].active=!0:this.arrPoint[i].active=!1);for(i=0;i<this.arrSplice.length;i++)if(0!=this.arrSplice[i].life){1==this.testSetActive(this.arrSplice[i])?this.arrSplice[i].active=!0:this.arrSplice[i].active=!1;for(var e=0;e<this.arrSplice[i].windows.array.length;e++)1==this.testSetActive(this.arrSplice[i].windows.array[e])?this.arrSplice[i].windows.array[e].active=!0:this.arrSplice[i].windows.array[e].active=!1}},this.testSetActive=function(t){if(0==s.length)return!1;for(var i=0;i<s.length;i++)if(s[i].uuid==t.uuid)return!0;return!1},this.bigDrag=function(){for(var t=0;t<this.arrSplice.length;t++)0!=this.arrSplice[t].life&&this.arrSplice[t].dragPost();for(t=0;t<this.arrPoint.length;t++)0!=this.arrPoint[t].life&&this.arrPoint[t].dragPost()},this.addObjFun=function(t){for(var i=0;i<this.arrObj.length;i++)if(this.arrObj[i].idRandom==t.idRandom)return;this.arrObj.push(t)},this.doRender=function(){if(0==e.arrObj.length)return!1;for(var t=0;t<e.arrObj.length;t++)e.arrObj[t].dragPost();return e.arrObj.length=0,!0}}function pt(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}ut.prototype=Object.create(G.prototype),ut.prototype.constructor=ut,ut.prototype.getObj=function(t){var i=G.prototype.getObj.call(this,t);return i.color=this._color,i.alpha=this._alpha,i.lineWord=this.lineWord.getObj(),i.worldBlok=this.lineWord.getObj(),i},ut.prototype.setObj=function(t){G.prototype.setObj.call(this,t),t.color&&(this.color=t.color),t.alpha&&(this.alpha=t.alpha),t.lineWord&&this.lineWord.setObj(t.lineWord),t.worldBlok&&this.lineWord.setObj(t.worldBlok),this.bigDrag()},ut.prototype.craetSplice1=function(){var t=G.prototype.craetSplice1.call(this);return t.col3d=this.col3d,t.col3d1=this.col3d1,t.activMouse=this._amSten,t.boolText=this.boolText,t},ut.prototype.craetPoint=function(){var t=G.prototype.craetPoint.call(this);return t.activMouse=this._amPoint,t},ut.prototype.craetPol=function(){var t=G.prototype.craetPol.call(this);return t.activMouse=this._amSten,t.col3d2=this.col3d2,t},Object.defineProperties(ut.prototype,{status:{set:function(t){this._status!=t&&(this._status=t,null!=this.content2d.parent&&this.content2d.parent.removeChild(this.content2d),this._status,1==this._status&&this.fun("addChild","c2dSloi",this.content2d),0==this._status&&this.fun("addChild","c2dSloi2",this.content2d))},get:function(){return this._status}},mashtab:{set:function(t){this._mashtab!=t&&(this._mashtab=t)},get:function(){return this._mashtab}},carrier:{set:function(t){this._carrier!==t&&(this._carrier=t,this._delph=this.getDelphToBoolS(this._carrier,this._out,this._adjacent))},get:function(){return this._carrier}},out:{set:function(t){this._out!==t&&(this._out=t,this._delph=this.getDelphToBoolS(this._carrier,this._out,this._adjacent))},get:function(){return this._out}},adjacent:{set:function(t){this._adjacent!==t&&(this._adjacent=t,this._delph=this.getDelphToBoolS(this._carrier,this._out,this._adjacent))},get:function(){return this._adjacent}},colorC0:{set:function(t){if(this._colorC0!=t){this._colorC0=t,this._colorC0_=this.convertC(t);for(var i=0;i<this.arrSplice.length;i++)this.arrSplice[i].draw1()}},get:function(){return this._colorC0}},colorC1:{set:function(t){if(this._colorC1!=t){this._colorC1=t,this._colorC1_=this.convertC(t);for(var i=0;i<this.arrSplice.length;i++)this.arrSplice[i].draw1()}},get:function(){return this._colorC1}},delphC0:{set:function(t){if(this._delphC0!=t){this._delphC0=t;for(var i=0;i<this.arrSplice.length;i++)this.arrSplice[i].delph=this.getDelphToBoolS(this.arrSplice[i].carrier,this.arrSplice[i].out,this.arrSplice[i].adjacent)}},get:function(){return this._delphC0}},delphC1:{set:function(t){if(this._delphC1!=t){this._delphC1=t;for(var i=0;i<this.arrSplice.length;i++)this.arrSplice[i].delph=this.getDelphToBoolS(this.arrSplice[i].carrier,this.arrSplice[i].out,this.arrSplice[i].adjacent)}},get:function(){return this._delphC1}},delphPlus:{set:function(t){if(this._delphPlus!=t){this._delphPlus=t;for(var i=0;i<this.arrSplice.length;i++)1==this.arrSplice[i].carrier&&(this.arrSplice[i].delph=this.getDelphToBoolS(this.arrSplice[i].carrier,this.arrSplice[i].out,this.arrSplice[i].adjacent))}},get:function(){return this._delphPlus}},color:{set:function(t){this._color=t,this._colorP=this.convertC(t),this._colorP1=this.convertC(t,[.8,.8,.8]);for(var i=0;i<this.arrSplice.length;i++)this.arrSplice[i].colorP=this._colorP,this.arrSplice[i].colorP1=this._colorP1,this.arrSplice[i].draw1()},get:function(){return this._color}},alpha:{set:function(t){this._alpha=t;for(var i=0;i<this.arrSplice.length;i++)this.arrSplice[i].alpha=this._alpha,this.arrSplice[i].draw1()},get:function(){return this._alpha}},height:{set:function(t){this._height=t;for(var i=0;i<this.arrSplice.length;i++)this.arrSplice[i].height=this._height;for(i=0;i<this.arrPoint.length;i++)this.arrPoint[i].life&&this.arrPoint[i].dragGG()},get:function(){return this._height}},amSten:{set:function(t){if(this._amSten!=t){this._amSten=t;for(var i=0;i<this.arrSplice.length;i++)this.arrSplice[i].life&&(this.arrSplice[i].activMouse=t)}},get:function(){return this._amSten}},amPoint:{set:function(t){if(this._amPoint!=t){this._amPoint=t;for(var i=0;i<this.arrPoint.length;i++)this.arrPoint[i].life&&(this.arrPoint[i].activMouse=t)}},get:function(){return this._amPoint}},amPol:{set:function(t){if(this._amPol!=t){this._amPol=t;for(var i=0;i<this.arrPol.length;i++)this.arrPol[i].life&&(this.arrPol[i].activMouse=t)}},get:function(){return this._amPol}},activMouse:{set:function(t){this._activMouse=t,this.amPol=t,this.amPoint=t,this.amSten=t},get:function(){return this._activMouse}},colorLine:{set:function(t){if(this._colorLine!=t){this._colorLine=t,this._colorLine_=this.convertC(t),this.worldBlok._colorLine_=this._colorLine_,this.worldBlok.colorLine=this._colorLine_;for(var i=0;i<this.arrSplice.length;i++)this.arrSplice[i].draw1()}},get:function(){return this._colorLine}},sizeLine:{set:function(t){if(this._sizeLine!=t){this._sizeLine=t,this.worldBlok.sizeLine=t;for(var i=0;i<this.arrSplice.length;i++)this.arrSplice[i].delph=this.getDelphToBoolS(this.arrSplice[i].carrier,this.arrSplice[i].out,this.arrSplice[i].adjacent)}},get:function(){return this._sizeLine}},activeSten:{set:function(t){this._activeSten=t;for(var i=0;i<this.arrSplice.length;i++)this.arrSplice[i].life&&(i==this._activeSten?this.arrSplice[i].active=!0:this.arrSplice[i].active=!1)},get:function(){return this._activeSten}},activePoin:{set:function(t){this._activePoin=t;for(var i=0;i<this.arrPoint.length;i++)this.arrPoint[i].life&&(i==this._activePoin?this.arrPoint[i].active=!0:this.arrPoint[i].active=!1)},get:function(){return this._activePoin}},activePol:{set:function(t){this._activePol=t;for(var i=0;i<this.arrPol.length;i++)this.arrPol[i].life&&(i==this._activePol?this.arrPol[i].active=!0:this.arrPol[i].active=!1)},get:function(){return this._activePol}}});var dt=function(){function t(i,e){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,t),this.type="P20";var n=this;this.par=i,this.fun=e,this.sobSP=void 0,this.startStyle='{"colorC0":"#ffe4d4","colorC1":"#f0f0f0","delphC0":200,"delphC1":500,"delphPlus":100}',this.startStyle='{"colorC0":"#ffe4d4","colorC1":"#b0dfee","delphC0":200,"delphC1":500,"delphPlus":100}',this._activObject=void 0,this.div=document.createElement("div"),this.div.style.position="fixed",this.div.style.top="0px",this.div.style.left="0px",this.sobSP=function(t,i,e){n.fun(t,i,e)},this._index=-1,this._mashtab=1,this.arrayChesh=[],this.array=[];for(var s=0;s<2;s++)this.arrayChesh[s]=new ut(this,this.sobSP),this.arrayChesh[s].idArr=s,this.array[s]=this.arrayChesh[s];this.setArrObj=function(t){if(this.sp.clear(),null!=t[0]||null==t.type){for(var i={type:"SpStageSten",tipPoint:"SpPointSten",arrPoint:[],arrSplice:[]},e={x:99999,y:99999,x1:-999999,y1:-99999},n=0;n<t.length;n++){var s={};s.position=t[n].point0,s.position1=t[n].point1,s.delph=t[n].width,s.idUi=t[n].id,t[n].alignmentId?(s.bChaz=!1,"left"==t[n].alignmentOtherSide&&(s.bChaz=!0),s.bChaz1=!1,"left"==t[n].alignmentThisSide&&(s.bChaz1=!0),s.sUi=t[n].alignmentId):s.sUi=-1,i.arrSplice.push(s),e.x>t[n].point0.x&&(e.x=t[n].point0.x),e.y>t[n].point0.y&&(e.y=t[n].point0.y),e.x1<t[n].point0.x&&(e.x1=t[n].point0.x),e.y1<t[n].point0.y&&(e.y1=t[n].point0.y)}this.setObj(i)}else this.setObj(t)},this.dragStyleObj=function(t){for(var i=0;i<this.array.length;i++)this.array[i].dragStyleObj(t)},this.dragStyleObj(JSON.parse(this.startStyle)),this.renderDebag=function(){this.fun("render",-1)},this.creatFloor=function(){trace(">>>>>>>"),null==this.arrayChesh[this.array.length]&&(this.arrayChesh[this.array.length]=new ut(this,this.sobSP),this.arrayChesh[this.array.length].idArr=this.array.length),this.array[this.array.length]=this.arrayChesh[this.array.length]},this.upDate=function(){return null!=this.sp&&this.sp.doRender()},this.clearBig=function(){for(var t=0;t<this.arrayChesh.length;t++)this.arrayChesh[t].clear();this.array=[]},this.setObjOpen=function(t){null==t.index?this.sp.setObj(t):(this.clearBig(),this.setObj(t))},this.getObj=function(){var t={};t.index=this._index,t.array=[];for(var i=0;i<this.array.length;i++)t.array[i]=this.array[i].getObj();return t},this.setObj=function(t){if(null!=t.index)for(var i=0;i<t.array.length;i++)null==this.array[i]&&(null==this.arrayChesh[i]&&(this.arrayChesh[i]=new ut(this,this.sobSP),this.arrayChesh[i].idArr=i),this.array[i]=this.arrayChesh[i]),this.array[i].setObj(t.array[i]);else n.fun("message","Error Старая модель файла","Старый не опдерживал этажность")},this.getRect=function(t){var i=this.sp;if(null!=t){if(null==this.array[t])return null;i=this.array[t]}return i.getRect()},this.fun("complit")}var i,e,n;return i=t,(e=[{key:"index",set:function(t){this._index=t;for(var i=0;i<this.array.length;i++){var e=2;this.array[t-1]&&i==t-1&&(e=1),this.array[i]&&t==i&&(e=0,this.sp=this.array[i],this.fun("indexSP",this.sp)),this.array[i].status=e}},get:function(){return this._index}},{key:"mashtab",set:function(t){if(this._mashtab!=t){this._mashtab=t;for(var i=0;i<this.array.length;i++)this.array[i].mashtab=t}},get:function(){return this._mashtab}}])&&pt(i.prototype,e),n&&pt(i,n),t}(),ft=e(7);var gt=function t(){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,t);var i=this;this._width=100,this._height=100,this.div=document.createElement("div"),this.div.style.position="fixed",this.div.style.top="0px",this.div.style.left="0px",this.stage=new PIXI.Container,this.content2d=new PIXI.Container,this.stage.addChild(this.content2d),this.renderer=new PIXI.autoDetectRenderer(this._width,this._height,{antialias:!0,transparent:!0,preserveDrawingBuffer:!0}),this.renderer.view.style.position="fixed",this.div.appendChild(this.renderer.view),this.render=function(){i.renderer.render(i.stage)},this.sizeWindow=function(t,e){t&&(i._width=t,i._height=e),i.renderer.view.style.width=i._width+"px",i.renderer.view.style.height=i._height+"px",i.renderer.resize(i._width,i._height)}};var yt=function t(i){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,t),this.type="ViewServer";var e=this;this.fun=i,this.id=void 0,this.openId=function(t){this.id=t,trace(t);var i={url:"https://alphakp.ru/catalog/plan/"+t+"/edit_scheme/get_response",type:"GET",data:{},cache:!1,async:!1,success:function(t){null!=t.json?e.fun("setObj",JSON.parse(t.json)):e.fun("setObj",null)},error:function(t){e.fun("message","Error","Чо то не грузит линк")}};$.ajax(i)},this.saveGetObjId=function(t){if(null!=this.id){var i={url:"https://alphakp.ru/catalog/plan/"+this.id+"/edit_scheme/get_response",type:"POST",data:{json:JSON.stringify(t)},cache:!1,async:!1,success:function(t){e.fun("message","Проект сохронен","ХЗ потом вобще снести этот месендж")},error:function(t){e.fun("message","Error","Чо то не грузит линк")}};$.ajax(i)}else e.fun("message","Error Проект не имеет ИД","Этот проект не открыт, в плане не имеет связи с сервером")},this.openURL=function(){var t=function(t,i){var e=window.document.URL.toString();i&&(e=i);var n=e.split("/");if(e.indexOf("?")>0){var n=e.split("?"),s=n[1].split("&"),r=new Array(s.length),o=new Array(s.length);n=e.split("?"),s=n[1].split("&"),r=new Array(s.length),o=new Array(s.length);var h=0;for(h=0;h<s.length;h++){var a=s[h].split("=");r[h]=a[0],""!=a[1]?o[h]=unescape(a[1]):o[h]=null}for(h=0;h<s.length;h++)if(r[h]==t)return o[h];return null}}("id");null!=t&&this.openId(t)}};var vt=function t(i){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,t),this.type="Glaf";var e=this;this.par=i,this.dCont=new DCont(document.body),this.visiPixi=new gt,this.cont2d=new PIXI.Container,this.content2d=new PIXI.Container,this.visiPixi.content2d.addChild(this.cont2d),this.cont2d.addChild(this.content2d),this.c2dSloi=new PIXI.Container,this.c2dSloi1=new PIXI.Container,this.c2dSloi2=new PIXI.Container,this.c2dSloi3=new PIXI.Container,this.content2d.addChild(this.c2dSloi),this.content2d.addChild(this.c2dSloi1),this.content2d.addChild(this.c2dSloi2),this.content2d.addChild(this.c2dSloi3),this.intRend=0,this.render=function(){this.intRend=1},this.viewServer=new yt(function(t,i,n){if(trace("viewServer",t,i,n),"setObj"==t&&(null==i?e.menu.setMessage("message","Error","Проект id ="+e.viewServer.id+" не создан. json еще не сохранен и нечего открывать"):e.p20.setObjOpen(i),e.menu.mStart.visiId(e.viewServer.id)),"message"==t)return console.warn(i,n),void e.menu.setMessage(i,n)}),this.p20=new dt(this,function(t,i,n){"render"!=t?"complit"!=t&&("indexSP"==t&&e.menu.setSP(i),"message"!=t?("addChild"==t&&e[i].addChild(n),e.render()):e.menu.setMessage(i,n)):e.intRend=i||1}),this.menu=new ft.a(this,function(t,i,n){"mashtab"==t&&(e.p20.mashtab=i,e.menu.mashtab=i),"setObjSP"==t&&e.p20.setObj(i),"dragStyleObj"==t&&e.p20.dragStyleObj(i),"openId"==t&&e.viewServer.openId(i),"message"!=t?"saveGetObjId"!=t?e.render():e.viewServer.saveGetObjId(e.p20.getObj()):e.menu.setMessage(i,n)}),this.menu.setP20(this.p20),this.p20.index=1,this.update=function(){1==this.p20.upDate()&&(this.intRend=1),(this.intRend<=1||100==this.intRend)&&(this.visiPixi.render(),this.intRend=2),this.intRend++},this.sizeWindow=function(t,i,e){this.scale=e,this.dCont.scale=e,this.menu.sizeWindow(t,i,e)},this.keydown=function(t){this.menu.keydown(t)},this.keyup=function(t){this.menu.keyup(t)},this.viewServer.openURL()};function Pt(t,i){this.fun=t;var e,n=this;this.object,this.key=i||"shirt",this.object,this.initLoad=function(){e=!0,this.object=window.localStorage[this.key],"undefined"==this.object&&(e=!1),null==this.object&&(e=!1),this.object=0==e?this.getStartObj():jQuery.parseJSON(this.object),this.fun&&n.fun()},this.getStartObj=function(){return{activ:!1,dubag:!1,menu:{},xz:{}}},this.save=function(){window.localStorage[this.key]=JSON.stringify(n.object)},this.clear=function(){window.localStorage[this.key]=void 0},n.initLoad()}e.d(i,"a",function(){return wt});var wt=function t(i){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,t),this.type="LMain",this.fun=i;var e=this;this.glaf=null,this._width=100,this._height=100,e.resolution=1,e.objectBase=null,e.confText=null,this.localStorage=void 0,this.debug=!1,this.contentHTML=document.createElement("div"),this.contentHTML.style.position="fixed",this.contentHTML.style.top="0px",this.contentHTML.style.left="0px",document.body.appendChild(this.contentHTML),this.start=function(){this.tick(),this.localStorage=new Pt(null,"localStorage"),null==e.localStorage.object.debug&&(e.localStorage.object.debug=!1),this.debug=e.localStorage.object.debug,this.fina()},this.fina=function(){e.localStorage.object.debug=!0,e.glaf=new vt(e),sizeWindow(),i("init")};var n,s=!0;this.tick=function(){1==(s=!s)&&(TWEEN.update(),e.glaf&&e.glaf.update()),requestAnimationFrame(e.tick)},this.boolCTRL=!1,this.keydown=function(t){17==event.keyCode&&(e.boolCTRL=!0),81==event.keyCode&&e.boolCTRL&&(e.localStorage.object.debug=!e.localStorage.object.debug,e.localStorage.save()),e.glaf.keydown(t)},this.keyup=function(t){17==event.keyCode&&(e.boolCTRL=!1),e.glaf.keyup(t)},window.addEventListener("keydown",this.keydown),window.addEventListener("keyup",this.keyup),this.scale=1,this.sizeWindow=function(t,i){e._width=t,e._height=i,e._width<800&&(e._width=800),e._height<600&&(e._height=600),(n=t/e._width)>i/e._height&&(n=i/e._height),this.scale=n,1==dcmParam.isIE&&(this.scale=1),e.glaf&&e.glaf.sizeWindow(t,i,this.scale)},e.start()}},function(t,i,e){"use strict";(function(t){e.d(i,"a",function(){return u});var n=e(8),s=e(14),r=e(13),o=e(15),h=e(11),a=e(16),c=e(12);e(18);function l(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var u=function(){function i(e,l){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,i),this.type="Menu";var u=this;this.par=e,this.fun=l,this._mashtab=1,this.wh=48,this.otstup=5,this.otstup1=10,this.sizeMax=1e5,dcmParam.activButton="#f28044",this._menuIndex=-1,this.dCont=new DCont(this.par.dCont),this.localStorage=e.par.localStorage,this.array=[],this.array[this.array.length]=this.mGridDrag=new o.a(this,function(t,i,e){u.fun(t,i,e)}),this.array[this.array.length]=this.mStart=new a.a(this,function(t,i,e){"index"==t&&(u.menuIndex=i),u.fun(t,i,e)}),this.array[this.array.length]=this.mLeft=new n.a(this,function(t,i,e){"index"==t&&(u.menuIndex=i),"gIndex"==t&&u.mDragScane.sobMenu(t,i,e)}),this.array[this.array.length]=this.mDragScane=new s.a(this,function(t,i){}),this.array[this.array.length]=this.mObject=new r.a(this,function(t,i){}),this.array[this.array.length]=this.mCont2dHelp=new h.a(this,function(t,i){}),this.array[this.array.length]=t.mInfo=this.mInfo=new c.a(this.par.dCont),this.array[this.array.length]=t.dragPic=this.dragPic=new DDragPic(this.par.dCont),t.dragPic.whBase=this.wh,this.setP20=function(t){this.p20=t,this.mDragScane.setP20(t)},this.sp=void 0,this.setSP=function(t){this.sp=t,this.mDragScane.setSP(t),this.mGridDrag.setSP(t),this.mCont2dHelp.setSP(t),this.mObject.setSP(t)},this.object,this.setObject=function(t){this.object=t;for(var i=0,e=this.array.length-1;e>=0;e--)if(this.array[e].testObj&&1==this.array[e].testObj(t)){i=e;break}this.openMenu(i)},this.setMessage=function(t,i){var e=t||"Сообщение",n=i||"null";mInfo.setFun(e,n)},this.setApi=function(t,i,e){"activObject"==t&&this.setObject(i)},this.setObj=function(t){this.mStart.setObj(t)},this.setArrObj=function(t){this.mStart.setArrObj(t),this.mDragScane.redrag()},this.sizeWindow=function(t,i,e){null==e&&(e=1);for(var n=this.array.length-1;n>=0;n--)this.array[n].sizeWindow&&this.array[n].sizeWindow(t,i,e)},this.keydown=function(t){for(var i=this.array.length-1;i>=0;i--)this.array[i].keydown&&this.array[i].keydown(t)},this.keyup=function(t){for(var i=this.array.length-1;i>=0;i--)this.array[i].keyup&&this.array[i].keyup(t)},this.menuIndex=0}var e,u,p;return e=i,(u=[{key:"menuIndex",set:function(t){this._menuIndex!=t&&(this._menuIndex=t,this.mLeft.index=t,this.mDragScane.menuIndex=t,this.mGridDrag.menuIndex=t,this.mObject.clear(),this.sp&&this.sp.setActive())},get:function(){return this._menuIndex}},{key:"mashtab",set:function(t){if(this._mashtab!=t){this._mashtab=t;for(var i=this.array.length-1;i>=0;i--)null!=this.array[i]._mashtab&&(this.array[i].mashtab=t)}},get:function(){return this._mashtab}}])&&l(e.prototype,u),p&&l(e,p),i}()}).call(this,e(4))},function(t,i,e){"use strict";function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function s(t,i){return!i||"object"!==n(i)&&"function"!=typeof i?a(t):i}function r(t){return(r=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function o(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&h(t,i)}function h(t,i){return(h=Object.setPrototypeOf||function(t,i){return t.__proto__=i,t})(t,i)}function a(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function c(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function l(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function u(t,i,e){return i&&l(t.prototype,i),e&&l(t,e),t}e.d(i,"a",function(){return p});var p=function(){function t(i,e){c(this,t),this.type="MLeft";var n=this;this.par=i,this.fun=e,this.otstup=this.par.otstup,this.otstup1=this.par.otstup1,this.wh=this.par.wh,this._index=-1,this._tipVisi=-1,this._tipDrav=-1,this.dCont=new DCont(i.dCont),this.dCont.x=2*this.otstup,this.dCont.y=5*this.otstup+this.wh,this.objectBase=void 0,this.objThree=void 0,this.panel=void 0,this.array=[];this.objZ={},this.objZ.three=[{keyName:"MLeft",array:[{src:"resources/image/p1_100.png",array:[]},{src:"resources/image/p2_100.png",array:[{src:"resources/image/p2_100.png",array:[],id:0},{src:"resources/image/p4_100.png",array:[],id:0}]},{src:"resources/image/size.png",array:[]},{src:"resources/image/w.png",array:[{src:"resources/image/w0.png",array:[],id:0},{src:"resources/image/w1.png",array:[],id:1},{src:"resources/image/w2.png",array:[],id:2},{src:"resources/image/w0.png",array:[],id:4}]}]}],this.init=function(t){this.objectBase=t;for(var i=0;i<t.three.length;i++)"MLeft"==t.three[i].keyName&&(this.objThree=t.three[i]);for(i=0;i<this.objThree.array.length;i++)this.array[i]=new d(this,this.drag,i,this.objThree.array[i])},this.drag=function(t,i){trace(t,i),n.fun(t,i)},this.init(this.objZ),this.sobMenu=function(t,i,e){},this.sizeWindow=function(t,i,e){}}return u(t,[{key:"index",set:function(t){if(this._index!=t){this._index=t;for(var i=0;i<this.array.length;i++)i==this._index?this.array[i].active=!0:this.array[i].active=!1}},get:function(){return this._index}},{key:"tipVisi",set:function(t){this._tipVisi!=t&&(this._tipVisi=t)},get:function(){return this._tipVisi}},{key:"tipDrav",set:function(t){this._tipDrav!=t&&(this._tipDrav=t)},get:function(){return this._tipDrav}}]),t}(),d=function(){function t(i,e,n,s){c(this,t),this.type="MLButGal";var r=this;this.par=i,this.fun=e,this.idArr=n,this.obj=s,this._active=!1,this._startIndex=-1,this.otstup=this.par.otstup,this.otstup1=this.par.otstup1,this.wh=this.par.wh,this.gallery=void 0,this.dCont=new DCont(i.dCont),this.button=new DButton(this.dCont,0,n*(this.wh+this.otstup),"",function(){r.fun("index",r.idArr)},s.src),this.button.width=this.button.height=this.wh,this.dCGal=new DCont(this.dCont),this.dCGal.x=this.wh+this.otstup,this.init=function(t){if(null==this.gallery&&0!=this.obj.array.length){2==this.idArr&&(this.gallery=new f(this.dCGal,0,0,function(t,i){},this)),0!=this.idArr&&1!=this.idArr&&3!=this.idArr||(this.gallery=new DGallery(this.dCGal,0,0,function(){var t={};t.idArr=r.idArr,t.index=this.index,t.obj=this.obj,r.fun("gIndex",t)})),this.gallery.kolII=3,this.gallery.widthPic=64,this.gallery.heightPic=64,this.gallery.width=66*this.gallery.kolII+2;for(var i=0;i<this.obj.array.length;i++)this.obj.array[i].title=" ",this.obj.array[i].src=this.obj.array[i].src;this.gallery.start(this.obj.array),0==this.obj.array.length?this.gallery.visible=!1:(this.obj.array.length<=this.gallery.kolII&&(this.gallery.width=66*this.obj.array.length+2),this.gallery.height=66*Math.ceil(this.obj.array.length/this.gallery.kolII)+2,-1!=this._startIndex&&(this.gallery.index=this._startIndex))}}}return u(t,[{key:"active",set:function(t){this._active!=t&&(this._active=t,this.dCGal.visible=t,this.init(),1==this._active?this.button.color=dcmParam.activButton:this.button.color=dcmParam.color)},get:function(){return this._active}},{key:"startIndex",set:function(t){this._startIndex!=t&&(this._startIndex=t,null!=this.gallery&&(this.gallery.index=t))},get:function(){return this._startIndex}}]),t}(),f=function(t){function i(t,e,n,o,h){var l;c(this,i),(l=s(this,r(i).call(this,t,e,n,o))).par=h,l._index=-1,l.par=h;var u=a(a(l));l.downBtn=function(t,i){u.fun&&u.fun(t,i)},l.createZamen=function(){return new g(this.content,0,0,this.downBtn,this)};return l.dragIndex=function(){for(var t=0;t<this.array.length;t++)this._index1==t||this._index==t?(this._index==t&&(this.array[t].activ=!0,this.array[t].setAct(0,!0),this._index1!=t&&this.array[t].setAct(1,!1)),this._index1==t&&(this.array[t].activ=!0,this.array[t].setAct(1,!0),this._index!=t&&this.array[t].setAct(0,!1))):(this.array[t].activ=!1,this.array[t].setAct(0,!1),this.array[t].setAct(1,!1))},l}return o(i,DGallery),u(i,[{key:"index",set:function(t){this._index=t},get:function(){return this._index}}]),i}(),g=function(t){function i(t,e,n,o,h){var l;c(this,i),(l=s(this,r(i).call(this,t,e,n,o))).par=h,l.dragPic=l.par.par.par.par.dragPic;var u=a(a(l));return l.down=function(t){u.fun&&u.fun("indexBig")},l.drag=function(t){var i=u.object;i.typeThree="Blok";var e="resources/data/"+u.object.id+"/original.png";u.dragPic.start(32,e,i)},l.mouseDownNew=function(t){u.dragPic.testDrag(5,u.down,u.drag)},0==dcmParam.mobile?(l.image.image.removeEventListener("mousedown",l.mouseDown),l.panel.div.removeEventListener("mousedown",l.mouseDown)):(l.image.image.removeEventListener("touchstart",l.mouseDown),l.panel.div.removeEventListener("touchstart",l.mouseDown)),0==dcmParam.mobile?(l.image.image.addEventListener("mousedown",l.mouseDownNew),l.panel.div.addEventListener("mousedown",l.mouseDownNew)):(l.image.image.addEventListener("touchstart",l.mouseDownNew),l.panel.div.addEventListener("touchstart",l.mouseDownNew)),l}return o(i,DBox),i}()},function(t,i,e){"use strict";(function(t){e.d(i,"a",function(){return a});var n=e(2);function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(t){return(r=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function o(t,i){return(o=Object.setPrototypeOf||function(t,i){return t.__proto__=i,t})(t,i)}function h(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var a=function(i){function e(i,n){var o;!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,e),(o=function(t,i){return!i||"object"!==s(i)&&"function"!=typeof i?h(t):i}(this,r(e).call(this))).type="SobIndex0";var a=h(h(o));o.par=i,o.fun=n;var c,l,u,p,d,f={x:0,y:0,o:null,dist:0},g=void 0;return o.mousemove=function(i){a.getPositPlan(f),a.korektAP(f),null!=g&&(null==g.parent?f.o&&f.o.type&&"SpliceSten"==f.o.type&&1==f.o.windows.isBlokPlace(g)&&(f.o.addBlok(g),t.dragPic.stop()):null==f.o?(t.dragPic.start(48,g.icon,g,this.upDrag,1),g.parent.removeBlok(g)):g.parent.uuid!=f.o.windows.uuid&&f.o.addBlok(g),null!=g.parent&&g.setPosition(f.x,f.y,0))},o.mouseup=function(t){g&&null==g.parent&&(g.life=!1),document.removeEventListener("mouseup",a.mouseup),document.removeEventListener("mousemove",a.mousemove)},o.korektAP=function(t){t.o=null,c=-1,l=99999999;for(var i=0;i<a.p20.sp.arrSplice.length;i++)a.sp.arrSplice[i].life&&(u=calc.isPointInLin(a.sp.arrSplice[i].position,a.sp.arrSplice[i].position1,t,11111,0))&&Math.abs(u.z)<a.sp.arrSplice[i].delph+200&&Math.abs(u.z)<Math.abs(l)&&(l=u.z,c=i,p=u.x,d=u.y);-1!=c&&(t.o=a.sp.arrSplice[c],t.dist=l,t.x=p,t.y=d)},o.sobMenu=function(t,i,e){"gIndex"==t&&a.sobSP("creatObjDin",i.obj)},o.upDrag=function(){},o.sobSP=function(i,e,n){return e&&a.par.par.mObject.setObject(e),"downBlok"==i?(g=e,document.addEventListener("mouseup",a.mouseup),void document.addEventListener("mousemove",a.mousemove)):"creatObjDin"==i?(g=a.sp.worldBlok.getBlok(e.id),t.dragPic.start(48,g.icon,g,this.upDrag,1),document.addEventListener("mouseup",a.mouseup),void document.addEventListener("mousemove",a.mousemove)):void(n&&a.downFont(n))},o}return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&o(t,i)}(e,n["a"]),e}()}).call(this,e(4))},function(t,i,e){"use strict";(function(t){e.d(i,"a",function(){return l});var n=e(0);function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function o(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function h(t){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function a(t,i){return(a=Object.setPrototypeOf||function(t,i){return t.__proto__=i,t})(t,i)}function c(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var l=function(t){function i(t,e){var n;o(this,i),(n=function(t,i){return!i||"object"!==s(i)&&"function"!=typeof i?c(t):i}(this,h(i).call(this,t,e))).type="MOSten",n.typeNa="SpliceSten";var r,a=c(c(n));return n.par=t,n.dCont=new DCont(t.dCont),n.button=void 0,n.slid,n.slid1,n.msUi=void 0,n.postIn=function(){this.window.title="Sten";var t=this.otstup1,i=this.otstup1,e=["carrier","out","adjacent"];r={};for(var n=0;n<e.length;n++)r[e[n]]={},r[e[n]][0]=new DButton(this.window.content,i,t,"",function(){a.object[this.name]=this.param,a.object._addPoint.dragGG(),a.object._addPoint1.dragGG(),a.drag(),a.object.par[this.name]=this.param},"resources/image/sten_"+e[n]+"0.png"),r[e[n]][0].width=r[e[n]][0].height=this.wh,r[e[n]][0].name=e[n],r[e[n]][0].param=!1,r[e[n]][1]=new DButton(this.window.content,i,t,"",function(){a.object[this.name]=this.param,a.object._addPoint.dragGG(),a.object._addPoint1.dragGG(),a.drag(),a.object.par[this.name]=this.param},"resources/image/sten_"+e[n]+"1.png"),r[e[n]][1].width=r[e[n]][1].height=this.wh,r[e[n]][1].name=e[n],r[e[n]][1].param=!0,i+=this.otstup1+this.wh;this.button=new DButton(this.window.content,i,t,"",function(){a.object.clear()},"resources/image/p0.png"),this.button.width=this.button.height=this.wh,t+=this.otstup1+this.wh,this.slid=new DSliderBig(this.window.content,this.otstup1,t,function(t){a.object.delph=a.slid.value,a.object._addPoint.dragGG(),a.object._addPoint1.dragGG()},"delph",5,1e3),this.slid.width=this.width-2*this.otstup1,this.slid.okrug=1,t+=this.otstup1+70,this.msUi=new u(this,this.dCont,this.otstup1,t),t+=this.otstup1+this.msUi.height,this.window.height=t+32},n.drag=function(){for(var t in a.slid.value=a.object.delph,a.msUi.drag(),r)r[t][0].visible=a.object[t],r[t][1].visible=!a.object[t]},n.postSO=function(){this.object.funDragMenu=this.drag,this.window.title="Sten "+this.object.idArr,this.object.par.setActive(this.object),this.drag()},n.clear=function(){null!=this.object&&(this.object.funDragMenu=void 0),this.active=!1},n.sizeWindow=function(t,i,e){this.dCont.x=t/e-this.width},n}return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&a(t,i)}(i,n["a"]),i}(),u=function(){function i(e,n,s,r){o(this,i),this.par=e;var h=this;this.otstup1=this.par.otstup1,this.wh=this.par.wh,this.height=this.par.wh+2*this.par.otstup1+20,this.dCont=new DCont(e.dCont),this.dCont.x=s,this.dCont.y=r,this.panel=new DPanel(this.dCont,0,0),this.panel.height=this.height,this.panel.width=this.par.window.width-2*this.par.otstup1,this.lebel=new DLabel(this.panel,this.otstup1,this.otstup1,"bChafghfghfhz"),this.lebel.fontSize=10,this.lebel.width=this.panel.width,this.aS,this.down=function(){if(2!=this.idArr&&3!=this.idArr||(h.par.object.bChaz=!h.par.object.bChaz,h.par.object._addPoint.dragVokrug(),h.par.object._addPoint1.dragVokrug(),h.drag()),1==this.idArr&&(h.par.object.sUi=-1,h.par.object.offset=0,h.par.object._addPoint.dragVokrug(),h.par.object._addPoint1.dragVokrug(),h.drag()),0==this.idArr){for(var i=[],e=[],n=0;n<h.par.object._addPoint.arrSHron.length;n++)trace(n+"  "+h.par.object._addPoint.arrSHron[n]),i.push(h.par.object._addPoint.arrSHron[n].sten);for(n=0;n<h.par.object._addPoint1.arrSHron.length;n++)trace(n+"  : "+h.par.object._addPoint1.arrSHron[n]),i.push(h.par.object._addPoint1.arrSHron[n].sten);for(n=0;n<i.length;n++)if(i[n].uuid!=h.par.object.uuid&&-1==i[n].sUi){for(var s=!0,r=0;r<e.length;r++)e[r].uuid==i[n].uuid&&(s=!1);s&&e.push(i[n])}if(h.aS=e,0==e.length)t.mInfo.setFun("Отсутствуют стены.","Необходимо что бы стенка привязывалась к стене с какой либо стороны от себя. Так же не отработает со стенами уже имеющими привязки");else{for(n=0;n<e.length;n++)e[n].animat(1e3);h.help(),h.par.par.perehvat=h.perehvat}}},this.lh,this.th;var a=5;this.help=function(){null==this.lh&&(this.lh=new DLabel(this.panel,-100,30,"Нажмите по подсвеченым стенкам"),this.th=new TWEEN.Tween(this.lh),this.lh.div.style.pointerEvents="none"),a>0&&(this.lh.alpha=1,this.th.to({alpha:0},3e3).start(),a--)},this.perehvat=function(i){if(i&&i.type&&"SpliceSten"==i.type){for(var e=!1,n=0;n<h.aS.length;n++)h.aS[n].uuid==i.uuid&&(e=!0);e?(h.par.object.sUi=i.uuid,h.par.object._addPoint.dragVokrug(),h.par.object._addPoint1.dragVokrug(),h.drag()):t.mInfo.setFun("Не та стена","нажать на стены прилегающие к выбранной")}else t.mInfo.setFun("Небыла нажата стена","надо тыкнуть по стенам который были анимированы в прозрачный цвет")},this.arrBut=[];for(var c=0;c<4;c++){var l=this.otstup1;c>=2&&(l=this.otstup1+this.otstup1+this.wh);var u=new DButton(this.dCont,l,this.otstup1+20,"",this.down,"resources/image/sUi_"+c+".png");u.width=u.height=this.wh,u.idArr=c,this.arrBut[c]=u}var p=this.otstup1+this.otstup1+this.wh;this.slid=new DSliderBig(this.dCont,p,20+this.otstup1,function(t){h.par.object.offset=this.value,h.par.object._addPoint.dragVokrug(),h.par.object._addPoint1.dragVokrug()},"offset",-1e3,1e3),this.slid.width=this.panel.width-this.slid.x-this.otstup1,this.slid.okrug=1,p=this.otstup1+2*(this.otstup1+this.wh),this.input=new DInput(this.dCont,p,20+this.otstup1,"",function(t){h.par.object.sUi=this.value,h.par.object._addPoint.dragVokrug(),h.par.object._addPoint1.dragVokrug(),h.drag()}),this.input.width=this.panel.width-p-this.otstup1,this.drag=function(){this.lebel.text="uuid :"+this.par.object.uuid,-1==this.par.object.sUi?(this.slid.visible=!0,this.arrBut[0].visible=!0,this.arrBut[1].visible=this.arrBut[2].visible=this.arrBut[3].visible=!1,this.input.visible=!1):(this.slid.visible=!1,this.input.visible=!0,this.input.value=this.par.object.sUi,this.arrBut[0].visible=!1,this.arrBut[1].visible=!0,this.arrBut[2].visible=this.par.object.bChaz,this.arrBut[3].visible=!this.par.object.bChaz)}}var e,n,s;return e=i,(n=[{key:"index",set:function(t){this._index=t,this.dragIndex()},get:function(){return this._index}}])&&r(e.prototype,n),s&&r(e,s),i}()}).call(this,e(4))},function(t,i,e){"use strict";e.d(i,"a",function(){return s});var n=e(1);var s=function t(i,e){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,t),this.type="MDragScane";this.par=i,this.fun=e,this.sp=void 0,this.helpDP=new n.a,this.helpDP.alpha=.3,this.helpDP.color=new THREE.Color(dcmParam.color).getHex(),this.helpDP.colorActiv=new THREE.Color(dcmParam.activButton).getHex(),this.clear=function(){this.helpDP.clear()},this.setSP=function(t){this.sp=t,this.sp.content2d.addChild(this.helpDP.content2d)},this.sizeWindow=function(t,i,e){this.cont}}},function(t,i,e){"use strict";function n(t){var i=this;this.type="MInfo",this.fun=void 0,this.dC=t,this._width=100,this._height=100,this._active=!1,this.otstup=2,this.otstup2=10,this.dCont=new DCont,this.text="null",this.panel=new DPanel(this.dCont),this.window=new DWindow(this.dCont,0,0," "),this.window.dragBool=!1,this.window.hasMinimizeButton=!1,this.label=new DLabel(this.window,this.otstup2,this.otstup2+32," "),this.button=new DButton(this.window,0,0,"Да",function(){null!=i.fun&&i.fun(),i.active=!1}),this.button1=new DButton(this.window,0,0,"Нет",function(){i.active=!1}),this.button2=new DButton(this.window,this.otstup,this.otstup,"x",function(){i.active=!1}),this.button2.width=this.button2.height=32-2*this.otstup,this.input=new DInput(this.window,10,this.otstup,"x",function(){i.text=this.text}),this.input.timeFun=1,this.setFun=function(t,i,e){this.active=!0,this.fun=e,this.window.text=t,this.label.text=i;var n=this.otstup2;this.button1.visible=this.button.visible=!1,this.input.visible=!1,null!=this.fun&&(n=2*this.otstup2+32,this.button1.visible=this.button.visible=!0);var s=this.label.getRect();this.window.height=this.label.y+s.height+n,this.button1.y=this.button.y=this.label.y+s.height+this.otstup2,this.sizeWindow(1*this._width,1*this._height)},this.setFunInput=function(t,i,e,n){this.active=!0,this.fun=n,this.window.text=t,this.label.text=i,this.text=e;var s=this.otstup2;this.button1.visible=this.button.visible=!1,null!=this.fun&&(s=2*this.otstup2+32,this.button1.visible=this.button.visible=!0),this.input.text=e,this.input.visible=!0;var r=this.label.getRect();this.input.y=this.label.y+r.height+5,this.window.height=this.label.y+r.height+s+32+5,this.button1.y=this.button.y=this.label.y+r.height+this.otstup2+32+5,this.sizeWindow(1*this._width,1*this._height)},this.setW=function(t){this.window.width=t,this.label.width=t-2*this.otstup2,this.input.width=t-2*this.otstup2,this.button2.x=t-this.button2.width-this.otstup,this.button1.x=t-this.otstup2-this.button1.width,this.button.x=t-2*this.otstup2-2*this.button1.width},this.setW(300),this.sizeWindow=function(t,i){this._width=t,this._height=i,0!=this._active&&(this.panel.width=t,this.panel.height=i,this.window.x=(t-this.window.width)/2,this.window.y=(i-this.window.height)/2)},this.panel.alpha=.4,this.panel.div.addEventListener("mousedown",function(){i.active=!1}),Object.defineProperty(this,"active",{set:function(t){this._active!=t&&(this._active=t,1==t?this.dC.add(this.dCont):this.dC.remove(this.dCont))},get:function(){return this._active}})}e.d(i,"a",function(){return n})},function(t,i,e){"use strict";var n=e(0);function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function o(t){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function h(t,i){return(h=Object.setPrototypeOf||function(t,i){return t.__proto__=i,t})(t,i)}function a(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var c=function(t){function i(t,e){var n;!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,i),(n=function(t,i){return!i||"object"!==s(i)&&"function"!=typeof i?a(t):i}(this,o(i).call(this,t,e))).type="MOPoint",n.typeNa="SpPointSten";var r=a(a(n));return n.whSize=5555555,n.dCont=new DCont(t.dCont),n.button=void 0,n.slid,n.slid1,n.bool=!0,n.postIn=function(){this.window.title="Point",this.button=new DButton(this.window.content,this.otstup1,this.otstup1,"",function(){r.bool=!1,r.object.clear()},"resources/image/p0.png"),this.button.width=this.button.height=this.wh,this.slid=new DSliderBig(this.window.content,this.otstup1,this.otstup1+1*(this.otstup1+this.wh),function(t){r.bool=!1,r.object.position.x=r.slid.value},"x",-this.whSize/2,this.whSize/2),this.slid.width=this.width-2*this.otstup1,this.slid.okrug=1,this.slid.funChange=function(){r.bool=!0,r.drag()},this.slid1=new DSliderBig(this.window.content,this.otstup1,this.otstup1+2*(this.otstup1+this.wh),function(t){r.bool=!1,r.object.position.y=r.slid1.value},"y",-this.whSize/2,this.whSize/2),this.slid1.width=this.width-2*this.otstup1,this.window.height=210,this.slid1.okrug=1,this.slid1.funChange=function(){r.bool=!0,r.drag()}},n.drag=function(){0!=r.bool&&(r.slid.min=r.object.position.x-500,r.slid.max=r.object.position.x+500,r.slid.value=Math.round(r.object.position.x),r.slid1.min=r.object.position.y-500,r.slid1.max=r.object.position.y+500,r.slid1.value=Math.round(r.object.position.y))},n.postSO=function(){this.bool=!0,this.object.funDragMenu=this.drag,this.object.par.setActive(this.object),this.drag()},n.clear=function(){null!=this.object&&(this.bool=!0,this.object.funDragMenu=void 0),this.active=!1},n.sizeWindow=function(t,i,e){this.dCont.x=t/e-this.width},n}var e,c,l;return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&h(t,i)}(i,n["a"]),e=i,(c=[{key:"index",set:function(t){this._index!=t&&(this._index=t)}}])&&r(e.prototype,c),l&&r(e,l),i}(),l=e(10);function u(t){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function p(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function d(t){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function f(t,i){return(f=Object.setPrototypeOf||function(t,i){return t.__proto__=i,t})(t,i)}function g(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var y=function(t){function i(t,e){var n;!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,i),(n=function(t,i){return!i||"object"!==u(i)&&"function"!=typeof i?g(t):i}(this,d(i).call(this,t,e))).type="MOSp",n.typeNa="SpStageSten";var s=g(g(n));return n.whSize=5555555,n.dCont=new DCont(t.dCont),n.button=void 0,n.slid,n.slid1,n.bool=!0,n.postIn=function(){this.window.title="SP";var t=this.otstup1;this.slid=new DSliderBig(this.window.content,this.otstup1,t,function(t){s.bool=!1,s.object.alpha=s.slid.value},"alpha",0,1),this.slid.width=this.width-2*this.otstup1,this.slid.okrug=100,t+=this.otstup1+this.wh,this.window.height=210},n.drag=function(){0!=s.bool&&(s.col.value=s.object.color,s.slid.value=s.object.alpha)},n.postSO=function(){this.bool=!0,this.drag()},n.clear=function(){null!=this.object&&(this.bool=!0,this.object.funDragMenu=void 0),this.active=!1},n.sizeWindow=function(t,i,e){this.dCont.x=t/e-this.width},n}var e,s,r;return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&f(t,i)}(i,n["a"]),e=i,(s=[{key:"index",set:function(t){this._index!=t&&(this._index=t)}}])&&p(e.prototype,s),r&&p(e,r),i}();function v(t){return(v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function P(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function w(t,i){return!i||"object"!==v(i)&&"function"!=typeof i?m(t):i}function b(t){return(b=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function x(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&_(t,i)}function _(t,i){return(_=Object.setPrototypeOf||function(t,i){return t.__proto__=i,t})(t,i)}function m(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var S=function(t){function i(t,e){var n;P(this,i),(n=w(this,b(i).call(this,t,e))).type="MOLine",n.typeNa="SPLine";var s=m(m(n));return n.dCont=new DCont(t.dCont),n.button=void 0,n.slid,n.slid1,n.postIn=function(){this.window.title="SPLine";var t=this.otstup1;this.button=new DButton(this.window.content,this.otstup1,t,"",function(){s.object.clear()},"resources/image/p0.png"),this.button.width=this.button.height=this.wh,t+=this.otstup1+this.wh,this.slid=new DSliderBig(this.window.content,this.otstup1,t,function(t){s.object.otstup=s.slid.value},"otstup",-2e3,2e3),this.slid.width=this.width-2*this.otstup1,this.slid.okrug=1,t+=50,this.window.height=t+32},n.drag=function(){s.slid.value=s.object.otstup},n.postSO=function(){this.object.funDragMenu=this.drag,this.window.title="SPLine "+this.object.idArr,this.drag()},n.clear=function(){null!=this.object&&(this.object.funDragMenu=void 0),this.active=!1},n.sizeWindow=function(t,i,e){this.dCont.x=t/e-this.width},n}return x(i,n["a"]),i}();function M(t){return(M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function C(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function O(t){return(O=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function j(t,i){return(j=Object.setPrototypeOf||function(t,i){return t.__proto__=i,t})(t,i)}function I(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var D=function(t){function i(t,e){var n;!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,i),(n=function(t,i){return!i||"object"!==M(i)&&"function"!=typeof i?I(t):i}(this,O(i).call(this,t,e))).type="MOP20",n.typeNa="P20";var s=I(I(n));return n.whSize=5555555,n.dCont=new DCont(t.dCont),n.buttons=void 0,n.slid,n.slid1,n.bool=!0,n.postIn=function(){this.window.title="P20",this.buttons=[];for(var t=this.otstup,i=(this.window.width-this.otstup)/this.object.array.length-this.otstup,e=0;e<this.object.array.length;e++)this.buttons[e]=new DButton(this.window.content,this.otstup+e*(i+this.otstup),t,""+e,function(){s.object.index=this.idArr,s.drag()}),this.buttons[e].width=this.buttons[e].height=i,this.buttons[e].idArr=e;t+=i+this.otstup;var n=new DButton(this.window.content,this.otstup,t,"Плюс новый этаж",function(){s.object.creatFloor()});n.width=this.window.width-this.otstup,t+=n.height+this.otstup,this.window.height=t+32},n.drag=function(){if(0!=s.bool)for(var t=0;t<this.buttons.length;t++)t==s.object.index?this.buttons[t].color=dcmParam.activButton:this.buttons[t].color=dcmParam.color},n.postSO=function(){this.bool=!0,this.drag()},n.clear=function(){null!=this.object&&(this.bool=!0,this.object.funDragMenu=void 0),this.active=!1},n.sizeWindow=function(t,i,e){this.dCont.x=t/e-this.width},n}var e,s,r;return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&j(t,i)}(i,n["a"]),e=i,(s=[{key:"index",set:function(t){this._index!=t&&(this._index=t)}}])&&C(e.prototype,s),r&&C(e,r),i}();function A(t){return(A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function k(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function R(t){return(R=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function L(t,i){return(L=Object.setPrototypeOf||function(t,i){return t.__proto__=i,t})(t,i)}function T(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var E=function(t){function i(t,e){var n;!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,i),(n=function(t,i){return!i||"object"!==A(i)&&"function"!=typeof i?T(t):i}(this,R(i).call(this,t,e))).type="MOWindow",n.typeNa="BInSten";var s=T(T(n));return n.whSize=5555555,n.dCont=new DCont(t.dCont),n.button=void 0,n.slid,n.slid1,n.bool=!0,n.postIn=function(){this.window.title="Blok";this.otstup1;this.button=new DButton(this.window.content,this.otstup1,this.otstup1,"",function(){s.bool=!1,s.object.clear()},"resources/image/p0.png"),this.button.width=this.button.height=this.wh,this.window.height=210},n.drag=function(){s.bool},n.postSO=function(){this.bool=!0,this.drag(),this.window.title="Blok: "+this.object.idArr,trace(this.object._parent.par.par),this.object._parent&&this.object._parent.par.par.setActive(this.object)},n.clear=function(){null!=this.object&&(this.bool=!0,this.object.funDragMenu=void 0),this.active=!1},n.sizeWindow=function(t,i,e){this.dCont.x=t/e-this.width},n}var e,s,r;return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&L(t,i)}(i,n["a"]),e=i,(s=[{key:"index",set:function(t){this._index!=t&&(this._index=t)}}])&&k(e.prototype,s),r&&k(e,r),i}();function z(t){return(z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function B(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function H(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function V(t){return(V=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function G(t,i){return(G=Object.setPrototypeOf||function(t,i){return t.__proto__=i,t})(t,i)}function X(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var Y=function(t){function i(t,e){var n;B(this,i),(n=function(t,i){return!i||"object"!==z(i)&&"function"!=typeof i?X(t):i}(this,V(i).call(this,t,e))).type="MOGroup",n.typeNa="SPGroup";var s=X(X(n));return n.whSize=5555555,n.dCont=new DCont(t.dCont),n.button=void 0,n.slid,n.slid1,n.bool=!0,n.postIn=function(){this.window.title="GROUP";this.otstup1;this.button=new DButton(this.window.content,this.window.width-this.otstup1-this.wh,this.otstup1,"",function(){s.bool=!1,s.object.clear(),s.active=!1},"resources/image/p0.png"),this.button.width=this.button.height=this.wh,this.window.height=210,this.mogObj=new W(this,function(t,i){})},n.drag=function(){0!=s.bool&&(s.mogObj.drag(),s.object.par.setActive(s.object.array),s.window.height=s.mogObj.height+32+2*s.otstup1+s.wh)},n.postSO=function(){this.bool=!0,this.object.funDragMenu=this.drag,this.drag()},n.clear=function(){null!=this.object&&(this.bool=!0,this.object.funDragMenu=void 0),this.active=!1},n.sizeWindow=function(t,i,e){this.dCont.x=t/e-this.width},n}var e,s,r;return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&G(t,i)}(i,n["a"]),e=i,(s=[{key:"index",set:function(t){this._index!=t&&(this._index=t)}}])&&H(e.prototype,s),r&&H(e,r),i}(),W=function t(i,e){B(this,t);var n=this;this.par=i,this.fun=e,this.height=0,this.otstup=this.par.otstup1,this.otstup1=this.par.otstup1,this.whSize=5555555,this.width=this.par.window.width-2*this.otstup,this.wh=(this.width-this.otstup)/4-this.otstup,this.arrSt=[],this.arrWin=[],this.arrPoint=[];var s,r,o,h,a,c={};this.dCont=new DCont(this.par.window.content),this.dCont.y=2*this.otstup+this.par.wh,this.panelSt=void 0,this.init=function(){if(null==this.panelSt){var t;this.panelSt=new DPanel(this.dCont,this.otstup,0),this.panelSt.width=this.par.window.width-2*this.otstup,this.panelSt.height=this.wh+this.otstup+20,this.labelSt=new DLabel(this.panelSt,this.otstup,this.otstup,""),this.labelSt.fontSize=12,this.labelSt.width=this.width;this.otstup1;var i=this.otstup1;s=["carrier","out","adjacent"];for(var e=0;e<s.length;e++)c[s[e]]={},c[s[e]][0]=new DButton(this.panelSt,i,20,"",function(){trace(this.name,this.param,n.arrSt.length);for(var i=0;i<n.arrSt.length;i++)(t=n.arrSt[i])[this.name]=this.param,t._addPoint.dragGG(),t._addPoint1.dragGG(),n.drag();t.par[this.name]=this.param},"resources/image/sten_"+s[e]+"0.png"),c[s[e]][0].width=c[s[e]][0].height=this.wh,c[s[e]][0].name=s[e],c[s[e]][0].param=!1,c[s[e]][1]=new DButton(this.panelSt,i,20,"",function(){for(var i=0;i<n.arrSt.length;i++)(t=n.arrSt[i])[this.name]=this.param,t._addPoint.dragGG(),t._addPoint1.dragGG(),n.drag();t.par[this.name]=this.param},"resources/image/sten_"+s[e]+"1.png"),c[s[e]][1].width=c[s[e]][1].height=this.wh,c[s[e]][1].name=s[e],c[s[e]][1].param=!0,i+=this.otstup1+this.wh;this.butClearSt=new DButton(this.panelSt,this.panelSt.width-this.otstup1-this.wh,20,"",function(){n.clearSim("SpliceSten")},"resources/image/p0.png"),this.butClearSt.width=this.butClearSt.height=this.wh,this.panelWin=new DPanel(this.dCont,this.otstup,0),this.panelWin.width=this.par.window.width-2*this.otstup,this.panelWin.height=this.wh+this.otstup+20,this.labelWin=new DLabel(this.panelWin,this.otstup,this.otstup,""),this.labelWin.fontSize=12,this.labelWin.width=this.width,this.butClearWin=new DButton(this.panelWin,this.panelSt.width-this.otstup1-this.wh,20,"",function(){n.clearSim("BInSten")},"resources/image/p0.png"),this.butClearWin.width=this.butClearWin.height=this.wh,this.panelPoint=new DPanel(this.dCont,this.otstup,0),this.panelPoint.width=this.par.window.width-2*this.otstup,this.panelPoint.height=this.wh+this.otstup+20,this.labelPoint=new DLabel(this.panelPoint,this.otstup,this.otstup,""),this.labelPoint.fontSize=12,this.labelPoint.width=this.width,this.butClearPoint=new DButton(this.panelPoint,this.panelSt.width-this.otstup1-this.wh,20,"",function(){n.clearSim("SpPointSten")},"resources/image/p0.png"),this.butClearPoint.width=this.butClearPoint.height=this.wh,this.slid=new DSliderBig(this.panelPoint,this.otstup1,20,function(t){n.par.bool=!1;for(var i=0;i<n.arrPoint.length;i++)n.arrPoint[i].position.x=this.value,n.arrPoint[i].doFunRend();n.par.object.korektRect(!0)},"x",-this.whSize/2,this.whSize/2),this.slid.width=this.width-3*this.otstup1-this.wh,this.slid.okrug=1,this.slid.funChange=function(){n.par.bool=!0,n.par.drag()},this.slid1=new DSliderBig(this.panelPoint,this.otstup1,70,function(t){n.par.bool=!1;for(var i=0;i<n.arrPoint.length;i++)n.arrPoint[i].position.y=this.value,n.arrPoint[i].doFunRend();n.par.object.korektRect(!0)},"y",-this.whSize/2,this.whSize/2),this.slid1.width=this.width-3*this.otstup1-this.wh,this.slid1.okrug=1,this.slid1.funChange=function(){n.par.bool=!0,n.par.drag()}}},this.clearSim=function(t){for(var i=n.par.object.array.length-1;i>=0;i--)n.par.object.array[i].type==t&&(n.par.object.array[i].clear(),n.par.object.array.splice(i,1));n.par.drag(),n.par.object.korektRect(!0)},this.drag=function(){var t=0;this.init(),this.arrSt.length=0;for(var i=0;i<this.par.object.array.length;i++)"SpliceSten"==this.par.object.array[i].type&&this.arrSt.push(this.par.object.array[i]);if(0==this.arrSt.length)this.panelSt.visible=!1;else{this.panelSt.visible=!0,this.labelSt.text="Sten: "+this.arrSt.length,t+=this.panelSt.height+this.otstup;for(i=0;i<s.length;i++){o=this.arrSt[0][s[i]],r=!0;for(var e=0;e<this.arrSt.length;e++)this.arrSt[e][s[i]]!=o&&(r=!1);0==r?(c[s[i]][0].alpha=.5,c[s[i]][1].alpha=.5):(c[s[i]][0].alpha=1,c[s[i]][1].alpha=1),c[s[i]][0].visible=o,c[s[i]][1].visible=!o}}this.arrWin.length=0;for(i=0;i<this.par.object.array.length;i++)"BInSten"==this.par.object.array[i].type&&this.arrWin.push(this.par.object.array[i]);0==this.arrWin.length?this.panelWin.visible=!1:(this.panelWin.visible=!0,this.labelWin.text="Object: "+this.arrWin.length,this.panelWin.y=t,t+=this.panelWin.height+this.otstup),this.arrPoint.length=0;for(i=0;i<this.par.object.array.length;i++)"SpPointSten"==this.par.object.array[i].type&&this.arrPoint.push(this.par.object.array[i]);if(0==this.arrPoint.length)this.panelPoint.visible=!1;else{this.panelPoint.visible=!0,this.labelPoint.text="Point: "+this.arrPoint.length,this.panelPoint.y=t,h=Math.round(this.arrPoint[0].position.x),a=Math.round(this.arrPoint[0].position.y),r=!0,o=!0;for(i=1;i<this.arrPoint.length;i++)h!=Math.round(this.arrPoint[i].position.x)&&(r=!1),a!=Math.round(this.arrPoint[i].position.y)&&(o=!1);0==r&&0==o?(this.slid.visible=!1,this.slid1.visible=!1,this.panelPoint.height=this.wh+this.otstup+20):(this.slid.visible=!0,this.slid1.visible=!0,this.slid.activMouse=r,this.slid1.activMouse=o,this.panelPoint.height=this.slid1.y+50,n.slid.min=Math.round(h-1e3),n.slid.max=Math.round(h+1e3),n.slid.value=Math.round(h),n.slid1.min=Math.round(a-1e3),n.slid1.max=Math.round(a+1e3),n.slid1.value=Math.round(a)),trace(this.arrPoint.length,this.arrWin.length,this.arrSt.length,this.par.object),0==this.arrPoint.length&&0==this.arrWin.length&&0==this.arrSt.length&&(this.par.object.active=!1),t+=this.panelPoint.height+this.otstup}this.height=t}};e.d(i,"a",function(){return N});var N=function t(i,e){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,t),this.type="MObject";this.par=i,this.fun=e,this.otstup=this.par.otstup,this.otstup1=this.par.otstup1,this.wh=this.par.wh,this.width=222,this.whSize=1e3,this.dCont=new DCont(i.dCont),this.dCont.y=this.wh+4*this.otstup,this.perehvat,this.array=[],this.dragPic=this.par.dragPic,this.array[0]=this.moPoint=new c(this,function(t,i){}),this.array[1]=this.moSten=new l.a(this,function(t,i){}),this.array[2]=this.moSp=new y(this,function(t,i){}),this.array[3]=this.moLine=new S(this,function(t,i){}),this.array[4]=this.moP20=new D(this,function(t,i){}),this.array[5]=this.moWindow=new E(this,function(t,i){}),this.array[6]=this.moGroup=new Y(this,function(t,i){}),this.clear=function(){for(var t=0;t<this.array.length;t++)this.array[t].clear()},this.clearActive=function(){for(var t=0;t<this.array.length;t++)this.array[t].active=!1},this.setObject=function(t){if(null!=this.perehvat)return this.perehvat(t),void(this.perehvat=void 0);if(this.clear(),t)for(var i=0;i<this.array.length;i++)this.array[i].typeNa==t.type&&(this.array[i].setObject(t),this.dCont.visible=!0)},this.keydown=function(t){if(trace(t.keyCode),46==t.keyCode)for(var i=this.array.length-1;i>=0;i--)1==this.array[i].active&&this.array[i].deleteObj()},this.keyup=function(t){},this.sp=void 0,this.setSP=function(t){this.sp=t;for(var i=0;i<this.array.length;i++)this.array[i].setSP(t)},this.sizeWindow=function(t,i,e){this.dCont.x=t/e-this.width-this.otstup}}},function(t,i,e){"use strict";var n=e(2);function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(t){return(r=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function o(t,i){return(o=Object.setPrototypeOf||function(t,i){return t.__proto__=i,t})(t,i)}function h(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var a=function(t){function i(t,e){var n;!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,i),(n=function(t,i){return!i||"object"!==s(i)&&"function"!=typeof i?h(t):i}(this,r(i).call(this,t,e))).type="SobIndex0";var o=h(h(n));n.par=t,n.fun=e;var a={x:0,y:0,o:null},c={x1:0,y1:0,o:null},l={x:0,y:0,x1:0,y1:0,s:0,o:null};n.mousemove=function(t){a.x=l.x+(t.clientX-l.x1)/l.s,a.y=l.y+(t.clientY-l.y1)/l.s,o.korektAP(a,l.o),l.o.position.x=a.x,l.o.position.y=a.y,o.p20.sp.addObjFun(l.o)},n.mouseup=function(t){a.x=l.o.position.x,a.y=l.o.position.y,o.korektAP(a,l.o),null!=a.o&&null!=a.o.type&&("SpPointSten"==a.o.type&&(l.o.slitie(a.o),l.o.dragVokrug()),"SpliceSten"==a.o.type&&l.o.dragVokrug()),document.removeEventListener("mouseup",o.mouseup),document.removeEventListener("mousemove",o.mousemove)};var u={x:0,y:0,x1:0,y1:0,w:0,h:0,o:null};n.mousemove1=function(t){if(o.getPositPlan(c),0==p)return a.x<c.x?(u.x=a.x,u.w=c.x-a.x):(u.x=c.x,u.w=a.x-c.x),a.y<c.y?(u.y=a.y,u.h=c.y-a.y):(u.y=c.y,u.h=a.y-c.y),void o.sp.group.setRect(u);1==p&&(o.sp.group.setPosOffset(c.x-a.x,c.y-a.y),a.x=c.x,a.y=c.y)},n.mouseup1=function(t){0==p&&(o.mousemove1(),o.sp.group.addRect(u),o.sp.group.setRect()),document.removeEventListener("mouseup",o.mouseup1),document.removeEventListener("mousemove",o.mousemove1)};var p=0;return n.sobSP=function(t,i,e){if(2==e.data.originalEvent.button)return 0==o.boolCTRL&&(o.sp.group.active=!1),0==o.sp.group.active&&(o.sp.group.active=!0,o.par.par.mObject.setObject(o.sp.group)),p=0,o.getPositPlan(a),document.addEventListener("mouseup",o.mouseup1),void document.addEventListener("mousemove",o.mousemove1);if("downGroup"==t)return p=1,o.getPositPlan(a),document.addEventListener("mouseup",o.mouseup1),void document.addEventListener("mousemove",o.mousemove1);if(1==o.boolCTRL&&("downPoint"==t||"downSten"==t||"downBlok"==t))return 0==o.sp.group.active&&(o.sp.group.active=!0,o.par.par.mObject.setObject(o.sp.group)),void(0==o.sp.group.addObj(i)&&o.sp.group.removeObj(i));if(o.sp.group.active=!1,trace(t,i,e),i&&o.par.par.mObject.setObject(i),"downPoint"==t&&(o.sp.group.active=!1,o.par.par.mObject.setObject(i),0==e.data.originalEvent.button))return l.x=i.position.x,l.y=i.position.y,l.x1=e.data.originalEvent.clientX,l.y1=e.data.originalEvent.clientY,l.s=o.sp._mashtab,l.o=i,document.addEventListener("mouseup",o.mouseup),void document.addEventListener("mousemove",o.mousemove);o.downFont(e)},n}return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&o(t,i)}(i,n["a"]),i}();e(5);function c(t){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function u(t,i){return(u=Object.setPrototypeOf||function(t,i){return t.__proto__=i,t})(t,i)}function p(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var d=function(t){function i(t,e){var n;!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,i),(n=function(t,i){return!i||"object"!==c(i)&&"function"!=typeof i?p(t):i}(this,l(i).call(this,t,e))).type="SobIndex1";var s=p(p(n));n.par=t,n.fun=e;var r,o,h,a={x:0,y:0,o:null},u={x:0,y:0,x1:0,y1:0,s:0,o:null,oy:null,ox:null};n.mousemove=function(t){a.x=u.x+(t.clientX-u.x1)/u.s,a.y=u.y+(t.clientY-u.y1)/u.s,s.korektAP(a,u.o),u.o.position.x=a.x,u.o.position.y=a.y,s.p20.sp.addObjFun(u.o),s.helpDP.clear(),null!=a.oy&&s.helpDP.dLineParam(u.o.position.x,u.o.position.y,u.o.position.x,a.oy),null!=a.ox&&s.helpDP.dLineParam(u.o.position.x,u.o.position.y,a.ox,u.o.position.y)},n.mouseup=function(t){a.x=u.o.position.x,a.y=u.o.position.y,s.korektAP(a,u.o),null!=a.o&&null!=a.o.type&&("SpPointSten"==a.o.type&&(u.o.slitie(a.o),u.o.dragVokrug()),"SpliceSten"==a.o.type&&u.o.dragVokrug()),s.pointOld=void 0,s.helpDP.clear(),u.o=void 0,document.removeEventListener("mouseup",s.mouseup)},n.sobSP=function(t,i,e){if(0==e.data.originalEvent.button){if("downFont"==t&&(r=s.p20.sp.craetPoint(),o=s.p20.sp.craetPoint(),h=s.p20.sp.craetSplice1(),r.addSplice(h,!0),o.addSplice(h,!1),r.position.set(g.x,g.y),o.position.set(g.x,g.y),o.dragPost(),s.par.par.mObject.setObject(h),u.x=g.x,u.y=g.y,u.x1=e.data.originalEvent.clientX,u.y1=e.data.originalEvent.clientY,u.s=s.sp._mashtab,u.o=r,s.pointOld={x:g.x,y:g.y,uuidArr:[r.uuid,o.uuid]},document.addEventListener("mouseup",s.mouseup)),"downSten"==t){var n=this.getPositPlan(),a=calc.isPointInLin(i.position,i.position1,n,11111,0);if(null==a)return;r=s.p20.sp.craetPoint(),(o=s.p20.sp.craetPoint()).position.set(a.x,a.y),h=s.p20.sp.craetSplice1(),r.addSplice(h,!0),o.addSplice(h,!1),r.position.set(a.x,a.y),o.position.set(a.x,a.y),o.dragPost(),s.par.par.mObject.setObject(h),u.x=a.x,u.y=a.y,u.x1=e.data.originalEvent.clientX,u.y1=e.data.originalEvent.clientY,u.s=s.sp._mashtab,u.o=r,s.pointOld={x:a.x,y:a.y,uuidArr:[r.uuid,o.uuid]},document.addEventListener("mouseup",s.mouseup)}"downPoint"==t&&((r=s.p20.sp.craetPoint()).position.setPoint(i.position),h=s.p20.sp.craetSplice1(),r.addSplice(h,!0),i.addSplice(h,!1),s.par.par.mObject.setObject(h),u.x=i.position.x,u.y=i.position.y,u.x1=e.data.originalEvent.clientX,u.y1=e.data.originalEvent.clientY,u.s=s.sp._mashtab,u.o=r,s.pointOld={x:i.position.x,y:i.position.y,uuidArr:[h._addPoint.uuid,h._addPoint.uuid]},document.addEventListener("mouseup",s.mouseup))}else s.downFont(e)};var d,f,g={x:0,y:0,x1:0,y1:0,s:0,o:null,oy:null,ox:null};return n.mouseMoveAll=function(t){s.par.par.mGridDrag.getPositPlan(g),s.korektAP(g),s.helpDP.clear(),s.helpDP.alpha=1,d=1/s._mashtab,f=5/s._mashtab,null!=g.ox&&(s.helpDP.dLineParam(g.x,g.y,g.ox,g.y,void 0,d),s.helpDP.dPointParam(g.ox,g.y,f,void 0,f),s.helpDP.dPointParam(g.ox,g.y,f/2,15892548,f/2)),null!=g.oy&&(s.helpDP.dLineParam(g.x,g.y,g.x,g.oy,void 0,d),s.helpDP.dPointParam(g.x,g.oy,f,void 0,f),s.helpDP.dPointParam(g.x,g.oy,f/2,15892548,f/2)),s.sp.render(),null!=u.o&&"SpPointSten"==u.o.type&&(u.o.position.x=g.x,u.o.position.y=g.y,s.p20.sp.addObjFun(u.o))},n.funActive=function(){1==this._active?dcmParam.addFunMove(s.mouseMoveAll):dcmParam.removeFunMove(s.mouseMoveAll)},n}return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&u(t,i)}(i,n["a"]),i}();function f(t){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function g(t){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function y(t,i){return(y=Object.setPrototypeOf||function(t,i){return t.__proto__=i,t})(t,i)}function v(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var P=function(t){function i(t,e){var n;!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,i),(n=function(t,i){return!i||"object"!==f(i)&&"function"!=typeof i?v(t):i}(this,g(i).call(this,t,e))).type="SobIndex2";var s=v(v(n));n.par=t,n.fun=e;var r,o,h={x:0,y:0,x1:0,y1:0,s:0,o:null},a={x:0,y:0,x1:0,y1:0,s:0,o:null},c={x:0,y:0,d:0,o:null},l={x:0,y:0,d:0,o:null};n.mousemove=function(t){s.getPositPlan(I),"downLine"==u[0]&&(s.korektAP(I,null,h),h.o.position.set(I.x,I.y)),"downLine1"==u[0]&&(s.korektAP(I,null,h),h.o.position1.set(I.x,I.y)),"downLine2"==u[0]&&(h.o.poiskOt(I),o=s.p20.sp.lineWord.getPoint(h.o.p,h.o),c.d=99999999,o&&s.objInObj(o,c),o=s.p20.sp.lineWord.getPoint(h.o.p1,h.o),l.d=99999999,o&&(s.objInObj(o,l),c.d>l.d&&s.objInObj(l,c)),c.d<222&&h.o.poiskOt(c))},n.objInObj=function(t,i){for(var e in t)i[e]=t[e]},n.clearSob=function(t){u.length=0,document.removeEventListener("mouseup",s.mouseup),document.removeEventListener("mousemove",s.mousemove)},n.mouseup=function(t){1==u.length&&s.clearSob(),u.splice(0,1)};var u=[];n.sobSP=function(t,i,e){0==e.data.originalEvent.button?0==u.length&&(a=this.getPositPlan(),s.korektAP(a),u.length=0,(r=s.p20.sp.lineWord.craetLine()).position.set(a.x,a.y),r.position1.set(a.x,a.y),h.x=a.x,h.y=a.y,h.o=r,u.push("downLine1"),u.push("downLine2"),s.par.par.mObject.setObject(h.o),document.addEventListener("mouseup",s.mouseup),document.addEventListener("mousemove",s.mousemove)):s.downFont(e)};var p,d,y,P,w,b,x,_,m,S,M,C,O,j,I={x:0,y:0,o:null},D={x:0,y:0,o:null},A={x:0,y:0,o:null},k={x:0,y:0,o:null};return n.korektAP=function(t,i,e){t.o=null,D.o=null,A.o=null,d=1e18,_=1e18,b=-1,O=1e18,M=-1,null!=e&&(m=calc.getAngle(e,t),S=45*Math.round(180*m/Math.PI/45)*Math.PI/180,calc.getVector(9999999,S,k),k.x+=e.x,k.y+=e.y);for(var n=0;n<s.sp.arrSplice.length;n++)s.sp.arrSplice[n].life&&(p=calc.getDistance(t,s.sp.arrSplice[n].arrGran[0]),d>p&&(d=p,y=n,P=0),p=calc.getDistance(t,s.sp.arrSplice[n].arrGran[1]),d>p&&(d=p,y=n,P=1),p=calc.getDistance(t,s.sp.arrSplice[n].arrGran[2]),d>p&&(d=p,y=n,P=2),p=calc.getDistance(t,s.sp.arrSplice[n].arrGran[3]),d>p&&(d=p,y=n,P=3),(w=calc.isPointInLin(s.sp.arrSplice[n].arrGran[0],s.sp.arrSplice[n].arrGran[1],t,1e7,0))&&_>Math.abs(w.z)&&(_=Math.abs(w.z),x=n,b=0),(w=calc.isPointInLin(s.sp.arrSplice[n].arrGran[2],s.sp.arrSplice[n].arrGran[3],t,1e7,0))&&_>Math.abs(w.z)&&(_=Math.abs(w.z),x=n,b=1),e&&((w=calc.getPointOfIntersection(s.sp.arrSplice[n].arrGran[0],s.sp.arrSplice[n].arrGran[1],e,k))&&(C=calc.getDistance(t,w))>100&&O>C&&(O=C,M=n,j=0),(w=calc.getPointOfIntersection(s.sp.arrSplice[n].arrGran[2],s.sp.arrSplice[n].arrGran[3],e,k))&&(C=calc.getDistance(t,w))>100&&O>C&&(O=C,M=n,j=1)));var r=!0;if(-1!=b&&_<d&&(r=!1),d<300&&(r=!0),1e18!=O&&(w=calc.getPointOfIntersection(s.sp.arrSplice[M].arrGran[2*j+0],s.sp.arrSplice[M].arrGran[2*j+1],e,k),O<d))return t.x=w.x,t.y=w.y,void(t.o=s.sp.arrSplice[M]);1==r?(t.x=s.sp.arrSplice[y].arrGran[P].x,t.y=s.sp.arrSplice[y].arrGran[P].y,s.debug.dPoint(s.sp.arrSplice[y].arrGran[P],20,s.color,20),t.o=s.sp.arrSplice[y]):(w=calc.isPointInLin(s.sp.arrSplice[x].arrGran[2*b+0],s.sp.arrSplice[x].arrGran[2*b+1],t,1e7,0))&&(t.x=w.x,t.y=w.y,t.o=s.sp.arrSplice[x])},n.korektAP2=function(t,i){},n.oP=void 0,n.debug=void 0,n.funActive=function(){1==this.active?(s.sp.getRect(),this.debug=s.sp.lineWord.debugPixi,s.sp.render()):this.clearSob()},n}return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&y(t,i)}(i,n["a"]),i}(),w=e(9),b=e(1);function x(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}e.d(i,"a",function(){return _});var _=function(){function t(i,e){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,t),this.type="MDragScane";var n=this;this.par=i,this.fun=e,this.p20=void 0,this.cont=void 0,this.cont1=void 0,this.stage=void 0,this._menuIndex=-1,this._mashtab=1,this.otstup=this.par.otstup,this.otstup1=this.par.otstup1,this.wh=this.par.wh,$(document).bind("contextmenu",function(t){return!1}),this.actAI=void 0,this.sobIndex=[],this.sobIndex[0]=new a(this),this.sobIndex[1]=new d(this),this.sobIndex[2]=new P(this),this.sobIndex[3]=new w.a(this),this.sobSP=function(t,i,e){null!=n.actAI&&n.actAI.sobSP(t,i,e)},this.sobMenu=function(t,i,e){null!=n.actAI&&n.actAI.sobMenu(t,i,e)},this.helpDP=new b.a,this.klikGoem=function(t){},this.setP20=function(t){if(null==this.p20){this.cont=t.cont2d,this.cont1=t.c2dNiz,this.p20=t,this.p20.sobSP=this.sobSP;for(var i=0;i<this.sobIndex.length;i++)this.sobIndex[i].setP20(t)}},this.sp=void 0,this.setSP=function(t){this.sp=t;for(var i=0;i<this.sobIndex.length;i++)this.sobIndex[i].setSP(t)},this.redrag=function(){this.p20.creatRect(),this.cont.x=this.p20.rectXX1.xs,this.cont.y=this.p20.rectXX1.ys,this.scale(this.p20.rectXX1.s)},this.sizeWindow=function(t,i,e){this.cont&&(this.cont.x=t/2,this.cont.y=i/2)},this.keydown=function(t){for(var i=this.sobIndex.length-1;i>=0;i--)this.sobIndex[i].keydown&&this.sobIndex[i].keydown(t)},this.keyup=function(t){for(var i=this.sobIndex.length-1;i>=0;i--)this.sobIndex[i].keyup&&this.sobIndex[i].keyup(t)}}var i,e,n;return i=t,(e=[{key:"menuIndex",set:function(t){if(this._menuIndex!=t){this._menuIndex=t;for(var i=0;i<this.sobIndex.length;i++)this.sobIndex[i].active=!1;this.actAI=void 0,null!=this.sobIndex[this._menuIndex]&&(this.actAI=this.sobIndex[this._menuIndex],this.sobIndex[this._menuIndex].active=!0)}},get:function(){return this._menuIndex}},{key:"mashtab",set:function(t){if(this._mashtab!=t){this._mashtab=t;for(var i=0;i<this.sobIndex.length;i++)this.sobIndex[i].mashtab=t}},get:function(){return this._mashtab}}])&&x(i.prototype,e),n&&x(i,n),t}()},function(t,i,e){"use strict";var n=function t(i,e,n){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,t),this.type="PGrid";this.texture=PIXI.Texture.from("resources/image/fill.png"),this.wh=e;var s=new PIXI.extras.TilingSprite(this.texture,this.wh,this.wh);i.addChild(s);var r=.390625/(n/100);s.tileScale.set(r,r),s.alpha=.9,s.position.x=-this.wh/2,s.position.y=-this.wh/2},s=e(3);function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,i){return!i||"object"!==r(i)&&"function"!=typeof i?l(t):i}function h(t){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function a(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&c(t,i)}function c(t,i){return(c=Object.setPrototypeOf||function(t,i){return t.__proto__=i,t})(t,i)}function l(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function u(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function p(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function d(t,i,e){return i&&p(t.prototype,i),e&&p(t,e),t}var f=function(){function t(i,e){u(this,t),this.type="MKrai";var n=this;this.par=i,this.fun=e,this.otstup=i.otstup,this.otstup1=i.otstup1,this.wh=i.wh,this.sizeMax=400,this.otMax=100,this._bool=!0,this._mashtab=1,this.otMas=this.otMax/this._mashtab,this._menuIndex=-1,this._activeMove="null",this.sp=void 0,this.dCont=new DCont(this.par.par.dCont),this.dCont.x=this.otstup,this.dCont.y=4*this.otstup+this.wh,this.init=function(){this.panVisiW=new b(this.dCont,0,0,this,this.sob),this.panVisiW.height=this.wh/2+2*this.otstup,this.panVisiH=new P(this.dCont,0,0,this,this.sob),this.panVisiH.width=this.wh/2+2*this.otstup,this.batton=new DButton(this.dCont,0,0,"",function(){n.bool=!n.bool}),this.batton.width=this.batton.height=this.wh/2};var s=!1;dcmParam.addFunMove(function(t){"null"!=n._activeMove&&("lines"==n._activeMove&&n.sp.lineWord.visiLine.visiPoint(n.par.getPositPlan(),1==s?-Math.PI/2:-Math.PI,n.par.rectScane),"linesOtstup"==n._activeMove&&n.sp.lineWord.visiLine.visiOtstup(n.par.getPositPlan(),1==s?-Math.PI/2:-Math.PI))}),this.mouseup=function(t){"linesOtstup"==n._activeMove&&n.sp.lineWord.visiLine.creatReal(),n.activeMove="null",document.body.style.pointerEvents="auto",0==dcmParam.mobile?document.removeEventListener("mouseup",n.mouseup):document.removeEventListener("touchend",n.mouseup)},this.sob=function(t,i,e){"mousewheel"!=t?(s=!1,"MKPanelVisiW"==this.type&&(s=!0),this.type,0==n._menuIndex&&("mouseover"==t&&this.startActive(),"mouseout"==t&&this.finalActive()),2==n._menuIndex&&("mouseover"==t&&(n.activeMove="lines"),"mouseout"==t&&"linesOtstup"!=n.activeMove&&(n.activeMove="null"),"mousedown"==t&&(n.sp.lineWord.visiLine.visiPoint(n.par.getPositPlan(),1==s?-Math.PI/2:-Math.PI,n.par.rectScane),n.activeMove="linesOtstup",document.body.style.pointerEvents="none",dcmParam.mobile,document.addEventListener("mouseup",n.mouseup)))):n.par.mousewheel(i)},this.init(),this.set=function(t,i){this.panVisiW.setPosition(t,i),this.panVisiH.setPosition(t,i)},this.helpDP=void 0,this.sp=void 0,this.setSP=function(t){this.sp=t,n.helpDP=n.par.par.mCont2dHelp.helpDP,this.panVisiW.setSP(t,n.helpDP),this.panVisiH.setSP(t,n.helpDP)},this.sizeWindow=function(t,i,e){this.panVisiW.width=t,this.panVisiW.y=i,this.panVisiH.height=i,this.panVisiH.x=t,this.batton.y=i+this.otstup,this.batton.x=t+this.otstup}}return d(t,[{key:"activeMove",set:function(t){this._activeMove!=t&&("lines"==this._activeMove&&this.sp.lineWord.visiLine.clear(),this._activeMove=t)},get:function(){return this._activeMove}},{key:"menuIndex",set:function(t){this._menuIndex!=t&&(this._menuIndex=t)},get:function(){return this._menuIndex}},{key:"mashtab",set:function(t){this._mashtab!=t&&(this._mashtab=t,this.otMas=this.otMax/this._mashtab)},get:function(){return this._mashtab}},{key:"bool",set:function(t){this._bool!=t&&(this._bool=t,this.panVisiW.bool=t,this.panVisiH.bool=t,this.batton.borderRadius=t?0:100)},get:function(){return this._bool}}]),t}(),g=function t(i){u(this,t),this.type="MKBlok";this.dc,this.idArr=-1,this._active=!0,this.param="x",this.posit=0,this.posit1=0,this.array=[],this.zdwih=function(t,i){for(var e=0;e<this.array.length;e++)this.array[e].position[t]+=i},this.clear=function(){this.array.length=0,this.active=!1},this.add=function(t){this.array.push(t)}},y=function(t){function i(t,e,n,s){var r;u(this,i),(r=o(this,h(i).call(this,t,e,n))).type="MPanel";l(l(r));r.fun=s,r._active=!1,r.dL=new DCont(l(l(r))),r.dL1=new DCont(r.dL),r.label=new DLabel(r.dL1,0,0,""),r.c="#aaaaaa",r.c1="#444444",r.c2="#ff0000",r.c3="#00ff00",r.a=.5,r.a1=1,r.setColor=function(t,i,e,n,s,r){this.c=t,this.c1=i,this.c2=e,this.c3=n,this.a=s,this.a1=r,this.alpha=s,this.color=t,this.label.color=i},r.bool,r.pp,r.t1,r.setParam=function(t,i,e,n,s){this.t1=s,this.pp=e,this.width=t,this.height=i,this.bool=n,this.korectParam()};var a=0;return r.korectParam=function(){this.label.text=this.pp+"",a=10*this.label._text.length,this.label.y=(this._height-18)/2,this.bool?this.label.x=(this._width-a)/2:this.label.x=this._width-a,this._width<a?this.label.visible=!1:this.label.visible=!0},r}return a(i,DPanel),d(i,[{key:"active",set:function(t){this._active!=t&&(this._active=t,t?(this.alpha=this.a1,this.color=this.c2,this.label.color=this.c3):(this.alpha=this.a,this.color=this.c,this.label.color=this.c1))},get:function(){return this._active}}]),i}(),v=function(t){function i(t,e,n,r,a){var c;u(this,i),(c=o(this,h(i).call(this))).type="MKPanelVisiW";var p=l(l(c));null!=t&&null!=t.add&&t.add(l(l(c))),c.x=e||0,c.y=n||0,c.uuid=Math.random(),c.fun=a,c._drag=!1,c._width=100,c._height=100,c.par=r,c._bool=r._bool,c.otstup=c.par.otstup,c.rectScane=c.par.par.rectScane,c.panel=new DPanel(l(l(c)),0,c.otstup),c.panel.height=c._height-2*c.otstup,c.pan=new DPanel(l(l(c)),0,c.otstup),c.pan.height=c._height-2*c.otstup,c.pan.width=c._width/2,c.pan.color="#dddddd",c.pan.alpha=.35,c.dCont=new DCont(l(l(c))),c.dCont.visible=!1,c.panEvent=new DPanel(l(l(c)),0,0),c.panEvent.alpha=.1,c.panEvent.dCont.div.uuid=c.uuid,c.panEvent.dCont.div.tttt="panel",c.pInfo=new DPanel(l(l(c)),0,0),c.input=new DInput(c.pInfo,c.otstup,c.otstup,""),c.input.width=50,c.pInfo.width=c.input.width+2*c.otstup+2,c.pInfo.height=c.input.height+2*c.otstup,c.pInfo.visible=!1,c.pInfo.alpha=.5,c.input.object.uuid=c.uuid,c.input.object.tttt="input",c.input.funEnter=function(){var t=1*this.text;0==isNaN(t)&&"number"==typeof t&&p.setPNew(t)},c.setPNew=function(t){if(1==p.bool){if(-1!=p.inArXY){var i=t-p.arrPanel[p.inArXY].pp;i<=-(p.arrPanel[p.inArXY].pp-1)&&(i=-(p.arrPanel[p.inArXY].pp-1));for(var e=-i/2,n=0;n<p.arrX.length;n++)n<=p.inArXY?p.arrX[n].zdwih("x",e):p.arrX[n].zdwih("x",e+i);p.sp.bigDrag(),p.testPosit(),p.moveIn(),p.moveIn1()}}else if(-1!=p.inArXY){var s=t-p.arrPanel[p.inArXY].pp;s<=-(p.arrPanel[p.inArXY].pp-1)&&(s=-(p.arrPanel[p.inArXY].pp-1));for(n=0;n<p.arrX.length;n++)n<=p.inArXY&&p.arrX[n].zdwih("x",-s);p.sp.bigDrag(),p.testPosit(),p.moveIn(),p.moveIn1()}},c.panEvent.div.addEventListener("mousewheel",function(t){p.fun("mousewheel",t),1==p.boolStart&&(p.testPosit(),p.move())}),c.panEvent.div.addEventListener("DOMMouseScroll",function(t){p.fun("mousewheel",t)}),c.panEvent.div.addEventListener("mousedown",function(t){if(-1!=p.inArXY)return p.drag=!0,void p.startDragMove();p.fun("mousedown",t)}),c.panEvent.div.addEventListener("mouseover",function(t){1!=p.drag&&(p.corektBattonX(-1,-1),p.fun("mouseover",t))}),c.panEvent.div.addEventListener("mouseout",function(t){1!=p.drag&&p.fun("mouseout",t)}),c.panEvent.div.addEventListener("mouseup",function(t){1==p.drag&&p.aaaa()}),c.pos=void 0,c.pos1=void 0,c.s,c.xx,c.ww,c.pr,c.setPosition=function(t,i,e){null==e&&(this.pos=t,this.pos1=i),this.setPosition1()},c.setPosition1=function(){this.s=this.pos.w/this.pos1.w,this.xx=this.pos.x-this.pos1.x,this.ww=this.pos.w-this.pos1.w,this.pr=1,0!=this.ww&&(this.pr=-this.xx/this.ww),this.pan.width=Math.round(this.s*this._width),this.pan.x=(this._width-this.pan._width)*this.pr},c.dragWH=function(){this.panEvent.height=this._height,this.panEvent.width=this._width,this.panel.height=this._height-2*this.otstup,this.panel.width=this._width,this.pan.height=this._height-2*this.otstup,this.dCont.div.style.clip="rect(0px "+this._width+"px "+this._height+"px 0px)"},c.otMas=c.par.otMas,c.color=36026,c.color1=36026,c.color2=1145500,c.color3=15892548,c.ooo=50,c.move=function(t){if(p.helpDP.alpha=1,p.helpDP.clear(),0!=p.arrX.length&&1!=p.dragB1){!0,p.ooo=1/p.par._mashtab,p.moveIn(),p.moveIn1();var i=20*p.ooo;p.helpDP.dPoint(O,5*p.ooo,p.color3),p.helpDP.dLineParam(O.x-i,O.y,O.x+i,O.y,p.color3,10),p.helpDP.dLineParam(O.x,O.y-i,O.x,O.y+i,p.color3,10),p.sp.render()}},c.smd={x:0,y:0,inArXY:-1,param:0},c.dragB1=!1,c.startDragMove=function(){0!=p.arrX.length&&(p.testPosit(),p.moveIn(),this.par.par.getPositPlan(this.smd),this.smd.inArXY=p.inArXY,this.smd.pp=p.arrPanel[p.inArXY].pp,p.dragB1=!0,dcmParam.addFunMove(this.move1),document.body.addEventListener("mouseup",this.funUp))},c.moveZdvig=function(t,i,e,n){for(var s=0;s<t.length;s++)s<=i?t[s].zdwih(t[s].param,e):t[s].zdwih(t[s].param,e+n);p.sp.bigDrag(),p.testPosit(),p.moveIn(),p.moveIn1()};var d,f,v=new s.a;c.move1=function(t){if(0!=p.arrX.length){if(p.par.par.getPositPlan(v),d=v.x-p.smd.x,0!=(f=Math.floor(d/200))){var i=200*f*2;f<0&&(i=200*f/2);var e=p.smd.pp+i;p.moveZdvig(p.arrX,p.smd.inArXY,-i/2,i),p.smd.pp=e,p.par.par.getPositPlan(p.smd),p.input.text=p.arrPanel[p.smd.inArXY].pp}}},c.funUp=function(t){p.dragB1=!1,dcmParam.removeFunMove(p.move1),document.body.removeEventListener("mouseup",p.funUp)},c.moveIn=function(){if(0!=p.arrX.length){p.poiskXY(_,"x");for(var t=0;t<_.length;t++)p.helpDP.dLineParam(_[t].array[0].position.x,_[t].array[0].position.y,_[t].array[0].position.x,p.rectScane.y1),p.helpDP.dPoint(_[t].array[0].position,p.ooo,p.color1,p.ooo);-1!=p.inArXY&&(p.bool&&p.drawArrPoint(_[p.inArXY].array,_[p.inArXY].array[0].position.x,p.rectScane.y1,p.color1,p.color3,2*p.ooo),p.drawArrPoint(_[p.inArXY+1].array,_[p.inArXY+1].array[0].position.x,p.rectScane.y1,p.color1,p.color3,2*p.ooo))}},c.arrPanel=[],c.creatPan=function(t,i){null==this.arrPanel[t]&&(this.arrPanel[t]=null==i?new y(this.dCont):new w(this.dCont),t%2==0?this.arrPanel[t].setColor("#dddddd","#444444",dcmParam.color,dcmParam.colorText,.35,1):this.arrPanel[t].setColor("#444444","#dddddd",dcmParam.color,dcmParam.colorText,.35,1))},c.moveIn1=function(){for(var t=0;t<_.length;t++)_[t].posit1=Math.round(_[t].posit*p.par._mashtab-p.rectScane.x*p.par._mashtab);var i,e,n;n=0;for(t=0;t<_.length-1;t++)this.creatPan(t),this.arrPanel[t].x=_[t].posit1,this.arrPanel[t].y=this.otstup,i=_[t+1].posit1-_[t].posit1,n+=e=Math.round(_[t+1].posit-_[t].posit),this.arrPanel[t].setParam(i,this._height-2*this.otstup,p._bool?e:n,p._bool),this.arrPanel[t].visible=!0;for(t=_.length-1;t<this.arrPanel.length;t++)this.arrPanel[t].visible=!1;null!=this.arrPanel[p.inArXY]?(this.arrPanel[p.inArXY].active=!0,this.pInfo.visible=!0,p._bool?this.pInfo.x=this.arrPanel[p.inArXY].x+(this.arrPanel[p.inArXY].width-this.pInfo.width)/2:this.pInfo.x=this.arrPanel[p.inArXY].x+this.arrPanel[p.inArXY].width-this.pInfo.width/2,1!=this.drag&&(this.input.text=this.arrPanel[p.inArXY].pp),this.pInfo.y=-this.pInfo.height):this.pInfo.visible=!1},c.drawArrPoint=function(t,i,e,n,s,r){if(i)for(var o=0;o<t.length;o++)p.helpDP.dLineParam(t[o].position.x,t[o].position.y,i,e,n,2*r),p.helpDP.dLineParam(t[o].position.x,t[o].position.y,i,e,s,r);for(o=0;o<t.length;o++)t[o].position,p.helpDP.dPoint(t[o].position,1.5*r,n,1.5*r),p.helpDP.dPoint(t[o].position,r,s,r)},p.inArXY=-1,p.inPoXY=-1,c.corektBattonX=function(t,i){p.inArXY!=t&&null!=p.arrPanel[p.inArXY]&&(p.arrPanel[p.inArXY].active=!1),p.inArXY=t,p.inPoXY=i};var P,b,x=new s.a;c.poiskXY=function(t,i){if(1!=this.drag){this.par.par.getPositPlan(x),S=-1,P=-1,b=1e16;for(var e=0;e<t.length-1;e++)if(x[i]>=t[e].posit&&x[i]<=t[e+1].posit){S=e;break}for(e=0;e<t.length-1;e++)b>Math.abs(x[i]-t[e].posit)&&(b=Math.abs(x[i]-t[e].posit),P=e);this.corektBattonX(S,P)}},c.man="null",c.boolStart=!1,c.finalActive=function(){p.boolStart=!1,p.pInfo.visible=!1,p.drag=!1,p.helpDP.clear(),p.sp.render(),dcmParam.removeFunMove(p.move),p.dCont.visible=!1,p.pan.visible=!p.dCont.visible},c.startActive=function(t){p.boolStart=!0,p.testPosit(),dcmParam.addFunMove(p.move),p.dCont.visible=!0,p.pan.visible=!p.dCont.visible,0==_.length&&p.finalActive()},c.getBlok=function(){for(var t=0;t<C.length;t++)if(0==C[t].active)return C[t].active=!0,C[t];return C.push(new g(this.dCont)),C[C.length-1]},c.param=null,c.param1=null,c.sortBla=function(t,i){return null==p.param?t[p.param1]-i[p.param1]:t[p.param][p.param1]-i[p.param][p.param1]};var _=[],m=[];c.arrX=_,c.arrY=m;var S,M,C=[],O=new s.a;new s.a;return c.testPosit=function(){this.clear();for(var t=0;t<this.sp.arrPoint.length;t++)0!=this.sp.arrPoint[t].life&&(this.testPosit1(this.sp.arrPoint[t],"x",_),this.testPosit1(this.sp.arrPoint[t],"y",m));this.param=null,this.param1=null,_.sort(function(t,i){return t.posit-i.posit});for(t=0;t<_.length;t++)_[t].array.sort(function(t,i){return i.position.y-t.position.y});m.sort(function(t,i){return t.posit-i.posit});for(t=0;t<m.length;t++)m[t].array.sort(function(t,i){return i.position.x-t.position.x});0!=_.length&&(O.x=_[0].array[0].position.x,O.y=m[m.length-1].array[0].position.y,1)},c.testPosit1=function(t,i,e){S=-1;for(var n=0;n<e.length;n++)if(Math.round(e[n].posit)==Math.round(t.position[i])){S=n;break}-1!=S?e[n].add(t):((M=this.getBlok()).posit=t.position[i],M.param=i,M.add(t),e.push(M))},c.clear=function(){_.length=0,m.length=0;for(var t=0;t<C.length;t++)C[t].clear()},c.helpDP=void 0,c.sp=void 0,c.setSP=function(t,i){this.sp=t,p.helpDP=i,this.rectScane=this.par.par.rectScane},c.bbbE=!1,c.aaaa=function(){p.input.object.focus(),p.input.object.select(),setTimeout(function(){p.input.object.focus(),p.input.object.select(),0==p.bbbE&&(document.body.addEventListener("mousedown",p.moused),p.bbbE=!0)},10)},c.moused=function(t){var i="null";t&&t.target&&t.target.uuid&&t.target.uuid==p.uuid&&(i=t.target.tttt),"null"!=i?"panel"==i&&(p.drag=!1):p.finalActive()},c}return a(i,DCont),d(i,[{key:"height",set:function(t){this._height!=t&&(this._height=t,this.dragWH())},get:function(){return this._height}},{key:"width",set:function(t){this._width!=t&&(this._width=t,this.dragWH())},get:function(){return this._width}},{key:"bool",set:function(t){this._bool!=t&&(this._bool=t)},get:function(){return this._bool}},{key:"drag",set:function(t){this._drag!=t&&(this._drag=t,1==t?(this.pInfo.alpha=1,this.aaaa()):(this.pInfo.alpha=.5,1==this.bbbE&&(document.body.removeEventListener("mousedown",this.moused),this.bbbE=!1)))},get:function(){return this._drag}}]),i}(),P=function(t){function i(t,e,n,r,a){var c;u(this,i),(c=o(this,h(i).call(this,t,e,n,r,a))).type="MKPanelVisiH";var p=l(l(c));c.panel.y=0,c.panel.x=c.otstup,c.pan.x=c.otstup,c.setPosition1=function(){this.s=this.pos.h/this.pos1.h,this.xx=this.pos.y-this.pos1.y,this.ww=this.pos.h-this.pos1.h,this.pr=1,0!=this.ww&&(this.pr=-this.xx/this.ww),this.pan.height=Math.round(this.s*this._height),this.pan.y=(this._height-this.pan._height)*this.pr};var d,f,g=new s.a;return c.move1=function(t){if(p.par.par.getPositPlan(g),d=g.y-p.smd.y,0!=(f=Math.floor(d/200))){var i=200*f*2;f<0&&(i=200*f/2);var e=p.smd.pp+i;p.moveZdvig(p.arrY,p.smd.inArXY,-i/2,i),p.smd.pp=e,p.par.par.getPositPlan(p.smd),p.input.text=p.arrPanel[p.smd.inArXY].pp}},c.moveIn=function(){p.poiskXY(p.arrY,"y");for(var t=0;t<p.arrY.length;t++)p.helpDP.dLineParam(p.arrY[t].array[0].position.x,p.arrY[t].array[0].position.y,p.rectScane.x1,p.arrY[t].array[0].position.y),p.helpDP.dPoint(p.arrY[t].array[0].position,p.ooo,p.color1,p.ooo);-1!=p.inArXY&&(p.drawArrPoint(p.arrY[p.inArXY].array,p.rectScane.x1,p.arrY[p.inArXY].array[0].position.y,p.color1,p.color3,2*p.ooo),p.bool&&p.drawArrPoint(p.arrY[p.inArXY+1].array,p.rectScane.x1,p.arrY[p.inArXY+1].array[0].position.y,p.color1,p.color3,2*p.ooo))},c.setPNew=function(t){if(1==p.bool){if(-1!=p.inArXY){var i=t-p.arrPanel[p.inArXY].pp;i<=-(p.arrPanel[p.inArXY].pp-1)&&(i=-(p.arrPanel[p.inArXY].pp-1));for(var e=-i/2,n=0;n<p.arrY.length;n++)n<=p.inArXY?p.arrY[n].zdwih("y",e):p.arrY[n].zdwih("y",e+i);p.sp.bigDrag(),p.testPosit(),p.moveIn(),p.moveIn1()}}else if(-1!=p.inArXY){var s=t-p.arrPanel[p.inArXY].pp;s<=-(p.arrPanel[p.inArXY].pp-1)&&(s=-(p.arrPanel[p.inArXY].pp-1));for(n=0;n<p.arrY.length;n++)n<=p.inArXY&&p.arrY[n].zdwih("y",-s);p.sp.bigDrag(),p.testPosit(),p.moveIn(),p.moveIn1()}},c.moveIn1=function(){for(var t=0;t<p.arrY.length;t++)p.arrY[t].posit1=Math.round(p.arrY[t].posit*p.par._mashtab-p.rectScane.y*p.par._mashtab);var i,e,n;if(n=0,1==p._bool)for(t=0;t<p.arrY.length-1;t++)this.creatPan(t,!0),this.arrPanel[t].y=p.arrY[t].posit1,this.arrPanel[t].x=this.otstup,i=p.arrY[t+1].posit1-p.arrY[t].posit1,e=Math.round(p.arrY[t+1].posit-p.arrY[t].posit),this.arrPanel[t].setParam(this._width-2*this.otstup,i,e,p._bool,e),this.arrPanel[t].visible=!0;else for(p.arrY[p.arrY.length-1].posit,p.arrY[0].posit,t=p.arrY.length-2;t>=0;t--)this.creatPan(t,!0),this.arrPanel[t].y=p.arrY[t].posit1,this.arrPanel[t].x=this.otstup,i=p.arrY[t+1].posit1-p.arrY[t].posit1,n+=e=Math.round(p.arrY[t+1].posit-p.arrY[t].posit),this.arrPanel[t].setParam(this._width-2*this.otstup,i,n,p._bool,n),this.arrPanel[t].visible=!0;for(t=p.arrY.length-1;t<this.arrPanel.length;t++)this.arrPanel[t].visible=!1;null!=this.arrPanel[p.inArXY]?(this.arrPanel[p.inArXY].active=!0,this.pInfo.visible=!0,p._bool?this.pInfo.y=this.arrPanel[p.inArXY].y+(this.arrPanel[p.inArXY].height-this.pInfo.height)/2:this.pInfo.y=this.arrPanel[p.inArXY].y-this.pInfo.height/2,1!=this.drag&&(this.input.text=this.arrPanel[p.inArXY].pp),this.pInfo.x=-this.pInfo.width):this.pInfo.visible=!1},c.dragWH=function(){this.panEvent.height=this._height,this.panEvent.width=this._width,this.panel.width=this._width-2*this.otstup,this.panel.height=this._height,this.pan.width=this._width-2*this.otstup,this.dCont.div.style.clip="rect(0px "+this._width+"px "+this._height+"px 0px)"},c}return a(i,v),i}(),w=function(t){function i(t,e,n,s){var r;u(this,i),(r=o(this,h(i).call(this,t,e,n,s))).type="MPanelH";l(l(r));r.fun=s,r.label.div;var a=0;return r.korectParam=function(){this.label.text!=this.t1+""&&(this.label.text=this.t1+""),a=10*this.label._text.length,this.dL.x=-38,this.dL.y=-32,this.label._text.length>=4&&(this.dL.y+=8*(this.label._text.length-3)),this.bool?this.dL.y+=(this._height-a)/2:this.dL.y+=7,this._height<a?this.label.visible=!1:(this.label.dCT.div.style.webkitTransform="rotate(-90deg)",this.label.dCT.div.style.mozTransform="rotate(-90deg)",this.label.dCT.div.style.msTransform="rotate(-90deg)",this.label.dCT.div.style.oTransform="rotate(-90deg)",this.label.dCT.div.style.transform="rotate(-90deg)",this.label.visible=!0)},r}return a(i,y),i}(),b=function(t){function i(t,e,n,s,r){var a;u(this,i),(a=o(this,h(i).call(this,t,e,n,s,r))).type="MKPanelVisiW";l(l(a));return a}return a(i,v),i}(),x=e(1);function _(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}e.d(i,"a",function(){return m});var m=function(){function t(i,e){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,t),this.type="MGridDrag";var s=this;this.par=i,this.fun=e,this.otstup=i.otstup,this.otstup1=i.otstup1,this.wh=i.wh,this.width=100,this.height=100,this._mashtab=1,this._menuIndex=-1,this.sizeMax=i.sizeMax,this.dCont=new DCont(this.par.dCont),this.visiPixi=this.par.par.visiPixi,this.mKrai=new f(this,function(t,i){}),this.debugPixi=new x.a,this.par.par.cont2d.addChild(this.debugPixi.content2d),this.debugPixi.content2d.scale.set(.1,.1),this.grid=new n(this.par.par.c2dSloi1,this.sizeMax,20),this.graphics=new PIXI.Graphics,this.par.par.c2dSloi1.addChild(this.graphics),this.panel=new DPanel(this.dCont,this.otstup,4*this.otstup+this.wh),this.panel.div.appendChild(this.visiPixi.div);var r={x:0,y:0,x1:0,y1:0,s:0,o:null};function o(t){s.cont.x=r.x+(t.clientX-r.x1),s.cont.y=r.y+(t.clientY-r.y1),s.korestPosit()}function h(t){document.removeEventListener("mouseup",h),document.removeEventListener("mousemove",o)}this.cont=this.par.par.content2d,this.p20,this.downFont=function(t){r.x1=t.data.originalEvent.clientX,r.y1=t.data.originalEvent.clientY,r.x=s.cont.x,r.y=s.cont.y,r.s=s.cont.scale.x,document.addEventListener("mouseup",h),document.addEventListener("mousemove",o)},this.klikGoem=function(t){var i={position:s.getPositPlan()};s.par.mDragScane.sobSP("downFont",i,t)};var a={x:0,y:0},c={x:0,y:0};this.getPositPlan=function(t){a=s.panel.div.getBoundingClientRect(),c.x=(dcmParam.globXY.x-a.x)/y/s.width*2-1,c.y=(dcmParam.globXY.y-a.y)/y/s.height*2-1;var i=s.width/2*c.x/s._mashtab-s.cont.x/s._mashtab,e=s.height/2*c.y/s._mashtab-s.cont.y/s._mashtab;return null!=t?(t.x=i,t.y=e,t):{x:i,y:e}};var l={x:0,y:0,w:0,h:0},u={x:0,y:0,w:this.sizeMax,h:this.sizeMax};this.rectScane={x:0,y:0,x1:0,y1:0,w:100,h:100},this.korestPosit=function(){var t=this.sizeMax*this._mashtab,i=t/l.w;if(t/l.h<i&&(i=t/l.h),i<1){this.mashtab/=i;this.sizeMax,this._mashtab}else u.h=u.w=t,u.x=s.cont.x-u.w/2,u.y=s.cont.y-u.w/2,l.x<u.x&&(s.cont.x=l.x+this.sizeMax/2*this._mashtab),l.x+l.w>u.x+u.w&&(s.cont.x=-(l.x+this.sizeMax/2*this._mashtab)),l.y<u.y&&(s.cont.y=l.y+this.sizeMax/2*this._mashtab),l.y+l.h>u.y+u.h&&(s.cont.y=-(l.y+this.sizeMax/2*this._mashtab)),u.x=s.cont.x-u.w/2,u.y=s.cont.y-u.w/2,this.mKrai.set(l,u),this.fun("render"),this.rectScane.w=l.w/this._mashtab,this.rectScane.h=l.h/this._mashtab,this.rectScane.x=-s.cont.x/this._mashtab-this.rectScane.w/2,this.rectScane.x1=-s.cont.x/this._mashtab+this.rectScane.w/2,this.rectScane.y=-s.cont.y/this._mashtab-this.rectScane.h/2,this.rectScane.y1=-s.cont.y/this._mashtab+this.rectScane.h/2},this.setRect=function(t,i,e){null==i&&(i=0);var n=l.w/(t.w+2*i);n>l.h/(t.h+2*i)&&(n=l.h/(t.h+2*i)),this.mashtab=n,s.korestPosit(),s.cont.x=-t.x*this._mashtab-t.w*this._mashtab/2,s.cont.y=-t.y*this._mashtab-t.h*this._mashtab/2,1==e&&this.setRect(t,i/this._mashtab),s.fun("mashtab",s._mashtab)};var p=null,d={x:0,y:0};this.mousewheel=function(t){var i=-1;t.delta;null==t.wheelDelta&&t.wheelDelta,t.delta&&t.delta<0&&(i=1),t.deltaY&&t.deltaY<0&&(i=1),t.detail&&t.detail<0&&(i=1),null!=t.wheelDelta&&(i=t.wheelDelta>0?-1:1);var e=-i*(.05*s._mashtab)+s._mashtab;e<.01&&(e=.01),p=s.getPositPlan(),d.x=p.x,d.y=p.y,s.mashtab=e,p=s.getPositPlan(),s.cont.x-=(d.x-p.x)*s._mashtab,s.cont.y-=(d.y-p.y)*s._mashtab,s.korestPosit(),s.fun("mashtab",s._mashtab)},this.panel.div.addEventListener("mousewheel",this.mousewheel),this.panel.div.addEventListener("DOMMouseScroll",this.mousewheel),this.setSP=function(t){this.mKrai.setSP(t)},this.graphics.name="xz";var g=this.sizeMax;this.graphics.beginFill(14479866,.1),this.graphics.drawRect(-g/2,-g/2,g,g),this.graphics.interactive=!0,this.graphics.on("mousedown",this.klikGoem);var y=1;this.sizeWindow=function(t,i,e){y=e,this.panel.width=t/e-3*this.otstup-this.wh/2,this.panel.height=i/e-6*this.otstup-this.wh-this.wh/2,this.width=Math.round(this.panel.width),this.height=Math.round(this.panel.height),this.visiPixi.sizeWindow(this.width,this.panel.height),this.visiPixi.render(),l.w=this.width,l.h=this.height,l.x=-this.width/2,l.y=-this.height/2,this.par.par.cont2d.position.set(this.width/2,this.height/2),this.mKrai.sizeWindow(this.width,this.height,e),s.korestPosit()}}var i,e,s;return i=t,(e=[{key:"mashtab",set:function(t){this._mashtab!=t&&(this._mashtab=t,this.cont.scale.x=this.cont.scale.y=t,this.mKrai.mashtab=t,this.korestPosit())},get:function(){return this._mashtab}},{key:"menuIndex",set:function(t){this._menuIndex!=t&&(this._menuIndex=t,this.mKrai.menuIndex=t)},get:function(){return this._menuIndex}}])&&_(i.prototype,e),s&&_(i,s),t}()},function(t,i,e){"use strict";function n(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var s=function(){function t(i,e){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,t),this.type="MStyle";var n=this;this.par=i,this.fun=e,this._active=!1,this.otstup=this.par.otstup,this.wh=this.par.wh,this.dCont=new DCont(i.dCont),this.dCont.x=4*this.otstup+this.wh,this.dCont.y=4*this.otstup+this.wh;var s=['{"colorC0":"#ffc0b0","colorC1":"#f4f4f4","delphC0":217.07,"delphC1":500, "sizeLine":10, "colorLine":"#000000"}','{"colorC0":"#89ffa3","colorC1":"#f3267c","delphC0":217.07,"delphC1":500, "sizeLine":10, "colorLine":"#000000"}','{"colorC0":"#89ffa3","colorC1":"#07419b","delphC0":824.43,"delphC1":206.37, "sizeLine":10, "colorLine":"#000000"}'];this.dCont.visible=this._active,this.object={colorC0:"#ff0000",colorC1:"#00ff00",colorLine:"#000000",delphC0:200,delphC1:500,delphPlus:100,sizeLine:10},this.init=function(){if(null==this.window){this.window=new DWindow(this.dCont,0,0,"style"),this.pObject=new DParamObject(this.window.content,this.otstup,this.otstup,function(){n.dragObj(n.object)}),this.pObject.tipRide=!0,this.pObject.w.hasMinimizeButton=!1,this.pObject.w.dragBool=!1,this.pObject.w.text="Project styles",this.pObject.width=this.pObject.w.width=250,this.pObject.addObject(this.object),this.panel=new DPanel(this.window.content,this.pObject.width+2*this.otstup,this.otstup);for(var t=0;t<s.length;t++){var i=new DButton(this.panel,this.otstup+t*(this.otstup+this.wh),this.otstup,""+t,function(){var t=JSON.parse(s[this.idArr]);n.object=t,n.pObject.addObject(n.object),n.dragObj(t)});i.idArr=t,i.width=i.height=this.wh}this.panel.width=s.length*(this.otstup+this.wh)+this.otstup,this.panel.height=this.pObject.w.height,this.window.width=this.panel.width+this.panel.x+this.otstup,this.window.height=this.pObject.w.height+32+2*this.otstup,this.textArea=new DTextArea(this.panel,this.otstup,2*this.otstup+this.wh,"null"),this.textArea.width=this.panel.width-2*this.otstup,this.textArea.height=this.panel.height-this.textArea.y-this.otstup}},this.dragObj=function(t){var i=JSON.stringify(t);n.textArea.value=i,n.fun("dragStyleObj",t)}}var i,e,s;return i=t,(e=[{key:"active",set:function(t){this._active!=t&&(this._active=t,this.init(),this.dCont.visible=t)},get:function(){return this._active}}])&&n(i.prototype,e),s&&n(i,s),t}();function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}e.d(i,"a",function(){return o});var o=function t(i,e){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,t),this.type="MStart";var n=this;this.par=i,this.fun=e,this.dCont=new DCont(i.dCont),this.otstup=this.par.otstup,this.wh=this.par.wh,this.w=new DPanel(this.dCont,this.par.otstup,this.par.otstup),this.w.height=i.wh+2*this.par.otstup,this.dCont1=new DCont(this.w),n.input=void 0,this.menuScene=void 0,n.localStorage=this.par.localStorage,this.opentScane=function(){bopent.visible=!1;var t=n.par.fun("returnHoneycomb");n.menuScene=new MenuScene(n.w.content,t.visi3D,function(t,i){trace(t,i)}),n.menuScene.sceneSB.setObj(JSON.parse(t.jsonCamera)),n.menuScene.setObj()},this.init1=function(){var t,e=0;(t=new DButton(this.dCont1,e,this.par.otstup,"SP",function(){n.par.mObject.setObject(n.par.p20.sp)})).width=t.height=i.wh,e+=i.wh+this.par.otstup,(t=new DButton(this.dCont1,e,this.par.otstup,"P20",function(){n.par.mObject.setObject(n.par.p20)})).width=t.height=i.wh,e+=i.wh+this.par.otstup,this.dCont1.width=e},this.init1(),this.openJSON=function(t){var i;i="object"==r(t)?t:JSON.parse(t),n.par.fun("setObjSP",i);var e=n.par.par.p20.getRect(n.par.par.p20.index);null!=e&&n.par.mGridDrag.setRect(e,this.par.otstup,!0)},this.inputS,this.visiId=function(t){this.inputS&&(this.inputS.text=t+"")},this.init=function(){var t=0,e=new DButton(this.w,this.par.otstup+(i.wh+this.par.otstup)*t,this.par.otstup,"rect",function(){var t=n.par.par.p20.getRect(n.par.par.p20.index);n.par.mGridDrag.setRect(t,n.par.otstup,!0)});e.width=e.height=i.wh,t++;var r=new DButton(this.w,this.par.otstup+(i.wh+this.par.otstup)*t,this.par.otstup,"style",function(){n.sStyle.active=!0});r.width=r.height=i.wh,t++;var o=new DButton(this.w,this.par.otstup+(i.wh+this.par.otstup)*t,this.par.otstup,"dev",function(){n.dev.active=!n.dev.active});o.width=o.height=i.wh,t++;var h=new DButton(this.w,this.par.otstup+(i.wh+this.par.otstup)*t,this.par.otstup,"saveL",function(){n.par.localStorage.object.model=n.par.mDragScane.p20.getObj(),n.par.localStorage.save(),a.visible=!0});h.width=i.wh,h.height=i.wh/2;var a=new DButton(this.w,this.par.otstup+(i.wh+this.par.otstup)*t,this.par.otstup+i.wh/2,"clearL",function(){n.par.localStorage.object.model=null,n.par.localStorage.save(),a.visible=!1});a.width=i.wh,a.height=i.wh/2,a.visible=!1,t++,n.inputS=new DInput(this.w,this.par.otstup+(i.wh+this.par.otstup)*t,this.par.otstup,"20"),n.inputS.height=i.wh/2-2,n.inputS.width=2*i.wh+this.par.otstup-3;var c=new DButton(this.w,this.par.otstup+(i.wh+this.par.otstup)*t,this.par.otstup+i.wh/2,"open",function(){n.fun("openId",n.inputS.text)});c.width=i.wh,c.height=i.wh/2,t++;var l=new DButton(this.w,this.par.otstup+(i.wh+this.par.otstup)*t,this.par.otstup+i.wh/2,"save",function(){n.fun("saveGetObjId")});l.width=i.wh,l.height=i.wh/2,setTimeout(function(){null==n.par.localStorage.object.model||(n.openJSON(n.par.localStorage.object.model),a.visible=!0)},10),null!=this.startObj&&trace(this.startObj),this.par.array[this.par.array.length]=this.sStyle=new s(this,function(t,i){n.par.fun(t,i)}),this.init3()},this.init3=function(t){var i=document.createElement("script");i.src="src/libMy/divLibPlus.js",document.head.append(i),i.onload=function(){n.dev=new DCompDev(n.dCont,25,25,"test33",function(){}),n.dev.active=!1}},n.dev=void 0,this.setObj=function(t){if(null!=n.textArea){var i=JSON.stringify(t);1==n.check.value&&(i=JSON.stringify(t,null,"\t")),n.textArea.value=i}},this.startObj=void 0,this.setArrObj=function(t){if(this.startObj=t,null!=n.textArea){var i=JSON.stringify(t);n.textArea.value=i}},this.setObject=function(t){null!=n.textArea&&(this.object=n.par.fun("returnScane"),n.input.value=n.object.startVisi,"null"==n.input.value?bGetScane.text="<":bGetScane.text="x",n.par.fun("index",-1),rot.value=this.object.time)},this.sizeWindow=function(t,e,n){this.w.width=t/n-2*i.otstup,this.dCont1.x=this.w.width-this.dCont1.width};var o=function(t){var i=window.document.URL.toString();if(i.split("/"),i.indexOf("?")>0){var e=i.split("?")[1].split("&"),n=new Array(e.length),s=new Array(e.length);e=i.split("?")[1].split("&"),n=new Array(e.length),s=new Array(e.length);var r=0;for(r=0;r<e.length;r++){var o=e[r].split("=");n[r]=o[0],""!=o[1]?s[r]=unescape(o[1]):s[r]=null}for(r=0;r<e.length;r++)if(n[r]==t)return s[r];return null}}("infoDlaVorodis2");(trace("####################################",o),null!=o)&&(new DLabel(this.w,500,20,"infoDlaVorodis2=  "+o).fontSize=32);n.localStorage.object.debug&&1==n.localStorage.object.debug&&this.init()}},function(t,i,e){"use strict";e.r(i),function(t){var n=e(6);e.d(i,"Main",function(){return n.a}),t.Main=n.a}.call(this,e(4))},function(t,i,e){"use strict"}]);