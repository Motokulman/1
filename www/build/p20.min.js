!function(t){var i=window.webpackHotUpdate;window.webpackHotUpdate=function(t,e){!function(t,i){if(!b[t]||!v[t])return;for(var e in v[t]=!1,i)Object.prototype.hasOwnProperty.call(i,e)&&(g[e]=i[e]);0==--y&&0===x&&S()}(t,e),i&&i(t,e)};var e,s=!0,r="8a3bc48b4c1d6636a871",n=1e4,a={},o=[],h=[];function l(t){var i=C[t];if(!i)return E;var s=function(s){return i.hot.active?(C[s]?-1===C[s].parents.indexOf(t)&&C[s].parents.push(t):(o=[t],e=s),-1===i.children.indexOf(s)&&i.children.push(s)):(console.warn("[HMR] unexpected require("+s+") from disposed module "+t),o=[]),E(s)},r=function(t){return{configurable:!0,enumerable:!0,get:function(){return E[t]},set:function(i){E[t]=i}}};for(var n in E)Object.prototype.hasOwnProperty.call(E,n)&&"e"!==n&&"t"!==n&&Object.defineProperty(s,n,r(n));return s.e=function(t){return"ready"===p&&d("prepare"),x++,E.e(t).then(i,function(t){throw i(),t});function i(){x--,"prepare"===p&&(m[t]||_(t),0===x&&0===y&&S())}},s.t=function(t,i){return 1&i&&(t=s(t)),E.t(t,-2&i)},s}function u(t){var i={_acceptedDependencies:{},_declinedDependencies:{},_selfAccepted:!1,_selfDeclined:!1,_disposeHandlers:[],_main:e!==t,active:!0,accept:function(t,e){if(void 0===t)i._selfAccepted=!0;else if("function"==typeof t)i._selfAccepted=t;else if("object"==typeof t)for(var s=0;s<t.length;s++)i._acceptedDependencies[t[s]]=e||function(){};else i._acceptedDependencies[t]=e||function(){}},decline:function(t){if(void 0===t)i._selfDeclined=!0;else if("object"==typeof t)for(var e=0;e<t.length;e++)i._declinedDependencies[t[e]]=!0;else i._declinedDependencies[t]=!0},dispose:function(t){i._disposeHandlers.push(t)},addDisposeHandler:function(t){i._disposeHandlers.push(t)},removeDisposeHandler:function(t){var e=i._disposeHandlers.indexOf(t);e>=0&&i._disposeHandlers.splice(e,1)},check:P,apply:I,status:function(t){if(!t)return p;c.push(t)},addStatusHandler:function(t){c.push(t)},removeStatusHandler:function(t){var i=c.indexOf(t);i>=0&&c.splice(i,1)},data:a[t]};return e=void 0,i}var c=[],p="idle";function d(t){p=t;for(var i=0;i<c.length;i++)c[i].call(null,t)}var f,g,A,y=0,x=0,m={},v={},b={};function w(t){return+t+""===t?+t:t}function P(t){if("idle"!==p)throw new Error("check() is only allowed in idle status");return s=t,d("check"),(i=n,i=i||1e4,new Promise(function(t,e){if("undefined"==typeof XMLHttpRequest)return e(new Error("No browser support"));try{var s=new XMLHttpRequest,n=E.p+""+r+".hot-update.json";s.open("GET",n,!0),s.timeout=i,s.send(null)}catch(t){return e(t)}s.onreadystatechange=function(){if(4===s.readyState)if(0===s.status)e(new Error("Manifest request to "+n+" timed out."));else if(404===s.status)t();else if(200!==s.status&&304!==s.status)e(new Error("Manifest request to "+n+" failed."));else{try{var i=JSON.parse(s.responseText)}catch(t){return void e(t)}t(i)}}})).then(function(t){if(!t)return d("idle"),null;v={},m={},b=t.c,A=t.h,d("prepare");var i=new Promise(function(t,i){f={resolve:t,reject:i}});g={};return _(0),"prepare"===p&&0===x&&0===y&&S(),i});var i}function _(t){b[t]?(v[t]=!0,y++,function(t){var i=document.createElement("script");i.charset="utf-8",i.src=E.p+""+t+"."+r+".hot-update.js",document.head.appendChild(i)}(t)):m[t]=!0}function S(){d("ready");var t=f;if(f=null,t)if(s)Promise.resolve().then(function(){return I(s)}).then(function(i){t.resolve(i)},function(i){t.reject(i)});else{var i=[];for(var e in g)Object.prototype.hasOwnProperty.call(g,e)&&i.push(w(e));t.resolve(i)}}function I(i){if("ready"!==p)throw new Error("apply() is only allowed in ready status");var e,s,n,h,l;function u(t){for(var i=[t],e={},s=i.slice().map(function(t){return{chain:[t],id:t}});s.length>0;){var r=s.pop(),n=r.id,a=r.chain;if((h=C[n])&&!h.hot._selfAccepted){if(h.hot._selfDeclined)return{type:"self-declined",chain:a,moduleId:n};if(h.hot._main)return{type:"unaccepted",chain:a,moduleId:n};for(var o=0;o<h.parents.length;o++){var l=h.parents[o],u=C[l];if(u){if(u.hot._declinedDependencies[n])return{type:"declined",chain:a.concat([l]),moduleId:n,parentId:l};-1===i.indexOf(l)&&(u.hot._acceptedDependencies[n]?(e[l]||(e[l]=[]),c(e[l],[n])):(delete e[l],i.push(l),s.push({chain:a.concat([l]),id:l})))}}}}return{type:"accepted",moduleId:t,outdatedModules:i,outdatedDependencies:e}}function c(t,i){for(var e=0;e<i.length;e++){var s=i[e];-1===t.indexOf(s)&&t.push(s)}}i=i||{};var f={},y=[],x={},m=function(){console.warn("[HMR] unexpected require("+P.moduleId+") to disposed module")};for(var v in g)if(Object.prototype.hasOwnProperty.call(g,v)){var P;l=w(v);var _=!1,S=!1,I=!1,T="";switch((P=g[v]?u(l):{type:"disposed",moduleId:v}).chain&&(T="\nUpdate propagation: "+P.chain.join(" -> ")),P.type){case"self-declined":i.onDeclined&&i.onDeclined(P),i.ignoreDeclined||(_=new Error("Aborted because of self decline: "+P.moduleId+T));break;case"declined":i.onDeclined&&i.onDeclined(P),i.ignoreDeclined||(_=new Error("Aborted because of declined dependency: "+P.moduleId+" in "+P.parentId+T));break;case"unaccepted":i.onUnaccepted&&i.onUnaccepted(P),i.ignoreUnaccepted||(_=new Error("Aborted because "+l+" is not accepted"+T));break;case"accepted":i.onAccepted&&i.onAccepted(P),S=!0;break;case"disposed":i.onDisposed&&i.onDisposed(P),I=!0;break;default:throw new Error("Unexception type "+P.type)}if(_)return d("abort"),Promise.reject(_);if(S)for(l in x[l]=g[l],c(y,P.outdatedModules),P.outdatedDependencies)Object.prototype.hasOwnProperty.call(P.outdatedDependencies,l)&&(f[l]||(f[l]=[]),c(f[l],P.outdatedDependencies[l]));I&&(c(y,[P.moduleId]),x[l]=m)}var M,D=[];for(s=0;s<y.length;s++)l=y[s],C[l]&&C[l].hot._selfAccepted&&D.push({module:l,errorHandler:C[l].hot._selfAccepted});d("dispose"),Object.keys(b).forEach(function(t){!1===b[t]&&function(t){delete installedChunks[t]}(t)});for(var R,L,O=y.slice();O.length>0;)if(l=O.pop(),h=C[l]){var B={},j=h.hot._disposeHandlers;for(n=0;n<j.length;n++)(e=j[n])(B);for(a[l]=B,h.hot.active=!1,delete C[l],delete f[l],n=0;n<h.children.length;n++){var F=C[h.children[n]];F&&((M=F.parents.indexOf(l))>=0&&F.parents.splice(M,1))}}for(l in f)if(Object.prototype.hasOwnProperty.call(f,l)&&(h=C[l]))for(L=f[l],n=0;n<L.length;n++)R=L[n],(M=h.children.indexOf(R))>=0&&h.children.splice(M,1);for(l in d("apply"),r=A,x)Object.prototype.hasOwnProperty.call(x,l)&&(t[l]=x[l]);var k=null;for(l in f)if(Object.prototype.hasOwnProperty.call(f,l)&&(h=C[l])){L=f[l];var H=[];for(s=0;s<L.length;s++)if(R=L[s],e=h.hot._acceptedDependencies[R]){if(-1!==H.indexOf(e))continue;H.push(e)}for(s=0;s<H.length;s++){e=H[s];try{e(L)}catch(t){i.onErrored&&i.onErrored({type:"accept-errored",moduleId:l,dependencyId:L[s],error:t}),i.ignoreErrored||k||(k=t)}}}for(s=0;s<D.length;s++){var z=D[s];l=z.module,o=[l];try{E(l)}catch(t){if("function"==typeof z.errorHandler)try{z.errorHandler(t)}catch(e){i.onErrored&&i.onErrored({type:"self-accept-error-handler-errored",moduleId:l,error:e,originalError:t}),i.ignoreErrored||k||(k=e),k||(k=t)}else i.onErrored&&i.onErrored({type:"self-accept-errored",moduleId:l,error:t}),i.ignoreErrored||k||(k=t)}}return k?(d("fail"),Promise.reject(k)):(d("idle"),new Promise(function(t){t(y)}))}var C={};function E(i){if(C[i])return C[i].exports;var e=C[i]={i:i,l:!1,exports:{},hot:u(i),parents:(h=o,o=[],h),children:[]};return t[i].call(e.exports,e,e.exports,l(i)),e.l=!0,e.exports}E.m=t,E.c=C,E.d=function(t,i,e){E.o(t,i)||Object.defineProperty(t,i,{enumerable:!0,get:e})},E.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},E.t=function(t,i){if(1&i&&(t=E(t)),8&i)return t;if(4&i&&"object"==typeof t&&t&&t.__esModule)return t;var e=Object.create(null);if(E.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:t}),2&i&&"string"!=typeof t)for(var s in t)E.d(e,s,function(i){return t[i]}.bind(null,s));return e},E.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return E.d(i,"a",i),i},E.o=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},E.p="build/",E.h=function(){return r},l(29)(E.s=29)}([function(t,i,e){"use strict";function s(t,i){for(var e=0;e<i.length;e++){var s=i[e];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}e.d(i,"a",function(){return r});var r=function(){function t(i,e){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,t),this.type="MOBaza",this.typeNa="xz";var s=this;this.par=i,this.fun=e,this._active=!1,this.otstup=this.par.otstup,this.otstup1=this.par.otstup,this.wh=this.par.wh,this.width=4*(this.par.wh+this.otstup)+this.otstup,this.whSize=this.par.whSize,this.dCont=new DCont(i.dCont),this.dCont.visible=this._active,this.object=void 0,this.postSO=void 0,this.postIn=void 0,this.init=function(){null==this.window&&(this.whSize=this.par.whSize,this.window=new DWindow(this.dCont,0,0,"xz"),this.window.width=this.width,this.window.hasMinimizeButton=!1,this.window.dragBool=!1,this.buttonClose=new DButton(this.window,2,2,"",function(){s.active=!1,s.sp.setActive()},"resources/image/close.png"),this.buttonClose.width=this.buttonClose.height=28,this.buttonClose.x=this.width-this.buttonClose.width-2,this.buttonClose.boolFond=!1,null!=this.postIn&&this.postIn())},this.setObject=function(t){this.object=t,this.active=!0,this.init(),null!=this.postSO&&this.postSO()},this.sp=void 0,this.setSP=function(t){this.sp=t},this.drag=function(){},this.clear=function(){this.active=!1},this.deleteObj=function(){null!=this.object&&null!=this.object.clear&&(this.object.clear(),this.active=!1)}}var i,e,r;return i=t,(e=[{key:"active",set:function(t){this._active!=t&&(this._active=t,this.dCont.visible=t)},get:function(){return this._active}}])&&s(i.prototype,e),r&&s(i,r),t}()},function(t,i,e){"use strict";function s(){var t,i,e,s,n=new THREE.Vector3(0,0,0),a=new THREE.Vector3(0,0,0),o=new THREE.Vector3(0,0,0),h=new THREE.Vector3(0,0,0);this.DEG2RAD=Math.PI/180,this.RAD2DEG=180/Math.PI,this.getAngle=function(t,i){return i=i||h,t=t||h,Math.atan2(i.y-t.y,i.x-t.x)};var l,u,c,p,d,f,g,A,y,x=0;this.getAngle2=function(t,i){return i=i||h,t=t||h,(x=Math.atan2(i.y-t.y,i.x-t.x))<0&&(x+=2*Math.PI),x},this.getDistance=function(t,i){return null==t?0:(null==i&&(i=h),i=i||h,Math.sqrt(Math.pow(t.x-i.x,2)+Math.pow(t.y-i.y,2)))},this.getVector=function(t,i,e){if(null==e)e=new THREE.Vector2(0,0);return t<0&&(i+=Math.PI),e.x=Math.abs(t)*Math.cos(i),e.y=Math.abs(t)*Math.sin(i),e},this.isPointInLin=function(t,e,r,n,h){return this.getTreeAngel(t,e,r),h<0&&2*Math.abs(h)>s?null:a.x<=s+h&&a.x>=-h&&Math.abs(a.y)<=n?((o=a.x<0?this.getVector(a.x,i-Math.PI):this.getVector(a.x,i)).x+=e.x,o.y+=e.y,o.z=a.y,o):null},this.testLine=function(t,i,e,s){return e>=t&&e<=i||t>=e&&t<=s},this.okrugPoint=function(t,i){null==i&&(i=100),t.x=Math.round(t.x/i)*i,t.y=Math.round(t.y/i)*i},this.okrugNumber=function(t,i){null==i&&(i=100);var e=Math.round(t*i)/i;return t=e,e},this.isInTriangle=function(t,i,e,s){var r=(t.x-s.x)*(i.y-t.y)-(i.x-t.x)*(t.y-s.y),n=(i.x-s.x)*(e.y-i.y)-(e.x-i.x)*(i.y-s.y),a=(e.x-s.x)*(t.y-e.y)-(t.x-e.x)*(e.y-s.y);return r>=0&&n>=0&&a>=0||r<=0&&n<=0&&a<=0},this.getTreeAngel=function(t,r,n,o){return i=this.getAngle(r,t),e=this.getAngle(r,n),l=this.getDistance(r,n),s=this.getDistance(t,r),this.getVector(l,e-i,a),e=this.getAngle(h,a),null==o?e:e>0?e:2*Math.PI+e},this.getTreeAngelPI2=function(t,i,e){x1=t.x-i.x,x2=e.x-i.x,y1=t.y-i.y,y2=e.y-i.y,s=Math.sqrt(x1*x1+y1*y1),d2=Math.sqrt(x2*x2+y2*y2);var r=(x1*x2+y1*y2)/(s*d2);return r>1&&(r=1),r<-1&&(r=-1),Math.acos(r)},this.isLineInTriangle=function(i,e,s,r,a){return(t=this.getPointOfIntersection(i,e,r,a))?(n.x=t.x,n.y=t.y,n.z=0,n):(t=this.getPointOfIntersection(e,s,r,a))?(n.x=t.x,n.y=t.y,n.z=1,n):!!(t=this.getPointOfIntersection(s,i,r,a))&&(n.x=t.x,n.y=t.y,n.z=2,n)};var m,v,b,w,P=new THREE.Vector2(0,0);this.getPointOfIntersection=function(t,i,e,s){return l=(t.x-i.x)*(s.y-e.y)-(t.y-i.y)*(s.x-e.x),u=(t.x-e.x)*(s.y-e.y)-(t.y-e.y)*(s.x-e.x),c=(t.x-i.x)*(t.y-e.y)-(t.y-i.y)*(t.x-e.x),d=c/l,(p=u/l)>=0&&p<=1&&d>=0&&d<=1?(f=t.x+p*(i.x-t.x),g=t.y+p*(i.y-t.y),P.x=f,P.y=g,P):null},this.korektToLine=function(t,i,e,s,r){A=this.getDistance(t,i),y=null==r?this.getAngle(t,i):r,0!=s&&(P=s<0?this.getVector(-s,y-Math.PI/2):this.getVector(s,y+Math.PI/2),t.x+=P.x,t.y+=P.y,i.x+=P.x,i.y+=P.y),P=this.getVector(e,y),i.x+=P.x,i.y+=P.y,P=this.getVector(e,y+Math.PI),t.x+=P.x,t.y+=P.y},this.getProsent3Point=function(t,i,e){return u=this.getDistance(t,i),(c=this.getDistance(t,e))/u},this.povotorOtAngel=function(t,i,e){return y=this.getAngle(t,i),A=this.getDistance(t,i),this.getVector(A,y+e)},this.testPositPoint=function(t,i,e){return null==e&&(e=100),Math.round(t.x*e)/e==Math.round(i.x*e)/e&&Math.round(t.y*e)/e==Math.round(i.y*e)/e},this.okrugAngel=function(t,i,e){var s=t;m=1,t<0&&(m=-1),v=Math.abs(t),b=Math.round(v/i)+1,w=0;for(var r=b;r>=0;r--){if(v>r*i-e&&v<r*i+e)return s=r*i*m;if(3==++w)return s}return s};var _=new r,S=new r,I=[];this.getLineCircleIntersectionPoints=function(t,i,e,s,r){I.length=0;var n=i.x-t.x,a=i.y-t.y,o=e.x-t.x,h=e.y-t.y,l=n*n+a*a,u=(n*o+a*h)/l,c=u*u-(o*o+h*h-s*s)/l;if(c<0)return I;var p=Math.sqrt(c),d=-u+p,f=-u-p;return _.set(t.x-n*d,t.y-a*d),this.isPointInLine(t,i,_)&&I.push(_),0==c?I:(S.set(t.x-n*f,t.y-a*f),this.isPointInLine(t,i,S)&&I.push(S),r&&2==I.length&&(m=this.getDistance(t,I[0]),v=this.getDistance(t,I[1]),m>v&&I.reverse()),I)},this.isPointInLine=function(t,i,e){var s=this.getDistance(t,i),r=this.getDistance(t,e),n=this.getDistance(i,e);return this.okrugNumber(r+n)===this.okrugNumber(s)},this.getDistancePointToLine=function(t,i,e){var s=((i.y-t.y)*e.x-(i.x-t.x)*e.y+i.x*t.y-i.y*t.x)/this.getDistance(t,i);return-this.okrugNumber(Number.isFinite(s)?s:0)},this.getCircleCircleIntersectionPoints=function(t,i,e,s){var r,n,a,o,h;return I.length=0,(a=Math.sqrt(Math.pow(Math.abs(t.x-e.x),2)+Math.pow(Math.abs(t.y-e.y),2)))>i+s?I:(o=(i*i-s*s+a*a)/(2*a),h=Math.sqrt(Math.pow(i,2)-Math.pow(o,2)),isNaN(h)?I:(r=t.x+o*(e.x-t.x)/a,n=t.y+o*(e.y-t.y)/a,_.x=r+h*(e.y-t.y)/a,_.y=n-h*(e.x-t.x)/a,I.push(_),o==i?I:(S.x=r-h*(e.y-t.y)/a,S.y=n+h*(e.x-t.x)/a,I.push(S),I)))};var C=[new r,new r,new r,new r],E=[new r,new r,new r,new r];this.isIntersectionRect=function(t,i){return C[0].set(t.x,t.y),C[1].set(t.x+t.width,t.y),C[2].set(t.x+t.width,t.y+t.height),C[3].set(t.x,t.y+t.height),E[0].set(i.x,i.y),E[1].set(i.x+i.width,i.y),E[2].set(i.x+i.width,i.y+i.height),E[3].set(i.x,i.y+i.height),this.isIntersectionFromPoint(C,E)},this.isIntersectionFromPoint=function(t,i){for(var e=0;e<t.length-2;e++)for(var s=0;s<i.length-2;s++)if(this.getPointOfIntersection(t[e],t[(e+2)%t.length],i[s],i[(s+2)%i.length]))return!0;for(e=0;e<t.length;e++)for(s=0;s<i.length;s++)if(this.getPointOfIntersection(t[e],t[(e+1)%t.length],i[s],i[(s+1)%i.length]))return!0;for(e=0;e<i.length;e+=2)if(this.contains(i[e].x,i[e].y,t))return!0;for(e=0;e<t.length;e+=2)if(this.contains(t[e].x,t[e].y,i))return!0;return!1},this.isParalel=function(t,i,e,s,r){r=r||0;var n=Math.abs(this.getAngle(t,i)%Math.PI),a=Math.abs(this.getAngle(i,t)%Math.PI),o=Math.abs(this.getAngle(e,s)%Math.PI),h=Math.abs(this.getAngle(s,e)%Math.PI);return Math.min(Math.abs(n-o),Math.abs(a-h),Math.abs(n-h),Math.abs(a-o))<=r},this.rotationPoint=function(t,i,e){var s=0,r=0;e?(s=e.x+(t.x-e.x)*Math.cos(i)-(t.y-e.y)*Math.sin(i),r=e.y+(t.y-e.y)*Math.cos(i)+(t.x-e.x)*Math.sin(i)):(s=t.x*Math.cos(i)-t.y*Math.sin(i),r=t.y*Math.cos(i)+t.x*Math.sin(i)),t.x=s,t.y=r},this.rotationPointByLength=function(t,i,e){e=e||h;var s=this.getDistance(t,e),r=this.getLenghtCircle(s),n=i*(2*Math.PI/r);this.rotationPoint(t,n,e)},this.isIntersectionTriangle=function(t,i,e,s,r,n){for(var a=!1,o=[t,i,e],h=[s,r,n],l=0;l<o.length&&!a;l++)a=this.isInTriangle(s,r,n,o[l]);for(l=0;l<h.length&&!a;l++)a=this.isInTriangle(t,i,e,h[l]);if(!a)for(l=0;l<o.length;l++)for(var u=0;u<h.length&&!a;u++)a=this.getPointOfIntersection(o[l],o[(l+1)%o.length],h[u],h[(u+1)%h.length]);return a},this.getArrPointCircle=function(t,i,e,s,n,a,o){var h,l=this.getAngle(e,t)-Math.PI,u=this.getAngle(s,t)-Math.PI;h=o||[new r],n=n||5,!(a=a||!1)&&u<=l?u+=2*Math.PI:a&&l<=u&&(l+=2*Math.PI);var c=a?-1*(l-u):u-l,p=Math.ceil(Math.abs(c)/(2*Math.PI))*(n-1),d=c/(2*p),f=2*d,g=Math.cos(d),A=Math.sin(d),y=p-1,x=y%1/y,m=0,v=0,b=0,w=0,P=0;h[0].x=t.x+Math.cos(l)*i,h[0].y=t.y+Math.sin(l)*i;for(var _=0;_<=y;_++)m=d+l+(f*_+x*_),w=(g*(v=Math.cos(m))+A*(b=-Math.sin(m)))*i+t.x,P=(g*-b+A*v)*i+t.y,h[_+1]?(h[_+1].x=w,h[_+1].y=P):h.push(new r(w,P));return h},this.getLenghtCircle=function(t,i,e,s,r){i||(i=e=s=h);var n=this.getAngle(e,i)-Math.PI,a=this.getAngle(s,i)-Math.PI;return n===a&&e!==s?0:(!(r=r||!1)&&a<=n?a+=2*Math.PI:r&&n<=a&&(n+=2*Math.PI),Math.PI*t*(r?n-a:a-n)/Math.PI)},this.getLengthByWidth=function(t,i){var e=new r(0,0),s=new r(t,0),n=this.getVector(i,.5*Math.PI);n.x=t/2;var a=this.getCenterCircle(e,s,n);return a?this.getLenghtCircle(this.getDistance(a,e),a,e,s,i>0):t},this.getCenterCircle=function(t,i,e){var s=i.x-t.x,n=i.y-t.y,a=e.x-t.x,o=e.y-t.y,h=s*(t.x+i.x)+n*(t.y+i.y),l=a*(t.x+e.x)+o*(t.y+e.y),u=2*(s*(e.y-i.y)-n*(e.x-i.x));return 0===u?null:new r((o*h-n*l)/u,(s*l-a*h)/u)},this.getArcPoint=function(t,i,e,s,n){s=s||5;var a=this.getAngle(t,i)+90*this.DEG2RAD,o=this.getVector(e,a),h=new r((t.x+i.x)/2,(t.y+i.y)/2);h.x+=o.x,h.y+=o.y;var l=this.getCenterCircle(t,h,i);return l?this.getArrPointCircle(l,this.getDistance(l,t),t,i,s,e>0,n):[t,i]},this.getArea=function(t){for(var i=t.length,e=0,s=i-1,r=0;r<i;s=r++)e+=t[s].x*t[r].y-t[r].x*t[s].y;return.5*e||0},this.generateUUID=function(){for(var t=[],i=0;i<256;i++)t[i]=(i<16?"0":"")+i.toString(16);return function(){var i=4294967295*Math.random()|0,e=4294967295*Math.random()|0,s=4294967295*Math.random()|0,r=4294967295*Math.random()|0;return(t[255&i]+t[i>>8&255]+t[i>>16&255]+t[i>>24&255]+"-"+t[255&e]+t[e>>8&255]+"-"+t[e>>16&15|64]+t[e>>24&255]+"-"+t[63&s|128]+t[s>>8&255]+"-"+t[s>>16&255]+t[s>>24&255]+t[255&r]+t[r>>8&255]+t[r>>16&255]+t[r>>24&255]).toUpperCase()}}(),this.generateRendom=function(t){null==t&&(t=2);let i,e="",s="";for(var r=0;r<t;r++){if((s=(255&(i=4294967295*Math.random()|0)).toString(16)+(i>>8&255).toString(16)+(i>>16&255).toString(16)+(i>>24&255).toString(16)).length<8)for(var n=0;n<8-s.length+1;n++)s+="Z";e+=s,r!=t-1&&(e+="-")}return e},this.diffNum=function(t,i){return t>=0&&i>=0?Math.abs(t-i):t<=0&&i<=0?Math.abs(Math.abs(t)-Math.abs(i)):t<=0&&i>=0?Math.abs(t)+i:t>=0&&i<=0?t+Math.abs(i):void 0},this.getPercentNum=function(t,i,e){return((t=null!=t?t:0)-(i=null!=i?i:0))/((e=null!=e?e:100)-i)*100},this.getValueNum=function(t,i,e){return(t=null!=t?t:0)/100*((e=null!=e?e:100)-(i=null!=i?i:0))+i},this.getValueBetween=function(t,i,e){var s=Math.max(i,e),r=Math.min(i,e);return Math.max(Math.min(t,s),r)},this.contains=function(t,i,e){for(var s=!1,r=e.length,n=0,a=r-1;n<r;a=n++){if(e[n].x===t&&e[n].y===i)return!0;var o=e[n].x,h=e[n].y,l=e[a].x,u=e[a].y;h>i!=u>i&&t<(l-o)*(i-h)/(u-h)+o&&(s=!s)}return s};var T={maxX:0,minX:0,maxY:0,minY:0},M=new r,D=[new r,new r,new r,new r],R=new r;this.getBoundsRect=function(t,i){R.set(t.width/2,t.height/2),D[0].set(0,0),D[1].set(t.width,0),D[2].set(t.width,t.height),D[3].set(0,t.height);for(var e=0;e<D.length;e++)this.rotationPoint(D[e],i,R);T.maxX=-t.width,T.minX=t.width,T.maxY=-t.height,T.minY=t.height;for(e=0;e<D.length;e++)T.maxX=Math.max(T.maxX,D[e].x),T.minX=Math.min(T.minX,D[e].x),T.maxY=Math.max(T.maxY,D[e].y),T.minY=Math.min(T.minY,D[e].y);return M.x=T.minX,M.y=T.minY,M.width=T.maxX-T.minX,M.height=T.maxY-T.minY,M},this.getCurvatureByWidth=function(t,i){if(Math.abs(t)>2*i)return null;var e=Math.pow(Math.abs(t),2),s=Math.pow(i,2),r=Math.acos((s+s-e)/(2*s));return i*(1-Math.cos(r/2))*(t<0?-1:1)},this.getWidthByCurvature=function(t,i){return 2*i*Math.sin(Math.acos(1-2*Math.abs(t)/(2*i)))*(t<0?-1:1)};var L=function(t,i){if(O(t)&&O(i))return t===i;for(var e in t){if(t.hasOwnProperty(e)!==i.hasOwnProperty(e))return!1;switch(typeof t[e]){case"object":if(!L(t[e],i[e]))return!1;break;case"function":if(void 0===i[e]||"compare"!==e&&t[e].toString()!==i[e].toString())return!1;break;case"number":if(Number(Number(t[e]).toFixed(3))!==Number(Number(i[e]).toFixed(3)))return!1;break;default:if(t[e]!==i[e])return!1}}for(var e in i)if(t.hasOwnProperty(e)!==i.hasOwnProperty(e))return!1;return!0};function O(t){return t!==Object(t)}this.compare=L}function r(t,i,e){this._x=t||0,this._y=i||0,this._z=e||0,this.set=function(t,i,e){this._x=t||0,this._y=i||0,void 0!==e&&(this._z=e)},this.setPoint=function(t){this._x=t.x,this._y=t.y,void 0!==t.z&&(this._z=t.z)},this.getObj=function(){var t={};return t.x=this._x,t.y=this._y,t.z=this._z,t},this.copy=function(){return new r(this._x,this._y,this._z)}}e.d(i,"a",function(){return s}),e.d(i,"b",function(){return r}),r.prototype={set x(t){this._x=t},get x(){return this._x},set y(t){this._y=t},get y(){return this._y},set z(t){this._z=t},get z(){return this._z}}},function(t,i,e){"use strict";function s(t,i){for(var e=0;e<i.length;e++){var s=i[e];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}e.d(i,"a",function(){return r});var r=function(){function t(){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,t),this.type="SpDebugPixi";this.content2d=new PIXI.Container,this.color=11184810,this.colorActiv=16711680,this.wL=10,this.al=1,this._alpha=1,this.contentDebag=new PIXI.Container,this.content2d.addChild(this.contentDebag);var i=new PIXI.Graphics;this.content2d.addChild(i),this.debagLine=function(t,i,e,s){this.graphics=new PIXI.Graphics,this.contentDebag.addChild(this.graphics),null==e&&(e=this.color),null==s&&(s=this.wL),this.graphics.lineStyle(s,e,s),this.graphics.moveTo(t.x,t.y),this.graphics.lineTo(i.x,i.y)},this.debagPoint=function(t,i,e,s,r){this.graphics=new PIXI.Graphics,this.contentDebag.addChild(this.graphics),i=i||50,null==e&&(e=this.color),s=s||this.wL,this.graphics.lineStyle(this.wL,e,s),this.graphics.beginFill(e,null==r?1:r),this.graphics.drawCircle(t.x,t.y,i)};var e,s,r=0,n=[];this.clearD=function(){i.clear(),r=0;for(var t=0;t<n.length;t++)n[t].visible=!1},this.clear=function(){this.clearD()},this.dText=function(t,i,a,o){var h=o||4;null==n[r]&&(n[r]=new PIXI.Container,s=new PIXI.Text("345634634",{fontFamily:"Arial"}),n[r].addChild(s),this.content2d.addChild(n[r])),(e=n[r]).children[0].text=i+"",e.children[0].position.x=-e.children[0].width/2,e.children[0].position.y=-e.children[0].height/2,e.position.x=t.x,e.position.y=t.y,e.scale.x=h,e.scale.y=h,e.visible=!0,r++};var a={x:0,y:0},o={x:0,y:0};this.dLineParam=function(t,i,e,s,r,n){a.x=t,a.y=i,o.x=e,o.y=s,this.dLine(a,o,r,n)},this.dLine=function(t,e,s,r){null==s&&(s=this.color),null==r&&(r=this.wL),i.endFill(),i.lineStyle(r,s,this.al),i.moveTo(t.x,t.y),i.lineTo(e.x,e.y),i.endFill()},this.dPointParam=function(t,i,e,s,r){a.x=t,a.y=i,this.dPoint(a,e,s,r)},this.dPoint=function(t,e,s,r){(e=e||50)>1e6?console.warn("Большой круг рисовать не буду",e):(null==s&&(s=this.color),r=r||this.wL,i.lineStyle(r,s,this.al),i.drawCircle(t.x,t.y,e),i.endFill())},this.dLinePosition=function(t,e){i.lineStyle(20.5,e,this.al),i.moveTo(t.p.x,t.p.y),i.lineTo(t.p1.x,t.p1.y),i.moveTo(t.p1.x,t.p1.y),i.lineTo(t.p2.x,t.p2.y),i.beginFill(e,.3),i.drawCircle(t.p.x,t.p.y,20.5),i.drawCircle(t.p1.x,t.p1.y,20.5),i.drawCircle(t.p2.x,t.p2.y,20.5),i.endFill()},this.dRect=function(t,i,e){if((t=t||50)>1e6)console.warn("Большой круг рисовать не буду",t);else{null==i&&(i=16777215*Math.random()),e=e||this.wL;var s=null==t.w?t.width:t.w,r=null==t.h?t.height:t.h,n={x:t.x,y:t.y},a={x:t.x+s,y:t.y},o={x:t.x+s,y:t.y+r},h={x:t.x,y:t.y+r};this.dLine(n,a,i,e),this.dLine(a,o,i,e),this.dLine(o,h,i,e),this.dLine(h,n,i,e)}}}var i,e,r;return i=t,(e=[{key:"alpha",set:function(t){this._alpha!=t&&(this._alpha=t,this.content2d.alpha=t)},get:function(){return this._alpha}}])&&s(i.prototype,e),r&&s(i,r),t}()},function(t,i,e){"use strict";e.d(i,"a",function(){return n});var s=e(6);function r(t,i){for(var e=0;e<i.length;e++){var s=i[e];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}var n=function(){function t(i,e){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,t),this.type="SobIndex";var r=this;this.par=i,this.fun=e,this._active=!1,this.funActive=void 0,this._mashtab=1,this._otstup=25,this._sah=0,this.color=16711680,this.activColor=65280;var n,a,o=new s.a;this.setActive=function(){this.par.floor.sp.activMouse=!0,this.par.floor.visiPoint=!0,this.par.floor.bazaMod.activMouse=!1,this.par.floor.bazaMod.activeRadius=!1},this.move=function(t){},this.out=function(t){},this.over=function(t){},this.down=function(t){},this.clear=function(){this._sah=0},this.clearActive=function(){!1,n=this.par.floor.sp.arrPoint,a=this.par.floor.sp.arrSplice;for(var t=0;t<n.length;t++)n[t].life&&!1!==n[t].active&&(n[t].active=!1);for(t=0;t<a.length;t++)a[t].life&&!1!==a[t].active&&(a[t].active=!1)},this.distSten=20,this.getPosEv3D=function(t){var i=new THREE.Vector3;return i.set(-this.par.whSize/2+this.par.whSize*t.uv.x,-(-this.par.whSize/2+this.par.whSize*t.uv.y),0),i};var h,l=new THREE.Vector2,u=new THREE.Vector2;this.getSten=function(t){return this.getParName(t,"sten")},this.getParName=function(t,i){return null!=t[i]?t[i]:null!=t.parent?this.getParName(t.parent,i):null},this.getPosEv3DSten=function(t){var i=new THREE.Vector3;return null==(h=this.getSten(t.target))?null:(i.z=2,u.x=t.point.x,u.y=t.point.z,o.getDistance(u,h.position)<25?(i.z=0,i.x=h.position.x,i.y=h.position.y,i):o.getDistance(u,h.position1)<25?(i.z=1,i.x=h.position1.x,i.y=h.position1.y,i):(l=o.isPointInLin(h.position,h.position1,u,10,10),i.z=2,i.x=l.x,i.y=l.y,i))};var c=new THREE.Vector3,p=[],d=[];this.startAP=function(t,i){t,t?(c.x=t.position.x,c.y=t.position.y):(c.x=9999999999,c.y=9999999999),p.length=0;for(var e=0;e<this.par.floor.sp.arrPoint.length;e++)this.par.floor.sp.arrPoint[e].life&&(t&&this.par.floor.sp.arrPoint[e]._uuid==t._uuid||i&&this.par.floor.sp.arrPoint[e]._uuid==i._uuid||p.push(this.par.floor.sp.arrPoint[e]));var s;d.length=0;for(e=0;e<this.par.floor.sp.arrSplice.length;e++)if(this.par.floor.sp.arrSplice[e].life){s=!0;for(var r=0;r<t.arrSHron.length;r++)t.arrSHron[r].sten._uuid==this.par.floor.sp.arrSplice[e]._uuid&&(s=!1);1==s&&d.push(this.par.floor.sp.arrSplice[e])}};u={x:0,y:0,o:null};this.getDistSten=function(t,i){return u.x=i.x,u.y=i.y,l=o.isPointInLin(t.position,t.position1,u,11111,0),o.getDistance(u,l)},this.pointOld=void 0;var f,g,A,y,x,m,v,b,w;this.korektAP=function(t,i,e){t.x=10*Math.round(t.x/10),t.y=10*Math.round(t.y/10),t.o=null,t.oy=null,t.ox=null,25,null!=r.pointOld&&(Math.abs(t.x-this.pointOld.x)<25/this._mashtab&&(t.x=this.pointOld.x),Math.abs(t.y-this.pointOld.y)<25/this._mashtab&&(t.y=this.pointOld.y)),g=25/this._mashtab,A=null,y=25/this._mashtab,x=null;for(var s=0;s<r.p20.sp.arrPoint.length;s++)if(r.p20.sp.arrPoint[s].life&&(!i||r.p20.sp.arrPoint[s]._uuid!=i._uuid)&&0!=r.p20.sp.arrPoint[s].activMouse){if(this.pointOld&&null!=this.pointOld.uuidArr){m=!0;for(var n=0;n<this.pointOld.uuidArr.length;n++)this.pointOld.uuidArr[n]==r.p20.sp.arrPoint[s]._uuid&&(m=!1);if(!m)continue}(v=Math.abs(t.x-r.p20.sp.arrPoint[s].position.x))<g&&(g=v,A=r.p20.sp.arrPoint[s].position.x,b=r.p20.sp.arrPoint[s].position.y),(v=Math.abs(t.y-r.p20.sp.arrPoint[s].position.y))<y&&(y=v,x=r.p20.sp.arrPoint[s].position.y,w=r.p20.sp.arrPoint[s].position.x)}if(1==e)for(s=0;s<r.p20.sp.avp.length;s++)if(r.p20.sp.avp[s].life&&(!i||r.p20.sp.avp[s]._uuid!=i._uuid)&&0!=r.p20.sp.avp[s].activMouse){if(this.pointOld&&null!=this.pointOld.uuidArr){m=!0;for(n=0;n<this.pointOld.uuidArr.length;n++)this.pointOld.uuidArr[n]==r.p20.sp.avp[s]._uuid&&(m=!1);if(!m)continue}(v=Math.abs(t.x-r.p20.sp.avp[s].position.x))<g&&(g=v,A=r.p20.sp.avp[s].position.x,b=r.p20.sp.avp[s].position.y),(v=Math.abs(t.y-r.p20.sp.avp[s].position.y))<y&&(y=v,x=r.p20.sp.avp[s].position.y,w=r.p20.sp.avp[s].position.x)}null!=A&&(t.x=A,t.oy=b),null!=x&&(t.y=x,t.ox=w);for(s=0;s<r.p20.sp.arrPoint.length;s++){if(r.p20.sp.arrPoint[s].life)if(!i||r.p20.sp.arrPoint[s]._uuid!=i._uuid)if(o.getDistance(r.p20.sp.arrPoint[s].position,t)<25)return t.x=r.p20.sp.arrPoint[s].position.x,t.y=r.p20.sp.arrPoint[s].position.y,void(t.o=r.p20.sp.arrPoint[s])}for(s=0;s<r.p20.sp.arrSplice.length;s++)if(r.p20.sp.arrSplice[s].life&&(null==i||r.p20.sp.arrSplice[s].addPoint._uuid!=i._uuid&&r.p20.sp.arrSplice[s].addPoint1._uuid!=i._uuid)&&(f=this.getDistSten(r.p20.sp.arrSplice[s],t),l&&-1!=f&&f<50))return t.x=l.x,t.y=l.y,void(t.o=r.p20.sp.arrSplice[s])},this.getPositPlan=function(t){return r.par.par.mGridDrag.getPositPlan(t)},this.downFont=function(t){r.par.par.mGridDrag.downFont(t)},this.helpDP=void 0,this.setP20=function(t){r.cont=t.cont2d,r.p20=t,r.helpDP=r.par.par.mCont2dHelp.helpDP},this.sp=void 0,this.setSP=function(t){this.sp=t,this.color=this.sp.convertC(dcmParam.color),this.activColor=this.sp.convertC(dcmParam.activButton)},this.render=function(){r.par.par.fun("render")},this.sobSP=function(t,i,e){trace(this.type+" sobSP >>",t,i,e)},this.sobMenu=function(t,i,e){trace(this.type+" sobMenu >>",t,i,e)},this.boolCTRL=!1,this.keydown=function(t){17==event.keyCode&&(r.boolCTRL=!0)},this.keyup=function(t){17==event.keyCode&&(r.boolCTRL=!1)}}var i,e,n;return i=t,(e=[{key:"active",set:function(t){this._active!=t&&(this._active=t,null!=this.funActive&&this.funActive(),this.helpDP&&this.helpDP.clear())},get:function(){return this._active}},{key:"mashtab",set:function(t){this._mashtab!=t&&(this._mashtab=t)},get:function(){return this._mashtab}}])&&r(i.prototype,e),n&&r(i,n),t}()},function(t,i,e){"use strict";function s(t,i,e){this._x=t||0,this._y=i||0,this._z=e||0,this.set=function(t,i,e){this._x=t||0,this._y=i||0,void 0!==e&&(this._z=e)},this.setPoint=function(t){this._x=t.x,this._y=t.y,void 0!==t.z&&(this._z=t.z)},this.getObj=function(){var t={};return t.x=this._x,t.y=this._y,t.z=this._z,t},this.copy=function(){return new s(this._x,this._y,this._z)}}e.d(i,"a",function(){return s}),s.prototype={set x(t){this._x=t},get x(){return this._x},set y(t){this._y=t},get y(){return this._y},set z(t){this._z=t},get z(){return this._z}}},function(t,i){var e;e=function(){return this}();try{e=e||new Function("return this")()}catch(t){"object"==typeof window&&(e=window)}t.exports=e},function(t,i,e){"use strict";function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(){var t,i,e,r,a=new THREE.Vector3(0,0,0),o=new THREE.Vector3(0,0,0),h=new THREE.Vector3(0,0,0),l=new THREE.Vector3(0,0,0);this.DEG2RAD=Math.PI/180,this.RAD2DEG=180/Math.PI,this.getAngle=function(t,i){return i=i||l,t=t||l,Math.atan2(i.y-t.y,i.x-t.x)};var u,c,p,d,f,g,A,y,x,m=0;this.getAngle2=function(t,i){return i=i||l,t=t||l,(m=Math.atan2(i.y-t.y,i.x-t.x))<0&&(m+=2*Math.PI),m},this.getDistance=function(t,i){return null==t?0:(null==i&&(i=l),i=i||l,Math.sqrt(Math.pow(t.x-i.x,2)+Math.pow(t.y-i.y,2)))},this.getVector=function(t,i,e){if(null==e)e=new THREE.Vector2(0,0);return t<0&&(i+=Math.PI),e.x=Math.abs(t)*Math.cos(i),e.y=Math.abs(t)*Math.sin(i),e},this.isPointInLin=function(t,e,s,n,a){return this.getTreeAngel(t,e,s),a<0&&2*Math.abs(a)>r?null:o.x<=r+a&&o.x>=-a&&Math.abs(o.y)<=n?((h=o.x<0?this.getVector(o.x,i-Math.PI):this.getVector(o.x,i)).x+=e.x,h.y+=e.y,h.z=o.y,h):null},this.okrugPoint=function(t,i){null==i&&(i=100),t.x=Math.round(t.x/i)*i,t.y=Math.round(t.y/i)*i},this.okrugNumber=function(t,i){null==i&&(i=100);var e=Math.round(t*i)/i;return t=e,e},this.isInTriangle=function(t,i,e,s){var r=(t.x-s.x)*(i.y-t.y)-(i.x-t.x)*(t.y-s.y),n=(i.x-s.x)*(e.y-i.y)-(e.x-i.x)*(i.y-s.y),a=(e.x-s.x)*(t.y-e.y)-(t.x-e.x)*(e.y-s.y);return r>=0&&n>=0&&a>=0||r<=0&&n<=0&&a<=0},this.getTreeAngel=function(t,s,n,a){return i=this.getAngle(s,t),e=this.getAngle(s,n),u=this.getDistance(s,n),r=this.getDistance(t,s),this.getVector(u,e-i,o),e=this.getAngle(l,o),null==a?e:e>0?e:2*Math.PI+e},this.getTreeAngelPI2=function(t,i,e){x1=t.x-i.x,x2=e.x-i.x,y1=t.y-i.y,y2=e.y-i.y,r=Math.sqrt(x1*x1+y1*y1),d2=Math.sqrt(x2*x2+y2*y2);var s=(x1*x2+y1*y2)/(r*d2);return s>1&&(s=1),s<-1&&(s=-1),Math.acos(s)},this.isLineInTriangle=function(i,e,s,r,n){return(t=this.getPointOfIntersection(i,e,r,n))?(a.x=t.x,a.y=t.y,a.z=0,a):(t=this.getPointOfIntersection(e,s,r,n))?(a.x=t.x,a.y=t.y,a.z=1,a):!!(t=this.getPointOfIntersection(s,i,r,n))&&(a.x=t.x,a.y=t.y,a.z=2,a)};var v,b,w,P,_=new THREE.Vector2(0,0);this.getPointOfIntersection=function(t,i,e,s){return u=(t.x-i.x)*(s.y-e.y)-(t.y-i.y)*(s.x-e.x),c=(t.x-e.x)*(s.y-e.y)-(t.y-e.y)*(s.x-e.x),p=(t.x-i.x)*(t.y-e.y)-(t.y-i.y)*(t.x-e.x),f=p/u,(d=c/u)>=0&&d<=1&&f>=0&&f<=1?(g=t.x+d*(i.x-t.x),A=t.y+d*(i.y-t.y),_.x=g,_.y=A,_):null},this.korektToLine=function(t,i,e,s,r){y=this.getDistance(t,i),x=null==r?this.getAngle(t,i):r,0!=s&&(_=s<0?this.getVector(-s,x-Math.PI/2):this.getVector(s,x+Math.PI/2),t.x+=_.x,t.y+=_.y,i.x+=_.x,i.y+=_.y),_=this.getVector(e,x),i.x+=_.x,i.y+=_.y,_=this.getVector(e,x+Math.PI),t.x+=_.x,t.y+=_.y},this.getProsent3Point=function(t,i,e){return c=this.getDistance(t,i),(p=this.getDistance(t,e))/c},this.povotorOtAngel=function(t,i,e){return x=this.getAngle(t,i),y=this.getDistance(t,i),this.getVector(y,x+e)},this.testPositPoint=function(t,i,e){return null==e&&(e=100),Math.round(t.x*e)/e==Math.round(i.x*e)/e&&Math.round(t.y*e)/e==Math.round(i.y*e)/e},this.okrugAngel=function(t,i,e){var s=t;v=1,t<0&&(v=-1),b=Math.abs(t),w=Math.round(b/i)+1,P=0;for(var r=w;r>=0;r--){if(b>r*i-e&&b<r*i+e)return s=r*i*v;if(3==++P)return s}return s};var S=new n,I=new n,C=[];this.getLineCircleIntersectionPoints=function(t,i,e,s,r){C.length=0;var n=i.x-t.x,a=i.y-t.y,o=e.x-t.x,h=e.y-t.y,l=n*n+a*a,u=(n*o+a*h)/l,c=u*u-(o*o+h*h-s*s)/l;if(c<0)return C;var p=Math.sqrt(c),d=-u+p,f=-u-p;return S.set(t.x-n*d,t.y-a*d),this.isPointInLine(t,i,S)&&C.push(S),0==c?C:(I.set(t.x-n*f,t.y-a*f),this.isPointInLine(t,i,I)&&C.push(I),r&&2==C.length&&(v=this.getDistance(t,C[0]),b=this.getDistance(t,C[1]),v>b&&C.reverse()),C)},this.isPointInLine=function(t,i,e){var s=calc.getDistance(t,i),r=calc.getDistance(t,e),n=calc.getDistance(i,e);return calc.okrugNumber(r+n)===calc.okrugNumber(s)},this.getDistancePointToLine=function(t,i,e){var s=((i.y-t.y)*e.x-(i.x-t.x)*e.y+i.x*t.y-i.y*t.x)/calc.getDistance(t,i);return-calc.okrugNumber(Number.isFinite(s)?s:0)},this.getCircleCircleIntersectionPoints=function(t,i,e,s){var r,n,a,o,h;return C.length=0,(a=Math.sqrt(Math.pow(Math.abs(t.x-e.x),2)+Math.pow(Math.abs(t.y-e.y),2)))>i+s?C:(o=(i*i-s*s+a*a)/(2*a),h=Math.sqrt(Math.pow(i,2)-Math.pow(o,2)),isNaN(h)?C:(r=t.x+o*(e.x-t.x)/a,n=t.y+o*(e.y-t.y)/a,S.x=r+h*(e.y-t.y)/a,S.y=n-h*(e.x-t.x)/a,C.push(S),o==i?C:(I.x=r-h*(e.y-t.y)/a,I.y=n+h*(e.x-t.x)/a,C.push(I),C)))};var E=[new n,new n,new n,new n],T=[new n,new n,new n,new n];this.isIntersectionRect=function(t,i){return E[0].set(t.x,t.y),E[1].set(t.x+t.width,t.y),E[2].set(t.x+t.width,t.y+t.height),E[3].set(t.x,t.y+t.height),T[0].set(i.x,i.y),T[1].set(i.x+i.width,i.y),T[2].set(i.x+i.width,i.y+i.height),T[3].set(i.x,i.y+i.height),this.isIntersectionFromPoint(E,T)},this.isIntersectionFromPoint=function(t,i){for(var e=0;e<t.length-2;e++)for(var s=0;s<i.length-2;s++)if(calc.getPointOfIntersection(t[e],t[(e+2)%t.length],i[s],i[(s+2)%i.length]))return!0;for(e=0;e<t.length;e++)for(s=0;s<i.length;s++)if(calc.getPointOfIntersection(t[e],t[(e+1)%t.length],i[s],i[(s+1)%i.length]))return!0;for(e=0;e<i.length;e+=2)if(calc.contains(i[e].x,i[e].y,t))return!0;for(e=0;e<t.length;e+=2)if(calc.contains(t[e].x,t[e].y,i))return!0;return!1},this.isParalel=function(t,i,e,s,r){r=r||0;var n=Math.abs(calc.getAngle(t,i)%Math.PI),a=Math.abs(calc.getAngle(i,t)%Math.PI),o=Math.abs(calc.getAngle(e,s)%Math.PI),h=Math.abs(calc.getAngle(s,e)%Math.PI);return Math.min(Math.abs(n-o),Math.abs(a-h),Math.abs(n-h),Math.abs(a-o))<=r},this.rotationPoint=function(t,i,e){var s=0,r=0;e?(s=e.x+(t.x-e.x)*Math.cos(i)-(t.y-e.y)*Math.sin(i),r=e.y+(t.y-e.y)*Math.cos(i)+(t.x-e.x)*Math.sin(i)):(s=t.x*Math.cos(i)-t.y*Math.sin(i),r=t.y*Math.cos(i)+t.x*Math.sin(i)),t.x=s,t.y=r},this.rotationPointByLength=function(t,i,e){e=e||l;var s=calc.getDistance(t,e),r=calc.getLenghtCircle(s),n=i*(2*Math.PI/r);calc.rotationPoint(t,n,e)},this.isIntersectionTriangle=function(t,i,e,s,r,n){for(var a=!1,o=[t,i,e],h=[s,r,n],l=0;l<o.length&&!a;l++)a=calc.isInTriangle(s,r,n,o[l]);for(l=0;l<h.length&&!a;l++)a=calc.isInTriangle(t,i,e,h[l]);if(!a)for(l=0;l<o.length;l++)for(var u=0;u<h.length&&!a;u++)a=calc.getPointOfIntersection(o[l],o[(l+1)%o.length],h[u],h[(u+1)%h.length]);return a},this.getArrPointCircle=function(t,i,e,s,r,a,o){var h,l=calc.getAngle(e,t)-Math.PI,u=calc.getAngle(s,t)-Math.PI;h=o||[new n],r=r||5,!(a=a||!1)&&u<=l?u+=2*Math.PI:a&&l<=u&&(l+=2*Math.PI);var c=a?-1*(l-u):u-l,p=Math.ceil(Math.abs(c)/(2*Math.PI))*(r-1),d=c/(2*p),f=2*d,g=Math.cos(d),A=Math.sin(d),y=p-1,x=y%1/y,m=0,v=0,b=0,w=0,P=0;h[0].x=t.x+Math.cos(l)*i,h[0].y=t.y+Math.sin(l)*i;for(var _=0;_<=y;_++)m=d+l+(f*_+x*_),w=(g*(v=Math.cos(m))+A*(b=-Math.sin(m)))*i+t.x,P=(g*-b+A*v)*i+t.y,h[_+1]?(h[_+1].x=w,h[_+1].y=P):h.push(new n(w,P));return h},this.getLenghtCircle=function(t,i,e,s,r){i||(i=e=s=l);var n=calc.getAngle(e,i)-Math.PI,a=calc.getAngle(s,i)-Math.PI;return n===a&&e!==s?0:(!(r=r||!1)&&a<=n?a+=2*Math.PI:r&&n<=a&&(n+=2*Math.PI),Math.PI*t*(r?n-a:a-n)/Math.PI)},this.getLengthByWidth=function(t,i){var e=new n(0,0),s=new n(t,0),r=calc.getVector(i,.5*Math.PI);r.x=t/2;var a=calc.getCenterCircle(e,s,r);return a?calc.getLenghtCircle(calc.getDistance(a,e),a,e,s,i>0):t},this.getCenterCircle=function(t,i,e){var s=i.x-t.x,r=i.y-t.y,a=e.x-t.x,o=e.y-t.y,h=s*(t.x+i.x)+r*(t.y+i.y),l=a*(t.x+e.x)+o*(t.y+e.y),u=2*(s*(e.y-i.y)-r*(e.x-i.x));return 0===u?null:new n((o*h-r*l)/u,(s*l-a*h)/u)},this.getArcPoint=function(t,i,e,s,r){s=s||5;var a=calc.getAngle(t,i)+90*calc.DEG2RAD,o=calc.getVector(e,a),h=new n((t.x+i.x)/2,(t.y+i.y)/2);h.x+=o.x,h.y+=o.y;var l=calc.getCenterCircle(t,h,i);return l?calc.getArrPointCircle(l,calc.getDistance(l,t),t,i,s,e>0,r):[t,i]},this.getArea=function(t){for(var i=t.length,e=0,s=i-1,r=0;r<i;s=r++)e+=t[s].x*t[r].y-t[r].x*t[s].y;return.5*e||0},this.generateUUID=function(){for(var t=[],i=0;i<256;i++)t[i]=(i<16?"0":"")+i.toString(16);return function(){var i=4294967295*Math.random()|0,e=4294967295*Math.random()|0,s=4294967295*Math.random()|0,r=4294967295*Math.random()|0;return(t[255&i]+t[i>>8&255]+t[i>>16&255]+t[i>>24&255]+"-"+t[255&e]+t[e>>8&255]+"-"+t[e>>16&15|64]+t[e>>24&255]+"-"+t[63&s|128]+t[s>>8&255]+"-"+t[s>>16&255]+t[s>>24&255]+t[255&r]+t[r>>8&255]+t[r>>16&255]+t[r>>24&255]).toUpperCase()}}(),this.diffNum=function(t,i){return t>=0&&i>=0?Math.abs(t-i):t<=0&&i<=0?Math.abs(Math.abs(t)-Math.abs(i)):t<=0&&i>=0?Math.abs(t)+i:t>=0&&i<=0?t+Math.abs(i):void 0},this.getPercentNum=function(t,i,e){return((t=null!=t?t:0)-(i=null!=i?i:0))/((e=null!=e?e:100)-i)*100},this.getValueNum=function(t,i,e){return(t=null!=t?t:0)/100*((e=null!=e?e:100)-(i=null!=i?i:0))+i},this.getValueBetween=function(t,i,e){var s=Math.max(i,e),r=Math.min(i,e);return Math.max(Math.min(t,s),r)},this.contains=function(t,i,e){for(var s=!1,r=e.length,n=0,a=r-1;n<r;a=n++){if(e[n].x===t&&e[n].y===i)return!0;var o=e[n].x,h=e[n].y,l=e[a].x,u=e[a].y;h>i!=u>i&&t<(l-o)*(i-h)/(u-h)+o&&(s=!s)}return s};var M={maxX:0,minX:0,maxY:0,minY:0},D=new n,R=[new n,new n,new n,new n],L=new n;this.getBoundsRect=function(t,i){L.set(t.width/2,t.height/2),R[0].set(0,0),R[1].set(t.width,0),R[2].set(t.width,t.height),R[3].set(0,t.height);for(var e=0;e<R.length;e++)this.rotationPoint(R[e],i,L);M.maxX=-t.width,M.minX=t.width,M.maxY=-t.height,M.minY=t.height;for(e=0;e<R.length;e++)M.maxX=Math.max(M.maxX,R[e].x),M.minX=Math.min(M.minX,R[e].x),M.maxY=Math.max(M.maxY,R[e].y),M.minY=Math.min(M.minY,R[e].y);return D.x=M.minX,D.y=M.minY,D.width=M.maxX-M.minX,D.height=M.maxY-M.minY,D},this.getCurvatureByWidth=function(t,i){if(Math.abs(t)>2*i)return null;var e=Math.pow(Math.abs(t),2),s=Math.pow(i,2),r=Math.acos((s+s-e)/(2*s));return i*(1-Math.cos(r/2))*(t<0?-1:1)},this.getWidthByCurvature=function(t,i){return 2*i*Math.sin(Math.acos(1-2*Math.abs(t)/(2*i)))*(t<0?-1:1)};function O(t){return t!==Object(t)}this.compare=function t(i,e){if(O(i)&&O(e))return i===e;for(var r in i){if(i.hasOwnProperty(r)!==e.hasOwnProperty(r))return!1;switch(s(i[r])){case"object":if(!t(i[r],e[r]))return!1;break;case"function":if(void 0===e[r]||"compare"!==r&&i[r].toString()!==e[r].toString())return!1;break;case"number":if(Number(Number(i[r]).toFixed(3))!==Number(Number(e[r]).toFixed(3)))return!1;break;default:if(i[r]!==e[r])return!1}}for(var r in e)if(i.hasOwnProperty(r)!==e.hasOwnProperty(r))return!1;return!0}}function n(t,i,e){this._x=t||0,this._y=i||0,this._z=e||0,this.set=function(t,i,e){this._x=t||0,this._y=i||0,void 0!==e&&(this._z=e)},this.setPoint=function(t){this._x=t.x,this._y=t.y,void 0!==t.z&&(this._z=t.z)},this.getObj=function(){var t={};return t.x=this._x,t.y=this._y,t.z=this._z,t},this.copy=function(){return new n(this._x,this._y,this._z)}}e.d(i,"a",function(){return r}),n.prototype={set x(t){this._x=t},get x(){return this._x},set y(t){this._y=t},get y(){return this._y},set z(t){this._z=t},get z(){return this._z}}},function(t,i,e){"use strict";e.d(i,"a",function(){return s});var s=function(t){THREE.DataTextureLoader.call(this,t),this.type=THREE.UnsignedByteType};s.prototype=Object.assign(Object.create(THREE.DataTextureLoader.prototype),{constructor:s,parse:function(t){var i=function(t,i){switch(t){case 1:console.error("RGBELoader Read Error: "+(i||""));break;case 2:console.error("RGBELoader Write Error: "+(i||""));break;case 3:console.error("RGBELoader Bad File Format: "+(i||""));break;default:case 4:console.error("RGBELoader: Error: "+(i||""))}return-1},e=function(t,i,e){i=i||1024;for(var s=t.pos,r=-1,n=0,a="",o=String.fromCharCode.apply(null,new Uint16Array(t.subarray(s,s+128)));0>(r=o.indexOf("\n"))&&n<i&&s<t.byteLength;)a+=o,n+=o.length,s+=128,o+=String.fromCharCode.apply(null,new Uint16Array(t.subarray(s,s+128)));return-1<r&&(!1!==e&&(t.pos+=n+r+1),a+o.slice(0,r))},s=function(){var t=new Float32Array(1),i=new Int32Array(t.buffer);function e(e){t[0]=e;var s=i[0],r=s>>16&32768,n=s>>12&2047,a=s>>23&255;return a<103?r:a>142?(r|=31744,r|=(255==a?0:1)&&8388607&s):a<113?r|=((n|=2048)>>114-a)+(n>>113-a&1):(r|=a-112<<10|n>>1,r+=1&n)}return function(t,i,s,r){var n=t[i+3],a=Math.pow(2,n-128)/255;s[r+0]=e(t[i+0]*a),s[r+1]=e(t[i+1]*a),s[r+2]=e(t[i+2]*a)}}(),r=new Uint8Array(t);r.pos=0;var n,a,o,h,l,u,c=function(t){var s,r,n=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,a=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,o=/^\s*FORMAT=(\S+)\s*$/,h=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,l={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};if(t.pos>=t.byteLength||!(s=e(t)))return i(1,"no header found");if(!(r=s.match(/^#\?(\S+)$/)))return i(3,"bad initial token");for(l.valid|=1,l.programtype=r[1],l.string+=s+"\n";!1!==(s=e(t));)if(l.string+=s+"\n","#"!==s.charAt(0)){if((r=s.match(n))&&(l.gamma=parseFloat(r[1],10)),(r=s.match(a))&&(l.exposure=parseFloat(r[1],10)),(r=s.match(o))&&(l.valid|=2,l.format=r[1]),(r=s.match(h))&&(l.valid|=4,l.height=parseInt(r[1],10),l.width=parseInt(r[2],10)),2&l.valid&&4&l.valid)break}else l.comments+=s+"\n";return 2&l.valid?4&l.valid?l:i(3,"missing image size specifier"):i(3,"missing format specifier")}(r);if(-1!==c){var p=c.width,d=c.height,f=function(t,e,s){var r,n,a,o,h,l,u,c,p,d,f,g,A,y=e,x=s;if(y<8||y>32767||2!==t[0]||2!==t[1]||128&t[2])return new Uint8Array(t);if(y!==(t[2]<<8|t[3]))return i(3,"wrong scanline width");if(!(r=new Uint8Array(4*e*s))||!r.length)return i(4,"unable to allocate buffer space");for(n=0,a=0,c=4*y,A=new Uint8Array(4),l=new Uint8Array(c);x>0&&a<t.byteLength;){if(a+4>t.byteLength)return i(1);if(A[0]=t[a++],A[1]=t[a++],A[2]=t[a++],A[3]=t[a++],2!=A[0]||2!=A[1]||(A[2]<<8|A[3])!=y)return i(3,"bad rgbe scanline format");for(u=0;u<c&&a<t.byteLength;){if((g=(o=t[a++])>128)&&(o-=128),0===o||u+o>c)return i(3,"bad scanline data");if(g)for(h=t[a++],p=0;p<o;p++)l[u++]=h;else l.set(t.subarray(a,a+o),u),u+=o,a+=o}for(d=y,p=0;p<d;p++)f=0,r[n]=l[p+f],f+=y,r[n+1]=l[p+f],f+=y,r[n+2]=l[p+f],f+=y,r[n+3]=l[p+f],n+=4;x--}return r}(r.subarray(r.pos),p,d);if(-1!==f){switch(this.type){case THREE.UnsignedByteType:var g=f,A=THREE.RGBEFormat,y=THREE.UnsignedByteType;break;case THREE.FloatType:for(var x=f.length/4*3,m=new Float32Array(x),v=0;v<x;v++)o=m,h=3*v,l=void 0,u=void 0,l=(n=f)[(a=4*v)+3],u=Math.pow(2,l-128)/255,o[h+0]=n[a+0]*u,o[h+1]=n[a+1]*u,o[h+2]=n[a+2]*u;g=m,A=THREE.RGBFormat,y=THREE.FloatType;break;case THREE.HalfFloatType:x=f.length/4*3;var b=new Uint16Array(x);for(v=0;v<x;v++)s(f,4*v,b,3*v);g=b,A=THREE.RGBFormat,y=THREE.HalfFloatType;break;default:console.error("THREE.RGBELoader: unsupported type: ",this.type)}return{width:p,height:d,data:g,header:c.string,gamma:c.gamma,exposure:c.exposure,format:A,type:y}}}return null},setDataType:function(t){return this.type=t,this},load:function(t,i,e,s){return THREE.DataTextureLoader.prototype.load.call(this,t,function(t,e){switch(t.type){case THREE.UnsignedByteType:t.encoding=THREE.RGBEEncoding,t.minFilter=THREE.NearestFilter,t.magFilter=THREE.NearestFilter,t.generateMipmaps=!1,t.flipY=!0;break;case THREE.FloatType:case THREE.HalfFloatType:t.encoding=THREE.LinearEncoding,t.minFilter=THREE.LinearFilter,t.magFilter=THREE.LinearFilter,t.generateMipmaps=!1,t.flipY=!0}i&&i(t,e)},e,s)}})},function(t,i,e){"use strict";var s=e(1);class r{constructor(t){this.type="KRUmnik";var i,e,s,r,a,o,h,l,u,c,p,d,f;this.par=t,this.naStart=function(){u=this.par.rect.h+this.par.rect.y,c=this.par.rect.y,s=!1,r=!1,a=!1,o=!1,0!=this.par.pS.y&&(s=!0,e=Math.abs(this.par.pS.y)%this.par.pS.h,d=1,p=1-e/this.par.pS.h,this.par.pS.y>0&&(e=((d=1)-(p=1-p))*this.par.pS.h),e>this.par.rect.h&&(e=this.par.rect.h,d=(e+p*this.par.pS.h)/this.par.pS.h),this.naVV(c,e,s,a,p,d),c+=e);for(var t=c;t<u;t+=this.par.pS.h)s=!1,r=!1,a=!1,o=!1,0==t&&0==this.par.pS.y&&(s=!0),t+(e=this.par.pS.h)>u&&(e=u-t,a=!0),t+e==u&&(a=!0),p=0,d=e/this.par.pS.h,this.naVV(t,e,s,a,p,d);this.par.arrDin.length=0;for(var i=0;i<this.par.sah;i++)this.par.arrDin[i]=this.par.array[i]},this.naVV=function(t,e,s,n,a,u){h=this.par.rect.w+this.par.rect.x,l=this.par.rect.x,0!=this.par.pS.x&&(o=!0,i=Math.abs(this.par.pS.x)%this.par.pS.w,d=1,p=1-i/this.par.pS.w,this.par.pS.x>0&&(i=((d=1)-(p=1-p))*this.par.pS.w),i>this.par.rect.w&&(i=this.par.rect.w,d=(i+p*this.par.pS.w)/this.par.pS.w),r=!1,c+i>h&&(r=!0),l+i==h&&(r=!0),this.creatNS(l,t,i,e,s,r,n,o,p,a,d,u),l+=i);for(var c=l;c<h;c+=this.par.pS.w)o=!1,c==l&&0==this.par.pS.x&&(o=!0),r=!1,c+(i=this.par.pS.w)>h&&(i=h-c,r=!0),c+i==h&&(r=!0),d=i/this.par.pS.w,this.creatNS(c,t,i,e,s,r,n,o,0,a,d,u)},this.creatNS=function(t,i,e,s,r,n,a,o,h,l,u,c){return(f=this.par.getR()).x=t,f.y=i,f.w=e,f.h=s,f.setP(t,i,e,s,r,n,a,o,h,l,u,c),f};var g,A={x:0,y:0},y={x:0,y:0},x=[{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0}],m={};m.tip=0,m.inBool=!1,m.inBool1=!1,m.pBool=!1,m.arrPos=[{x:0,y:0},{x:0,y:0}],m.p={x:0,y:0},m.p1={x:0,y:0},this.isRectLine=function(t,i){if(A.x=i.o.p.x,A.y=i.o.p.y,y.x=i.o.p1.x,y.y=i.o.p1.y,x[0].x=t.x,x[0].y=t.y,x[1].x=t.x+t.w,x[1].y=t.y,x[2].x=t.x+t.w,x[2].y=t.y+t.h,x[3].x=t.x,x[3].y=t.y+t.h,m.tip=0,g=A.x>y.x?this.par.calc.isPointInLin(A,y,x[0],99999999999,99999999999):this.par.calc.isPointInLin(y,A,x[0],99999999999,99999999999),m.pBool=!0,g.z>0&&(m.pBool=!1),m.inBool=!1,t.x<=i.o.p.x&&t.x1>=i.o.p.x&&t.y<=i.o.p.y&&t.y1>=i.o.p.y&&(m.inBool=!0),m.inBool1=!1,t.x<=i.o.p1.x&&t.x1>=i.o.p1.x&&t.y<i.o.p1.y&&t.y1>=i.o.p1.y&&(m.inBool1=!0),1==m.inBool&&1==m.inBool1)return m.tip=3,m.p.x=i.o.p.x,m.p.y=i.o.p.y,m.p1.x=i.o.p1.x,m.p1.y=i.o.p1.y,m;let e=[];for(let t=0;t<x.length;t++){let i=this.par.calc.getPointOfIntersection(x[t],x[(t+1)%x.length],A,y);null!=i&&e.push({x:i.x,y:i.y})}if(m.tip=e.length>=2?2:e.length,e.length&&(m.arrPos[0]=e[0],1==m.inBool&&(m.arrPos[1].x=i.o.p.x,m.arrPos[1].y=i.o.p.y),1==m.inBool1&&(m.arrPos[1].x=i.o.p1.x,m.arrPos[1].y=i.o.p1.y),e.length>=2)){if(m.arrPos[0]=e[e.length-2],m.arrPos[1]=e[e.length-1],e.length>2){let t=function(t){for(var i=[],e=0;e<t.length;e++)i.some(function(i){return n(i,t[e])})||i.push(t[e]);return i}(e);m.arrPos=t}return m.p.x=m.arrPos[0].x,m.p.y=m.arrPos[0].y,m.p1.x=m.arrPos[1].x,m.p1.y=m.arrPos[1].y,m}return m.p.x=m.arrPos[0].x,m.p.y=m.arrPos[0].y,m.p1.x=m.arrPos[1].x,m.p1.y=m.arrPos[1].y,m};var v,b=[],w=[],P=[],_=0,S=0,I={};I.rx=0,I.ry=0,I.ax=[],I.ay=[],I.ar=[],I.arBig=[],this.setBoxInRect=function(t,i,e){v=!1,null!=e&&(v=e),b.length=0,w.length=0,P.length=0,_=0,S=0,b[0]=0,w[0]=0,t.x<i.x&&(_=b.length,b.push((i.x-t.x)/t.w)),t.x1>i.x1&&b.push((i.x1-t.x)/t.w),t.y<i.y&&(S=w.length,w.push((i.y-t.y)/t.h)),t.y1>i.y1&&w.push((i.y1-t.y)/t.h),b.push(1),w.push(1);for(var s=0;s<I.arBig.length;s++)delete I.arBig[s];I.arBig.length=0;for(s=0;s<w.length-1;s++){null==I.arBig[s]&&(I.arBig[s]=[]);for(var r=0;r<b.length-1;r++)(O=this.par.getR()).x=t.x+t.w*b[r],O.x1=t.x+t.w*b[r+1],O.w=O.x1-O.x,O.u=t.u+(t.u1-t.u)*b[r],O.u1=t.u+(t.u1-t.u)*b[r+1],O.y=t.y+t.h*w[s],O.y1=t.y+t.h*w[s+1],O.h=O.y1-O.y,O.v=t.v+(t.v1-t.v)*w[s],O.v1=t.v+(t.v1-t.v)*w[s+1],I.arBig[s][r]=O,0==s&&(O.bool[0]=t.bool[0]),0==r&&(O.bool[3]=t.bool[3]),s==w.length-2&&(O.bool[2]=t.bool[2]),r==b.length-2&&(O.bool[1]=t.bool[1]),0==s&&(O.bool1[0]=t.bool1[0]),0==r&&(O.bool1[3]=t.bool1[3]),s==w.length-2&&(O.bool1[2]=t.bool1[2]),r==b.length-2&&(O.bool1[1]=t.bool1[1]),r==_&&s==S?1==v&&P.push(O):(P.push(O),void 0===i.tipe&&(s==S&&(r+1==_&&(O.bool1[1]=!0),r-1==_&&(O.bool1[3]=!0)),r==_&&(s+1==S&&(O.bool1[2]=!0),s-1==S&&(O.bool1[0]=!0))))}for(r=0;r<P.length;r++)this.par.arrDin.push(P[r]);return I.rx=_,I.ry=S,I.ax=b,I.ay=w,I.ar=P,I},this.finalPro=function(){for(var t=this.par.arrDin.length-1;t>=0;t--)this.finalProBox(this.par.arrDin[t])},this.finalProBox=function(t){0!=t.w&&0!=t.h||this.par.removeDin(t)};var C,E,T=[],M=[],D=[];this.setGeomLine=function(t){T.length=0;for(var i=0;i<this.par.arrDin.length;i++)this.setGeomLineB(this.par.arrDin[i]);t.setAttribute("position",new THREE.Float32BufferAttribute(T,3))},this.setGeom=function(t,i){C=0,null!=i&&(C=i),T.length=0,M.length=0,D.length=0;for(var e=0;e<this.par.arrDin.length;e++)this.setGeomB(this.par.arrDin[e]);t.setAttribute("uv",new THREE.Float32BufferAttribute(M,2)),t.setAttribute("position",new THREE.Float32BufferAttribute(T,3)),t.setAttribute("normal",new THREE.Float32BufferAttribute(D,3)),t.computeBoundingBox(),t.computeBoundingSphere()},this.setGeomBool1=function(t,i,e){E=i/2,trace("distOt ",E),T.length=0,M.length=0,D.length=0;for(var s=0;s<this.par.arrDin.length;s++)this.setGB1(this.par.arrDin[s]);t.setAttribute("uv",new THREE.Float32BufferAttribute(M,2)),t.setAttribute("position",new THREE.Float32BufferAttribute(T,3)),t.setAttribute("normal",new THREE.Float32BufferAttribute(D,3)),t.computeBoundingBox(),t.computeBoundingSphere()};var R,L,O,B=new THREE.Vector3,j=new THREE.Vector3,F=new THREE.Vector3;this.setGB1=function(t){!0===t.bool1[0]&&(B.set(t.x,0,t.y),j.set(t.x+t.w,0,t.y),F.set(0,0,1),this.drawB1()),!0===t.bool1[1]&&(B.set(t.x+t.w,0,t.y),j.set(t.x+t.w,0,t.y+t.h),F.set(0,0,1),this.drawB1()),!0===t.bool1[2]&&(B.set(t.x+t.w,0,t.y+t.h),j.set(t.x,0,t.y+t.h),F.set(0,0,1),this.drawB1()),!0===t.bool1[3]&&(B.set(t.x,0,t.y+t.h),j.set(t.x,0,t.y),F.set(0,0,1),this.drawB1())},this.drawB1=function(){T.push(B.x,-E,B.z),T.push(B.x,E,B.z),T.push(j.x,-E,j.z),M.push(0,0),M.push(0,1),M.push(1,0),D.push(F.x,F.y,F.z),D.push(F.x,F.y,F.z),D.push(F.x,F.y,F.z),T.push(B.x,E,B.z),T.push(j.x,E,j.z),T.push(j.x,-E,j.z),M.push(0,1),M.push(1,1),M.push(1,0),D.push(F.x,F.y,F.z),D.push(F.x,F.y,F.z),D.push(F.x,F.y,F.z),T.push(B.x,E,B.z),T.push(B.x,-E,B.z),T.push(j.x,-E,j.z),M.push(0,1),M.push(0,0),M.push(1,0),D.push(-1*F.x,-1*F.y,-1*F.z),D.push(-1*F.x,-1*F.y,-1*F.z),D.push(-1*F.x,-1*F.y,-1*F.z),T.push(j.x,E,j.z),T.push(B.x,E,B.z),T.push(j.x,-E,j.z),M.push(1,1),M.push(0,1),M.push(1,0),D.push(-1*F.x,-1*F.y,-1*F.z),D.push(-1*F.x,-1*F.y,-1*F.z),D.push(-1*F.x,-1*F.y,-1*F.z)},this.drawStroke=function(t){if(t.sides.length){const{sides:i}=t;i.forEach(i=>{const{side:e,size:s,isLeft:r,isDown:n}=i;0===e&&T.push(r?t.x+t.w:t.x+t.w-s,t.y+t.h,0,r?t.x+s:t.x,t.y+t.h,0),1===e&&T.push(t.x,n?t.y+t.h-s:t.y+t.h,0,t.x,n?t.y:t.y+s,0),2===e&&T.push(r?t.x+s:t.x,t.y,0,r?t.x+t.w:t.x+t.w-s,t.y,0),3===e&&T.push(t.x+t.w,n?t.y:t.y+s,0,t.x+t.w,n?t.y+t.h-s:t.y+t.h,0)})}},this.setGeomLineB=function(t){!0!==t.bool[0]&&!0!==t.bool1[0]||T.push(t.x,t.y,0,t.x+t.w,t.y,0),!0!==t.bool[1]&&!0!==t.bool1[1]||T.push(t.x+t.w,t.y,0,t.x+t.w,t.y+t.h,0),!0!==t.bool[2]&&!0!==t.bool1[2]||T.push(t.x+t.w,t.y+t.h,0,t.x,t.y+t.h,0),!0!==t.bool[3]&&!0!==t.bool1[3]||T.push(t.x,t.y+t.h,0,t.x,t.y,0),1==t.boolNa&&(1==t.boolPoli?T.push(t.x,t.y,0,t.x+t.w,t.y+t.h,0):T.push(t.x+t.w,t.ysetGeom,0,t.x,t.y,0))},this.setGeomB=function(t){1==(R=t).boolPoli?0==R.boolNa?(this.sGm(1,0,2),this.sGm(0,3,2)):1==R.boolOt?this.sGm(1,0,2):this.sGm(0,3,2):0==R.boolNa?(this.sGm(2,1,3),this.sGm(3,1,0)):1==R.boolOt?this.sGm(2,1,3):this.sGm(3,1,0)},this.sGm=function(t,i,e){0==C&&(this.sGmL(t,!1),this.sGmL(i,!1),this.sGmL(e,!1)),1==C&&(this.sGmL(i,!0),this.sGmL(t,!0),this.sGmL(e,!0)),2==C&&(this.sGmL(t,!1),this.sGmL(i,!1),this.sGmL(e,!1),this.sGmL(i,!0),this.sGmL(t,!0),this.sGmL(e,!0))},this.sGmL=function(t,i){1==i?D.push(0,0,1):D.push(0,0,-1),0==t&&(T.push(R.x,R.y,0),M.push(R.u,R.v)),1==t&&(T.push(R.x+R.w,R.y,0),M.push(R.u1,R.v)),2==t&&(T.push(R.x+R.w,R.y+R.h,0),M.push(R.u1,R.v1)),3==t&&(T.push(R.x,R.y+R.h,0),M.push(R.u,R.v1))},this.arrLine=[],this.arrLineCesh=[],this.clearAL=function(){this.arrLine.length=0},this.getLine=function(){return null==this.arrLineCesh[this.arrLine.length]&&(this.arrLineCesh[this.arrLine.length]={p:{x:0,y:0},p1:{x:0,y:-100}}),this.arrLine.push(this.arrLineCesh[this.arrLine.length]),this.arrLine[this.arrLine.length-1]},this.getLine1=function(){this.clearAL();for(var t=this.par.arrDin.length-1;t>=0;t--)1==this.par.arrDin[t].boolNa?(O=this.par.arrDin[t],L=this.getLine(),1==O.boolPoli?this.setLine(O.x,O.y,O.x+O.w,O.y+O.h,L):this.setLine(O.x,O.y+O.h,O.x+O.w,O.y,L)):1==this.par.arrDin[t].bool[0]&&(L=this.getLine(),this.setLine(this.par.arrDin[t].x,this.par.arrDin[t].y,this.par.arrDin[t].x+this.par.arrDin[t].w,this.par.arrDin[t].y,L));return this.arrLine},this.setLine=function(t,i,e,s,r){r.p.x=t,r.p.y=i,r.p1.x=e,r.p1.y=s}}}function n(t,i){var e;for(e in t)if(t[e]!==i[e])return!1;for(e in i)if(i[e]!==t[e])return!1;return!0}class a{constructor(t){this.type="KRUColi";this.par=t,this.arrWinChesh=[];var i,e=0;this.getW=function(){return null==this.arrWinChesh[e]&&(this.arrWinChesh[e]=new o(this),this.arrWinChesh[e].idArr=e),e++,this.arrWinChesh[e-1]},this.korectRect=function(){e=0,this.par.arrWinDin.length=0;for(var t=0;t<this.par.arrWin.length;t++)(i=this.getW()).setRect(this.par.arrWin[t]),this.par.arrWinDin.push(i);if(null!=this.par.coliz)for(t=0;t<this.par.coliz.array.length;t++)for(var s=0;s<this.par.coliz.array[t].array.length;s++)(i=this.getW()).setShape(this.par.coliz.array[t].array[s],this.par.coliz.array[t],this.par.colizX,this.par.colizY),this.par.arrWinDin.push(i)}}}class o{constructor(){this.type="KRBodyRect";this.idArr=-1,this.x=0,this.y=0,this.w=100,this.h=100,this.x1=0,this.y1=0,this.setRect=function(t){this.x=t.x,this.y=t.y,this.w=t.w,this.h=t.h,this.x1=t.x+t.w,this.y1=t.y+t.h},this.setShape=function(t,i,e,s){this.x=t.rect.x+i.position.x+e,this.y=s-i.position.y,this.w=t.rect.w,this.h=t.rect.h,this.x1=this.x+this.w,this.y1=this.y+this.h}}}class h{constructor(){this.type="KRGronRect";var t;this.idArr=-1,this.x=0,this.y=0,this.w=1e3,this.h=1e3,this.u=0,this.v=0,this.u1=1,this.v1=1,this.sides=[],this.boolPoli=!0,this.boolNa=!1,this.boolOt=!1,this.bool=[!1,!1,!1,!1],this.bool1=[!1,!1,!1,!1],this.set=function(i){for(this.x=i.x,this.y=i.y,this.w=i.w,this.h=i.h,this.u=i.u,this.v=i.v,this.u1=i.u1,this.v1=i.v1,this.sides=i.sides,t=0;t<4;t++)this.bool[t]=i.bool[t],this.bool1[t]=i.bool1[t]},this.setP=function(t,i,e,s,r,n,a,o,h,l,u,c){this.x=t,this.y=i,this.w=e,this.h=s,this.bool[0]=r,this.bool[1]=n,this.bool[2]=a,this.bool[3]=o,this.sides=[],this.u=h,this.v=l,this.u1=u,this.v1=c},this.clear=function(){for(t=0;t<4;t++)this.bool[t]=!1,this.bool1[t]=!1;this.sides.length=0,this.boolPoli=!0,this.boolNa=!1,this.boolOt=!1}}}class l{constructor(){this.type="KRGronLine",this.tipe="KRGronLine";var t;this.idArr=-1,this.x=0,this.y=0,this.x1=0,this.y1=0,this.w=1e3,this.h=1e3,this.type=0,this.angel=0,this.o=void 0,this.setLine=function(i){this.o=i,this.type=0,this.angel=this.getAngle(i.p,i.p1)*(180/Math.PI),(t=Math.round(this.angel))>=0&&t<=90&&(this.type=1),t>=-180&&t<=-90&&(this.type=1),i.p.x==i.p.x1&&(this.type=2),i.p.y==i.p.y1&&(this.type=3),this.o=i,this.x=i.p.x,this.x1=i.p1.x,i.p1.x<this.x&&(this.x=i.p1.x,this.x1=i.p.x),this.w=this.x1-this.x,this.y=i.p.y,this.y1=i.p1.y,i.p1.y<this.y&&(this.y=i.p1.y,this.y1=i.p.y),this.h=this.y1-this.y},this.clear=function(){},this.getAngle=function(t,i){return i=i||rezNull,t=t||rezNull,Math.atan2(i.y-t.y,i.x-t.x)}}}e.d(i,"a",function(){return u});class u{constructor(t){this.type="KorektRect";var i,e,n,o,u,c,p,d;this.fun=t,this.boolDebug=!0,this.funRender=void 0,this.pS={x:0,y:0,w:100,h:100},this.rect={x:0,y:0,w:800,h:300},this.r={x:0,y:0,w:10,h:10,type:0},this.r1={x:0,y:0,w:10,h:10,type:0},this.array=[],this.arrayL=[],this.arrayCesh=[],this.arrDin=[],this.arrDinL=[],this.colizX=0,this.colizY=0,this.coliz=null,this.arrWin=[],this.arrWinDin=[],this.arrLine=[{p:{x:0,y:-100},p1:{x:0,y:-100}}],this.calc=new s.a,this.boolVergDrag=!1,this.krUmnik=new r(this),this.krUColi=new a(this),this.setSten=function(t,e,s){s=s||0,i=null!=t.width?t.width:t._distans,this.rect.x=-200,this.rect.w=i- -200+s,this.rect.x1=this.rect.x+this.rect.w,this.rect.y=0,this.rect.h=t.height,this.rect.h1=t.height1},this.removeDin=function(t){for(var i=!1,e=this.arrDin.length-1;e>=0;e--)this.arrDin[e].idArr==t.idArr&&(this.arrDin.splice(e,1),i=!0);return 1==i&&t.clear(),i},this.sah=0,this.setRect=function(t){this.rect=t},this.clear=function(){this.sah=0,this.sahL=0;for(var t=0;t<this.array.length;t++)this.array[t].clear();for(t=0;t<this.arrayL.length;t++)this.arrayL[t].clear()},this.getR=function(){return null==this.array[this.sah]&&(this.array[this.sah]=new h,this.array[this.sah].idArr=this.sah),this.sah++,this.array[this.sah-1]},this.sahL=0,this.getL=function(){return null==this.arrayL[this.sahL]&&(this.arrayL[this.sahL]=new l,this.arrayL[this.sahL].idArr=this.sah),this.sahL++,this.arrayL[this.sahL-1]},this.korektGrid=function(){this.boolVergDrag=!1,this.clear(),this.naStart(),this.reshik(),this.reshikLine(),this.finalPro(),this.render()},this.naStart=function(){this.krUmnik.naStart()},this.reshik=function(){this.krUColi.korectRect();for(var t=0;t<this.arrWinDin.length;t++)for(var i=this.arrDin.length-1;i>=0;i--)this.reshik2Old(i,this.arrDin[i],this.arrWinDin[t])},this.isRectInsideWindow=function(t,i){return t.x>=i.x&&t.x1<=i.x1&&t.y>=i.y&&t.y1<=i.y1},this.isAdjacent=function(t,i){const e=(t,i,e,s)=>e>=t&&e<=i||t>=e&&t<=s;let s=e(t.x,t.x1,i.x,i.x1),r=e(t.y,t.y1,i.y,i.y1);return(t.x1!=i.x||t.y1!=i.y)&&((t.x!=i.x1||t.y1!=i.y)&&((t.x1!=i.x||t.y!=i.y1)&&((t.x!=i.x1||t.y!=i.y1)&&!(!s||!r))))},this.getMatchEdges=((t,i)=>{const e=t.y1==i.y,s=t.y==i.y1,r=t.x1==i.x,n=t.x==i.x1,{sides:a}=t;let o,h,l,u;if(e||s){if(t.x==i.x&&t.x1==i.x1)return void a.push({size:0,side:e?0:2});if(t.x1<=i.x1&&t.x<i.x)return h=e?0:2,c=(i.x-t.x)/t.w,l=!0,o=t.w*c,void a.push({size:o,side:h,isLeft:l});if(t.x>=i.x&&t.x1>i.x1)return h=e?0:2,c=(i.x1-t.x)/t.w,p=t.w*c,l=!1,o=t.w-p,void a.push({size:o,side:h,isLeft:l});if(t.x<i.x&&(t.x1,i.x1),e&&t.y<i.y)return void a.push({size:0,side:0});if(s&&t.y1>i.y1)return void a.push({size:0,side:2})}if(r||n){if(t.y==i.y&&t.y1==i.y1)return void a.push({size:0,side:n?1:3});if(t.y1<=i.y1&&t.y<i.y)return h=n?1:3,c=(i.y-t.y)/t.h,o=t.h*c,u=!1,void a.push({size:o,side:h,isDown:u});if(t.y>=i.y&&t.y1>i.y1)return h=n?1:3,c=(i.y1-t.y)/t.h,p=t.h*c,o=t.h-p,u=!0,void a.push({side:h,size:o,isDown:u});if(n&&t.x1>i.x1)return void a.push({side:1,size:0});if(r&&t.x<i.x)return void a.push({side:3,size:0})}}),this.endCoords=function(t){t.x1=t.x+t.w,t.y1=t.y+t.h},this.rectIntersect=function(t,i){return i.y<t.y1&&i.y1>t.y&&i.x<t.x1&&i.x1>t.x},this.reshik2=function(t,i,e){if(this.endCoords(i),this.endCoords(e),this.isAdjacent(i,e)){if(this.isRectInsideWindow(i,e))return void this.arrDin.splice(t,1);if(this.getMatchEdges(i,e),!this.rectIntersect(i,e))return;return this.krUmnik.setBoxInRect(i,e),void this.arrDin.splice(t,1)}},this.testLine=function(t,i,e,s){return e>=t&&e<i||t>=e&&t<s},this.reshik2Old=function(t,i,s){if(i.x1=i.x+i.w,i.y1=i.y+i.h,s.x1=s.x+s.w,s.y1=s.y+s.h,e=this.testLine(i.x,i.x1,s.x,s.x1),n=this.testLine(i.y,i.y1,s.y,s.y1),o=!1,i.x>=s.x&&i.x1<=s.x1&&(o=!0),u=!1,i.y>=s.y&&i.y1<=s.y1&&(u=!0),1==e&&1==n){if(o&&u)return void this.arrDin.splice(t,1);if(1==u){if(i.x<s.x&&i.x1>s.x)return d=null,i.x1>s.x1&&((d=this.getR()).set(i),this.arrDin.push(d),d.x1=d.x+d.w,d.y1=d.y+d.h),c=(s.x-i.x)/i.w,i.w=i.w*c,i.u1=i.u+(i.u1-i.u)*c,i.bool1[1]=!0,i.bool[1]=!1,void(null!==d&&(c=(s.x1-d.x)/d.w,p=d.w*c,d.w=d.w-p,d.x+=p,d.u=d.u+(d.u1-d.u)*c,d.bool1[3]=!0,d.bool[3]=!1));if(i.x>s.x&&i.x<s.x1)return c=(s.x1-i.x)/i.w,p=i.w*c,i.w=i.w-p,i.x+=p,i.u=i.u+(i.u1-i.u)*c,i.bool1[3]=!0,void(i.bool[3]=!1)}if(1==o){if(i.y<s.y&&i.y1>s.y)return d=null,i.y1>s.y1&&((d=this.getR()).set(i),this.arrDin.push(d),d.x1=d.x1,d.y1=d.y1),c=(s.y-i.y)/i.h,i.h=i.h*c,i.v1=i.v+(i.v1-i.v)*c,i.bool1[2]=!0,i.bool[2]=!1,void(null!==d&&(c=(s.y1-d.y)/d.h,p=d.h*c,d.h=d.h-p,d.y+=p,d.v=d.v+(d.v1-d.v)*c,d.bool1[0]=!0,d.bool[0]=!1));if(i.y>s.y&&i.y<s.y1)return c=(s.y1-i.y)/i.h,p=i.h*c,i.h=i.h-p,i.y+=p,i.v=i.v+(i.v1-i.v)*c,i.bool1[0]=!0,void(i.bool[0]=!1)}return this.krUmnik.setBoxInRect(i,s),void this.arrDin.splice(t,1)}};var f,g={x:0,y:0,x1:0,y1:0,w:0,w:0,o:null};this.reshikLine=function(){var t,i;for(i=0;i<this.arrLine.length;i++)this.getL().setLine(this.arrLine[i]);for(i=0;i<this.sahL;i++)for(g=this.arrayL[i],t=this.arrDin.length-1;t>=0;t--)this.reshikLine1(t,this.arrDin[t],g)};var A,y,x,m=new l;this.reshikLine1=function(t,i,e){i.x1=i.x+i.w,i.y1=i.y+i.h,e.x>=i.x1||e.x1<=i.x||e.y1<=i.y||e.y>=i.y1&&1==this.nahVerh(t,i,e)||(0!=(f=this.krUmnik.isRectLine(i,e)).tip?(this.boolVergDrag=!0,3==f.tip&&1==this.nafigRect(t,i,e)||2!=f.tip&&1!=f.tip||(m.setLine(f),this.nafigRect(t,i,m))):1==f.pBool&&this.nahVerh(t,i,e))},this.nafigRect=function(t,i,e){if(A=this.krUmnik.setBoxInRect(i,e,!0),1==e.type){A.arBig[A.ry][A.rx].boolPoli=!0,A.arBig[A.ry][A.rx].boolNa=!0,A.arBig[A.ry][A.rx].boolOt=!1,null!=A.arBig[A.ry][A.rx-1]&&(A.arBig[A.ry][A.rx-1].bool1[1]=!1);for(var s=0;s<A.arBig.length;s++)A.arBig[s][A.rx+1]&&this.nahVerh(null,A.arBig[s][A.rx+1],g)}if(0==e.type){A.arBig[A.ry][A.rx].boolPoli=!1,A.arBig[A.ry][A.rx].boolNa=!0,A.arBig[A.ry][A.rx].boolOt=!0,null!=A.arBig[A.ry][A.rx+1]&&(A.arBig[A.ry][A.rx+1].bool1[3]=!1);for(s=0;s<A.arBig.length;s++)A.arBig[s][A.rx-1]&&this.nahVerh(null,A.arBig[s][A.rx-1],g)}return null!=A.arBig[A.ry+1]&&(A.arBig[A.ry+1][A.rx].bool1[0]=!1),null!=A.arBig[A.ry-1]&&(this.removeDin(A.arBig[A.ry-1][A.rx]),0==A.arBig[A.ry][A.rx].h&&null!=A.arBig[A.ry+1]&&(A.arBig[A.ry+1][A.rx].bool[0]=!0)),this.arrDin.splice(t,1),!0},this.nahVerh=function(t,i,e){return y=!1,i.x<e.x&&(y=!0),x=!0,i.x1<e.x1&&(x=!1),0==y&&0==x?(this.removeDin(i),!0):1==y&&0==x?(c=(e.x-i.x)/i.w,i.w=i.w*c,i.u1=i.u+(i.u1-i.u)*c,i.bool[1]=!1,!0):0==y&&1==x?(c=(e.x1-i.x)/i.w,p=i.w*c,i.w=i.w-p,i.x+=p,i.u=i.u+(i.u1-i.u)*c,i.bool[3]=!1,!0):1==y&&1==x&&((d=this.getR()).set(i),this.arrDin.push(d),d.x1=i.x1,d.y1=i.y1,c=(e.x1-d.x)/d.w,p=d.w*c,d.w=d.w-p,d.x+=p,d.u=d.u+(d.u1-d.u)*c,d.bool[3]=!1,c=(e.x-i.x)/i.w,i.w=i.w*c,i.u1=i.u+(i.u1-i.u)*c,i.bool[1]=!1,!0)},this.finalPro=function(){this.krUmnik.finalPro()},this.setGeomLine=function(t){this.krUmnik.setGeomLine(t)},this.setGeom=function(t,i){this.krUmnik.setGeom(t,i)},this.setGeomBool1=function(t,i,e){this.krUmnik.setGeomBool1(t,i,e)},this.getLine1=function(){return this.krUmnik.getLine1()},this.render=function(){0!=this.boolDebug&&null!=this.funRender&&this.funRender()}}}},function(t,i,e){"use strict";function s(t){var i=this;this.type="SpPoint",this.tipe="SpPoint",this.stage=t,this._life=!0,this.size2=10,this.size3=.001,this._uuid=calc.generateUUID(),this.arrSHronBaza=[],this.arrSHron=[],this.arrPol=[],this.arrIdSten=[],this.arrSten=[],this.arrayClass=[];var e,s,n=0;function a(t,i){if(t)for(var e=0;e<t.arrSHron.length;e++)i.push(t.arrSHron[e].sten)}function o(t,i){if(t)for(var e=0;e<t.arrSHron.length;e++)t.arrSHron[e].sten._addPoint&&i.push(t.arrSHron[e].sten._addPoint),t.arrSHron[e].sten._addPoint1&&i.push(t.arrSHron[e].sten._addPoint1)}function h(t){for(var i=0;i<t.length;i++){for(var e=!1,s=0;s<t.length;s++)if(i!==s&&t[s].uuid===t[i].uuid){e=!0;break}e&&t.splice(i--,1)}}this.creatSHron=function(){for(var t=0;t<this.arrSHronBaza.length;t++)if(0==this.arrSHronBaza[t].life)return this.arrSHronBaza[t].life=!0,this.arrSHronBaza[t];return this.arrSHronBaza.push(new r(this)),this.arrSHronBaza[this.arrSHronBaza.length-1]},this.addSplice=function(t,r){s=99999;for(var n=0;n<this.arrSHron.length;n++)this.arrSHron[n].sten.idArr==t.idArr&&(s=n);99999==s&&((e=this.creatSHron()).sten=t,e.storona=r,this.arrSHron.push(e),i.arrIdSten.push(t.idArr),1==r?t.addPoint=this:t.addPoint1=this,this.life=!0,this.drag()),this.stage.render(),null!=i.doFunRend&&i.doFunRend()},this.removeSplice=function(t){s=-1;for(var e=0;e<this.arrSHron.length;e++)this.arrSHron[e].sten.idArr==t.idArr&&(s=e);if(-1!=s){var r=this.arrSHron[s];return this.arrSHron.splice(s,1),r.clear(),this.arrIdSten.splice(s,1),this.drag(),r}return this.stage.render(),null!=i.doFunRend&&i.doFunRend(),null},this.addPol=function(t){this.arrPol.push(t),this.stage.render()},this.removePol=function(t){for(var i=null,e=0;e<this.arrPol.length;e++)t.idArr==this.arrPol[e].idArr&&(this.arrPol.splice(e,1),null==i&&(i=0),i++,t.removePoint(this),e=0);return 0==this.arrSHron.length&&0==this.arrPol.length&&this.clear(),this.stage.render(),i},this._heightNew=0,this.dragHeight,this.drag=function(){n=this.arrSHron.length;for(var t=0;t<n;t++)this.arrSHron[t].sten.calculateOld=this.arrSHron[t].sten.calculate,this.arrSHron[t].sten.calculate=!0,this.arrSHron[t].sten.height>this._heightNew&&(this._heightNew=this.arrSHron[t].sten.height);this.setPointNotDrag(this.position);for(var i=this.getConectedPoint(),e=0;e<i.length;e++)i[e].korektSH();this.dragView();for(t=0;t<n;t++)this.arrSHron[t].sten.calculate=this.arrSHron[t].sten.calculateOld,this.arrSHron[t].sten.drag();for(e=0;e<this.arrPol.length;e++)this.arrPol[e].drag(),this.arrPol[e].height>this._heightNew&&(this._heightNew=this.arrPol[e].height);this.dragHeight&&this.dragGG(),this.stage.render()},this.dragGG=function(){this._heightNew=0;for(var t=0;t<n;t++)this.arrSHron[t].sten.height>this._heightNew&&(this._heightNew=this.arrSHron[t].sten.height);for(var i=0;i<this.arrPol.length;i++)this.arrPol[i].height>this._heightNew&&(this._heightNew=this.arrPol[i].height);this.dragHeight&&this.dragHeight()},this.dragView=function(){for(var t=0;t<this.arrayClass.length;t++)this.arrayClass[t].drag&&this.arrayClass[t].drag()};var l=!1;this.korektSH=function(){if(!l){l=!0,g(!0);for(var t=0;t<this.arrSHron.length;t++)this.arrSHron[t].korektAngel();this.arrSHron.sort(A);for(t=0;t<this.arrSHron.length;t++)this.stage.spCalc.korektSHObject(this,t);g(!1),l=!1}};var u,c,p,d,f=null;function g(t){if(t)f=i.arrSHron.slice(),i.arrSHron=i.arrSHron.filter(function(t){var i=0===t.sten.tip?t.sten._delph/2:t.sten._delph;return t.sten.visible=t.sten._distans>i,t.sten.visible});else{i.arrSHron=f;for(var e=0;e<i.arrSHron.length;e++){var s=0===i.arrSHron[e].sten.tip?i.arrSHron[e].sten._delph/2:i.arrSHron[e].sten._delph;i.arrSHron[e].sten.visible=i.arrSHron[e].sten._distans>s}f=null}}function A(t,i){return t.rotation-i.rotation}this.setPointNotDrag=function(t){n=i.arrSHron.length,i.position._x=t.x,i.position._y=t.y;for(var e=0;e<n;e++){var s=i.arrSHron[e].sten.calculate;i.arrSHron[e].sten.calculate=!0,1==i.arrSHron[e].storona?(i.arrSHron[e].sten.position._x=t.x,i.arrSHron[e].sten.position._y=t.y):(i.arrSHron[e].sten.position1._x=t.x,i.arrSHron[e].sten.position1._y=t.y),i.arrSHron[e].sten.drag(),i.arrSHron[e].sten.calculate=s}},this.getConectedPoint=function(t){t=t||[this];for(var i=[],e=0;e<t.length;e++)o(t[e],i);return h(i),i},this.getConectedSten=function(t){t=t||[this];for(var i=[],e=0;e<t.length;e++)a(t[e],i);return h(i),i},this.funDragVokrug,this.dragVokrug=function(){for(var t=this.getConectedPoint(),i=this.getConectedSten(t),e=0;e<t.length;e++)t[e].korektSH(),t[e].dragView();for(e=0;e<i.length;e++)i[e].drag();this.funDragVokrug&&this.funDragVokrug(t,i)},this.doFunRend,this.drawposit=function(){null!=i.doFunRend&&i.doFunRend(),i.calculate||i.drag()},this.position=new PositionFun(0,0,this.drawposit),this.restart=function(){},this.clear=function(){if(this.life){if(2==this.arrSHron.length){this.arrStep=[];var t=this.stage.spCalc.getSten2AddPoint(this.arrSHron[0].sten,this),i=this.stage.spCalc.getSten2AddPoint(this.arrSHron[1].sten,this);if(-1!=this.getClonSten(-1,t,i))e=this.removeSplice(this.arrSHron[1].sten),s=this.removeSplice(this.arrSHron[0].sten),e.sten.clear(),s.sten.clear();else{t=this.arrSHron[0].sten._addPoint.idArr==this.idArr?this.arrSHron[0].sten._addPoint1:this.arrSHron[0].sten._addPoint;var e=this.removeSplice(this.arrSHron[1].sten),s=this.removeSplice(this.arrSHron[0].sten);e.sten._addPoint.idArr==this.idArr?(t.addSplice(e.sten,!0),1===e.sten.tip&&1===s.sten.tip&&e.sten.lineRange.p2.setPoint(s.sten._addPoint1.position)):(t.addSplice(e.sten,!1),1===e.sten.tip&&1===s.sten.tip&&e.sten.lineRange.p2.setPoint(s.sten._addPoint.position)),e.sten.addPoint1.drag(),e.sten.addPoint.drag(),this.life=!1,s.sten.clear()}}else{this.arrStep=[];for(var r=this.arrSHron.length-1;r>=0;r--){null!=(s=this.removeSplice(this.arrSHron[r].sten)).sten&&(s.sten.addPoint.idArr!=this.idArr&&s.sten.addPoint1.idArr!=this.idArr||(s.life=!1,s.sten.clear()))}}for(var n=0;n<this.arrayClass.length;n++)"function"==typeof this.arrayClass[n].clear&&this.arrayClass[n].clear();for(r=0;r<this.arrPol.length;r++)this.arrPol[r]&&this.removePol(this.arrPol[r]);this.life=!1,this.stage.render()}},this.clearFree=function(){0==this.arrSHron.length&&0==this.arrPol.length&&this.clear()},this.getClonSten=function(t,i,e){if(i&&e)for(var s=0;s<this.stage.arrSplice.length;s++){var r=this.stage.arrSplice[s];if(r.life&&(r.idArr!==t&&r.addPoint&&r.addPoint1)){if(r.addPoint.idArr===i.idArr&&r.addPoint1.idArr===e.idArr)return s;if(r.addPoint1.idArr===i.idArr&&r.addPoint.idArr===e.idArr)return s}}return-1},this.slitie=function(t){if(0!=this.life&&0!=t.life){for(var i=null,e=t.arrSHron.length-1;e>=0;e--)for(var s=0;s<this.arrSHron.length;s++)if(this.arrSHron[s].sten.idArr==t.arrSHron[e].sten.idArr&&this.arrSHron[s].sten._distans<2){i=this.arrSHron[s].sten;break}if(i){var r={};for(e=t.arrSHron.length-1;e>=0;e--)i.idArr==t.arrSHron[e].sten.idArr&&(r.sten=t.arrSHron[e].sten,r.storona=t.arrSHron[e].storona);t.removeSplice(i);for(e=this.arrSHron.length-1;e>=0;e--)i.idArr==this.arrSHron[e].sten.idArr&&(r.sten=this.arrSHron[e].sten,r.storona=this.arrSHron[e].storona);this.removeSplice(i)}var n=[];for(e=t.arrSHron.length-1;e>=0;e--)n.push(t.arrSHron[e]);for(e=0;e<n.length;e++)t.removeSplice(n[e].sten);for(e=0;e<n.length;e++)this.addSplice(n[e].sten,n[e].storona);i&&i.clear(),t.clear()}},this.arrDistRadom=[],this.miniDist=-1,this.miniId=-1,this.miniOkSlit=-1,this.testDistRadom=function(t){this.arrDistRadom=[],this.miniDist=1e17,this.miniId=-1,this.miniOkSlit=-1;for(var i=0;i<this.stage.arrPoint.length;i++){if(t){for(var e=!1,s=0;s<t.length;s++)if(t[s].idArr==this.stage.arrPoint[i].idArr){e=!0;break}if(e)continue}this.idArr==i?this.arrDistRadom.push(-1):0==this.stage.arrPoint[i].life?this.arrDistRadom.push(-1):(this.arrDistRadom.push(calc.getDistance(this.position,this.stage.arrPoint[i].position)),this.miniDist>this.arrDistRadom[this.arrDistRadom.length-1]&&(this.miniDist=this.arrDistRadom[this.arrDistRadom.length-1],this.miniId=i,this.miniDist<aidPointStatic.radius&&(this.miniOkSlit=i)))}},this.isGroup=function(t){for(var i=0;i<this.arrSHron.length;i++){if(this.arrSHron[i].sten.addPoint&&this.arrSHron[i].sten.addPoint.idArr==this.idArr&&this.arrSHron[i].sten.addPoint1&&this.arrSHron[i].sten.addPoint1.idArr==t)return!0;if(this.arrSHron[i].sten.addPoint1&&this.arrSHron[i].sten.addPoint1.idArr==this.idArr&&this.arrSHron[i].sten.addPoint&&this.arrSHron[i].sten.addPoint.idArr==t)return!0}return!1},this.finaldrag=function(){for(var t=this.arrSHron.slice(),i=t.length-1;i>=0;i--)for(var e=0;e<this.arrSHron.length;e++)if(this.arrSHron[e].sten.idArr==t[i].sten.idArr){t[i].sten.life&&this.stage.korektSplice.paralelSten(t[i].sten);break}},this.rectangle=new Rectangle,this.getRect=function(){return this.rectangle.x=this.position.x-10,this.rectangle.y=this.position.y-10,this.rectangle.width=20,this.rectangle.height=20,this.rectangle},this.compare=function(t){return u=!0,c=this.getObj(),p=t,calc.getDistance(c.position,p.position)>.1&&(u=!1),u},this.rememberState=function(){(d=this.getObj()).life=this.life},this.saveChanges=function(){d&&(!this.compare(d)||(this.life,d.life)),d=null};var y=new Rectangle(-1/0,-1/0,1/0,1/0);this.getBoundRect=function(){return y.x=this.position.x-this.size3,y.y=this.position.y-this.size3,y.width=2*this.size3,y.height=2*this.size3,y}}function r(t){this.life=!0,this.sten=void 0,this.storona=!0,this.aidPoint=t,this.rotation=0,this.bp=0,this.bp1=0,this.linePosition=new LinePosition,this.korektAngel=function(){this.linePosition.p.setPoint(this.aidPoint.position),1==this.storona?this.linePosition.p1.setPoint(this.sten.position1):this.linePosition.p1.setPoint(this.sten.position),this.linePosition.angel=calc.getAngle(this.linePosition.p,this.linePosition.p1),this.rotation=this.linePosition.angel+Math.PI},this.clear=function(){this.life=!1}}function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(){var t,i,e,s,r=new THREE.Vector3(0,0,0),a=new THREE.Vector3(0,0,0),o=new THREE.Vector3(0,0,0),l=new THREE.Vector3(0,0,0);this.DEG2RAD=Math.PI/180,this.RAD2DEG=180/Math.PI,this.getAngle=function(t,i){return i=i||l,t=t||l,Math.atan2(i.y-t.y,i.x-t.x)};var u,c,p,d,f,g,A,y,x,m=0;this.getAngle2=function(t,i){return i=i||l,t=t||l,(m=Math.atan2(i.y-t.y,i.x-t.x))<0&&(m+=2*Math.PI),m},this.getDistance=function(t,i){return null==t?0:(null==i&&(i=l),i=i||l,Math.sqrt(Math.pow(t.x-i.x,2)+Math.pow(t.y-i.y,2)))},this.getVector=function(t,i,e){if(null==e)e=new THREE.Vector2(0,0);return t<0&&(i+=Math.PI),e.x=Math.abs(t)*Math.cos(i),e.y=Math.abs(t)*Math.sin(i),e},this.isPointInLin=function(t,e,r,n,h){return this.getTreeAngel(t,e,r),h<0&&2*Math.abs(h)>s?null:a.x<=s+h&&a.x>=-h&&Math.abs(a.y)<=n?((o=a.x<0?this.getVector(a.x,i-Math.PI):this.getVector(a.x,i)).x+=e.x,o.y+=e.y,o.z=a.y,o):null},this.okrugPoint=function(t,i){null==i&&(i=100),t.x=Math.round(t.x/i)*i,t.y=Math.round(t.y/i)*i},this.okrugNumber=function(t,i){null==i&&(i=100);var e=Math.round(t*i)/i;return t=e,e},this.isInTriangle=function(t,i,e,s){var r=(t.x-s.x)*(i.y-t.y)-(i.x-t.x)*(t.y-s.y),n=(i.x-s.x)*(e.y-i.y)-(e.x-i.x)*(i.y-s.y),a=(e.x-s.x)*(t.y-e.y)-(t.x-e.x)*(e.y-s.y);return r>=0&&n>=0&&a>=0||r<=0&&n<=0&&a<=0},this.getTreeAngel=function(t,r,n,o){return i=this.getAngle(r,t),e=this.getAngle(r,n),u=this.getDistance(r,n),s=this.getDistance(t,r),this.getVector(u,e-i,a),e=this.getAngle(l,a),null==o?e:e>0?e:2*Math.PI+e},this.getTreeAngelPI2=function(t,i,e){x1=t.x-i.x,x2=e.x-i.x,y1=t.y-i.y,y2=e.y-i.y,s=Math.sqrt(x1*x1+y1*y1),d2=Math.sqrt(x2*x2+y2*y2);var r=(x1*x2+y1*y2)/(s*d2);return r>1&&(r=1),r<-1&&(r=-1),Math.acos(r)},this.isLineInTriangle=function(i,e,s,n,a){return(t=this.getPointOfIntersection(i,e,n,a))?(r.x=t.x,r.y=t.y,r.z=0,r):(t=this.getPointOfIntersection(e,s,n,a))?(r.x=t.x,r.y=t.y,r.z=1,r):!!(t=this.getPointOfIntersection(s,i,n,a))&&(r.x=t.x,r.y=t.y,r.z=2,r)};var v,b,w,P,_=new THREE.Vector2(0,0);this.getPointOfIntersection=function(t,i,e,s){return u=(t.x-i.x)*(s.y-e.y)-(t.y-i.y)*(s.x-e.x),c=(t.x-e.x)*(s.y-e.y)-(t.y-e.y)*(s.x-e.x),p=(t.x-i.x)*(t.y-e.y)-(t.y-i.y)*(t.x-e.x),f=p/u,(d=c/u)>=0&&d<=1&&f>=0&&f<=1?(g=t.x+d*(i.x-t.x),A=t.y+d*(i.y-t.y),_.x=g,_.y=A,_):null},this.korektToLine=function(t,i,e,s,r){y=this.getDistance(t,i),x=null==r?this.getAngle(t,i):r,0!=s&&(_=s<0?this.getVector(-s,x-Math.PI/2):this.getVector(s,x+Math.PI/2),t.x+=_.x,t.y+=_.y,i.x+=_.x,i.y+=_.y),_=this.getVector(e,x),i.x+=_.x,i.y+=_.y,_=this.getVector(e,x+Math.PI),t.x+=_.x,t.y+=_.y},this.getProsent3Point=function(t,i,e){return c=this.getDistance(t,i),(p=this.getDistance(t,e))/c},this.povotorOtAngel=function(t,i,e){return x=this.getAngle(t,i),y=this.getDistance(t,i),this.getVector(y,x+e)},this.testPositPoint=function(t,i,e){return null==e&&(e=100),Math.round(t.x*e)/e==Math.round(i.x*e)/e&&Math.round(t.y*e)/e==Math.round(i.y*e)/e},this.okrugAngel=function(t,i,e){var s=t;v=1,t<0&&(v=-1),b=Math.abs(t),w=Math.round(b/i)+1,P=0;for(var r=w;r>=0;r--){if(b>r*i-e&&b<r*i+e)return s=r*i*v;if(3==++P)return s}return s};var S=new h,I=new h,C=[];this.getLineCircleIntersectionPoints=function(t,i,e,s,r){C.length=0;var n=i.x-t.x,a=i.y-t.y,o=e.x-t.x,h=e.y-t.y,l=n*n+a*a,u=(n*o+a*h)/l,c=u*u-(o*o+h*h-s*s)/l;if(c<0)return C;var p=Math.sqrt(c),d=-u+p,f=-u-p;return S.set(t.x-n*d,t.y-a*d),this.isPointInLine(t,i,S)&&C.push(S),0==c?C:(I.set(t.x-n*f,t.y-a*f),this.isPointInLine(t,i,I)&&C.push(I),r&&2==C.length&&(v=this.getDistance(t,C[0]),b=this.getDistance(t,C[1]),v>b&&C.reverse()),C)},this.isPointInLine=function(t,i,e){var s=calc.getDistance(t,i),r=calc.getDistance(t,e),n=calc.getDistance(i,e);return calc.okrugNumber(r+n)===calc.okrugNumber(s)},this.getDistancePointToLine=function(t,i,e){var s=((i.y-t.y)*e.x-(i.x-t.x)*e.y+i.x*t.y-i.y*t.x)/calc.getDistance(t,i);return-calc.okrugNumber(Number.isFinite(s)?s:0)},this.getCircleCircleIntersectionPoints=function(t,i,e,s){var r,n,a,o,h;return C.length=0,(a=Math.sqrt(Math.pow(Math.abs(t.x-e.x),2)+Math.pow(Math.abs(t.y-e.y),2)))>i+s?C:(o=(i*i-s*s+a*a)/(2*a),h=Math.sqrt(Math.pow(i,2)-Math.pow(o,2)),isNaN(h)?C:(r=t.x+o*(e.x-t.x)/a,n=t.y+o*(e.y-t.y)/a,S.x=r+h*(e.y-t.y)/a,S.y=n-h*(e.x-t.x)/a,C.push(S),o==i?C:(I.x=r-h*(e.y-t.y)/a,I.y=n+h*(e.x-t.x)/a,C.push(I),C)))};var E=[new h,new h,new h,new h],T=[new h,new h,new h,new h];this.isIntersectionRect=function(t,i){return E[0].set(t.x,t.y),E[1].set(t.x+t.width,t.y),E[2].set(t.x+t.width,t.y+t.height),E[3].set(t.x,t.y+t.height),T[0].set(i.x,i.y),T[1].set(i.x+i.width,i.y),T[2].set(i.x+i.width,i.y+i.height),T[3].set(i.x,i.y+i.height),this.isIntersectionFromPoint(E,T)},this.isRectS=function(t,i){return 1==this.colisiLine2D(t.x,t.x+(null==t.w?t.width:t.w),i.x,i.x+(null==i.w?i.width:i.w))&&1==this.colisiLine2D(t.y,t.y+(null==t.h?t.height:t.h),i.y,i.y+(null==i.h?i.height:i.h))},this.colisiLine2D=function(t,i,e,s){return e>=t&&e<=i||t>=e&&t<=s},this.isRectPoint=function(t,i){return i.x>=t.x&&i.y>=t.y&&i.x<=t.x+(null==t.w?t.width:t.w)&&i.y<=t.y+(null==t.h?t.height:t.h)};var M=new h,D=new h;this.isRectLine=function(t,i,e){return 1==this.isRectPoint(t,i)||(1==this.isRectPoint(t,e)||(M.set(t.x,t.y),D.set(t.x+(null==t.w?t.width:t.w),t.y),null!=this.getPointOfIntersection(M,D,i,e)||(M.set(t.x+(null==t.w?t.width:t.w),t.y),D.set(t.x+(null==t.w?t.width:t.w),t.y+(null==t.h?t.height:t.h)),null!=this.getPointOfIntersection(M,D,i,e)||(M.set(t.x+(null==t.w?t.width:t.w),t.y+(null==t.h?t.height:t.h)),D.set(t.x,t.y+(null==t.h?t.height:t.h)),null!=this.getPointOfIntersection(M,D,i,e)||(M.set(t.x,t.y+(null==t.h?t.height:t.h)),D.set(t.x,t.y),null!=this.getPointOfIntersection(M,D,i,e))))))},this.isIntersectionFromPoint=function(t,i){for(var e=0;e<t.length-2;e++)for(var s=0;s<i.length-2;s++)if(calc.getPointOfIntersection(t[e],t[(e+2)%t.length],i[s],i[(s+2)%i.length]))return!0;for(e=0;e<t.length;e++)for(s=0;s<i.length;s++)if(calc.getPointOfIntersection(t[e],t[(e+1)%t.length],i[s],i[(s+1)%i.length]))return!0;for(e=0;e<i.length;e+=2)if(calc.contains(i[e].x,i[e].y,t))return!0;for(e=0;e<t.length;e+=2)if(calc.contains(t[e].x,t[e].y,i))return!0;return!1},this.isParalel=function(t,i,e,s,r){r=r||0;var n=Math.abs(calc.getAngle(t,i)%Math.PI),a=Math.abs(calc.getAngle(i,t)%Math.PI),o=Math.abs(calc.getAngle(e,s)%Math.PI),h=Math.abs(calc.getAngle(s,e)%Math.PI);return Math.min(Math.abs(n-o),Math.abs(a-h),Math.abs(n-h),Math.abs(a-o))<=r},this.rotationPoint=function(t,i,e){var s=0,r=0;e?(s=e.x+(t.x-e.x)*Math.cos(i)-(t.y-e.y)*Math.sin(i),r=e.y+(t.y-e.y)*Math.cos(i)+(t.x-e.x)*Math.sin(i)):(s=t.x*Math.cos(i)-t.y*Math.sin(i),r=t.y*Math.cos(i)+t.x*Math.sin(i)),t.x=s,t.y=r},this.rotationPointByLength=function(t,i,e){e=e||l;var s=calc.getDistance(t,e),r=calc.getLenghtCircle(s),n=i*(2*Math.PI/r);calc.rotationPoint(t,n,e)},this.isIntersectionTriangle=function(t,i,e,s,r,n){for(var a=!1,o=[t,i,e],h=[s,r,n],l=0;l<o.length&&!a;l++)a=calc.isInTriangle(s,r,n,o[l]);for(l=0;l<h.length&&!a;l++)a=calc.isInTriangle(t,i,e,h[l]);if(!a)for(l=0;l<o.length;l++)for(var u=0;u<h.length&&!a;u++)a=calc.getPointOfIntersection(o[l],o[(l+1)%o.length],h[u],h[(u+1)%h.length]);return a},this.getArrPointCircle=function(t,i,e,s,r,n,a){var o,l=calc.getAngle(e,t)-Math.PI,u=calc.getAngle(s,t)-Math.PI;o=a||[new h],r=r||5,!(n=n||!1)&&u<=l?u+=2*Math.PI:n&&l<=u&&(l+=2*Math.PI);var c=n?-1*(l-u):u-l,p=Math.ceil(Math.abs(c)/(2*Math.PI))*(r-1),d=c/(2*p),f=2*d,g=Math.cos(d),A=Math.sin(d),y=p-1,x=y%1/y,m=0,v=0,b=0,w=0,P=0;o[0].x=t.x+Math.cos(l)*i,o[0].y=t.y+Math.sin(l)*i;for(var _=0;_<=y;_++)m=d+l+(f*_+x*_),w=(g*(v=Math.cos(m))+A*(b=-Math.sin(m)))*i+t.x,P=(g*-b+A*v)*i+t.y,o[_+1]?(o[_+1].x=w,o[_+1].y=P):o.push(new h(w,P));return o},this.getLenghtCircle=function(t,i,e,s,r){i||(i=e=s=l);var n=calc.getAngle(e,i)-Math.PI,a=calc.getAngle(s,i)-Math.PI;return n===a&&e!==s?0:(!(r=r||!1)&&a<=n?a+=2*Math.PI:r&&n<=a&&(n+=2*Math.PI),Math.PI*t*(r?n-a:a-n)/Math.PI)},this.getLengthByWidth=function(t,i){var e=new h(0,0),s=new h(t,0),r=calc.getVector(i,.5*Math.PI);r.x=t/2;var n=calc.getCenterCircle(e,s,r);return n?calc.getLenghtCircle(calc.getDistance(n,e),n,e,s,i>0):t},this.getCenterCircle=function(t,i,e){var s=i.x-t.x,r=i.y-t.y,n=e.x-t.x,a=e.y-t.y,o=s*(t.x+i.x)+r*(t.y+i.y),l=n*(t.x+e.x)+a*(t.y+e.y),u=2*(s*(e.y-i.y)-r*(e.x-i.x));return 0===u?null:new h((a*o-r*l)/u,(s*l-n*o)/u)},this.getArcPoint=function(t,i,e,s,r){s=s||5;var n=calc.getAngle(t,i)+90*calc.DEG2RAD,a=calc.getVector(e,n),o=new h((t.x+i.x)/2,(t.y+i.y)/2);o.x+=a.x,o.y+=a.y;var l=calc.getCenterCircle(t,o,i);return l?calc.getArrPointCircle(l,calc.getDistance(l,t),t,i,s,e>0,r):[t,i]},this.getArea=function(t){for(var i=t.length,e=0,s=i-1,r=0;r<i;s=r++)e+=t[s].x*t[r].y-t[r].x*t[s].y;return.5*e||0},this.generateUUID=function(){for(var t=[],i=0;i<256;i++)t[i]=(i<16?"0":"")+i.toString(16);return function(){var i=4294967295*Math.random()|0,e=4294967295*Math.random()|0,s=4294967295*Math.random()|0,r=4294967295*Math.random()|0;return(t[255&i]+t[i>>8&255]+t[i>>16&255]+t[i>>24&255]+"-"+t[255&e]+t[e>>8&255]+"-"+t[e>>16&15|64]+t[e>>24&255]+"-"+t[63&s|128]+t[s>>8&255]+"-"+t[s>>16&255]+t[s>>24&255]+t[255&r]+t[r>>8&255]+t[r>>16&255]+t[r>>24&255]).toUpperCase()}}(),this.generateRendom=function(t){null==t&&(t=2);for(var i,e="",s="",r=0;r<t;r++){if((s=(255&(i=4294967295*Math.random()|0)).toString(16)+(i>>8&255).toString(16)+(i>>16&255).toString(16)+(i>>24&255).toString(16)).length<8)for(var n=0;n<8-s.length+1;n++)s+="Z";e+=s,r!=t-1&&(e+="-")}return e},this.diffNum=function(t,i){return t>=0&&i>=0?Math.abs(t-i):t<=0&&i<=0?Math.abs(Math.abs(t)-Math.abs(i)):t<=0&&i>=0?Math.abs(t)+i:t>=0&&i<=0?t+Math.abs(i):void 0},this.getPercentNum=function(t,i,e){return((t=null!=t?t:0)-(i=null!=i?i:0))/((e=null!=e?e:100)-i)*100},this.getValueNum=function(t,i,e){return(t=null!=t?t:0)/100*((e=null!=e?e:100)-(i=null!=i?i:0))+i},this.getValueBetween=function(t,i,e){var s=Math.max(i,e),r=Math.min(i,e);return Math.max(Math.min(t,s),r)},this.contains=function(t,i,e){for(var s=!1,r=e.length,n=0,a=r-1;n<r;a=n++){if(e[n].x===t&&e[n].y===i)return!0;var o=e[n].x,h=e[n].y,l=e[a].x,u=e[a].y;h>i!=u>i&&t<(l-o)*(i-h)/(u-h)+o&&(s=!s)}return s};var R={maxX:0,minX:0,maxY:0,minY:0},L=new h,O=[new h,new h,new h,new h],B=new h;this.getBoundsRect=function(t,i){B.set(t.width/2,t.height/2),O[0].set(0,0),O[1].set(t.width,0),O[2].set(t.width,t.height),O[3].set(0,t.height);for(var e=0;e<O.length;e++)this.rotationPoint(O[e],i,B);R.maxX=-t.width,R.minX=t.width,R.maxY=-t.height,R.minY=t.height;for(e=0;e<O.length;e++)R.maxX=Math.max(R.maxX,O[e].x),R.minX=Math.min(R.minX,O[e].x),R.maxY=Math.max(R.maxY,O[e].y),R.minY=Math.min(R.minY,O[e].y);return L.x=R.minX,L.y=R.minY,L.width=R.maxX-R.minX,L.height=R.maxY-R.minY,L},this.getCurvatureByWidth=function(t,i){if(Math.abs(t)>2*i)return null;var e=Math.pow(Math.abs(t),2),s=Math.pow(i,2),r=Math.acos((s+s-e)/(2*s));return i*(1-Math.cos(r/2))*(t<0?-1:1)},this.getWidthByCurvature=function(t,i){return 2*i*Math.sin(Math.acos(1-2*Math.abs(t)/(2*i)))*(t<0?-1:1)};function j(t){return t!==Object(t)}this.compare=function t(i,e){if(j(i)&&j(e))return i===e;for(var s in i){if(i.hasOwnProperty(s)!==e.hasOwnProperty(s))return!1;switch(n(i[s])){case"object":if(!t(i[s],e[s]))return!1;break;case"function":if(void 0===e[s]||"compare"!==s&&i[s].toString()!==e[s].toString())return!1;break;case"number":if(Number(Number(i[s]).toFixed(3))!==Number(Number(e[s]).toFixed(3)))return!1;break;default:if(i[s]!==e[s])return!1}}for(var s in e)if(i.hasOwnProperty(s)!==e.hasOwnProperty(s))return!1;return!0}}function o(t,i){this.p=t||new h,this.p1=i||new h,this.p2=new h,this.status=0,this.perpendik=!0,this.angel=0,this.set=function(t,i){this.p=t||0,this.p1=i||0}}function h(t,i,e){this._x=0,this._y=0,this._z=0,null!=t&&(this._x=t),null!=i&&(this._y=i),null!=e&&(this._z=e),this.set=function(t,i,e){this._x=t||0,this._y=i||0,void 0!==e&&(this._z=e)},this.setPoint=function(t){this._x=t.x,this._y=t.y,void 0!==t.z&&(this._z=t.z)},this.getObj=function(){var t={};return t.x=this._x,t.y=this._y,t.z=this._z,t},this.copy=function(){return new h(this._x,this._y,this._z)}}function l(t,i,e,s){this._x=t||0,this._y=i||0,this._z=0,this.fun="function"==typeof e?e:s,this.set=function(t,i,e){this._x=t||0,this._y=i||0,null!=e&&(this._z=e),this.fun&&this.fun()},this.setPoint=function(t){this._x=t.x,this._y=t.y,null!=t.z&&(this._z=t.z),this.fun&&this.fun()},this.getObj=function(){var t={};return t.x=this._x,t.y=this._y,t.z=this._z,t},this.copy=function(){return new l(this._x,this._y,this._z)}}function u(t,i,e,s,r){this._x=t||0,this._y=i||0,this._width=void 0!==e?e:100,this._height=void 0!==s?s:100,this.angel=0,this.p=new h,this.fun,this.set=function(t,i,e,s){this._x=t||0,this._y=i||0,this._width=void 0!==e?e:100,this._height=void 0!==s?s:100},this.setRect=function(t){this._x=t.x,this._y=t.y,this._width=t.width,this._height=t.height,this.p.setPoint(t.p),this.angel=t.angel}}function c(t){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function p(t){var i,e,r,n=this;this.type="Splice",this.tipe="Splice",this.stage=t,this.idArr=-1,this._life=!0,this._delph=20,this.delphMin=1,this.delphMax=1e7,this._tip=0,this.arrOpor=[],this._uuid=t.spCalc.generateUUID(),this.arrayClass=[],this.arrPosit=[new h,new h,new h,new h,new h,new h],this.arrPosit1=[new h,new h,new h,new h,new h,new h],this.bolPosit=!1,this.bolPosit1=!1,this._addPoint,this._addPoint1,this._rotation=0,this._distans=0,this._oporPointVisi=!0,this.rectangle=new u,this.drawposit=function(){n.drag()},this.position=new l(0,0,this.drawposit),this.position1=new l(0,0,this.drawposit),this._distans0=0,this._distans1=0,this.dL0=0,this.dL1=0,this.dR0=0,this.dR1=0,this.updateDistans01=function(){if(1===this.tip){this.lineRange.korectPoint2(this._delph/2,this.arrPosit[5],this.arrPosit1[5]),this._distans0=0;for(var t=1;t<this.lineRange.sahAngel;t++)this._distans0+=calc.getDistance(this.lineRange.arrPosit[t-1],this.lineRange.arrPosit[t]);this.lineRange.korectPoint2(this._delph/2,this.arrPosit[0],this.arrPosit1[0]),this._distans1=0;for(t=1;t<this.lineRange.sahAngel;t++)this._distans1+=calc.getDistance(this.lineRange.arrPosit[t-1],this.lineRange.arrPosit[t])}else this.dL0=this.arrPosit[0].x,this.dL0<this.arrPosit[1].x&&(this.dL0=this.arrPosit[1].x),this.dL1=this.arrPosit1[5].x,this.dL1<this.arrPosit1[4].x&&(this.dL1=this.arrPosit1[4].x),this.dR0=this.arrPosit[5].x,this.dR0<this.arrPosit[4].x&&(this.dR0=this.arrPosit[4].x),this.dR1=this.arrPosit1[0].x,this.dR1<this.arrPosit1[1].x&&(this.dR1=this.arrPosit1[1].x),this._distans0=this._distans+this.dL0+this.dL1,this._distans1=this._distans+this.dR0+this.dR1},this.clear=function(){this.arrState.length=0,this.addPoint&&(this.addPoint.removeSplice(this),this.addPoint.clearFree()),this.addPoint1&&(this.addPoint1.removeSplice(this),this.addPoint1.clearFree()),this.addPoint=void 0,this.addPoint1=void 0,a("clear"),this.life=!1,this.stage.render()};function a(t,i,e,s,r){for(var a=0;a<n.arrayClass.length;a++)"function"==typeof n.arrayClass[a][t]&&n.arrayClass[a][t](i,e,s,r)}this.dividedSten=function(t,n){if(!t||t instanceof s){if(t&&0==t.life)return t;if(null==t){var h=position2dFlor.getLocalIsStage();0==this._tip?(o=calc.isPointInLin(this.position,this.position1,h,9e6,9e6),(t=this.stage.craetPoint()).position.x=o.x,t.position.y=o.y):1==this._tip&&((t=this.stage.craetPoint()).position.x=h.x,t.position.y=h.y,r=this.isPointInLin(t.position),t.position.x=r.x,t.position.y=r.y)}if(a("beforDivid"),0==this._tip)(i=this.addPoint1).removeSplice(this),t.addSplice(this,!1),(e=this.stage.craetSplice()).setSten(this),t.addSplice(e,!0),i.addSplice(e,!1),t.drag();else if(1==this._tip){var l=this.lineRange.getLR(t.position,0),u=this.lineRange.getLR(t.position,1);(i=this.addPoint1).removeSplice(this),t.addSplice(this,!1),this.lineRange.setLR(l),(e=this.stage.craetSplice()).setSten(this),t.addSplice(e,!0),i.addSplice(e,!1),e.lineRange.setLR(u),t.position.x+=1e-6,t.dragVokrug()}return a("afterDivid",e),this.stage.render(),1==n?e:t}},this.restartTip=function(){1==this._tip&&(this.lineRange||(this.lineRange=new LineRange(40)),0==this.arrOpor.length&&this.arrOpor.push(new h),this.lineRange.p.setPoint(this.position),this.lineRange.p1.setPoint(this.position1),this.lineRange.upDate(),this.arrOpor[0].setPoint(this.lineRange.p2)),2==this._tip&&(this.arrOpor[0]||(this.arrOpor[0]=new h),this.arrOpor[1]||(this.arrOpor[1]=new h))},this._setAllParam=function(t,i){for(var e=0;e<n.arrayClass.length;e++)t in n.arrayClass[e]&&(n.arrayClass[e][t]=i)},this._callAllFun=a,this.isPointInLin=function(t,i,e,s){i=void 0===i?9e6:i,e=void 0===e?9e6:e;var r=null;if(0==this._tip)if(s){r=calc.isPointInLin(this.position,this.position1,t,i,0);var n=new h;n.setPoint(t),r&&n.setPoint(r),r||(r=calc.getDistance(this.position,n)<calc.getDistance(this.position1,n)?this.position:this.position1)}else r=calc.isPointInLin(this.position,this.position1,t,i,e);else 1==this._tip?r=this.lineRange.getPointInLineRange(t,i,e,s):window.console.warn("хз как isPointInLin",this._tip);return a("isPointInLin",t,i,e,r),r},this.getBoundRect=this.getRect=function(){if(this.rectangle.x=1/0,this.rectangle.y=1/0,this.rectangle.width=-1/0,this.rectangle.height=-1/0,0==this._tip){for(var t=0;t<this.arrPosit.length;t++)v(-this.arrPosit[t].x,this.arrPosit[t].y,!1);for(t=0;t<this.arrPosit1.length;t++)v(this.arrPosit1[t].x+this._distans,this.arrPosit1[t].y,!1)}else if(1==this._tip){this.lineRange.korectPoint2(this._delph/2),v(this.lineRange.arrPosit[0].x,this.lineRange.arrPosit[0].y,!0);for(t=1;t<this.lineRange.sahAngel;t++)v(this.lineRange.arrPosit[t].x,this.lineRange.arrPosit[t].y,!0);for(1==this.bolPosit1&&(v(this.arrPosit1[4].x,this.arrPosit1[4].y,!0),v(this.arrPosit1[3].x,this.arrPosit1[3].y,!0),v(this.arrPosit1[2].x,this.arrPosit1[2].y,!0),v(this.arrPosit1[1].x,this.arrPosit1[1].y,!0),v(this.arrPosit1[0].x,this.arrPosit1[0].y,!0)),this.lineRange.korectPoint2(-this._delph/2),t=this.lineRange.sahAngel-1;t>=0;t--)v(this.lineRange.arrPosit[t].x,this.lineRange.arrPosit[t].y,!0);1==this.bolPosit&&(v(this.arrPosit[0].x,this.arrPosit[0].y,!0),v(this.arrPosit[1].x,this.arrPosit[1].y,!0),v(this.arrPosit[2].x,this.arrPosit[2].y,!0),v(this.arrPosit[3].x,this.arrPosit[3].y,!0),v(this.arrPosit[4].x,this.arrPosit[4].y,!0))}else window.console.warn("хз как getRect",this._tip);return this.rectangle.width=this.rectangle.width-this.rectangle.x,this.rectangle.height=this.rectangle.height-this.rectangle.y,a("getRect",this.rectangle),this.rectangle},this.isColLine=function(t,i){if(0==this._tip)return calc.getPointOfIntersection(this.position,this.position1,t,i);if(1==this._tip){this.lineRange.korectPoint2(0);for(var e=1;e<this.lineRange.sahAngel-1;e++)if(calc.getPointOfIntersection(this.lineRange.arrPosit[e],this.lineRange.arrPosit[e+1],t,i))return!0}else window.console.warn("хз как isColLine",this._tip);return!1};var o,c=[new h,new h,new h,new h];this.isColRect=function(t){if(c[0].set(t.x,t.y),c[1].set(t.x+t.width,t.y),c[2].set(t.x+t.width,t.y+t.height),c[3].set(t.x,t.y+t.height),calc.isInTriangle(c[0],c[1],c[2],this.position))return!0;if(calc.isInTriangle(c[0],c[3],c[2],this.position))return!0;if(calc.isInTriangle(c[0],c[1],c[2],this.position1))return!0;if(calc.isInTriangle(c[0],c[3],c[2],this.position1))return!0;for(var i=0;i<c.length;i++)if(this.isColLine(c[i],c[(i+1)%c.length]))return!0;return!1},this.arrState=[],this.rememberState=function(){this.startObj=this.getObj(),calc.compare(this.startObj,this.arrState[this.arrState.length-1]||{})||this.arrState.push(this.startObj)},this.getLastState=function(){return this.arrState.pop()},this.saveChanges=function(){return o=!1},this.compareLastState=function(){};var p,d,f,g,A,y=new h,x=new h,m=new h;function v(t,i,e){0==e?(y.x=t,y.y=i,f=calc.getDistance(m,y),g=calc.getAngle(m,y),A=g+n._rotation,calc.getVector(f,A,x),x.x+=n.position.x,x.y+=n.position.y,p=x.x,d=x.y):(p=t,d=i),n.rectangle.x=Math.min(n.rectangle.x,p),n.rectangle.y=Math.min(n.rectangle.y,d),n.rectangle.width=Math.max(n.rectangle.width,p),n.rectangle.height=Math.max(n.rectangle.height,d)}function b(t,i){if(t)for(var e=0;e<t.arrSHron.length;e++)t.arrSHron[e].sten._addPoint&&i.push(t.arrSHron[e].sten._addPoint),t.arrSHron[e].sten._addPoint1&&i.push(t.arrSHron[e].sten._addPoint1)}function w(t,i){if(t)for(var e=0;e<t.arrSHron.length;e++)i.push(t.arrSHron[e].sten)}function P(t){for(var i=0;i<t.length;i++){for(var e=!1,s=0;s<t.length;s++)if(i!==s&&t[s].uuid===t[i].uuid){e=!0;break}e&&t.splice(i--,1)}}function _(t){for(var i=[],e=0;e<t.arrSHron.length;e++){var s=t.arrSHron[e].sten;i.push(s.uuid)}return i}this.dragVokrug=function(){var t=[],i=[];b(this._addPoint,t),b(this._addPoint1,t),P(t);for(var e=0;e<t.length;e++)w(t[e],i);P(i);for(e=0;e<i.length;e++)i[e].calculate=!0;for(e=0;e<t.length;e++)t[e].drag();for(e=0;e<t.length;e++)t[e].drag();for(e=0;e<i.length;e++)i[e].calculate=!1,i[e].drag()},this.getArrConectedSplice=function(){var t={};return t.arr=_(this.addPoint),t.arr1=_(this.addPoint1),t}}function d(t){var i;this.type="SpVLines",this.ractLocal={x:0,y:0,x1:0,y1:0,w:0,h:0},this.array=[],this.add=function(t,e){(i=new f(this)).idArr=this.array.length,i.os=this.array.length,t&&i.p.setPoint(t),e&&i.p1.setPoint(e),this.array.push(i)},this.object,this.setObject=function(t){if(this.object=t,"Splice"==this.object.tipe)for(var i=0;i<3;i++)this.add()},this.upDate=function(){"Splice"==this.object.tipe&&(this.array[0].setPoisit(0,0),this.array[0].setPoisit1(this.object._distans,0),this.array[0].corectLocel(this.object.position,this.object._rotation),this.array[1].setPoisit(-this.object.arrPosit[0].x,this.object.arrPosit[0].y),this.array[1].setPoisit1(this.object.arrPosit1[5].x+this.object._distans,this.object.arrPosit1[5].y),this.array[1].corectLocel(this.object.position,this.object._rotation),this.array[2].setPoisit(-this.object.arrPosit[5].x,this.object.arrPosit[5].y),this.array[2].setPoisit1(this.object.arrPosit1[0].x+this.object._distans,this.object.arrPosit1[0].y),this.array[2].corectLocel(this.object.position,this.object._rotation)),this.ractLocal.x=this.ractLocal.y=999999999,this.ractLocal.x1=this.ractLocal.y1=-999999999;for(var t=0;t<this.array.length;t++)this.array[t].setMinMax(this.ractLocal);this.ractLocal.w=this.ractLocal.x1-this.ractLocal.x,this.ractLocal.h=this.ractLocal.y1-this.ractLocal.y},this.drawDebug=function(t){if(t){for(var i=0;i<this.array.length;i++)t.lineStyle(1,16777215*Math.random(),.5),t.moveTo(this.array[i].pLoacel.x,this.array[i].pLoacel.y),t.lineTo(this.array[i].pLoacel1.x,this.array[i].pLoacel1.y);t.moveTo(this.ractLocal.x,this.ractLocal.y),t.lineTo(this.ractLocal.x1,this.ractLocal.y),t.lineTo(this.ractLocal.x1,this.ractLocal.y1),t.lineTo(this.ractLocal.x,this.ractLocal.y1),t.lineTo(this.ractLocal.x,this.ractLocal.y)}};var e,s,r,n,a,o,h,l,u,c,p={x:0,y:0,dist:0,os:0,pros:0,target:this},d=new THREE.Vector3(0,0,0),g=new THREE.Vector3(0,0,0);this.getPL=function(t,i){if(p.dist=9999999999,this.ractLocal.x-i<t.x&&this.ractLocal.x1+i>t.x&&this.ractLocal.y-i<t.y&&this.ractLocal.y1+i>t.y)for(var o=0;o<this.array.length;o++)null!=(a=this.isPointInLin(this.array[o].pLoacel,this.array[o].pLoacel1,t,i,i))&&(d.x=a.x,d.y=a.y,g.x=(this.array[o].pLoacel.x+this.array[o].pLoacel1.x)/2,g.y=(this.array[o].pLoacel.y+this.array[o].pLoacel1.y)/2,e=this.getDistance(d,this.array[o].pLoacel),s=this.getDistance(d,this.array[o].pLoacel1),r=this.getDistance(d,g),e<=i&&(d.x=this.array[o].pLoacel.x,d.y=this.array[o].pLoacel.y),s<=i&&(d.x=this.array[o].pLoacel1.x,d.y=this.array[o].pLoacel1.y),r<=i&&(d.x=g.x,d.y=g.y),n=this.getDistance(t,d),p.dist>n&&(e=this.getProsent3Point(this.array[o].pLoacel,this.array[o].pLoacel1,d),p.x=d.x,p.y=d.y,p.dist=n,p.os=o,p.pros=e,p.uuid=this.array[o].uuid,p.targetGron=this.array[o]));return 9999999999!=p.dist?p:null},this.getGronVP=function(t){for(var i=0;i<this.array.length;i++)if(this.array[i].uuid==t)return this.array[i];return null},this.testLine=function(t,i,e,s){return e>=t&&e<=i||t>=e&&t<=s},this.getAngle=function(t,i){return i=i||x,t=t||x,Math.atan2(i.y-t.y,i.x-t.x)},this.getDistance=function(t,i){return null==t?0:(null==i&&(i=x),i=i||x,Math.sqrt(Math.pow(t.x-i.x,2)+Math.pow(t.y-i.y,2)))},this.getVector=function(t,i,e){if(null==e)e=new THREE.Vector2(0,0);return t<0&&(i+=Math.PI),e.x=Math.abs(t)*Math.cos(i),e.y=Math.abs(t)*Math.sin(i),e},this.getTreeAngel=function(t,i,e,s){return o=this.getAngle(i,t),l=this.getAngle(i,e),h=this.getDistance(i,e),u=this.getDistance(t,i),this.getVector(h,l-o,A),l=this.getAngle(x,A),null==s?l:l>0?l:2*Math.PI+l},this.isPointInLin=function(t,i,e,s,r){return this.getTreeAngel(t,i,e),r<0&&2*Math.abs(r)>u?null:A.x<=u+r&&A.x>=-r&&Math.abs(A.y)<=s?((y=A.x<0?this.getVector(A.x,o-Math.PI):this.getVector(A.x,o)).x+=i.x,y.y+=i.y,y.z=A.y,y):null},this.getProsent3Point=function(t,i,e){return c=this.getDistance(t,i),this.getDistance(t,e)/c};new THREE.Vector3(0,0,0);var A=new THREE.Vector3(0,0,0),y=new THREE.Vector3(0,0,0),x=(new THREE.Vector3(0,0,0),new THREE.Vector3(0,0,0));this.generateRendom=function(t){null==t&&(t=2);for(var i,e="",s="",r=0;r<t;r++){if((s=(255&(i=4294967295*Math.random()|0)).toString(16)+(i>>8&255).toString(16)+(i>>16&255).toString(16)+(i>>24&255).toString(16)).length<8)for(var n=0;n<8-s.length+1;n++)s+="Z";e+=s,r!=t-1&&(e+="-")}return e},this.setObject(t),this.setObj=function(t){for(var i=0;i<t.array.length;i++)this.array[i]&&this.array[i].setObj(t.array[i])},this.getObj=function(){for(var t={array:[]},i=0;i<this.array.length;i++)t.array[i]=this.array[i].getObj();return t}}function f(t){var i,e,s,r,n;this.par=t,this.uuid=this.par.generateRendom(2),this.idArr=-1,this.os=-1,this.type="GronVL",this.pNull=new Position(0,0),this.p=new Position(0,0),this.p1=new Position(1e3,0),this.pLoacel=new Position(0,0),this.pLoacel1=new Position(1e3,0),this.distans=1e3,this.array=[],this.arrayChesh=[],this.setPoisit=function(t,i){this.p.x=t,this.p.y=i},this.setPoisit1=function(t,i){this.p1.x=t,this.p1.y=i},this.corectLocel=function(t,s){i=this.par.getAngle(this.pNull,this.p),e=this.par.getDistance(this.pNull,this.p),this.par.getVector(e,i+s,this.pLoacel),this.pLoacel.x+=t.x,this.pLoacel.y+=t.y,i=this.par.getAngle(this.pNull,this.p1),e=this.par.getDistance(this.pNull,this.p1),this.par.getVector(e,i+s,this.pLoacel1),this.pLoacel1.x+=t.x,this.pLoacel1.y+=t.y,this.distans=this.par.getDistance(this.p,this.p1),this.dragPoint()},this.setMinMax=function(t){this.pLoacel.x<t.x&&(t.x=this.pLoacel.x),this.pLoacel1.x<t.x&&(t.x=this.pLoacel1.x),this.pLoacel.x>t.x1&&(t.x1=this.pLoacel.x),this.pLoacel1.x>t.x1&&(t.x1=this.pLoacel1.x),this.pLoacel.y<t.y&&(t.y=this.pLoacel.y),this.pLoacel1.y<t.y&&(t.y=this.pLoacel1.y),this.pLoacel.y>t.y1&&(t.y1=this.pLoacel.y),this.pLoacel1.y>t.y1&&(t.y1=this.pLoacel1.y)},this.dragPoint=function(t){for(var i=0;i<this.array.length;i++)0!=this.array[i].life&&(s=this.pLoacel.x*(1-this.array[i].pros)+this.pLoacel1.x*this.array[i].pros,r=this.pLoacel.y*(1-this.array[i].pros)+this.pLoacel1.y*this.array[i].pros,this.array[i].obj.position.set(s,r))},this.remove=function(t){if(!1,null!=t.gronVL)for(var i=this.array.length-1;i>=0;i--)this.array[i].obj.uuid==t.uuid&&(this.array[i].remove(t),this.array.splice(i,1),!0);return!1},this.add=function(t){return trace("add",t.uuid),(n=this.getBox()).add(t),this.array.push(n),n},this.getBox=function(){for(var t=0;t<this.arrayChesh.length;t++)if(0==this.arrayChesh[t].life)return this.arrayChesh[t];return this.arrayChesh.push(new g(this)),this.arrayChesh[this.arrayChesh.length-1].idArr=this.arrayChesh.length-1,this.arrayChesh[this.arrayChesh.length-1]},this.setObj=function(t){this.uuid=t.uuid},this.getObj=function(){var t={};return t.uuid=this.uuid,t}}function g(t){this.life=!1,this.type="GronVLBox",this.par=t,this.pros=0,this.os=0,this.obj,this.add=function(t){this.life=!0,this.obj=t,this.obj.gronVL=this},this.remove=function(t){this.life=!1,this.obj.gronVL=void 0,this.par.remove(t),this.obj=void 0}}function A(t){return(A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function y(){var t,i,e,s,r=new THREE.Vector3(0,0,0),n=new THREE.Vector3(0,0,0),a=new THREE.Vector3(0,0,0),o=new THREE.Vector3(0,0,0);this.DEG2RAD=Math.PI/180,this.RAD2DEG=180/Math.PI,this.getAngle=function(t,i){return i=i||o,t=t||o,Math.atan2(i.y-t.y,i.x-t.x)};var h,l,u,c,p,d,f,g,y,m=0;this.getAngle2=function(t,i){return i=i||o,t=t||o,(m=Math.atan2(i.y-t.y,i.x-t.x))<0&&(m+=2*Math.PI),m},this.getDistance=function(t,i){return null==t?0:(null==i&&(i=o),i=i||o,Math.sqrt(Math.pow(t.x-i.x,2)+Math.pow(t.y-i.y,2)))},this.getVector=function(t,i,e){if(null==e)e=new THREE.Vector2(0,0);return t<0&&(i+=Math.PI),e.x=Math.abs(t)*Math.cos(i),e.y=Math.abs(t)*Math.sin(i),e},this.isPointInLin=function(t,e,r,o,h){return this.getTreeAngel(t,e,r),h<0&&2*Math.abs(h)>s?null:n.x<=s+h&&n.x>=-h&&Math.abs(n.y)<=o?((a=n.x<0?this.getVector(n.x,i-Math.PI):this.getVector(n.x,i)).x+=e.x,a.y+=e.y,a.z=n.y,a):null},this.okrugPoint=function(t,i){null==i&&(i=100),t.x=Math.round(t.x/i)*i,t.y=Math.round(t.y/i)*i},this.okrugNumber=function(t,i){null==i&&(i=100);var e=Math.round(t*i)/i;return t=e,e},this.isInTriangle=function(t,i,e,s){var r=(t.x-s.x)*(i.y-t.y)-(i.x-t.x)*(t.y-s.y),n=(i.x-s.x)*(e.y-i.y)-(e.x-i.x)*(i.y-s.y),a=(e.x-s.x)*(t.y-e.y)-(t.x-e.x)*(e.y-s.y);return r>=0&&n>=0&&a>=0||r<=0&&n<=0&&a<=0},this.getTreeAngel=function(t,r,a,l){return i=this.getAngle(r,t),e=this.getAngle(r,a),h=this.getDistance(r,a),s=this.getDistance(t,r),this.getVector(h,e-i,n),e=this.getAngle(o,n),null==l?e:e>0?e:2*Math.PI+e},this.getTreeAngelPI2=function(t,i,e){x1=t.x-i.x,x2=e.x-i.x,y1=t.y-i.y,y2=e.y-i.y,s=Math.sqrt(x1*x1+y1*y1),d2=Math.sqrt(x2*x2+y2*y2);var r=(x1*x2+y1*y2)/(s*d2);return r>1&&(r=1),r<-1&&(r=-1),Math.acos(r)},this.isLineInTriangle=function(i,e,s,n,a){return(t=this.getPointOfIntersection(i,e,n,a))?(r.x=t.x,r.y=t.y,r.z=0,r):(t=this.getPointOfIntersection(e,s,n,a))?(r.x=t.x,r.y=t.y,r.z=1,r):!!(t=this.getPointOfIntersection(s,i,n,a))&&(r.x=t.x,r.y=t.y,r.z=2,r)};var v,b,w,P,_=new THREE.Vector2(0,0);this.getPointOfIntersection=function(t,i,e,s){return h=(t.x-i.x)*(s.y-e.y)-(t.y-i.y)*(s.x-e.x),l=(t.x-e.x)*(s.y-e.y)-(t.y-e.y)*(s.x-e.x),u=(t.x-i.x)*(t.y-e.y)-(t.y-i.y)*(t.x-e.x),p=u/h,(c=l/h)>=0&&c<=1&&p>=0&&p<=1?(d=t.x+c*(i.x-t.x),f=t.y+c*(i.y-t.y),_.x=d,_.y=f,_):null},this.korektToLine=function(t,i,e,s,r){g=this.getDistance(t,i),y=null==r?this.getAngle(t,i):r,0!=s&&(_=s<0?this.getVector(-s,y-Math.PI/2):this.getVector(s,y+Math.PI/2),t.x+=_.x,t.y+=_.y,i.x+=_.x,i.y+=_.y),_=this.getVector(e,y),i.x+=_.x,i.y+=_.y,_=this.getVector(e,y+Math.PI),t.x+=_.x,t.y+=_.y},this.getProsent3Point=function(t,i,e){return l=this.getDistance(t,i),(u=this.getDistance(t,e))/l},this.povotorOtAngel=function(t,i,e){return y=this.getAngle(t,i),g=this.getDistance(t,i),this.getVector(g,y+e)},this.testPositPoint=function(t,i,e){return null==e&&(e=100),Math.round(t.x*e)/e==Math.round(i.x*e)/e&&Math.round(t.y*e)/e==Math.round(i.y*e)/e},this.okrugAngel=function(t,i,e){var s=t;v=1,t<0&&(v=-1),b=Math.abs(t),w=Math.round(b/i)+1,P=0;for(var r=w;r>=0;r--){if(b>r*i-e&&b<r*i+e)return s=r*i*v;if(3==++P)return s}return s};var S=new x,I=new x,C=[];this.getLineCircleIntersectionPoints=function(t,i,e,s,r){C.length=0;var n=i.x-t.x,a=i.y-t.y,o=e.x-t.x,h=e.y-t.y,l=n*n+a*a,u=(n*o+a*h)/l,c=u*u-(o*o+h*h-s*s)/l;if(c<0)return C;var p=Math.sqrt(c),d=-u+p,f=-u-p;return S.set(t.x-n*d,t.y-a*d),this.isPointInLine(t,i,S)&&C.push(S),0==c?C:(I.set(t.x-n*f,t.y-a*f),this.isPointInLine(t,i,I)&&C.push(I),r&&2==C.length&&(v=this.getDistance(t,C[0]),b=this.getDistance(t,C[1]),v>b&&C.reverse()),C)},this.isPointInLine=function(t,i,e){var s=this.getDistance(t,i),r=this.getDistance(t,e),n=this.getDistance(i,e);return this.okrugNumber(r+n)===this.okrugNumber(s)},this.getDistancePointToLine=function(t,i,e){var s=((i.y-t.y)*e.x-(i.x-t.x)*e.y+i.x*t.y-i.y*t.x)/this.getDistance(t,i);return-this.okrugNumber(Number.isFinite(s)?s:0)},this.getCircleCircleIntersectionPoints=function(t,i,e,s){var r,n,a,o,h;return C.length=0,(a=Math.sqrt(Math.pow(Math.abs(t.x-e.x),2)+Math.pow(Math.abs(t.y-e.y),2)))>i+s?C:(o=(i*i-s*s+a*a)/(2*a),h=Math.sqrt(Math.pow(i,2)-Math.pow(o,2)),isNaN(h)?C:(r=t.x+o*(e.x-t.x)/a,n=t.y+o*(e.y-t.y)/a,S.x=r+h*(e.y-t.y)/a,S.y=n-h*(e.x-t.x)/a,C.push(S),o==i?C:(I.x=r-h*(e.y-t.y)/a,I.y=n+h*(e.x-t.x)/a,C.push(I),C)))};var E=[new x,new x,new x,new x],T=[new x,new x,new x,new x];this.isIntersectionRect=function(t,i){return E[0].set(t.x,t.y),E[1].set(t.x+t.width,t.y),E[2].set(t.x+t.width,t.y+t.height),E[3].set(t.x,t.y+t.height),T[0].set(i.x,i.y),T[1].set(i.x+i.width,i.y),T[2].set(i.x+i.width,i.y+i.height),T[3].set(i.x,i.y+i.height),this.isIntersectionFromPoint(E,T)},this.isIntersectionFromPoint=function(t,i){for(var e=0;e<t.length-2;e++)for(var s=0;s<i.length-2;s++)if(this.getPointOfIntersection(t[e],t[(e+2)%t.length],i[s],i[(s+2)%i.length]))return!0;for(e=0;e<t.length;e++)for(s=0;s<i.length;s++)if(this.getPointOfIntersection(t[e],t[(e+1)%t.length],i[s],i[(s+1)%i.length]))return!0;for(e=0;e<i.length;e+=2)if(this.contains(i[e].x,i[e].y,t))return!0;for(e=0;e<t.length;e+=2)if(this.contains(t[e].x,t[e].y,i))return!0;return!1},this.isParalel=function(t,i,e,s,r){r=r||0;var n=Math.abs(this.getAngle(t,i)%Math.PI),a=Math.abs(this.getAngle(i,t)%Math.PI),o=Math.abs(this.getAngle(e,s)%Math.PI),h=Math.abs(this.getAngle(s,e)%Math.PI);return Math.min(Math.abs(n-o),Math.abs(a-h),Math.abs(n-h),Math.abs(a-o))<=r},this.rotationPoint=function(t,i,e){var s=0,r=0;e?(s=e.x+(t.x-e.x)*Math.cos(i)-(t.y-e.y)*Math.sin(i),r=e.y+(t.y-e.y)*Math.cos(i)+(t.x-e.x)*Math.sin(i)):(s=t.x*Math.cos(i)-t.y*Math.sin(i),r=t.y*Math.cos(i)+t.x*Math.sin(i)),t.x=s,t.y=r},this.rotationPointByLength=function(t,i,e){e=e||o;var s=this.getDistance(t,e),r=this.getLenghtCircle(s),n=i*(2*Math.PI/r);this.rotationPoint(t,n,e)},this.isIntersectionTriangle=function(t,i,e,s,r,n){for(var a=!1,o=[t,i,e],h=[s,r,n],l=0;l<o.length&&!a;l++)a=this.isInTriangle(s,r,n,o[l]);for(l=0;l<h.length&&!a;l++)a=this.isInTriangle(t,i,e,h[l]);if(!a)for(l=0;l<o.length;l++)for(var u=0;u<h.length&&!a;u++)a=this.getPointOfIntersection(o[l],o[(l+1)%o.length],h[u],h[(u+1)%h.length]);return a},this.getArrPointCircle=function(t,i,e,s,r,n,a){var o,h=this.getAngle(e,t)-Math.PI,l=this.getAngle(s,t)-Math.PI;o=a||[new x],r=r||5,!(n=n||!1)&&l<=h?l+=2*Math.PI:n&&h<=l&&(h+=2*Math.PI);var u=n?-1*(h-l):l-h,c=Math.ceil(Math.abs(u)/(2*Math.PI))*(r-1),p=u/(2*c),d=2*p,f=Math.cos(p),g=Math.sin(p),A=c-1,y=A%1/A,m=0,v=0,b=0,w=0,P=0;o[0].x=t.x+Math.cos(h)*i,o[0].y=t.y+Math.sin(h)*i;for(var _=0;_<=A;_++)m=p+h+(d*_+y*_),w=(f*(v=Math.cos(m))+g*(b=-Math.sin(m)))*i+t.x,P=(f*-b+g*v)*i+t.y,o[_+1]?(o[_+1].x=w,o[_+1].y=P):o.push(new x(w,P));return o},this.getLenghtCircle=function(t,i,e,s,r){i||(i=e=s=o);var n=this.getAngle(e,i)-Math.PI,a=this.getAngle(s,i)-Math.PI;return n===a&&e!==s?0:(!(r=r||!1)&&a<=n?a+=2*Math.PI:r&&n<=a&&(n+=2*Math.PI),Math.PI*t*(r?n-a:a-n)/Math.PI)},this.getLengthByWidth=function(t,i){var e=new x(0,0),s=new x(t,0),r=this.getVector(i,.5*Math.PI);r.x=t/2;var n=this.getCenterCircle(e,s,r);return n?this.getLenghtCircle(this.getDistance(n,e),n,e,s,i>0):t},this.getCenterCircle=function(t,i,e){var s=i.x-t.x,r=i.y-t.y,n=e.x-t.x,a=e.y-t.y,o=s*(t.x+i.x)+r*(t.y+i.y),h=n*(t.x+e.x)+a*(t.y+e.y),l=2*(s*(e.y-i.y)-r*(e.x-i.x));return 0===l?null:new x((a*o-r*h)/l,(s*h-n*o)/l)},this.getArcPoint=function(t,i,e,s,r){s=s||5;var n=this.getAngle(t,i)+90*this.DEG2RAD,a=this.getVector(e,n),o=new x((t.x+i.x)/2,(t.y+i.y)/2);o.x+=a.x,o.y+=a.y;var h=this.getCenterCircle(t,o,i);return h?this.getArrPointCircle(h,this.getDistance(h,t),t,i,s,e>0,r):[t,i]},this.getArea=function(t){for(var i=t.length,e=0,s=i-1,r=0;r<i;s=r++)e+=t[s].x*t[r].y-t[r].x*t[s].y;return.5*e||0},this.generateUUID=function(){for(var t=[],i=0;i<256;i++)t[i]=(i<16?"0":"")+i.toString(16);return function(){var i=4294967295*Math.random()|0,e=4294967295*Math.random()|0,s=4294967295*Math.random()|0,r=4294967295*Math.random()|0;return(t[255&i]+t[i>>8&255]+t[i>>16&255]+t[i>>24&255]+"-"+t[255&e]+t[e>>8&255]+"-"+t[e>>16&15|64]+t[e>>24&255]+"-"+t[63&s|128]+t[s>>8&255]+"-"+t[s>>16&255]+t[s>>24&255]+t[255&r]+t[r>>8&255]+t[r>>16&255]+t[r>>24&255]).toUpperCase()}}(),this.generateRendom=function(t){null==t&&(t=2);for(var i,e="",s="",r=0;r<t;r++){if((s=(255&(i=4294967295*Math.random()|0)).toString(16)+(i>>8&255).toString(16)+(i>>16&255).toString(16)+(i>>24&255).toString(16)).length<8)for(var n=0;n<8-s.length+1;n++)s+="Z";e+=s,r!=t-1&&(e+="-")}return e},this.diffNum=function(t,i){return t>=0&&i>=0?Math.abs(t-i):t<=0&&i<=0?Math.abs(Math.abs(t)-Math.abs(i)):t<=0&&i>=0?Math.abs(t)+i:t>=0&&i<=0?t+Math.abs(i):void 0},this.getPercentNum=function(t,i,e){return((t=null!=t?t:0)-(i=null!=i?i:0))/((e=null!=e?e:100)-i)*100},this.getValueNum=function(t,i,e){return(t=null!=t?t:0)/100*((e=null!=e?e:100)-(i=null!=i?i:0))+i},this.getValueBetween=function(t,i,e){var s=Math.max(i,e),r=Math.min(i,e);return Math.max(Math.min(t,s),r)},this.contains=function(t,i,e){for(var s=!1,r=e.length,n=0,a=r-1;n<r;a=n++){if(e[n].x===t&&e[n].y===i)return!0;var o=e[n].x,h=e[n].y,l=e[a].x,u=e[a].y;h>i!=u>i&&t<(l-o)*(i-h)/(u-h)+o&&(s=!s)}return s};var M={maxX:0,minX:0,maxY:0,minY:0},D=new x,R=[new x,new x,new x,new x],L=new x;this.getBoundsRect=function(t,i){L.set(t.width/2,t.height/2),R[0].set(0,0),R[1].set(t.width,0),R[2].set(t.width,t.height),R[3].set(0,t.height);for(var e=0;e<R.length;e++)this.rotationPoint(R[e],i,L);M.maxX=-t.width,M.minX=t.width,M.maxY=-t.height,M.minY=t.height;for(e=0;e<R.length;e++)M.maxX=Math.max(M.maxX,R[e].x),M.minX=Math.min(M.minX,R[e].x),M.maxY=Math.max(M.maxY,R[e].y),M.minY=Math.min(M.minY,R[e].y);return D.x=M.minX,D.y=M.minY,D.width=M.maxX-M.minX,D.height=M.maxY-M.minY,D},this.getCurvatureByWidth=function(t,i){if(Math.abs(t)>2*i)return null;var e=Math.pow(Math.abs(t),2),s=Math.pow(i,2),r=Math.acos((s+s-e)/(2*s));return i*(1-Math.cos(r/2))*(t<0?-1:1)},this.getWidthByCurvature=function(t,i){return 2*i*Math.sin(Math.acos(1-2*Math.abs(t)/(2*i)))*(t<0?-1:1)};function O(t){return t!==Object(t)}this.compare=function t(i,e){if(O(i)&&O(e))return i===e;for(var s in i){if(i.hasOwnProperty(s)!==e.hasOwnProperty(s))return!1;switch(A(i[s])){case"object":if(!t(i[s],e[s]))return!1;break;case"function":if(void 0===e[s]||"compare"!==s&&i[s].toString()!==e[s].toString())return!1;break;case"number":if(Number(Number(i[s]).toFixed(3))!==Number(Number(e[s]).toFixed(3)))return!1;break;default:if(i[s]!==e[s])return!1}}for(var s in e)if(i.hasOwnProperty(s)!==e.hasOwnProperty(s))return!1;return!0}}function x(t,i,e){this._x=t||0,this._y=i||0,this._z=e||0,this.set=function(t,i,e){this._x=t||0,this._y=i||0,void 0!==e&&(this._z=e)},this.setPoint=function(t){this._x=t.x,this._y=t.y,void 0!==t.z&&(this._z=t.z)},this.getObj=function(){var t={};return t.x=this._x,t.y=this._y,t.z=this._z,t},this.copy=function(){return new x(this._x,this._y,this._z)}}function m(t,i,e,s){this._x=t||0,this._y=i||0,this._z="function"!=typeof e&&e||0,this.fun="function"==typeof e?e:s,this.set=function(t,i,e){this._x=t||0,this._y=i||0,this._z=e||0,this.fun&&this.fun()},this.setPoint=function(t){this._x=t.x,this._y=t.y,this._z=t.z,this.fun&&this.fun()},this.getObj=function(){var t={};return t.x=this._x,t.y=this._y,t.z=this._z,t},this.copy=function(){return new m(this._x,this._y,this._z)}}s.prototype={set uuid(t){this._uuid!==t&&(this.funUpdateUuid&&this.funUpdateUuid(this._uuid,t),this._uuid=t)},get uuid(){return this._uuid},getObj:function(){var t={};return t.type=this.type,t.idArr=this.idArr,t.position=this.position.getObj(),t},setObj:function(t){this.position.setPoint(t.position)},restart:function(t){},set life(t){if(this._life!=t){this._life=t;for(var i=0;i<this.arrayClass.length;i++)null!=this.arrayClass[i].life&&(this.arrayClass[i].life=this._life)}},get life(){return this._life}},h.prototype={set x(t){this._x=t},get x(){return this._x},set y(t){this._y=t},get y(){return this._y},set z(t){this._z=t},get z(){return this._z}},l.prototype={set x(t){this._x=t,this.fun&&this.fun()},get x(){return this._x},set y(t){this._y=t,this.fun&&this.fun()},get y(){return this._y},set z(t){this._z=t,this.fun&&this.fun()},get z(){return this._z}},u.prototype={set x(t){this._x!==t&&(this._x=t)},get x(){return this._x},set y(t){this._y!==t&&(this._y=t)},get y(){return this._y},set width(t){this._width!==t&&(this._width=t)},get width(){return this._width},set height(t){this._height!==t&&(this._height=t)},get height(){return this._height}},p.prototype={set uuid(t){this._uuid!==t&&(this.funUpdateUuid&&this.funUpdateUuid(this._uuid,t),this._uuid=t)},get uuid(){return this._uuid},getObj:function(){var t={};if(t.type=this.type,t.idArr=this.idArr,t.delph=this.delph,t.tip=this.tip,t.position=this.addPoint?this.addPoint.position.getObj():this.position.getObj(),t.position1=this.addPoint1?this.addPoint1.position.getObj():this.position1.getObj(),t.connected=this.getArrConectedSplice(),this.lineRange&&(t.position2=this.lineRange.p2.getObj()),0!=this.tip){t.arrOpor=[];for(var i=0;i<this.arrOpor.length;i++)t.arrOpor.push({x:this.arrOpor[i].x,y:this.arrOpor[i].y})}return t.uuid=this.uuid,t},setObj:function(t){if(void 0!==t.uuid&&(this.uuid=t.uuid),this.clear(),void 0!==t.delph&&(this._delph=t.delph),void 0!==t.position&&this.position.setPoint(t.position),void 0!==t.position1&&this.position1.setPoint(t.position1),void 0!==t.connected&&(this.connected=t.connected),this.stage.stenInPoint(this),void 0!==t.curve&&(this.tip=t.curve?1:0),void 0!==t.tip&&(this.tip=t.tip),t.position2&&1===this.tip&&(this.lineRange.setTwoPoint(this.position,this.position1),this.lineRange.setCurvFromPoint(t.position2)),null!=t.arrOpor)for(var i=0;i<t.arrOpor.length;i++)this.arrOpor[i]||(this.arrOpor[i]=new h),this.arrOpor[i].set(t.arrOpor[i].x,t.arrOpor[i].y);null!=this._addPoint&&this._addPoint.drag(),null!=this._addPoint1&&this._addPoint1.drag(),this.life=!0,this.drag()},setSten:function(t){void 0!==t.tip&&(this.tip=t.tip),void 0!==t.lineRange&&void 0!==this.lineRange&&this.lineRange.setLR(t.lineRange),void 0!==t.position&&this.position.setPoint(t.position),void 0!==t.position1&&this.position1.setPoint(t.position1),void 0!==t.delph&&(this.delph=t.delph)},restart:function(t){},compare:function(t,i){return rez=!0,s1=t.getObj(),s2=i,t.delph!=s2.delph&&(rez=!1),calc.getDistance(s1.position,s2.position)>.1&&(rez=!1),s1.position2&&s2.position2&&calc.getDistance(s1.position2,s2.position2)>.1&&(rez=!1),t.tip!=s2.tip&&(rez=!1),rez},drag:function(){this._rotation=this.stage.spCalc.getAngle(this.position,this.position1),this._distans=this.stage.spCalc.getDistance(this.position,this.position1),1==this.tip&&(this.lineRange.p.setPoint(this.position),this.lineRange.p1.setPoint(this.position1),this.lineRange.upDate(),this.arrOpor[0].set(this.lineRange.pint90.x,this.lineRange.pint90.y)),this.calculate||(this._callAllFun("drag"),this.funDragOne&&this.funDragOne())},clone:function(t){var i=this.stage.craetSplice(),e=this.stage.craetPoint(),s=this.stage.craetPoint();e.position.set(this.position.x,this.position.y),s.position.set(this.position1.x,this.position1.y);var r=this.getObj();return function t(i){void 0!==i.uuid&&(i.uuid=calc.generateUUID());for(var e in i)"object"===c(i[e])&&t(i[e])}(r),r.uuid=i.uuid,i.setObj(r),i.addPoint.removeSplice(i),i.addPoint1.removeSplice(i),e.addSplice(i,!0),s.addSplice(i,!1),t&&(e.position.x+=t.x,e.position.y+=t.y,s.position.x+=t.x,s.position.y+=t.y),i},set addPoint(t){this._addPoint!=t&&(this._addPoint=t,null!=this._addPoint1&&null!=this._addPoint&&this._addPoint1.idArr==this._addPoint.idArr&&this.clear())},get addPoint(){return this._addPoint},set addPoint1(t){this._addPoint1!=t&&(this._addPoint1=t,null!=this._addPoint&&null!=this._addPoint1&&this._addPoint.idArr==this._addPoint1.idArr&&this.clear())},get addPoint1(){return this._addPoint1},set delph(t){this._delph!=t&&(this._delph=t,this._setAllParam("delph",this._delph),null!=this._addPoint&&this._addPoint.drag(),null!=this._addPoint1&&this._addPoint1.drag())},get delph(){return this._delph},set tip(t){this._tip!=t&&(this._tip=t,this.calculate=!0,this.restartTip(),this._setAllParam("tip",this._tip),null!=this._addPoint&&this._addPoint.drag(),null!=this._addPoint1&&this._addPoint1.drag(),this.calculate=!1,this.drag())},get tip(){return this._tip},set life(t){this._life!=t&&(this._life=t,this._setAllParam("life",this._life))},get life(){return this._life},set activMouse(t){this._activMouse!=t&&(this._activMouse=t,this._setAllParam("activMouse",this._activMouse))},get activMouse(){return this._activMouse},set oporPointVisi(t){this._oporPointVisi!=t&&(this._oporPointVisi=t,this._setAllParam("oporPointVisi",this._oporPointVisi))},get oporPointVisi(){return this._oporPointVisi},set distans0(t){if(this._distans0!==t){var i=this.position.copy(),e=this.position1.copy();calc.korektToLine(i,e,(t-this._distans0)/2,0),this.addPoint&&(this.addPoint.position.setPoint(i),this.addPoint1.position.setPoint(e),this.addPoint.dragVokrug(),this.addPoint1.dragVokrug())}},get distans0(){return this.updateDistans01(),this._distans0},set distans1(t){if(this._distans1!==t){var i=this.position.copy(),e=this.position1.copy();calc.korektToLine(i,e,(t-this._distans1)/2,0),this.addPoint&&(this.addPoint.position.setPoint(i),this.addPoint1.position.setPoint(e),this.addPoint.dragVokrug(),this.addPoint1.dragVokrug())}},get distans1(){return this.updateDistans01(),this._distans1},set visible(t){this._visible!==t&&(this._visible=t,this._setAllParam("visible",this._visible))},get visible(){return this._visible}},d.prototype={},x.prototype={set x(t){this._x=t},get x(){return this._x},set y(t){this._y=t},get y(){return this._y},set z(t){this._z=t},get z(){return this._z}},m.prototype={set x(t){this._x=t,this.fun&&this.fun()},get x(){return this._x},set y(t){this._y=t,this.fun&&this.fun()},get y(){return this._y},set z(t){this._z=t,this.fun&&this.fun()},get z(){return this._z}};var v=function t(i,e,s,r){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,t),this.type="Line";this.par=i,this.p=e,this.p1=s,this.p2=r,this.array=[],this.arrayCheh=[];var n;this.maxP=0,this.isBlokPlace=function(t){return this.korektPosition(t)},this.col=parseInt("0100000000",2),this.col1=parseInt("1000000000",2);var a,o,h,l,u,c,p,d,f,g,A=[],y=[];this.korektPosition=function(t){if(o=t.position["_"+this.p],A.length=0,h=t.position[this.p],l=t.rect[this.p],u=t.rect[this.p2],c=-1,0!=(t.col&this.col))for(var i=0;i<this.par.array.length;i++)this.par.array[i].uuid!=t.uuid&&0!=(this.par.array[i].col1&t.col1)&&(p=this.par.array[i].offset,t.offset>p&&(p=t.offset),a=this.boInBoXX1(this.par.array[i],h,l,u,!1,p),c=a[this.p],0==a.bool&&A.push(a.param,a.param1));if(0!=(t.col&this.col1)&&(p=this.par.offset,t.offset>p&&(p=t.offset),0!=(a=this.boInBoXX1(this.par,h,l,u,!0,p)).tip?A.push(a.param,a.param1):c=a[this.p]),-1!=c&&0==A.length)return t.position["_"+this.p]=c,!0;d=!1,y.length=0,g=1e32;for(i=0;i<A.length;i++)y[i]=this.korePosit(A[i],t,o),-1!=y[i]&&(d=!0,g>y[i]&&(f=i,g=y[i]));return 1==d&&(t.position["_"+this.p]=A[f],!0)},this.korePosit=function(t,i,e){if(0!=(i.col&this.col1)&&0!=(a=this.boInBo(this.par,i,!0,t)).tip)return-1;if(0!=(i.col&this.col))for(var s=0;s<this.par.array.length;s++)if(this.par.array[s].uuid!=i.uuid&&0!=(this.par.array[s].col1&i.col1)&&1!=(a=this.boInBo(this.par.array[s],i,!1,t)).tip&&2!=a.tip)return-1;return Math.abs(e-t)};var x=[];this.naLineRect=function(t,i){for(x.length=0,n=0;n<i.length;n++)0!=(a=this.boInBo(this.par,i[n],!0)).tip&&x.push(i[n]);return x};var m,v={};v[this.p]=0,v.dist=0,v.param=0,v.paramDist=0,v.param1=0,v.paramDist1=0,v.bool=!0,v.bool1=!0,v.tip=0,this.boInBo=function(t,i,e,s){return v.bool=!1,v.tip=-1,m=t.offset,i.offset>m&&(m=i.offset),null==s&&(s=i.position[this.p]),this.boInBoXX1(t,s,i.rect[this.p],i.rect[this.p2],e,m)},this.boInBoXX1=function(t,i,e,s,r,n){return v.bool=!1,v.tip=-1,m=n,t.position[this.p]+t.rect[this.p]<=i+e-m&&t.position[this.p]+t.rect[this.p2]>=i+s+m&&(v.tip=0,1==r&&(v[this.p]=i)),t.position[this.p]+t.rect[this.p]>=i+s+m&&(v.tip=1,v.bool=!0,0==r&&(v[this.p]=i)),t.position[this.p]+t.rect[this.p2]<=i+e-m&&(v.tip=2,v.bool=!0,0==r&&(v[this.p]=i)),1==r?(v.param=t.position[this.p]+t.rect[this.p]-(e-m),v.param1=t.position[this.p]+t.rect[this.p2]-(s+m)):(v.param=t.position[this.p]+t.rect[this.p]-(s+m),v.param1=t.position[this.p]+t.rect[this.p2]-(e-m)),v.paramDist=Math.abs(v.param-i),v.paramDist1=Math.abs(v.param1-i),-1==v.tip&&(v.paramDist>v.paramDist1?(v.tip=3,v[this.p]=v.param1,v.dist=v.param1):(v.tip=4,v[this.p]=v.param,v.dist=v.param)),v}};function b(t,i){for(var e=0;e<i.length;e++){var s=i[e];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}var w=function(){function t(i){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,t),this.type="World";var e=this;this.fun=i,this.children=[],this.array=this.children;var s;this.position=new Position(0,0,0),this.rect={x:-999,y:-999,z:-999,w:1998,h:1998,d:1998,x1:999,y1:999,z1:999},this.col=parseInt("1100000000",2),this.col1=parseInt("111",2),this.offset=0,this.calc=new y,this.line_x=new v(this,"x","w","x1"),this.add=function(t){this.children.push(t),t.parent=this,this.korekt()},this.remove=function(t){var i=this.getId(t);return-1!=i&&(this.children.splice(i,1),this.korekt(),t.parent=void 0,this.remove(t)),null},this.getId=function(t){for(var i=0;i<this.children.length;i++)if(this.children[i].uuid==t.uuid)return i;return-1},this.korekt=function(){},this.korektPosition=function(t){this.line_x.korektPosition(t),e.fun("korektPosition",t)},this.dragRect=function(){if(0!=(s=this.line_x.naLineRect(this.rect,this.children)).length)for(var t=0;t<s.length;t++)s[t].dragFun();0!=(s=this.line_x.naLineRect(this.rect,this.children)).length&&i("clearBodys",s);for(t=0;t<s.length;t++)this.remove(s[t]);this.korekt()},this.deb=void 0;var r={x:0,y:0,z:0,w:100,h:100,d:100};this.drawDeb=function(){if(null!=this.deb){this.deb.clear(),this.deb.dRect(this.rect,16711680,20);for(var t=0;t<this.children.length;t++)this.drawCild(this.children[t]);for(t=0;t<this.line_x.array.length;t++)r.x=this.line_x.array[t][this.line_x.p],r.w=this.line_x.array[t][this.line_x.p1],r.y=-1e3,r.h=1e3,this.deb.dRect(r,255,20)}},this.drawCild=function(t){for(var i=0;i<t.children.length;i++)r.x=t.position.x+t.rect.x1,r.y=t.position.z+t.rect.z,r.w=t.children[i].rect.w,r.h=t.children[i].rect.d+1e3,this.deb.dRect(r,65280,20)}}var i,e,s;return i=t,(e=[{key:"parent",set:function(t){this._parent!=t&&(this._parent=t)},get:function(){return this._parent}}])&&b(i.prototype,e),s&&b(i,s),t}(),P=e(2);function _(t,i){for(var e=0;e<i.length;e++){var s=i[e];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}var S=function(){function t(i,e){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,t);var s,r,n,a=this;this.type="SPLWindow",this.uuid=calc.generateRendom(2),this.par=i,this.fun=e,this._delph=i._delph,this._height=i._height,this._height1=i._height1,this.sizeLine=i._sizeLine,this.content2d=new PIXI.Container,this.par.cont2dOfset.addChild(this.content2d),this.world=new w(function(t,i){if("korektPosition"==t&&a.par.draw1(!0),"clearBodys"==t)for(var e=0;e<i.length;e++)a.removeBlok(i[e].target)}),this.deb=new P.a,this.content2d.addChild(this.deb.content2d),this.deb.al=.3,this.array=[],this.addBlok=function(t){return null!=t.parent&&t.parent.removeBlok(t),this.delph=i._delph,t.delph=this._delph,this.array.push(t),this.world.add(t.body),t.parent=this,this.content2d.addChild(t.content2d),this.par.draw1(!0),t.redrahHHH(this._height,this._height1),this.par.content3d.add(t.content3d),this.par.par.fun("startTikInfo"),-1},this.removeBlok=function(t){return-1!=(r=this.isArrPos(t))?(s=this.array[r],this.array.splice(r,1),this.content2d.removeChild(s.content2d),this.par.content3d.remove(t.content3d),s.parent=void 0,this.removeBlok(t),this.world.remove(t.body),this.par.draw1(!0),this.par.par.fun("startTikInfo"),s):r},this.isArrPos=function(t){for(var i=0;i<this.array.length;i++)if(this.array[i].uuid==t.uuid)return i;return-1},this.isBlokPlace=function(t){return!(!t||!t.body)&&this.world.line_x.isBlokPlace(t.body)},this.vector=new THREE.Vector3,this.vr=new THREE.Vector3,this.getGlob=function(t,i,e,s){return this.vector.set(t,i,e),n=calc.getDistance(this.vector,this.par.position),this.vr.x=n,this.vr.y=0,this.vr.z=0,this.vr},this.colCentr=parseInt("0000010000",2);var o,h,l,u,c=[],p=[],d=[];this.getNumBlok=function(){p.length=0,c.length=0,d.length=0;for(var t=0;t<this.world.array.length;t++)0!=(this.world.array[t].col&this.colCentr)&&d.push(this.world.array[t]);if(0==d.length)return p;d.sort(function(t,i){return t.position.x-i.position.x});for(t=0;t<d.length;t++)c.push(d[t].position.x+d[t].rect.x,d[t].position.x+d[t].rect.x1);return this.sort2(c),c},this.sort2=function(t){if(2!=t.length){o=t.length-2;for(var i=0;i<o;i+=2)if(t[i+1]>=t[i+2])return t[i+1]>=t[i+3]?(t.splice(i+2,2),void this.sort2(t)):(t[i+1]=t[i+3],t.splice(i+2,2),void this.sort2(t))}},this.draw=function(){h=this.par.arrPosit[1].x<this.par.arrPosit[4].x?-this.par.arrPosit[1].x:-this.par.arrPosit[4].x,l=this.par.arrPosit1[1].x<this.par.arrPosit1[4].x?this.par.arrPosit1[1].x:this.par.arrPosit1[4].x,u=-h+l+this.par._distans,this.world.rect.x=h,this.world.rect.w=u,this.world.rect.x1=u+h,this.world.rect.y=-this._delph/2,this.world.rect.h=this._delph,this.world.dragRect(),this.drawDeb()},this.drawDeb=function(){this.deb&&this.world.drawDeb()};this.type,this.getInfo=function(t){for(var i=0;i<this.array.length;i++)this.array[i].getInfo(t)},this.setObj=function(t){for(var i=0;i<t.array.length;i++){var e=this.par.par.worldBlok.getBlok(t.array[i].id);e&&(e.setObj(t.array[i]),this.addBlok(e))}},this.getObj=function(){for(var t={array:[]},i=0;i<this.array.length;i++)t.array.push(this.array[i].getObj());return t}}var i,e,s;return i=t,(e=[{key:"delph",set:function(t){if(this._delph!=t){this._delph=t;for(var i=0;i<this.array.length;i++)this.array[i].delph=t}},get:function(){return this._delph}},{key:"height",set:function(t){if(this._height!=t){this._height=t;for(var i=0;i<this.array.length;i++)this.array[i].redrahHHH(this._height,this._height1)}},get:function(){return this._height}},{key:"height1",set:function(t){if(this._height1!=t){this._height1=t;for(var i=0;i<this.array.length;i++)this.array[i].redrahHHH(this._height,this._height1)}},get:function(){return this._height1}}])&&_(i.prototype,e),s&&_(i,s),t}();function I(t,i){for(var e=0;e<i.length;e++){var s=i[e];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}var C=function(){function t(i,e){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,t),this.type="SS2D",this.typeNa="SS2D";var s=this;this.par=i,this._life=i._life;var r,n=0;this.aVKol=0,this._mashtabText=1,this._distans=0,this._delph=0,this._rotation=0,this.content2d=new PIXI.Container,this.par.content2d.addChild(this.content2d),this.graphics=new PIXI.Graphics,this.content2d.addChild(this.graphics),this.graphics1=new PIXI.Graphics,this.par.content2d1.addChild(this.graphics1),this.onDragStart=function(t){null!=s.par.par.par.sobSP&&s.par.par.par.sobSP("downSten",s.par,t)},this.graphics.interactive=!0,this.graphics.on("mousedown",this.onDragStart),this.graphics.on("mouseover",function(t){s.stAct.sahPlus=10}),this.graphics.on("mouseout",function(t){s.stAct.sahPlus=0}),this.stAct=new E(this),this.arrVorur=i.arrVorur,this.arrPosit=i.arrPosit,this.arrPosit1=i.arrPosit1,this.cont2dDeb=void 0,this.cont2dOfset=new PIXI.Container,this.par.cont2dOfset.addChild(this.cont2dOfset),this.c2dt=new PIXI.Container,this.text=new PIXI.Text("345634634",{fontFamily:"Arial"}),this.c2dt.addChild(this.text),this.text.scale.x=this.text.scale.y=this._mashtabText,this.cont2dOfset.addChild(this.c2dt),this.c2dt.visible=!1,this.c2dt1=new PIXI.Container,this.text1=new PIXI.Text("345634634",{fontFamily:"Arial"}),this.c2dt1.addChild(this.text1),this.text1.scale.x=this.text1.scale.y=this._mashtabText,this.cont2dOfset.addChild(this.c2dt1),this.draw1=function(){if(this._distans=this.par._distans,this._delph=this.par._delph,this._rotation=this.par._rotation,n=0,this.plusVor(-this.arrPosit[2].x,this.arrPosit[2].y),this.plusVor(-this.arrPosit[1].x,this.arrPosit[1].y),this.plusVor(-this.arrPosit[0].x,this.arrPosit[0].y),this.plusVor(this.arrPosit1[5].x+this._distans,this.arrPosit1[5].y),this.plusVor(this.arrPosit1[4].x+this._distans,this.arrPosit1[4].y),this.plusVor(this.arrPosit1[3].x+this._distans,this.arrPosit1[3].y),this.plusVor(this.arrPosit1[2].x+this._distans,this.arrPosit1[2].y),this.plusVor(this.arrPosit1[1].x+this._distans,this.arrPosit1[1].y),this.plusVor(this.arrPosit1[0].x+this._distans,this.arrPosit1[0].y),this.plusVor(-this.arrPosit[5].x,this.arrPosit[5].y),this.plusVor(-this.arrPosit[4].x,this.arrPosit[4].y),this.plusVor(-this.arrPosit[3].x,this.arrPosit[3].y),this.par.aVKol=this.aVKol,null!=this.graphDeb&&(this.graphDeb.clear(),this.graphDeb.lineStyle(5,16711680,1),this.graphDeb.drawRect(this.par.rectBig.x,this.par.rectBig.y,this.par.rectBig.w,this.par.rectBig.h)),r=this.par.windows.getNumBlok(),this.graphics.clear(),this.graphics.beginFill(0==this._adjacent?this.par.par._colorC0_:this.par.par._colorC1_,.3),0==r.length){this.graphics.moveTo(this.arrVorur[0].x,this.arrVorur[0].y);for(var t=0;t<this.aVKol;t++)this.graphics.lineTo(this.arrVorur[t].x,this.arrVorur[t].y);this.graphics.lineTo(this.arrVorur[0].x,this.arrVorur[0].y)}else{this.graphics.moveTo(-this.arrPosit[2].x,this.arrPosit[2].y),this.graphics.lineTo(-this.arrPosit[1].x,this.arrPosit[1].y),this.graphics.lineTo(-this.arrPosit[0].x,this.arrPosit[0].y),this.graphics.lineTo(r[0],this.arrPosit[0].y),this.graphics.lineTo(r[0],this.arrPosit[5].y),this.graphics.lineTo(-this.arrPosit[5].x,this.arrPosit[5].y),this.graphics.lineTo(-this.arrPosit[4].x,this.arrPosit[4].y),this.graphics.lineTo(-this.arrPosit[3].x,this.arrPosit[3].y);for(t=0;t<r.length;t+=2)t!=r.length-2?(this.graphics.moveTo(r[t+1],this.arrPosit[0].y),this.graphics.lineTo(r[t+1],this.arrPosit[5].y),this.graphics.lineTo(r[t+2],this.arrPosit[5].y),this.graphics.lineTo(r[t+2],this.arrPosit[0].y),this.graphics.lineTo(r[t+1],this.arrPosit[0].y)):(this.graphics.moveTo(this.arrPosit1[5].x+this._distans,this.arrPosit1[5].y),this.graphics.lineTo(this.arrPosit1[4].x+this._distans,this.arrPosit1[4].y),this.graphics.lineTo(this.arrPosit1[3].x+this._distans,this.arrPosit1[3].y),this.graphics.lineTo(this.arrPosit1[2].x+this._distans,this.arrPosit1[2].y),this.graphics.lineTo(this.arrPosit1[1].x+this._distans,this.arrPosit1[1].y),this.graphics.lineTo(this.arrPosit1[0].x+this._distans,this.arrPosit1[0].y),this.graphics.lineTo(r[t+1],this.arrPosit1[0].y),this.graphics.lineTo(r[t+1],this.arrPosit1[5].y))}this.graphics.beginFill(255,.1),this.graphics.drawCircle(20,0,5),this.graphics1.clear();var i=2*this.par.par._sizeLine;if(this.graphics1.lineStyle(i,this.par.par._colorLine_,1),0==r)for(t=0;t<this.aVKol;t++)this.graphics1.moveTo(this.arrVorur[t].x,this.arrVorur[t].y),t!=this.aVKol-1?this.graphics1.lineTo(this.arrVorur[t+1].x,this.arrVorur[t+1].y):this.graphics1.lineTo(this.arrVorur[0].x,this.arrVorur[0].y);else{this.drawGrah(this.graphics1,-this.arrPosit[2].x,this.arrPosit[2].y,!0),this.drawGrah(this.graphics1,-this.arrPosit[1].x,this.arrPosit[1].y,!1),this.drawGrah(this.graphics1,-this.arrPosit[0].x,this.arrPosit[0].y,!1),this.drawGrah(this.graphics1,r[0],this.arrPosit[0].y,!1),this.drawGrah(this.graphics1,r[0],this.arrPosit[5].y,!1),this.drawGrah(this.graphics1,-this.arrPosit[5].x,this.arrPosit[5].y,!1),this.drawGrah(this.graphics1,-this.arrPosit[4].x,this.arrPosit[4].y,!1),this.drawGrah(this.graphics1,-this.arrPosit[3].x,this.arrPosit[3].y,!1),this.drawGrah(this.graphics1,-this.arrPosit[2].x,this.arrPosit[2].y,!1);for(t=0;t<r.length;t+=2)t!=r.length-2?(this.drawGrah(this.graphics1,r[t+1],this.arrPosit[0].y,!0),this.drawGrah(this.graphics1,r[t+1],this.arrPosit[5].y,!1),this.drawGrah(this.graphics1,r[t+2],this.arrPosit[5].y,!1),this.drawGrah(this.graphics1,r[t+2],this.arrPosit[0].y,!1),this.drawGrah(this.graphics1,r[t+1],this.arrPosit[0].y,!1)):(this.drawGrah(this.graphics1,this.arrPosit1[5].x+this._distans,this.arrPosit1[5].y,!0),this.drawGrah(this.graphics1,this.arrPosit1[4].x+this._distans,this.arrPosit1[4].y,!1),this.drawGrah(this.graphics1,this.arrPosit1[3].x+this._distans,this.arrPosit1[3].y,!1),this.drawGrah(this.graphics1,this.arrPosit1[2].x+this._distans,this.arrPosit1[2].y,!1),this.drawGrah(this.graphics1,this.arrPosit1[1].x+this._distans,this.arrPosit1[1].y,!1),this.drawGrah(this.graphics1,this.arrPosit1[0].x+this._distans,this.arrPosit1[0].y,!1),this.drawGrah(this.graphics1,r[t+1],this.arrPosit1[0].y,!1),this.drawGrah(this.graphics1,r[t+1],this.arrPosit1[5].y,!1),this.drawGrah(this.graphics1,this.arrPosit1[5].x+this._distans,this.arrPosit1[5].y,!1))}this.stAct.draw1();var e=!0;this._rotation>-Math.PI/2&&this._rotation<Math.PI/2&&(e=!1);var s=this._distans-(-this.arrPosit[0].x-this.arrPosit1[5].x);s<100?this.c2dt.visible=!1:(this.c2dt.visible=!0,this.text.text=Math.round(s)+"",0==e?(this.c2dt.x=s/2-this.arrPosit[0].x-this.text.width/2,this.c2dt.y=this._delph/2,this.c2dt.rotation=0):(this.c2dt.x=s/2-this.arrPosit[0].x+this.text.width/2,this.c2dt.y=this._delph/2+32*this._mashtabText,this.c2dt.rotation=Math.PI)),(s=this._distans-(-this.arrPosit[5].x-this.arrPosit1[0].x))<100?this.c2dt1.visible=!1:(this.c2dt1.visible=!0,this.text1.text=Math.round(s)+"",0==e?(this.c2dt1.x=s/2-this.arrPosit[5].x-this.text.width/2,this.c2dt1.y=-this._delph/2-32*this._mashtabText,this.c2dt1.rotation=0):(this.c2dt1.x=s/2-this.arrPosit[5].x+this.text.width/2,this.c2dt1.y=-this._delph/2,this.c2dt1.rotation=Math.PI))};var a={x:0,y:0};this.drawGrah=function(t,i,e,s){s?(a.x=i,a.y=e,t.moveTo(i,e)):i==a.x&&e==a.y||(a.x=i,a.y=e,t.lineTo(i,e))},this.plusVor=function(t,i){0==n?(this.arrVorur[n].set(t,i),n++):this.arrVorur[n-1].x==t&&this.arrVorur[n-1].y==i||this.arrVorur[0].x==t&&this.arrVorur[0].y==i||n<this.arrVorur.length&&(this.arrVorur[n].set(t,i),n++,this.aVKol=n)},this.tween=void 0,this.animat=function(t){null==this.tween&&(this.tween=new TWEEN.Tween(this.graphics),this.tween.onUpdate(function(){s.par.par.render()})),this.graphics.alpha=0,this.tween.to({alpha:1},t).start()}}var i,e,s;return i=t,(e=[{key:"active",set:function(t){this._active!=t&&(this._active=t,this.stAct.sahAct=t?40:0)},get:function(){return this._active}},{key:"life",set:function(t){this._life!=t&&(this._life=t,null!=this.cont2dDeb&&(1==this._life?this.par.stage.content2d2.addChild(this.cont2dDeb):null!=this.cont2dDeb.parent&&this.cont2dDeb.parent.removeChild(this.cont2dDeb)))},get:function(){return this._life}}])&&I(i.prototype,e),s&&I(i,s),t}();function E(t){this.type="STAct",this.par=t,this._sahAct=0,this._sahPlus=0,this.arrVorur=this.par.arrVorur,this.graphics=new PIXI.Graphics,this.par.content2d.addChild(this.graphics),this.graphics.alpha=this._sahAct/100,this.draw1=function(){this.graphics.clear(),this.graphics.beginFill(t.par.colorUI),this.graphics.moveTo(this.par.arrVorur[0].x,this.par.arrVorur[0].y);for(var i=1;i<this.par.aVKol;i++)this.graphics.lineTo(this.par.arrVorur[i].x,this.par.arrVorur[i].y);this.graphics.lineTo(this.par.arrVorur[0].x,this.par.arrVorur[0].y)},this.corektSetGet=function(){this.graphics.alpha=(this._sahAct+this._sahPlus)/100,this.par.par.par.render()}}function T(t){return(T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function M(t,i){return!i||"object"!==T(i)&&"function"!=typeof i?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):i}function D(t){return(D=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function R(t,i){return(R=Object.setPrototypeOf||function(t,i){return t.__proto__=i,t})(t,i)}E.prototype={set sahAct(t){this._sahAct!==t&&(this._sahAct=t,this.corektSetGet())},get sahAct(){return this._sahAct},set sahPlus(t){this._sahPlus!==t&&(this._sahPlus=t,this.corektSetGet())},get sahPlus(){return this._sahPlus}};var L=function(t){function i(){var t;!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,i),t=M(this,D(i).call(this));var e=[];t.upNull=function(){e.push(-.5,-.5,0),e.push(-.5,-.5,0),e.push(-.5,.5,0),e.push(-.5,-.5,0),e.push(-.5,-.5,0),e.push(.5,-.5,0),e.push(.5,-.5,0),e.push(.5,.5,0),e.push(.5,.5,0),e.push(-.5,.5,0),e.push(-.5,.5,0),e.push(.5,.5,0),this.setAttribute("position",new THREE.Float32BufferAttribute(e,3))},t.upNull(),t.clearPoint=function(){this.array.length=0},t.array=[],t.addLine=function(t,i){this.array.push(t,i)},t.clear=function(t){this.array.length=0,e.length=0,a.length=0,n.length=0},t.addTri=function(t,i,s,r,o,h,l,u){e.push(t.x,t.y,t.z),e.push(i.x,i.y,i.z),e.push(s.x,s.y,s.z),r&&(a.push(r.x,r.y,r.z),a.push(o.x,o.y,o.z),a.push(h.x,h.y,h.z),n.push(l.x,l.y),n.push(u.x,u.y))};var s,r,n=[],a=[];return t.redrag=function(t){if(null==t)this.setAttribute("position",new THREE.Float32BufferAttribute(e,3));else if(this.setAttribute("position",new THREE.Float32BufferAttribute(e,3)),this.computeBoundingBox(),this.computeBoundingSphere(),0==n.length){s=this.boundingBox.max.x-this.boundingBox.min.x,r=this.boundingBox.max.y-this.boundingBox.min.y;for(var i=0;i<e.length;i+=3)a.push(t.x,t.y,t.z),n.push((e[i]-this.boundingBox.min.x)/s,(e[i+1]-this.boundingBox.min.y)/r);this.setAttribute("normal",new THREE.Float32BufferAttribute(a,3)),this.setAttribute("uv",new THREE.Float32BufferAttribute(n,2))}else this.setAttribute("normal",new THREE.Float32BufferAttribute(a,3)),this.setAttribute("uv",new THREE.Float32BufferAttribute(n,2))},t.redrag1=function(){this.setAttribute("position",new THREE.Float32BufferAttribute(e,3))},t.upDate=function(){0==this.array.length&&this.upNull(),e.length=0;for(var t=0;t<this.array.length;t+=2)e.push(this.array[t].x,this.array[t].y,this.array[t].z),e.push(this.array[t+1].x,this.array[t+1].y,this.array[t+1].z);this.setAttribute("position",new THREE.Float32BufferAttribute(e,3))},t}return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&R(t,i)}(i,THREE.BufferGeometry),i}();function O(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function B(t,i){for(var e=0;e<i.length;e++){var s=i[e];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function j(t,i,e){return i&&B(t.prototype,i),e&&B(t,e),t}var F=function(){function t(i,e){O(this,t),this.type="SS3D";this.par=i,this._height=i._height,this._height1=i._height1,this._life=i._life;this.aVKol=0,this._mashtabText=8,this._distans=0,this._delph=0,this._rotation=0,this._color=this.par._color,this._color1=this.par._color1,this._color2=this.par._color2,this._color3=this.par._color3,this._color4=this.par._color4,this._boolLitel=!0,this.korektRect=this.par.par.par.korektRect,this.korektLine=this.par.par.par.korektLine,this.cont3d=new THREE.Object3D,this.par.content3d.add(this.cont3d),this.cont3dL=new THREE.Object3D,this.par.content3d.add(this.cont3dL),this.lineSegments=new THREE.LineSegments(this.par.par.planeXZ,this.par.par.lineBasicMaterial),this.cont3dL.add(this.lineSegments),this.lineSegments.rotation.x=Math.PI/2;parseInt("11100001000",2),parseInt("00011111111",2);this.pS={x:0,y:0,w:100,h:100},this.dragPost=function(){this.draw1()},this.draw1=function(){this._distans=this.par._distans,this._delph=this.par._delph,this._rotation=this.par._rotation,this.cont3d.position.z=-(this._height+this._height1),this.cont3d.visible=this.par.par._boolMax,this.cont3dL.visible=!this.par.par._boolMax,1==this.par.par._boolMax?(this.drawGrani(),this.drawVerg()):(this.drawLittel(),this.par.par.addObjFun1(this.par))},this.drawLittel=function(){this.lineSegments.scale.set(this._distans,this._height+this._height1,1),this.lineSegments.position.x=this._distans/2,this.lineSegments.position.z=-(this._height+this._height1)/2},this.vergLittel=new z(this,this.par.par.pm.matDop.getIDReturn(this._color4)),this.arrGrani=[],this.arrGrani[0]=new k(this,0,this.par.par.pm.matDop.getIDReturn(this._color)),this.arrGrani[1]=new k(this,1,this.par.par.pm.matDop.getIDReturn(this._color1)),this.arrGrani[2]=new k(this,0,this.par.par.pm.matDop.getIDReturn(this._color2)),this.arrGrani[3]=new k(this,1,this.par.par.pm.matDop.getIDReturn(this._color3));for(var s=0;s<this.arrGrani.length;s++)this.arrGrani[s].idArr=s;this.arrGrani[0].boolInvert=!0,this.arrGrani[1].boolInvert=!0,this.arrGrani[0].arr[2].vergLittel=this.vergLittel,this.drawVerg=function(){this.arrGrani[0].dragGeometry(),this.arrGrani[1].dragGeometry(),this.arrGrani[2].dragGeometry(),this.arrGrani[3].dragGeometry(),this.vergLittel.setGrani(this.arrGrani[0],this.arrGrani[1])},this.drawGrani=function(){this.arrGrani[0].dragPost(),this.arrGrani[1].dragPost(),this.arrGrani[0].setGrani1(this.arrGrani[1]),//!!! переворачиваем 			
this.arrGrani[2].dragPost(),this.arrGrani[3].dragPost(),this.arrGrani[2].setGrani1(this.arrGrani[3]),//!!! переворачиваем 
this.par.par.metodRezolk.setSten(this.par)},this.redrahHHH=function(){this.arrGrani[0].h=this.arrGrani[1].h=this._height,this.arrGrani[1].y=this.arrGrani[0].y=0,this.arrGrani[2].h=this._height1,this.arrGrani[2].y=this._height,this.arrGrani[3].h=this._height1,this.arrGrani[3].y=this._height},this.redrahHHH(),this.testMaterial=function(){},this.testMaterial()}return j(t,[{key:"height",set:function(t){this._height!=t&&(this._height=t,this.redrahHHH())},get:function(){return this._height}},{key:"height1",set:function(t){this._height1!=t&&(this._height1=t,this.redrahHHH())},get:function(){return this._height1}},{key:"active",set:function(t){this._active!=t&&(this._active=t)},get:function(){return this._active}},{key:"life",set:function(t){this._life!=t&&(this._life=t)},get:function(){return this._life}},{key:"color",set:function(t){this._color!=t&&(this._color=t,this.arrGrani[0].material=this.par.par.pm.matDop.getIDReturn(this._color),this.testMaterial())},get:function(){return this._color}},{key:"color1",set:function(t){this._color1!=t&&(this._color1=t,this.arrGrani[1].material=this.par.par.pm.matDop.getIDReturn(this._color1),this.testMaterial())},get:function(){return this._color1}},{key:"color2",set:function(t){this._color2!=t&&(this._color2=t,this.arrGrani[2].material=this.par.par.pm.matDop.getIDReturn(this._color2),this.testMaterial())},get:function(){return this._color2}},{key:"color3",set:function(t){this._color3!=t&&(this._color3=t,this.arrGrani[3].material=this.par.par.pm.matDop.getIDReturn(this._color3),this.testMaterial())},get:function(){return this._color3}},{key:"color4",set:function(t){this._color4!=t&&(this._color4=t,this.vergLittel.material=this.par.par.pm.matDop.getIDReturn(this._color3),this.testMaterial())},get:function(){return this._color4}}]),t}(),k=function(){function t(i,e,s){O(this,t),this.type="SGrani",this.par=i,this.sahTextur=e,this.y=0,this.h=300,this.arrPosit=this.par.par.arrPosit,this.arrPosit1=this.par.par.arrPosit1,this._distans=0,this._material=s,this.korektRect=this.par.korektRect,this.cont3d=new THREE.Object3D,this.par.cont3d.add(this.cont3d),this.boolVergDrag=!1,this.idArr=-1,this.boolInvert=!1,this.arrP=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3],this.arrPGlob=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3],this.arr=[];for(var r=0;r<5;r++)this.arr[r]=new H(this),this.arr[r].idArr=r;var n,a,o;this.clearAL=function(){for(var t=0;t<5;t++)this.arr[t].clearAL()};var h=new THREE.Vector3,l=new THREE.Vector3;this.invertToGlob=function(){n=this.par._rotation,h.x=i.par.position._x,h.y=i.par.position._y;for(var t=0;t<this.arrP.length;t++)o=calc.getAngle(l,this.arrP[t]),a=calc.getDistance(l,this.arrP[t]),calc.getVector(a,o+n,this.arrPGlob[t]),this.arrPGlob[t].x+=h.x,this.arrPGlob[t].y+=h.y},this.dragPost=function(){this._distans=this.par.par._distans,0==this.sahTextur&&(this.arrP[0].set(-this.arrPosit[2].x,this.arrPosit[2].y,0),this.arrP[1].set(-this.arrPosit[1].x,this.arrPosit[1].y,0),this.arrP[2].set(-this.arrPosit[0].x,this.arrPosit[0].y,0),this.arrP[3].set(this.arrPosit1[5].x+this._distans,this.arrPosit1[5].y,0),this.arrP[4].set(this.arrPosit1[4].x+this._distans,this.arrPosit1[4].y,0),this.arrP[5].set(this.arrPosit1[3].x+this._distans,this.arrPosit1[3].y,0)),1==this.sahTextur&&(this.arrP[5].set(this.arrPosit1[2].x+this._distans,this.arrPosit1[2].y,0),this.arrP[4].set(this.arrPosit1[1].x+this._distans,this.arrPosit1[1].y,0),this.arrP[3].set(this.arrPosit1[0].x+this._distans,this.arrPosit1[0].y,0),this.arrP[2].set(-this.arrPosit[5].x,this.arrPosit[5].y,0),this.arrP[1].set(-this.arrPosit[4].x,this.arrPosit[4].y,0),this.arrP[0].set(-this.arrPosit[3].x,this.arrPosit[3].y,0)),this.sahW=0;for(var t=0;t<5;t++)this.arr[t].setPosit(this.arrP[t],this.arrP[t+1]),0==this.arr[t].dist?0!=this.arr[t].mesh.visible&&(this.arr[t].mesh.visible=!1):1!=this.arr[t].mesh.visible&&(this.arr[t].mesh.visible=!0),this.arr[t].rendSahTextur=this.sahTextur;if(0==this.sahTextur)for(t=0;t<5;t++)this.arr[t].pS.y=0,this.arr[t].pS.w=100,this.arr[t].pS.h=100,this.arr[t].pS.x=this.sahW,t>=2&&(this.sahW+=this.arr[t].dist);if(1==this.sahTextur)for(t=4;t>=0;t--)t<=1&&(this.sahW+=this.arr[t].dist),this.arr[t].pS.y=0,this.arr[t].pS.w=100,this.arr[t].pS.h=100,this.arr[t].pS.x=-this.sahW;1==this.boolInvert&&this.invertToGlob()},this.setGrani1=function(t){t.arr[3].redragP(),t.arr[4].redragP(),t.arr[3].rendSahTextur=this.sahTextur,t.arr[4].rendSahTextur=this.sahTextur,t.arr[3].pS.x=this.sahW,t.arr[4].pS.x=this.sahW+t.arr[3].dist,this.arr[0].redragP(),this.arr[1].redragP(),this.arr[0].rendSahTextur=t.sahTextur,this.arr[1].rendSahTextur=t.sahTextur,this.arr[0].pS.x=-this.arr[0].dist-t.sahW,this.arr[1].pS.x=-this.arr[0].dist-this.arr[1].dist-t.sahW},this.sahW=0,this.dragGeometry=function(){if(0!=this.h){this.cont3d.visible=!0,this.korektRect.boolDebug=!1,this.boolVergDrag=!1,this.korektRect.colizY=this.par._height1+this.par._height;for(var t=0;t<5;t++)0!=this.arr[t].dist&&(2==t?(this.korektRect.colizX=-this.arrP[t].x,this.arr[t].setNaRect(0,this.par.par.windows.world,this.h,this.y,null,this.arrP[t].x)):this.arr[t].setNaRect(0,null,this.h,this.y,null,0),1==this.arr[t].boolVergDrag&&(this.boolVergDrag=!0)),this.korektRect.boolDebug=!1}else this.cont3d.visible=!1}}return j(t,[{key:"material",set:function(t){if(this._material!==t){this._material=t;for(var i=0;i<5;i++)this.arr[i].material=t}},get:function(){return this._material}}]),t}(),H=function(){function t(i){O(this,t);this.type="GronSten",this.par=i,this.geometry=new L,this.rendSahTextur=0,this.idArr=-1,this._material=i._material,this.vergLittel=void 0,this.mesh=new THREE.Mesh(this.geometry,this._material),this.mesh.rotation.x=Math.PI/2,this.cont3d=new THREE.Object3D,this.par.cont3d.add(this.cont3d),this.cont3d.add(this.mesh),this.p=new THREE.Vector3,this.p1=new THREE.Vector3,this.arrLine=[],this.arrLineCesh=[],this.clearAL=function(){this.arrLine.length=0},this.getLine=function(){return null==this.arrLineCesh[this.arrLine.length]&&(this.arrLineCesh[this.arrLine.length]={p:{x:0,y:0},p1:{x:0,y:-100}}),this.arrLine.push(this.arrLineCesh[this.arrLine.length]),this.arrLine[this.arrLine.length-1]},this.arrLine1=[],this.arrLineCesh1=[],this.clearAL1=function(){this.arrLine1.length=0},this.getLine1=function(){return null==this.arrLineCesh1[this.arrLine1.length]&&(this.arrLineCesh1[this.arrLine1.length]={p:{x:0,y:0,z:0},p1:{x:0,y:-100,z:0}}),this.arrLine1.push(this.arrLineCesh1[this.arrLine1.length]),this.arrLine1[this.arrLine1.length-1]},this.arrLine2=[],this.arrLineCesh2=[],this.clearAL2=function(){this.arrLine2.length=0},this.getLine2=function(){return null==this.arrLineCesh2[this.arrLine2.length]&&(this.arrLineCesh2[this.arrLine2.length]={p:{x:0,y:0,z:0},p1:{x:0,y:-100,z:0}}),this.arrLine2.push(this.arrLineCesh2[this.arrLine2.length]),this.arrLine2[this.arrLine2.length-1]};var e,s,r,n,a,o,h,l=new THREE.Vector3,u=new THREE.Vector3,c=new THREE.Vector3,p=new THREE.Vector3,d={p:l,p1:u};this.isLocalToGlob=function(t,i){return r=!1,1!=this.par.sahTextur||4!=this.idArr&&3!=this.idArr||(r=!0),0!=this.par.sahTextur||0!=this.idArr&&1!=this.idArr||(r=!0),1==r?(this.par.arrPGlob[this.idArr],s=this.par.arrPGlob[this.idArr+1]):(s=this.par.arrPGlob[this.idArr],this.par.arrPGlob[this.idArr+1]),c.x=t.x-s.x,c.y=t.y-s.y,calc.getAngle(p,c),e=calc.getDistance(p,c),calc.getVector(e,0,l),l.z=this.par.par.par._height+this.par.par.par._height1+t.z,c.x=i.x-s.x,c.y=i.y-s.y,calc.getAngle(p,c),e=calc.getDistance(p,c),calc.getVector(e,0,u),u.z=this.par.par.par._height+this.par.par.par._height1+i.z,d},this.rect={x:0,y:0,w:700,h:300},this.dist=0,this.angel=0,this.pS={x:0,y:0,w:100,h:100},this.setPosit=function(t,i){this.p=t,this.p1=i,this.setPRed()},this.redragP=function(){n=this.p,this.p=this.p1,this.p1=n,this.setPRed()},this.setPRed=function(){this.angel=calc.getAngle(this.p,this.p1),this.dist=calc.getDistance(this.p,this.p1),this.cont3d.position.x=this.p.x,this.cont3d.position.y=this.p.y,this.cont3d.rotation.z=this.angel},this.boolVergDrag=!1,this.setNaRect=function(t,i,e,s,r,n){this.boolVergDrag=!1,0,null!=n&&n,this.rect.y=s,this.rect.h=e,this.rect.w=this.dist,this.par.korektRect.rect=this.rect,this.par.korektRect.coliz=i,this.par.korektRect.arrLine=this.arrLine,this.par.korektRect.pS=this.pS,this.par.korektRect.korektGrid(),this.par.korektRect.setGeom(this.geometry,this.rendSahTextur),this.korektLine(),this.boolVergDrag=this.par.korektRect.boolVergDrag,void 0!==this.vergLittel&&this.vergLittel.drawWindow(this.par.korektRect,n)},this.korektLine=function(){if(!(this.par.par.idArr>=2)&&(this.clearAL1(),this.clearAL2(),0!=this.dist&&2==this.idArr)){a=this.par.korektRect.getLine1();for(var t=0;t<a.length;t++)(o=this.getLine1()).p.x=a[t].p.x+this.p.x,o.p.z=a[t].p.y,o.p.y=this.p.y,o.p1.x=a[t].p1.x+this.p.x,o.p1.z=a[t].p1.y,o.p1.y=this.p.y}},this.point=new THREE.Vector3,this.pNull=new THREE.Vector3,this.povorot=function(t,i,e){h=t.x,calc.getVector(h,-e,this.point),this.point.x+=i.x,this.point.y+=i.y}}return j(t,[{key:"material",set:function(t){this._material!==t&&(this._material=t,this.mesh.material=this._material)},get:function(){return this._material}}]),t}(),z=function(){function t(i,e){O(this,t);var s,r,n,a,o;this.type="VergLittel",this.par=i,this.geometry=new L,this.rendSahTextur=0,this.korektLine=this.par.korektLine,this._material=e,this.mesh=new THREE.Mesh(this.geometry,this._material),this.par.cont3d.add(this.mesh),this.normalPosit=new THREE.Vector3(0,1,0),this.geometry1=new L,this._material1=e,this.mesh1=new THREE.Mesh(this.geometry1,this._material1),this.par.cont3d.add(this.mesh1),this.arrLine=[],this.arrLineCesh=[],this.clearAL=function(){this.arrLine.length=0},this.getLine=function(){return null==this.arrLineCesh[this.arrLine.length]&&(this.arrLineCesh[this.arrLine.length]={p:{x:0,y:0,z:0},p1:{x:0,y:-100,z:0}}),this.arrLine.push(this.arrLineCesh[this.arrLine.length]),this.arrLine[this.arrLine.length-1]},this.setGrani=function(t,i){if(this.clearAL(),0==t.boolVergDrag&&0==i.boolVergDrag){for(s=0,r=0;r<this.par.arrGrani[s].arr.length;r++)0!=(a=this.par.arrGrani[s].arr[r]).dist&&((o=this.getLine()).p.x=a.p.x,o.p.y=a.p.y,o.p.z=a.p.z,o.p1.x=a.p1.x,o.p1.y=a.p1.y,o.p1.z=a.p1.z);for(s=1,r=0;r<this.par.arrGrani[s].arr.length;r++)0!=(a=this.par.arrGrani[s].arr[r]).dist&&((o=this.getLine()).p.x=a.p.x,o.p.y=a.p.y,o.p.z=a.p.z,o.p1.x=a.p1.x,o.p1.y=a.p1.y,o.p1.z=a.p1.z)}else for(s=0;s<2;s++)for(r=0;r<this.par.arrGrani[s].arr.length;r++)for(n=0;n<this.par.arrGrani[s].arr[r].arrLine1.length;n++)a=this.par.arrGrani[s].arr[r].arrLine1[n],(o=this.getLine()).p.x=a.p.x,o.p.y=a.p.y,o.p.z=a.p.z,o.p1.x=a.p1.x,o.p1.y=a.p1.y,o.p1.z=a.p1.z;this.korektLine.arrLine=this.arrLine,this.korektLine.start(),this.korektLine.setGeom(this.geometry),this.par.par.idArr},this.drawWindow=function(t,i){trace(this.par.par._delph),this.mesh1.position.x=i,t.setGeomBool1(this.geometry1,this.par.par._delph)}}return j(t,[{key:"material",set:function(t){this._material!==t&&(this._material=t,this.mesh.material=this._material)},get:function(){return this._material}}]),t}();var N=function t(i,e){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,t);var s,r;this.type="SSMatematik",this.par=i,this.fun=e,this.position=i.position,this.position1=i.position1,this.arrGran=i.arrGran,this.arrPosit=i.arrPosit,this.arrPosit1=i.arrPosit1,this.rectBig=i.rectBig,this.uuid=i.rectBig;var n,a,o=new Position;this.poiskGran=function(){p=calc.getAngle(this.position,this.position1),this.arrGran[0].set(this.arrPosit[0].x,this.arrPosit[0].y),s=calc.getAngle(o,this.arrGran[0]),r=calc.getDistance(o,this.arrGran[0]),calc.getVector(r,p-s-Math.PI,this.arrGran[0]),this.arrGran[0].x+=this.position.x,this.arrGran[0].y+=this.position.y,this.arrGran[1].set(this.arrPosit1[5].x,this.arrPosit1[5].y),s=calc.getAngle(o,this.arrGran[1]),r=calc.getDistance(o,this.arrGran[1]),calc.getVector(r,p+s,this.arrGran[1]),this.arrGran[1].x+=this.position1.x,this.arrGran[1].y+=this.position1.y,this.arrGran[2].set(-this.arrPosit1[0].x,this.arrPosit1[0].y),s=calc.getAngle(o,this.arrGran[2]),r=calc.getDistance(o,this.arrGran[2]),calc.getVector(r,p-s+Math.PI,this.arrGran[2]),this.arrGran[2].x+=this.position1.x,this.arrGran[2].y+=this.position1.y,this.arrGran[3].set(-this.arrPosit[5].x,this.arrPosit[5].y),s=calc.getAngle(o,this.arrGran[3]),r=calc.getDistance(o,this.arrGran[3]),calc.getVector(r,p+s,this.arrGran[3]),this.arrGran[3].x+=this.position.x,this.arrGran[3].y+=this.position.y,this.rectBig.x=99999999999,this.rectBig.y=99999999999,this.rectBig.x1=-29999999999,this.rectBig.y1=-29999999999;for(var t=0;t<this.arrGran.length;t++)this.rectBig.x>this.arrGran[t].x&&(this.rectBig.x=this.arrGran[t].x),this.rectBig.x1<this.arrGran[t].x&&(this.rectBig.x1=this.arrGran[t].x),this.rectBig.y>this.arrGran[t].y&&(this.rectBig.y=this.arrGran[t].y),this.rectBig.y1<this.arrGran[t].y&&(this.rectBig.y1=this.arrGran[t].y);this.rectBig.w=this.rectBig.x1-this.rectBig.x,this.rectBig.h=this.rectBig.y1-this.rectBig.y};var h,l,u,c,p,d,f,g,A,y=[];this.isRect=function(t,i){if(null==i&&this.poiskGran(),1==calc.isRectS(t,this.rectBig)){if(y.length=0,n=calc.isRectPoint(t,this.position),a=calc.isRectPoint(t,this.position1),1!=n&&1!=a||(1==n&&y.push(this.par.addPoint),1==a&&y.push(this.par.addPoint1)),trace(y),0!=y.length&&y[0].uuid!=this.uuid&&y.unshift(this.par),0==y.length)for(var e=0;e<this.arrGran.length;e+=2)if(1==calc.isRectLine(t,this.arrGran[e],this.arrGran[e+1])){y.unshift(this);break}if(0!=y.length){for(e=0;e<this.par.windows.array.length;e++)y.push(this.par.windows.array[e]);return y}}return null},this.korectOffset=function(){if(-1!=this.par.sUi){if(c=!1,this.par.offset=0,null!=f&&f.uuid==this.par.sUi&&1==f.life&&(c=!0),null==this.par._addPoint)return;if(null==this.par._addPoint1)return;if(0==c&&null==f)for(var t=0;t<this.par.stage.arrSplice.length;t++)0!=this.par.stage.arrSplice[t].life&&this.par.stage.arrSplice[t].uuid==this.par.sUi&&(f=this.par.stage.arrSplice[t],c=!0);1==c&&(h=null,l=null,u=null,this.par._addPoint._uuid==f._addPoint._uuid&&(h=this.par._addPoint1,l=this.par._addPoint,u=f._addPoint1),this.par._addPoint1._uuid==f._addPoint._uuid&&(h=this.par._addPoint,l=this.par._addPoint1,u=f._addPoint1),this.par._addPoint._uuid==f._addPoint1._uuid&&(h=this.par._addPoint1,l=this.par._addPoint,u=f._addPoint),this.par._addPoint1._uuid==f._addPoint1._uuid&&(h=this.par._addPoint,l=this.par._addPoint1,u=f._addPoint),null!=h&&(p=calc.getTreeAngel(h.position,l.position,u.position,!0),d=(p-Math.PI)/Math.PI,0==this.par._bChaz?(1==d&&(d=-1),g=this.par.delph/2-f.delph/2,A=f.delph,this.par.offset=d<=0?g-d*A:g):(g=-(this.par.delph/2-f.delph/2),A=f.delph,this.par.offset=d>=0?g-d*A:g)))}}};function G(t){p.call(this,t);this.type="SpliceSten",this.tipe="Splice",this.stage=t,this.par=t,this._boolText=!0,this._active=!1,this.idUi=Math.round(1e3*Math.random()),this.sUi=-1,this._offset=0,this._bChaz=!1,this._delph=t._delph,this._uuid=calc.generateRendom(2),this._height=t._height,this._height1=t._height1,this._carrier=t.carrier,this._out=t.out,this._adjacent=t.adjacent,this._color=this.par.aDefolt[1],this._color1=this.par.aDefolt[1],this._color2=this.par.aDefolt[2],this._color3=this.par.aDefolt[2],this._color4=this.par.aDefolt[0],1==this._carrier?this._delph=t._delphC1:this._delph=t._delphC0,this.alpha=t._alpha,this.colorP=t._colorP,this.colorP1=t._colorP1,this._height=this.stage._height,this.aVKol=0,this.arrVorur=[new Position,new Position,new Position,new Position,new Position,new Position,new Position,new Position],this.arrGran=[new Position,new Position,new Position,new Position],this.rectBig={x:0,y:0,z:0,x1:0,y1:0,z1:0,w:0,h:0,d:0,o:null},this.content2d1=new PIXI.Container,t.content2d1.addChild(this.content2d1),this.content2d=new PIXI.Container,t.content2d2.addChild(this.content2d),this.cont2dOfset=new PIXI.Container,this.cont2d0=new PIXI.Container,t.cont2dVerh.addChild(this.cont2d0),this.graph0=new PIXI.Graphics,this.cont2d0.addChild(this.graph0),this.content3d=new THREE.Object3D,this.par.content3d.add(this.content3d),this.matematik=new N(this),this.vLines=new d(this),this.ss2d=new C(this),this.ss3d=new F(this),this.arrayClass.push(this.ss2d),this.arrayClass.push(this.ss3d),this.content2d.addChild(this.cont2dOfset),this.windows=new S(this),this.arrayClass.push(this.windows),this.addBlok=function(t){return null==t?-1:this.windows.addBlok(t)},this.removeBlok=function(t){return null==t?-1:this.windows.removeBlok(t)},this.getGronVP=function(t){return null!=this.vLines.getGronVP(t)?this.vLines.getGronVP(t):null},this.numBlok=0,this.draw1=function(t){null==t&&this.windows.draw(),this.ss2d.draw1(),this.ss3d.draw1(),this.par.render()},this.dragPost=function(){this.content2d.x=this.position.x,this.content2d.y=this.position.y,this.content2d.rotation=this._rotation,this.content2d1.x=this.position.x,this.content2d1.y=this.position.y,this.content2d1.rotation=this._rotation,this.content3d.position.x=this.position.x,this.content3d.position.y=this.position.y,this.content3d.rotation.z=this._rotation,this.vLines.upDate(),this.graph0.clear(),this.vLines.drawDebug(this.graph0),this.ss3d.dragPost(),this.draw1(),this.stage.render(),this.poiskGran()};new Position;this.poiskGran=function(){this.matematik.poiskGran()};this.isRect=function(t,i){return this.matematik.isRect(t,i)};var i={};i.type=this.type,this.getInfo=function(t){i.square=this.ss3d.square,i.square01=this.ss3d.square01,i.square10=this.ss3d.square10,i.square01h1=this.ss3d.square01h1,i.square10h1=this.ss3d.square10h1,t.push(i),this.windows.getInfo(t)},this.animat=function(t){this.ss2d.animat(t)},this.korectOffset=function(){this.matematik.korectOffset()}}function X(t,i,e,s,r){var n,a;this.type="PTButton",this.par=t,this._active=t._active,this._activMouse=t._activMouse,this._activOver=!1,this.graphics=new PIXI.Graphics,this.draw=function(){this.graphics.clear(),n=r+3,1==this._activOver&&(n+=3),this.graphics.beginFill(s,a),this.graphics.drawCircle(0,0,n),1==this._active?this.graphics.beginFill(i,a):this.graphics.beginFill(e,a),this.graphics.drawCircle(0,0,n-3),this.par.par.render()},this.draw()}function U(t){s.call(this);var i=this;this.type="SpPointSten",this.tipe="SpPointSten",this.stage=t,this.par=t,this._height=300,this._active=!1,this._activMouse=t._amPoint,this.content2d=new PIXI.Container,this.stage.content2dPoint.addChild(this.content2d),this.funDragMenu=void 0,this.button=new X(this,this.stage._colorUIActive,this.stage._colorUI,this.stage._colorUI1,15),this.content2d.addChild(this.button.graphics),this.graphics=this.button.graphics,this.graphics.interactive=!0,this.onDragStart=function(e){null!=t.par.sobSP&&t.par.sobSP("downPoint",i,e)},this.graphics.interactive=this._activMouse,this.graphics.on("mousedown",this.onDragStart),this.graphics.on("mouseover",function(t){i.button.activOver=!0}),this.graphics.on("mouseout",function(t){i.button.activOver=!1}),this.funDragVokrug=function(t,i){for(var e=0;e<i.length;e++)i[e].dragPost()},this.dragPost=function(){this.dragVokrug(),this.content2d.x=this.position.x,this.content2d.y=this.position.y,null!=this.funDragMenu&&this.funDragMenu()},this.doFunRend=function(){this.par.addObjFun(this)},this.getTypeConnect=function(){var t=["AidPoint"];return this.arrIdSten.length>0&&t.push("Sten"),t}}function V(t){var i=this;this.type="SpVP",this.tipe="SpVP",this.stage=t,this.par=t,this.idArr=-1,this._life=!0,this._inSten=!1,this.gronVL=void 0,this._uuid=calc.generateRendom(2),this.uuid=this._uuid,this._objInLine=void 0,this.array=[],this.arrayClass=[],this.addObjInLine=function(t){},this.drawpositVP=function(){},this.arrayObj=[],this.addPol=function(t){this.arrayObj.push(t)},this.removePol=function(t){this.arrayObj.push(t)},this.removePol=function(t){var i=null;trace(this.arrayObj);for(var e=0;e<this.arrayObj.length;e++)t.uuid==this.arrayObj[e].uuid&&(this.arrayObj.splice(e,1),null==i&&(i=0),i++,t.removePoint(this),e=0);return 0==this.arrayObj.length&&this.clear(),this.stage.render(),i},this.clear=function(){for(var t=0;t<this.arrayClass.length;t++)"function"==typeof this.arrayClass[t].clear&&this.arrayClass[t].clear();for(var i=this.arrayObj.length-1;i>=0;i--)null!=this.arrayObj[i]&&this.removePol(this.arrayObj[i]);this.life=!1,this.stage.render()},this.drawposit=function(){console.warn("zzzz",i.position.z);for(var t=0;t<i.array.length;t++)i.array[t].drawpositVP&&i.array[t].drawpositVP(i);i.drawpositVP()},this.position=new l(0,0,0,this.drawposit)}function Q(t){V.call(this);var i=this;this.type="SpVPXz",this.tipe="SpVP",this.stage=t,this.par=t,this._height=300,this._active=!1,this._activMouse=t._amPoint,this.content2d=new PIXI.Container,this.stage.content2dPoint.addChild(this.content2d),this.funDragMenu=void 0,this.button=new X(this,this.stage._colorUIActive,this.stage._colorUI,this.stage._colorUI1,8),this.content2d.addChild(this.button.graphics),this.graphics=this.button.graphics,this.graphics.interactive=!0,this.onDragStart=function(e){null!=t.par.sobSP&&t.par.sobSP("downVP",i,e)},this.graphics.interactive=this._activMouse,this.graphics.on("mousedown",this.onDragStart),this.graphics.on("mouseover",function(t){i.button.activOver=!0}),this.graphics.on("mouseout",function(t){i.button.activOver=!1}),this.funDragVokrug=function(t,i){},this.drawpositVP=function(){this.doFunRend();for(var t=0;t<this.arrayObj.length;t++)this.par.addObjFun(this.arrayObj[t]);null!=this.funDragMenu&&this.funDragMenu()},this.dragPost=function(){this.content2d.x=this.position.x,this.content2d.y=this.position.y},this.doFunRend=function(){this.par.addObjFun(this)}}function Y(){this.type="SpUtility";var t=[],i=[];this.connectLines=function(e){t.length=0,i.length=0,t=this.tune(e);for(var s=0;s<t.length;s++)i[s]=e.stage.arrSplice[t[s]];return i};var e,s,r=[],n=[];function a(t,i){for(var e=0;e<t.length;e++)if(t[e]==i)return!1;return!0}function o(t){if(s=[],t._addPoint)for(var i=0;i<t._addPoint.arrSHron.length;i++)t.idArr!=t._addPoint.arrSHron[i].sten.idArr&&s.push(t._addPoint.arrSHron[i].sten.idArr);if(t._addPoint1)for(i=0;i<t._addPoint1.arrSHron.length;i++)t.idArr!=t._addPoint1.arrSHron[i].sten.idArr&&s.push(t._addPoint1.arrSHron[i].sten.idArr);return s}this.tune=function(t){arrSplice=t.stage.arrSplice,r.length=0,n.length=0,r.push(t.idArr),e=o(t);for(var i=0;i<e.length;i++)n.push(e[i]);for(i=0;i<n.length;i++)if(1==a(r,n[i])){r.push(n[i]),e=o(arrSplice[n[i]]);for(var s=0;s<e.length;s++)n.push(e[s])}return r}}function W(t){var i=this;this.sahAngel=t||10;var e=.1;this.radius=1,this.curvature=e,this.p=new h,this.p1=new h(1,0),this.p2=new h(.5,.5),this.pOCent=new h,this.pint90=new h,this.arrPosit=[];for(var s=0;s<this.sahAngel;s++)this.arrPosit[s]=new h;function r(t,i,e){calc.getVector(calc.getDistance(t,i)+e,calc.getAngle(i,t),t),t.x+=i.x,t.y+=i.y}this.moveLineRange=function(t){r(this.p,this.pOCent,t),r(this.p1,this.pOCent,t),r(this.p2,this.pOCent,t),this.updateFromCurvature(this.getCurrentCurvature())},this.setTwoPoint=function(t,i){this.p.setPoint(t),this.p1.setPoint(i),this.upDate()},this.getLR=function(t,i){this.upDate();var e=new W(this.sahAngel);0===i&&(e.p.setPoint(this.p),e.p1.setPoint(t)),1===i&&(e.p.setPoint(t),e.p1.setPoint(this.p1)),e.p2.set((e.p.x+e.p1.x)/2,(e.p.y+e.p1.y)/2);var s=calc.getAngle(this.pOCent,e.p2);return calc.getVector(this.radius,s,e.p2),e.p2.x+=this.pOCent.x,e.p2.y+=this.pOCent.y,e.updateFromCurvature(e.getCurrentCurvature()),e},this.setLR=function(t){this.p.setPoint(t.p),this.p1.setPoint(t.p1),this.p2.setPoint(t.p2),this.updateFromCurvature(this.getCurrentCurvature())},this.setCurvFromPoint=function(t){this.p2.setPoint(t),this.updateFromCurvature(this.getCurrentCurvature())},this.getCurrentCurvature=function(){return calc.getDistancePointToLine(this.p,this.p1,this.p2)},this.korectPoint2=function(t,i,e){t=t||0,i=i||this.p,e=e||this.p1,calc.getArrPointCircle(this.pOCent,this.radius+t,i,e,this.sahAngel,this.curvature>0,this.arrPosit)},this.upDate=function(){this.updateFromCurvature()};var n=new h;this.getPointInLineRange=function(t,i,e,s){e=e||0;var r=calc.getDistance(t,this.pOCent);if(calc.diffNum(r,this.radius)>i)return null;var a=this.getLengthPoint(t),o=this.getLenght();if(a<0||a>o){var h=Math.min(calc.diffNum(a,0),calc.diffNum(a,o));if(!s&&e<h)return null;if(s)return calc.diffNum(a,0)<calc.diffNum(a,o)?(n.setPoint(this.p),n):(n.setPoint(this.p1),n)}return calc.getVector(this.radius,calc.getAngle(this.pOCent,t),n),n.x+=this.pOCent.x,n.y+=this.pOCent.y,n},this.updateFromCurvature=function(t){var s,r,n,o;this.curvature=function(t){var s=calc.getDistance(i.p,i.p1)/2;(t=calc.getValueBetween(t,-s,s))<=0&&t>=-e?t=-e:t>=0&&t<=e&&(t=e);return t}(t||this.curvature),this.pint90.setPoint((s=this.p,r=this.p1,n=this.curvature,o=calc.getAngle(s,r)+90*calc.DEG2RAD,calc.getVector(n,o,a),a.x+=(s.x+r.x)/2,a.y+=(s.y+r.y)/2,a.x=calc.okrugNumber(a.x),a.y=calc.okrugNumber(a.y),a)),this.p2.setPoint(this.pint90);var h=calc.getCenterCircle(this.p,this.p1,this.p2);h&&this.pOCent.setPoint(h),this.radius=calc.getDistance(this.pOCent,this.p),this.korectPoint2()};var a=new h;this.getLengthPoint=function(t,i){i&&(t=new h(t.x,t.y),calc.rotationPointByLength(t,i*(this.curvature>0?-1:1),this.pOCent));var e=calc.getLenghtCircle(this.radius,this.pOCent,this.p,t,this.curvature>0),s=this.getLenght();if(e>s){var r=calc.getLenghtCircle(this.radius,this.pOCent);e>s+(r-s)/2&&(e-=r)}return e},this.getPositionByLength=function(t){var i=new h(this.p.x,this.p.y);return calc.rotationPointByLength(i,t*(this.curvature>0?-1:1),this.pOCent),i},this.getAngleByPoint=function(t,i){i*=this.curvature>0?-1:1;var e=calc.getCircleCircleIntersectionPoints(this.pOCent,this.radius,t,Math.abs(i)),s=i<0?e[0]:e[1];return calc.getAngle(t,s)},this.getLenght=function(){return calc.getLenghtCircle(this.radius,this.pOCent,this.p,this.p1,this.curvature>0)},this.getCurvatureByWidth=function(t){var i=calc.getCurvatureByWidth(t,this.radius);return null===i&&(i=calc.getCurvatureByWidth(2*this.radius*(t<0?-1:1),this.radius)),(i||0)*(this.curvature<0?-1:1)},this.getWidthByLengthTo=function(t){var i=new h(this.radius,0),e=new h(this.radius,0);return calc.rotationPointByLength(i,t),calc.getDistance(i,e)},this.getLengthByWidth=function(t){return calc.getLengthByWidth(t,i.getCurvatureByWidth(t))}}function Z(t){this.otstup=t||50,this.tip=0,this.p=new h,this.p1=new h,this.p2=new h,this.maxp=new h,this.maxp1=new h,this.maxSp1=new h,this.maxp2=new h,this.p3=new h,this.dist01=0,this.dist12=0,this.p4=new h,this.lineRange=new W(20),this.lineRange1=new W(20),this.angel=0;var i,e;this.restertTip=function(t,s,r,n,a,o){null!=a&&0!==a._offset&&(o=(i=calc.getDistance(s,a.position))<a.delph,this.angel=calc.getAngle(s,r),1!=o?calc.getVector(a._offset,this.angel-Math.PI/2,this.p):calc.getVector(a._offset,this.angel+Math.PI/2,this.p),s.x+=this.p.x,s.y+=this.p.y,r.x+=this.p.x,r.y+=this.p.y,n.x+=this.p.x,n.y+=this.p.y,a.arrPosit[2].y=a.arrPosit[3].y=0,a.arrPosit1[2].y=a.arrPosit1[3].y=0),this.tip=t,0==t&&(this.p.setPoint(s),this.p1.setPoint(r),this.p2.setPoint(n),this.angel=calc.getAngle(s,r),calc.getVector(2e4,this.angel+Math.PI,this.maxp),this.maxp.x+=s.x,this.maxp.y+=s.y,calc.getVector(this.otstup,this.angel,this.maxp1),this.maxp1.x+=r.x,this.maxp1.y+=r.y,this.dist01=calc.getDistance(this.p,this.p1),this.dist12=calc.getDistance(this.p1,this.p2),calc.getVector(2e4,this.angel,this.maxSp1),this.maxSp1.x+=r.x,this.maxSp1.y+=r.y,i=calc.getDistance(this.p1,this.p2),e=calc.getAngle(this.p1,this.p2),calc.getVector(2*i,e,this.p3),this.p3.x+=this.p.x,this.p3.y+=this.p.y),1==t&&(this.dist12=Math.abs(r),null!=n?(this.lineRange.p.setPoint(s.p1),this.lineRange.p1.setPoint(s.p),this.lineRange.p2.setPoint(s.p2),this.lineRange.updateFromCurvature(this.lineRange.getCurrentCurvature()),this.lineRange1.p.setPoint(s.p1),this.lineRange1.p1.setPoint(s.p),this.lineRange1.p2.setPoint(s.p2),this.lineRange1.updateFromCurvature(this.lineRange1.getCurrentCurvature()),this.lineRange.moveLineRange(r)):(this.lineRange.setLR(s),this.lineRange.moveLineRange(r),this.lineRange1.setLR(s)))},this.dragOtstup=function(t){0==this.tip&&(calc.getVector(t,this.angel,this.maxp1),this.maxp1.x+=this.p1.x,this.maxp1.y+=this.p1.y)},this.drawDebag=function(t,i,e){null!=t&&0==this.tip&&(t.dLine(this.p,this.maxp,e),t.dLine(this.p1,this.maxp1,e),t.dLine(this.maxSp1,this.maxp1,e,10),t.dLine(this.p,this.p3,i,10),t.dPoint(this.p3,10,i),t.dLine(this.p,this.p1,i),t.dLine(this.p1,this.p2,i),t.dPoint(this.p,10,i),t.dPoint(this.p1,10,i),t.dPoint(this.p2,10,i))}}function J(t){var i,e,s,r,n,a,o;this.setDebug=function(t){t},this.getPeresek=function(t,h){if(0==t.tip&&0==h.tip)return function(t,s){var a=new K;if(0==t.tip&&0==s.tip)return a.p.setPoint(t.p1),a.p1.setPoint(t.p1),a.p2.setPoint(t.p2),(n=t.otstup)<2*t.dist12&&(n=2*t.dist12),n<2*s.dist12&&(n=2*s.dist12),t.dragOtstup(n),s.dragOtstup(n),r=calc.getTreeAngel(t.p,t.p1,s.p),314==Math.abs(Math.round(100*r))?(a.p.setPoint(t.p1),a):0==Math.abs(Math.round(100*(t.angel-s.angel)))?(a.p.setPoint(t.p1),a):null!=(i=calc.getPointOfIntersection(t.p,t.maxp1,s.maxp,s.maxp1))?null!=(e=calc.getPointOfIntersection(t.p,t.p1,s.p,s.p3))?(a.p.setPoint(e),a.p1.setPoint(e),a):(a.p.setPoint(i),a.p1.setPoint(i),a):t.dist12>s.dist12&&null!=(i=calc.getPointOfIntersection(t.p,t.maxp,s.p,s.maxp))?(a.p1.setPoint(t.p2),a):null!=(i=calc.getPointOfIntersection(t.p1,t.p2,s.maxp,s.maxp1))?(a.p1.setPoint(i),a.p.setPoint(t.p1),a):null!=(e=calc.getPointOfIntersection(t.p,t.p1,s.p,s.p3))?(a.p.setPoint(e),a.p1.setPoint(e),a):null!=(i=calc.getPointOfIntersection(t.p,t.maxSp1,s.p1,s.p2))?(a.p.setPoint(i),a.p1.setPoint(i),a):null!=(i=calc.getPointOfIntersection(t.p,t.maxSp1,s.p1,s.maxp1))?(a.p.setPoint(i),a.p1.setPoint(i),a):null!=(i=calc.getPointOfIntersection(t.p,t.maxSp1,s.p1,s.maxSp1))?(a.p.setPoint(t.maxp1),a.p1.set((t.maxp1.x+s.maxp1.x)/2,(t.maxp1.y+s.maxp1.y)/2),null!=(e=calc.getPointOfIntersection(t.p1,t.maxp1,s.p1,s.maxp1))&&(a.p1.setPoint(e),a.p.setPoint(e)),a):a}(t,h);if(0==t.tip&&1==h.tip)return function(t,i){var e=Math.min(t.dis/2,i.dis/2),r=new K;if(0==t.tip&&1==i.tip){if(r.p.setPoint(t.p),r.p1.setPoint(t.p1),r.p2.setPoint(t.p2),(n=t.otstup)<2*t.dist12&&(n=2*t.dist12),n<2*i.dist12&&(n=2*i.dist12),t.dragOtstup(n),(s=calc.getLineCircleIntersectionPoints(t.maxp1,t.p,i.lineRange.pOCent,i.lineRange.radius)).length>1&&calc.getDistance(r.p1,s[0])>calc.getDistance(r.p1,s[1])&&s.reverse(),0!=s.length&&calc.getDistance(s[0],r.p1)<e)return r.p.setPoint(s[0]),r.p1.setPoint(s[0]),r;r.p.setPoint(t.p1)}return r}(t,h);if(1==t.tip&&0==h.tip)return function(t,i){var e=Math.min(t.dis/2,i.dis/2),r=new K;if(1==t.tip&&0==i.tip){if(r.p.setPoint(i.p),r.p1.setPoint(i.p1),r.p2.setPoint(i.p2),(n=i.otstup)<2*t.dist12&&(n=2*t.dist12),n<2*i.dist12&&(n=2*i.dist12),i.dragOtstup(n),(s=calc.getLineCircleIntersectionPoints(i.maxp1,i.p,t.lineRange.pOCent,t.lineRange.radius,!0)).length>1&&calc.getDistance(r.p1,s[0])>calc.getDistance(r.p1,s[1])&&s.reverse(),0!=s.length&&calc.getDistance(s[0],r.p1)<e)return r.p.setPoint(s[0]),r.p1.setPoint(s[0]),r;r.p.setPoint(i.p1)}return r}(t,h);if(1==t.tip&&1==h.tip)return function(t,e){var r=Math.min(t.dis/2,e.dis/2),h=new K;if(1==t.tip&&1==e.tip){if((n=e.otstup)<2*t.dist12&&(n=2*t.dist12),n<2*e.dist12&&(n=2*e.dist12),h.p.setPoint(t.lineRange.p),h.p1.setPoint(t.lineRange.p),h.p2.setPoint(t.lineRange1.p),0!=(s=calc.getCircleCircleIntersectionPoints(t.lineRange.pOCent,t.lineRange.radius,e.lineRange.pOCent,e.lineRange.radius)).length){if(1==s.length)return h.p.setPoint(s[0]),h.p1.setPoint(s[0]),h;a=calc.getDistance(h.p2,s[0]),o=calc.getDistance(h.p2,s[1]),a<o?(dis=a,i=s[0]):(dis=o,i=s[1]),dis<t.delph+e.delph&&dis<r&&(h.p.setPoint(i),h.p1.setPoint(i))}t.dist12,e.dist12}return h}(t,h);throw new Error("err type bla="+t.tip+" blaX="+h.tip)}}function q(){var t,i=!1,e=new Z(20),s=new Z(20);this.korektPoint=new J(this),this.generateUUID=function(){for(var t=[],i=0;i<256;i++)t[i]=(i<16?"0":"")+i.toString(16);return function(){var i=4294967295*Math.random()|0,e=4294967295*Math.random()|0,s=4294967295*Math.random()|0,r=4294967295*Math.random()|0;return(t[255&i]+t[i>>8&255]+t[i>>16&255]+t[i>>24&255]+"-"+t[255&e]+t[e>>8&255]+"-"+t[e>>16&15|64]+t[e>>24&255]+"-"+t[63&s|128]+t[s>>8&255]+"-"+t[s>>16&255]+t[s>>24&255]+t[255&r]+t[r>>8&255]+t[r>>16&255]+t[r>>24&255]).toUpperCase()}}();i=void 0;this.setDebug=function(t){i=t,this.korektPoint.setDebug(t)},this.getAngle=function(t,i){return i=i||rezNull,t=t||rezNull,Math.atan2(i.y-t.y,i.x-t.x)},this.getDistance=function(t,i){return null==t?0:(null==i&&(i=rezNull),i=i||rezNull,Math.sqrt(Math.pow(t.x-i.x,2)+Math.pow(t.y-i.y,2)))};var r,n,a,o=[new THREE.Vector2(0,0),new THREE.Vector2(0,0),new THREE.Vector2(0,0),new THREE.Vector2(0,0),new THREE.Vector2(0,0),new THREE.Vector2(0,0),new THREE.Vector2(0,0),new THREE.Vector2(0,0),new THREE.Vector2(0,0),new THREE.Vector2(0,0),new THREE.Vector2(0,0),new THREE.Vector2(0,0)];this.creatGrani2=function(i,e,s){if(t=i.sten,0==i.storona)if(o[0].x=e.p.x,o[0].y=e.p.y,o[1].x=e.p1.x,o[1].y=e.p1.y,o[2].x=e.p2.x,o[2].y=e.p2.y,o[3].x=s.p2.x,o[3].y=s.p2.y,o[4].x=s.p1.x,o[4].y=s.p1.y,o[5].x=s.p.x,o[5].y=s.p.y,r=i.sten.position1,n=-t._rotation,i.sten.bolPosit1=!0,0==i.sten.tip){for(var a=0;a<6;a++)o[a]=calc.povotorOtAngel(r,o[a],n);for(a=0;a<6;a++)i.sten.arrPosit1[a].set(o[a].x,o[a].y)}else if(1==i.sten.tip)if(i.sten.lineRange.curvature>0)for(a=0;a<6;a++)i.sten.arrPosit1[a].set(o[a].x,o[a].y);else for(a=0;a<6;a++)i.sten.arrPosit1[a].set(o[5-a].x,o[5-a].y);else window.console.warn("непонял как считить  ",i.sten.tip);else if(o[0].x=e.p.x,o[0].y=e.p.y,o[1].x=e.p1.x,o[1].y=e.p1.y,o[2].x=e.p2.x,o[2].y=e.p2.y,o[3].x=s.p2.x,o[3].y=s.p2.y,o[4].x=s.p1.x,o[4].y=s.p1.y,o[5].x=s.p.x,o[5].y=s.p.y,r=i.sten.position,n=-t._rotation,i.sten.bolPosit=!0,0==i.sten.tip){for(a=0;a<6;a++)o[a]=calc.povotorOtAngel(r,o[a],n);for(a=0;a<6;a++)i.sten.arrPosit[a].set(-o[a].x,o[a].y)}else if(1==i.sten.tip)if(i.sten.lineRange.curvature>0)for(a=0;a<6;a++)i.sten.arrPosit[a].set(o[5-a].x,o[5-a].y);else for(a=0;a<6;a++)i.sten.arrPosit[a].set(o[a].x,o[a].y);else window.console.warn("непонял как считить  ",i.sten.tip);0!=i.sten.offset&&(i.sten.arrPosit[2].y=i.sten.arrPosit[3].y=0,i.sten.arrPosit1[2].y=i.sten.arrPosit1[3].y=0)};var h,l,u,c,p,d,f,g=0,A=(new K,new K),y=new K;this.korektSHObject=function(t,i){if(p=(d=t).arrSHron.length,u=d.arrSHron[i],1==p&&(u.sten.korectOffset(),0==u.sten.tip?(f=u.sten.offset,1==u.storona?(u.sten.bolPosit=!1,u.sten.arrPosit[0].set(0,u.sten.delph/2+f),u.sten.arrPosit[1].set(0,u.sten.delph/2+f),u.sten.arrPosit[2].set(0,f),u.sten.arrPosit[3].set(0,f),u.sten.arrPosit[4].set(0,-u.sten.delph/2+f),u.sten.arrPosit[5].set(0,-u.sten.delph/2+f)):(u.sten.bolPosit1=!1,u.sten.arrPosit1[0].set(0,-u.sten.delph/2+f),u.sten.arrPosit1[1].set(0,-u.sten.delph/2+f),u.sten.arrPosit1[2].set(0,f),u.sten.arrPosit1[3].set(0,f),u.sten.arrPosit1[4].set(0,u.sten.delph/2+f),u.sten.arrPosit1[5].set(0,u.sten.delph/2+f))):1==u.sten.tip?1==u.storona?(u.sten.bolPosit=!0,u.sten.arrPosit[0].setPoint(u.sten.lineRange.p),u.sten.arrPosit[1].setPoint(u.sten.lineRange.p),u.sten.arrPosit[2].setPoint(u.sten.lineRange.p),u.sten.arrPosit[3].setPoint(u.sten.lineRange.p),u.sten.arrPosit[4].setPoint(u.sten.lineRange.p),u.sten.arrPosit[5].setPoint(u.sten.lineRange.p)):(u.sten.bolPosit1=!0,u.sten.arrPosit1[0].setPoint(u.sten.lineRange.p1),u.sten.arrPosit1[1].setPoint(u.sten.lineRange.p1),u.sten.arrPosit1[2].setPoint(u.sten.lineRange.p1),u.sten.arrPosit1[3].setPoint(u.sten.lineRange.p1),u.sten.arrPosit1[4].setPoint(u.sten.lineRange.p1),u.sten.arrPosit1[5].setPoint(u.sten.lineRange.p1)):window.console.warn("непонял как считить  ",u.sten.tip)),p>1){var e=0,s=0;e=0==i?d.arrSHron.length-1:i-1,s=i>=d.arrSHron.length-1?0:i+1,l=d.arrSHron[e],u=d.arrSHron[i],c=d.arrSHron[s],l.sten.korectOffset(),u.sten.korectOffset(),c.sten.korectOffset();var r=!1;p>2?(c=d.arrSHron[e],u=d.arrSHron[i],l=d.arrSHron[s]):(l=d.arrSHron[e],u=d.arrSHron[i],c=d.arrSHron[s]),A=this.getLineStan2(u,l,r),r=!r,y=this.getLineStan2(u,c,r),this.creatGrani2(u,A,y)}for(var n=0;n>d.arrSHron.length;n++)(h=d.arrSHron[n]).sten.arrPosit[2].y=0,h.sten.arrPosit[3].y=0,h.sten.arrPosit1[2].y=0,h.sten.arrPosit1[3].y=0},this.getSten2AddPoint=function(t,i){return null!=t.addPoint&&t.addPoint.idArr==i.idArr&&null!=t.addPoint1?t.addPoint1:null!=t.addPoint1&&t.addPoint1.idArr==i.idArr&&null!=t.addPoint?t.addPoint:null};var x=new THREE.Vector3(0,0);this.testAngel=function(t){if((p=t.arrSHron.length)<=1)return null;for(var i=0;i<t.arrSHron.length;i++)for(var e=i+1;e<t.arrSHron.length;e++)if(l=t.arrSHron[i],u=t.arrSHron[e],0==l.storona?(o[0].x=l.sten.position.x,o[0].y=l.sten.position.y,o[1].x=l.sten.position1.x,o[1].y=l.sten.position1.y):(o[0].x=l.sten.position1.x,o[0].y=l.sten.position1.y,o[1].x=l.sten.position.x,o[1].y=l.sten.position.y),0==u.storona?(o[2].x=u.sten.position.x,o[2].y=u.sten.position.y):(o[2].x=u.sten.position1.x,o[2].y=u.sten.position1.y),n=calc.getTreeAngel(o[0],o[1],o[2]),Math.abs(n)>3&&null!=(x=calc.isPointInLin(o[0],o[2],o[1],5,5)))return x;return null},this.getLineStan2=function(t,r,n,h,l){return e.delph=t.sten.delph+(h||0),s.delph=r.sten.delph+(l||0),e.dis=calc.getDistance(t.sten.position,t.sten.position1),s.dis=calc.getDistance(r.sten.position,r.sten.position1),g=5,e.delph/2+1>g&&(g=e.delph+1),s.delph/2+1>g&&(g=s.delph+1),a=1,1==n&&(a=-1),0==t.sten.tip?(0==t.storona?(o[0].x=o[2].x=o[4].x=t.sten.position.x,o[0].y=o[2].y=o[4].y=t.sten.position.y,o[1].x=o[3].x=o[5].x=t.sten.position1.x,o[1].y=o[3].y=o[5].y=t.sten.position1.y):(o[0].x=o[2].x=o[4].x=t.sten.position1.x,o[0].y=o[2].y=o[4].y=t.sten.position1.y,o[1].x=o[3].x=o[5].x=t.sten.position.x,o[1].y=o[3].y=o[5].y=t.sten.position.y),calc.korektToLine(o[0],o[1],0,-e.delph/2*a),e.restertTip(0,o[0],o[1],o[3],t.sten),i&&0!=t.sten.offset&&(i.clearD(),e.drawDebag(i))):1==t.sten.tip?1==n?1==t.storona?t.sten.lineRange.curvature>0?e.restertTip(1,t.sten.lineRange,-e.delph/2):e.restertTip(1,t.sten.lineRange,e.delph/2):t.sten.lineRange.curvature>0?e.restertTip(1,t.sten.lineRange,e.delph/2,!0):e.restertTip(1,t.sten.lineRange,-e.delph/2,!0):1==t.storona?t.sten.lineRange.curvature>0?e.restertTip(1,t.sten.lineRange,e.delph/2):e.restertTip(1,t.sten.lineRange,-e.delph/2):t.sten.lineRange.curvature>0?e.restertTip(1,t.sten.lineRange,-e.delph/2,!0):e.restertTip(1,t.sten.lineRange,e.delph/2,!0):window.console.warn("непонял как считить  ",t.sten.tip),0==r.sten.tip?(0==r.storona?(o[6].x=o[8].x=o[10].x=r.sten.position.x,o[6].y=o[8].y=o[10].y=r.sten.position.y,o[7].x=o[9].x=o[11].x=r.sten.position1.x,o[7].y=o[9].y=o[11].y=r.sten.position1.y):(o[6].x=o[8].x=o[10].x=r.sten.position1.x,o[6].y=o[8].y=o[10].y=r.sten.position1.y,o[7].x=o[9].x=o[11].x=r.sten.position.x,o[7].y=o[9].y=o[11].y=r.sten.position.y),calc.korektToLine(o[6],o[7],0,s.delph/2*a),s.restertTip(0,o[6],o[7],o[9],r.sten)):1==r.sten.tip?1==n?0==r.storona?r.sten.lineRange.curvature>0?s.restertTip(1,r.sten.lineRange,-s.delph/2,!0):s.restertTip(1,r.sten.lineRange,s.delph/2,!0):r.sten.lineRange.curvature>0?s.restertTip(1,r.sten.lineRange,s.delph/2):s.restertTip(1,r.sten.lineRange,-s.delph/2):0==r.storona?r.sten.lineRange.curvature>0?s.restertTip(1,r.sten.lineRange,s.delph/2,!0):s.restertTip(1,r.sten.lineRange,-s.delph/2,!0):r.sten.lineRange.curvature>0?s.restertTip(1,r.sten.lineRange,-s.delph/2):s.restertTip(1,r.sten.lineRange,s.delph/2):window.console.warn("непонял как считить  ",r.sten.tip),this.korektPoint.getPeresek(e,s)}}function K(t,i){this.p=t||new tt,this.p1=i||new tt,this.p2=new tt,this.status=0,this.perpendik=!0,this.angel=0,this.set=function(t,i){this.p=t||0,this.p1=i||0}}function tt(t,i,e){this._x=t||0,this._y=i||0,this._z=e||0,this.set=function(t,i,e){this._x=t||0,this._y=i||0,void 0!==e&&(this._z=e)},this.setPoint=function(t){this._x=t.x,this._y=t.y,void 0!==t.z&&(this._z=t.z)},this.getObj=function(){var t={};return t.x=this._x,t.y=this._y,t.z=this._z,t},this.copy=function(){return new tt(this._x,this._y,this._z)}}function it(t){var i=this;this.filterRect=void 0,this.stage=t;var e=new u;function s(t){return f().filter(p).filter(r,t)}function r(t){return calc.isParalel(this.position,this.position1,t.position,t.position1,3*calc.DEG2RAD)}function n(t,i){return t.addPoint.idArr===i.addPoint.idArr&&t.addPoint1.idArr===i.addPoint1.idArr||t.addPoint.idArr===i.addPoint1.idArr&&t.addPoint1.idArr===i.addPoint.idArr}function a(t,i){for(var e=0;e<i.length;e++)if(n(t,i[e]))return!0}function o(t,i){for(var e=0;e<i.length;e++)if(t.idArr===i[e].idArr)return!0}function h(t,i,e){return e.indexOf(t)===i}this.filterRect=void 0,this.paralelSten=function(t){i.filterRect=void 0,t&&(e.setRect(t.getRect()),i.filterRect=e);var r=function(t,e){for(var s=new DataChangeSp,r=0;r<t.length;r++){var n=i.setPointWalls(t[r].position,i.filterRect,e);s.add(n)}return s}(function(t){for(var i=[],e=0;e<t.length;e++)t[e].addPoint&&i.push(t[e].addPoint),t[e].addPoint1&&i.push(t[e].addPoint1);return i.filter(h)}(s(t)),t),l=function(t){for(var i=[],e=s(t),r=0;r<e.length;r++)for(var a=0;a<e.length;a++)e[r].idArr!==e[a].idArr&&n(e[r],e[a])&&i.push(e[r]);return i}(t);if(l.length<=1)return r;var u=function(t,i){for(var e=[],s=0;s<t.length;s++)o(t[s],i)||-1===e.indexOf(t[s])&&(t[s].rememberState(),t[s].clear(),e.push(t[s]));return e}(l,function(t,i){for(var e=[],s=0;s<t.length;s++)i.idArr!==t[s].idArr&&(a(t[s],e)||e.push(t[s]));return e}(l,t));return r.arrClearSplice=u,r};var l=5;function c(t,i){var e=!0;return e&&t.idArr==i.idArr&&(e=!1),!e||t.addPoint&&t.addPoint1&&i.addPoint&&i.addPoint1||(e=!1),!e||t.addPoint.idArr!=i.addPoint.idArr&&t.addPoint.idArr!=i.addPoint1.idArr||(e=!1),!e||t.addPoint1.idArr!=i.addPoint.idArr&&t.addPoint1.idArr!=i.addPoint1.idArr||(e=!1),e}function p(t){return!!t.life&&!(i.filterRect&&!calc.isIntersectionRect(i.filterRect,t.getRect()))}function d(t){var e=i.stage.spRelief.snappingPoint;i.stage.spRelief.snappingPoint=1,i.stage.spRelief.slitTestPoint(t),i.stage.spRelief.snappingPoint=e}function f(){return i.stage.arrSplice}function g(){return i.stage.arrPoint}function A(t,e){return i.stage.spRelief.getRadiusPoint(t,e)}function y(t,i){var e=[],s=null;if(0==t.tip&&0==i.tip)null!=(s=calc.getPointOfIntersection(t.addPoint.position,t.addPoint1.position,i.addPoint.position,i.addPoint1.position))&&e.push(new Position(s.x,s.y));else if(1==t.tip&&0==i.tip)for(var r=t.lineRange.arrPosit,n=0;n<r.length-1;n++)null!=(s=calc.getPointOfIntersection(r[n],r[n+1],i.addPoint.position,i.addPoint1.position))&&e.push(new Position(s.x,s.y));else if(0==t.tip&&1==i.tip)for(r=i.lineRange.arrPosit,n=0;n<r.length-1;n++)null!=(s=calc.getPointOfIntersection(t.addPoint.position,t.addPoint1.position,r[n],r[n+1]))&&e.push(new Position(s.x,s.y));else if(1==t.tip&&1==i.tip){r=t.lineRange.arrPosit;var a=i.lineRange.arrPosit;for(n=0;n<r.length-1;n++)for(var o=0;o<a.length-1;o++)null!=(s=calc.getPointOfIntersection(a[o],a[o+1],r[n],r[n+1]))&&e.push(new Position(s.x,s.y))}return(t.tip>1||i.tip>1)&&window.console.warn("нужно добавить для этого типа пересечения",t.tip,i.tip),e}this.setIntersectStenPoint=function(t){for(var e=new DataChangeSp,s=this.getPointOfIntersectionSten(t),r=0;r<s.length;r++){var n=i.setPointWalls(s[r],t);e.add(n)}return e},this.getPointOfIntersectionSten=function(t){i.filterRect=t;for(var e=f().filter(p),s=[],r=0;r<e.length;r++)for(var n=r;n<e.length;n++)c(e[r],e[n])&&(s=y(e[r],e[n]).concat(s));return function(t){for(var i=0;i<t.length;i++)for(var e=0;e<t.length;e++)if(i!=e&&calc.getDistance(t[i],t[e])<l){t.splice(i,1),i=0;break}for(var s=-1,i=0;i<t.length;i++)-1!=(s=A(t[i],l))&&t[i].set(g()[s].position.x,g()[s].position.y)}(s),s},this.setPointWalls=function(t,e,s){var r=null,n=new DataChangeSp;i.filterRect=e;var a=i.stage.craetPoint();a.position.set(t.x,t.y);for(var o=f().filter(p).filter(function(t){return null!=t.isPointInLin(a.position,t.delph/4,t.delph/4)&&calc.getDistance(a.position,t.addPoint.position)>l&&calc.getDistance(a.position,t.addPoint1.position)>l}),h=0;h<o.length;h++)o[h].rememberState(),r=o[h].dividedSten(a,!0),n.arrNewSplice.push(r),n.arrDividedSplice.push(o[h]),d(a);return a.clearFree(),n.update(),n}}function et(t){var i=this;this.type="SpPol",this.tipe="SpPol",this.stage=t,this.par=t,this._life=!0,this.idArr=-1,this._uuid=calc.generateUUID(),this.array=[],this.arrayClass=[];this.addPoint=function(t,i){var e=this.array.length;null!=i&&i<e&&(e=i),this.array.splice(e,0,t),t.addPol(this),this.drag(),this.stage.render()},this.removePoint=function(t){for(var i=0,e=0;e<this.array.length;e++)this.array[e].idArr==t.idArr&&(e,this.array.splice(e,1),t.removePol(this),i++);return 0!=i&&(this.drag(),this.testKill()),this.stage.render(),i},this.drag=function(){},this.clear=function(){for(var t=this.array.length-1;t>=0;t--)this.array[t]&&this.array[t].removePol(this);this.life=!1,this.stage.render()},this.testKill=function(){this.array.length<=2&&this.clear()},this._setAllParam=function(t,e){for(var s=0;s<i.arrayClass.length;s++)t in i.arrayClass[s]&&(i.arrayClass[s][t]=e)}}function st(){var t=this;this.type="SpStage",this._delph=20,this.tipPoint="SpPoint",this.tipSplice="Splice",this.arrSplice=[],this.arrPoint=[],this.arrPol=[],this.arrayClass=[],this.arrCreat=[],this.arrClear=[],this.arrClearState=[],this.avp=[],this.objBase=void 0,this.configData={delph:20},this.spUtility=new Y,this.spCalc=new q,window.calc=new a,window.PositionFun=l,window.Position=h,window.Rectangle=u,window.LinePosition=o,this.korektSplice=new it(this),this._activMouse=!0,this._pointVisi=!0,this._oporPointVisi=!0,this._visiDimensioOnObj=!1,this.hesh={},this.getPoint=function(t){return new s(this)},this.getSplice=function(t){return new p(this)},this.getPol=function(t){return new et(this)},this.getVP=function(t){return new V(this)},this.render=function(){},this.funUpdateUuid=function(i,e){t.hesh[i]&&(t.hesh[i]!==this&&window.console.error("",t.hesh[i],this),delete t.hesh[i]),t.hesh[e]&&(t.hesh[e]!==this&&window.console.error("этот uuid уже испольузутся",t.hesh[e],this),delete t.hesh[i]),t.hesh[e]=this}}G.prototype=Object.create(p.prototype),G.prototype.constructor=G,G.prototype.getObj=function(){var t=p.prototype.getObj.call(this);return t.type=this.type,t.windows=this.windows.getObj(),t.colorSten=this.colorSten,t.height=this.height,t.sUi=this.sUi,t.idUi=this.idUi,t.offset=this.offset,t.bChaz=this.bChaz,t.carrier=this.carrier,t.out=this.out,t.adjacent=this.adjacent,t.color=this.color,t.color1=this.color1,t.color2=this.color2,t.color3=this.color3,t.color4=this.color4,t.vLines=this.vLines.getObj(),t},G.prototype.setObj=function(t){p.prototype.setObj.call(this,t),void 0!==t.windows&&this.windows.setObj(t.windows),void 0!==t.boolText&&(this.boolText=t.boolText),void 0!==t.height&&(this.height=t.height),void 0!==t.idUi&&(this.idUi=t.idUi),void 0!==t.sUi&&(this.sUi=t.sUi),void 0!==t.offset&&(this.offset=t.offset),void 0!==t.bChaz&&(this.bChaz=t.bChaz),void 0!==t.carrier&&(this.carrier=t.carrier),void 0!==t.out&&(this.out=t.out),void 0!==t.adjacent&&(this.adjacent=t.adjacent),void 0!==t.color&&(this.color=t.color),void 0!==t.color1&&(this.color1=t.color1),void 0!==t.color2&&(this.color2=t.color2),void 0!==t.color3&&(this.color3=t.color3),void 0!==t.color4&&(this.color4=t.color4),t.vLines&&this.vLines.setObj(t.vLines)},G.prototype.compare=function(t){var i=!0;return p.prototype.compare(this,t)||(i=!1),i},G.prototype.setSten=function(t){p.prototype.setSten.call(this,t)},G.prototype.restart=function(){p.prototype.restart(this)},G.prototype.drag=function(){p.prototype.drag.call(this),this.stage.addObjFun(this)},Object.defineProperties(G.prototype,{height:{set:function(t){this._height!==t&&(this._height=t,this._setAllParam("height",this._height))},get:function(){return this._height}},height1:{set:function(t){this._heigh1!==t&&(this._height1=t,this._setAllParam("height1",this._height1))},get:function(){return this._height1}},boolText:{set:function(t){this._boolText!==t&&(this._boolText=t,this._setAllParam("boolText",this._boolText))},get:function(){return this._boolText}},active:{set:function(t){this._active!==t&&(this._active=t,this._setAllParam("active",this._active))},get:function(){return this._active}},activMouse:{set:function(t){if(this._activMouse!=t){this._activMouse=t;for(var i=0;i<this.arrayClass.length;i++)"activMouse"in this.arrayClass[i]&&(this.arrayClass[i].activMouse=this._activMouse)}},get:function(){return this._activMouse}},life:{set:function(t){if(this._life!=t){this._life=t;for(var i=0;i<this.arrayClass.length;i++)"life"in this.arrayClass[i]&&(this.arrayClass[i].life=this._life);1==this._life?this.par.content3d.add(this.content3d):null!=this.content3d.parent&&this.content3d.parent.remove(this.content3d),1==this._life?this.stage.content2d2.addChild(this.content2d):null!=this.content2d.parent&&this.content2d.parent.removeChild(this.content2d),1==this._life?this.stage.content2d1.addChild(this.content2d1):null!=this.content2d1.parent&&this.content2d1.parent.removeChild(this.content2d1)}},get:function(){return this._life}},carrier:{set:function(t){this._carrier!==t&&(this._carrier=t,this.delph=this.par.getDelphToBoolS(this._carrier,this._out,this._adjacent),this.draw1())},get:function(){return this._carrier}},out:{set:function(t){this._out!==t&&(this._out=t,this.delph=this.par.getDelphToBoolS(this._carrier,this._out,this._adjacent),this.draw1())},get:function(){return this._out}},adjacent:{set:function(t){this._adjacent!==t&&(this._adjacent=t,this.delph=this.par.getDelphToBoolS(this._carrier,this._out,this._adjacent),this.draw1())},get:function(){return this._adjacent}},offset:{set:function(t){this._offset!==t&&(this._offset=t,this.cont2dOfset.position.y=this._offset,this._setAllParam("offset",this._offset),null!=this.funDragMenu&&this.funDragMenu(),this.stage.render())},get:function(){return this._offset}},bChaz:{set:function(t){this._bChaz!==t&&(this._bChaz=t,this._setAllParam("bChaz",this._bChaz),null!=this.funDragMenu&&this.funDragMenu(),this.stage.render())},get:function(){return this._bChaz}},color:{set:function(t){this._color!==t&&(this._color=t,this._setAllParam("color",this._color),null!=this.funDragMenu&&this.funDragMenu(),this.stage.render())},get:function(){return this._color}},color1:{set:function(t){this._color1!==t&&(this._color1=t,this._setAllParam("color1",this._color1),null!=this.funDragMenu&&this.funDragMenu(),this.stage.render())},get:function(){return this._color1}},color2:{set:function(t){this._color2!==t&&(this._color2=t,this._setAllParam("color2",this._color2),null!=this.funDragMenu&&this.funDragMenu(),this.stage.render())},get:function(){return this._color2}},color3:{set:function(t){this._color3!==t&&(this._color3=t,this._setAllParam("color3",this._color3),null!=this.funDragMenu&&this.funDragMenu(),this.stage.render())},get:function(){return this._color3}},color4:{set:function(t){this._color4!==t&&(this._color4=t,this._setAllParam("color4",this._color4),null!=this.funDragMenu&&this.funDragMenu(),this.stage.render())},get:function(){return this._color4}}}),X.prototype={set activMouse(t){this._activMouse!==t&&(this._activMouse=t,this.draw())},get activMouse(){return this._activMouse},set active(t){this._active!==t&&(this._active=t,this.draw())},get active(){return this._active},set activOver(t){this._activOver!==t&&(this._activOver=t,this.draw())},get activOver(){return this._activOver}},U.prototype=Object.create(s.prototype),U.prototype.constructor=U,U.prototype.getObj=function(){var t=s.prototype.getObj.call(this);return t.type=this.type,t},U.prototype.setObj=function(t){s.prototype.setObj.call(this,t)},Object.defineProperties(U.prototype,{active:{set:function(t){if(this._active!=t){this._active=t,this.button.active=this._active;for(var i=0;i<this.arrayClass.length;i++)"active"in this.arrayClass[i]&&(this.arrayClass[i].active=this._active)}},get:function(){return this._active}},height:{set:function(t){if(this._height!=t){this._height=t;for(var i=0;i<this.arrayClass.length;i++)"height"in this.arrayClass[i]&&(this.arrayClass[i].height=this._height)}},get:function(){return this._height}},activMouse:{set:function(t){if(this._activMouse!=t){this._activMouse=t,this.button.activMouse=t,this.graphics.interactive=t,console.warn(this.idArr+"   "+this._activMouse+"   "+this._life);for(var i=0;i<this.arrayClass.length;i++)"activMouse"in this.arrayClass[i]&&(this.arrayClass[i].activMouse=this._activMouse)}},get:function(){return this._activMouse}},life:{set:function(t){this._life!=t&&(this._life=t,1==this._life?this.stage.content2dPoint.addChild(this.content2d):null!=this.content2d.parent&&this.content2d.parent.removeChild(this.content2d))},get:function(){return this._life}}}),V.prototype={set life(t){if(this._life!=t){this._life=t;for(var i=0;i<this.arrayClass.length;i++)null!=this.arrayClass[i].life&&(this.arrayClass[i].life=this._life)}},get life(){return this._life},getObj:function(){var t={};return t.uuid=this._uuid,t.position=this.position.getObj(),null!=this.gronVL&&(t.gronVL={},t.gronVL.uuid=this.gronVL.par.uuid,t.gronVL.pros=this.gronVL.pros,t.gronVL.os=this.gronVL.par.os),t},setObj:function(t){if(t.uuid&&(this.uuid=this._uuid=t.uuid),this.position.setPoint(t.position),null!=t.gronVL){var i=this.par.getGronVP(t.gronVL.uuid);if(null!=i)i.add(this).pros=t.gronVL.pros}}},Q.prototype=Object.create(V.prototype),Q.prototype.constructor=Q,Q.prototype.getObj=function(){return V.prototype.getObj.call(this)},Q.prototype.setObj=function(t){V.prototype.setObj.call(this,t)},Object.defineProperties(Q.prototype,{active:{set:function(t){if(this._active!=t){this._active=t,this.button.active=this._active;for(var i=0;i<this.arrayClass.length;i++)"active"in this.arrayClass[i]&&(this.arrayClass[i].active=this._active)}},get:function(){return this._active}},activMouse:{set:function(t){if(this._activMouse!=t){this._activMouse=t,this.graphics.interactive=t,this.button.activMouse=t;for(var i=0;i<this.arrayClass.length;i++)"activMouse"in this.arrayClass[i]&&(this.arrayClass[i].activMouse=this._activMouse)}},get:function(){return this._activMouse}},life:{set:function(t){this._life!=t&&(this._life=t,1==this._life?this.stage.content2dPoint.addChild(this.content2d):null!=this.content2d.parent&&this.content2d.parent.removeChild(this.content2d))},get:function(){return this._life}}}),tt.prototype={set x(t){this._x=t},get x(){return this._x},set y(t){this._y=t},get y(){return this._y},set z(t){this._z=t},get z(){return this._z}},et.prototype={set uuid(t){this._uuid},get uuid(){return this._uuid},getObj:function(){for(var t={array:[]},i=0;i<this.array.length;i++)t.array.push({x:this.array[i].position.x,y:this.array[i].position.y,z:this.array[i].position.z,tipe:this.array[i].tipe});return t},setObj:function(t){for(var i=0;i<t.array.length;i++){var e=this.stage.getPointXY(t.array[i]);this.addPoint(e)}this.drag()},set life(t){this._life!=t&&(this._life=t)},get life(){return this._life}},st.prototype={craetPoint:function(){for(var t=0;t<this.arrPoint.length;t++)if(0==this.arrPoint[t].life)return this.arrPoint[t].life=!0,this.arrPoint[t];var i=this.getPoint();return this.arrPoint.push(i),this.arrPoint[this.arrPoint.length-1].idArr=this.arrPoint.length-1,this.arrPoint[this.arrPoint.length-1]},craetVP:function(){for(var t=0;t<this.avp.length;t++)if(0==this.avp[t].life)return this.avp[t].life=!0,this.avp[t];var i=this.getVP();return this.avp.push(i),this.avp[this.avp.length-1].idArr=this.avp.length-1,this.avp[this.avp.length-1].life=!0,this.avp[this.avp.length-1]},craetSplice1:function(){for(var t=0;t<this.arrSplice.length;t++)if(0==this.arrSplice[t].life)return this.arrSplice[t].life=!0,this.arrSplice[t].delph=this._delph,this.arrSplice[t];var i=this.getSplice();return this.arrSplice.push(i),this.arrSplice[this.arrSplice.length-1].idArr=this.arrSplice.length-1,this.arrSplice[this.arrSplice.length-1].funUpdateUuid=this.funUpdateUuid,this.arrSplice[this.arrSplice.length-1].restart(),this.arrSplice[this.arrSplice.length-1].delph=this._delph,this.hesh[this.arrSplice[this.arrSplice.length-1].uuid]=this.arrSplice[this.arrSplice.length-1],this.arrSplice[this.arrSplice.length-1]},craetSplice11:function(){return this.craetSplice1()},craetSplice:function(t,i){return this.create(t,i)},create:function(t,i){if(t=t||{},!(i=i||t.uuid))return this.craetSplice1();this.hesh[i]||(this.craetSplice1().uuid=i);return t&&this.hesh[i].setObj(t),this.hesh[i]},craetPol:function(t){for(var i=0;i<this.arrPol.length;i++)if(0==this.arrPol[i].life)return this.arrPol[i].life=!0,this.arrPol[i];var e=this.getPol(t);return this.arrPol.push(e),this.arrPol[this.arrPol.length-1].idArr=this.arrPol.length-1,this.hesh[this.arrPol[this.arrPol.length-1].uuid]=this.arrPol[this.arrPol.length-1],this.arrPol[this.arrPol.length-1]},render:function(){},getIdPositon:function(t,i){for(var e=0;e<this.arrPoint.length;e++)if(0!=this.arrPoint[e].life&&calc.testPositPoint(this.arrPoint[e].position,t)&&s(this.arrPoint[e],i))return e;function s(t,i){if(!i)return!0;for(var e=t.getConectedSten(),s=0;s<e.length;s++)if(-1!==i.indexOf(e[s].uuid))return!0;return!1}return-1},getPointXY:function(t){if(t.tipe&&"SpVP"==t.tipe){for(var i=0;i<this.avp.length;i++)if(this.avp[i].life&&Math.round(t.x)==Math.round(this.avp[i].position.x)&&Math.round(t.y)==Math.round(this.avp[i].position.y)&&Math.round(t.z)==Math.round(this.avp[i].position.z))return trace(t.z),this.avp[i];return(e=this.craetVP()).position.setPoint(t),e}for(i=0;i<this.arrPoint.length;i++)if(this.arrPoint[i].life&&Math.round(t.x)==Math.round(this.arrPoint[i].position.x)&&Math.round(t.y)==Math.round(this.arrPoint[i].position.y))return this.arrPoint[i];var e;return(e=this.craetPoint()).position.setPoint(t),e},getGronVP:function(t){return null},stenInPoint:function(t){var i,e=t.connected?t.connected.arr:void 0,s=this.getIdPositon(t.position,e);(i=-1==s?this.craetPoint():this.arrPoint[s]).position.setPoint(t.position),i.addSplice(t,!0),e=t.connected?t.connected.arr1:void 0,(i=-1==(s=this.getIdPositon(t.position1,e))?this.craetPoint():this.arrPoint[s]).position.setPoint(t.position1),i.addSplice(t,!1)},getObj:function(t){var i={};i.type=this.type,i.tipPoint=this.tipPoint,i.tipSplice=this.tipSplice,i.arrPoint=[],i.arrSplice=[],i.arrPol=[],i.avp=[];for(var e=0;e<this.arrPoint.length;e++)this.arrPoint[e].life&&i.arrPoint.push(this.arrPoint[e].getObj());for(e=0;e<this.arrSplice.length;e++)this.arrSplice[e].life&&i.arrSplice.push(this.arrSplice[e].getObj());for(e=0;e<this.avp.length;e++)this.avp[e].life&&i.avp.push(this.avp[e].getObj());for(e=0;e<this.arrPol.length;e++)this.arrPol[e].life&&i.arrPol.push(this.arrPol[e].getObj());return i},setObj:function(t){var i;if(null!=t.tipPoint&&(this.tipPoint=t.tipPoint),null!=t.tipSplice&&(this.tipSplice=t.tipSplice),this.arrCreat.length=0,null!=t.arrSplice)for(var e=0;e<t.arrSplice.length;e++)(i=this.craetSplice()).setObj(t.arrSplice[e]),this.arrCreat.push(i);if(null!=t.avp)for(e=0;e<t.avp.length;e++)(i=this.craetVP()).setObj(t.avp[e]);if(null!=t.arrPol)for(e=0;e<t.arrPol.length;e++)(i=this.craetPol(t.arrPol[e].unik)).setObj(t.arrPol[e]);!function(t){for(var i=0;i<t.length;i++)t[i].clearFree()}(this.arrPoint);for(e=0;e<this.arrPoint.length;e++)this.arrPoint[e].life&&this.arrPoint[e].dragGG()},clear:function(){for(var t=0;t<this.arrPoint.length;t++)this.arrPoint[t].clear();for(t=0;t<this.arrSplice.length;t++)this.arrSplice[t].clear();for(t=0;t<this.arrPol.length;t++)this.arrPol[t].clear();for(t=0;t<this.avp.length;t++)this.avp[t].clear()}},Object.defineProperties(st.prototype,{delph:{set:function(t){this._delph=t},get:function(){return this._delph}}});e(4);function rt(t,i){for(var e=0;e<i.length;e++){var s=i[e];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}var nt=function(){function t(i,e){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,t),this.type="SPLine";var s,r,n,a=this;this.par=i,this.fun=e,this._life=!0,this._visible=!0,this._otstup=0,this.sah=10,this.colol=4085598,this.colol_="#3e575e",this.array=[],this.uuid=calc.generateUUID(),this._activeMouse=!this.par.activeMouse,this._mashtabText=1,this.content2d=new PIXI.Container,i.content2d.addChild(this.content2d),this.graphics=new PIXI.Graphics,this.content2d.addChild(this.graphics),this._addPoint=void 0,this._addPoint1=void 0,this.text=new PIXI.Text("345634634",{fontFamily:"Arial"}),this.content2d.addChild(this.text),this.text.scale.x=this.text.scale.y=this._mashtabText,this.onDragStart=function(t){null!=a.par.sobSP&&a.par.sobSP("downLine",a,t)},this.onDragStart1=function(t){null!=a.par.sobSP&&a.par.sobSP("downLine1",a,t)},this.onDragStart2=function(t){null!=a.par.sobSP&&a.par.sobSP("downLine2",a,t)},this.g=new PIXI.Graphics,this.g.name="0",this.g.beginFill(16777215,.01),this.g.drawCircle(0,0,5),this.g1=new PIXI.Graphics,this.g1.beginFill(16777215,.01),this.g1.drawCircle(0,0,5),this.g1.name="1",this.g2=new PIXI.Graphics,this.g2.name="1",this.render=this.par.render,this.activeMouse=this.par.activeMouse,this.clear=function(){this.life=!1,this._otstup=0,this.render&&this.render()},this.drawposit=function(){a.drag()},this.position=new PositionFun(0,0,this.drawposit),this.position1=new PositionFun(0,0,this.drawposit),this.p=new Position,this.p1=new Position,this.pNull=new Position(0,0),this.drag=function(){s=calc.getAngle(this.position,this.position1),r=calc.getDistance(this.position,this.position1),calc.getVector(this._otstup,s+Math.PI/2,this.p),this.p.x+=this.position.x,this.p.y+=this.position.y,calc.getVector(this._otstup,s+Math.PI/2,this.p1),this.p1.x+=this.position1.x,this.p1.y+=this.position1.y,this.content2d.x=this.position.x,this.content2d.y=this.position.y,this.content2d.rotation=s,this.graphics.clear(),this.graphics.lineStyle(1,this.colol,1),this.graphics.moveTo(0,0),this.graphics.lineTo(0,this._otstup+(this._otstup>0?this.sah:-this.sah)),this.graphics.moveTo(0,this._otstup),this.graphics.lineTo(r,this._otstup),this.graphics.moveTo(r,0),this.graphics.lineTo(r,this._otstup+(this._otstup>0?this.sah:-this.sah)),this.graphics.lineStyle(1.5,this.colol,1),this.graphics.moveTo(-this.sah/2,this._otstup+(this._otstup>0?.5*this.sah:.5*-this.sah)),this.graphics.lineTo(this.sah/2,this._otstup+(this._otstup>0?.5*-this.sah:.5*this.sah)),this.graphics.moveTo(r-this.sah/2,this._otstup+(this._otstup>0?.5*this.sah:.5*-this.sah)),this.graphics.lineTo(r+this.sah/2,this._otstup+(this._otstup>0?.5*-this.sah:.5*this.sah)),this.g2.clear(),this.g2.beginFill(16777215,.01),this.g2.drawRect(0,0,r,32*this._mashtabText),this.g2.y=this._otstup,this.g1.x=r,s>-Math.PI/2&&s<Math.PI/2?(this.text.text=""+Math.round(r),this.text.x=r/2-this.text.width/2,this.text.y=this._otstup,this.text.rotation=0):(this.text.text=""+Math.round(r),this.text.x=r/2+this.text.width/2,this.text.y=this._otstup+32*this._mashtabText,this.text.rotation=Math.PI),this.render&&this.render()},this.dragPost=function(){a.draw()},this.draw=function(){this.graphics.clear(),null!=this._addPoint&&null!=this._addPoint1&&(this.position._x=this._addPoint.position.x,this.position._y=this._addPoint.position.y,this.position1._x=this._addPoint1.position.x,this.position1._y=this._addPoint1.position.y,this.drag())},this.poiskOt=function(t){(n=calc.isPointInLin(this.position1,this.position,t,111111111,111111111))&&(this.otstup=n.z)},this.setObj=function(t){this.position.set(t.position.x,t.position.y),this.position1.set(t.position1.x,t.position1.y),this.otstup=t.otstup,t.apUUID&&null!=this.par.par.metod.getPLUUID(t.apUUID)&&(this.addPoint=this.par.par.metod.getPLUUID(t.apUUID)),t.apUUID1&&null!=this.par.par.metod.getPLUUID(t.apUUID1)&&(this.addPoint1=this.par.par.metod.getPLUUID(t.apUUID1))},this.getObj=function(){console.warn("@@@@@@@@@@@@@@@@@@@@@@@@@@");var t={};return t.position={x:this.position.x,y:this.position.y},t.position1={x:this.position1.x,y:this.position1.y},t.otstup=this.otstup,null!=this._addPoint&&(t.apUUID=this._addPoint.uuid),null!=this._addPoint1&&(t.apUUID1=this._addPoint1.uuid),t}}var i,e,s;return i=t,(e=[{key:"activeMouse",set:function(t){this._activeMouse!=t&&(this._activeMouse=t,t?(this.content2d.addChild(this.g2),this.content2d.addChild(this.g),this.content2d.addChild(this.g1),this.g.interactive=!0,this.g1.interactive=!0,this.g2.interactive=!0,this.g.on("mousedown",this.onDragStart),this.g1.on("mousedown",this.onDragStart1),this.g2.on("mousedown",this.onDragStart2)):(this.content2d.removeChild(this.g2),this.content2d.removeChild(this.g),this.content2d.removeChild(this.g1),this.g.interactive=!1,this.g1.interactive=!1,this.g2.interactive=!1,this.g.off("mousedown",this.onDragStart),this.g1.off("mousedown",this.onDragStart1),this.g2.off("mousedown",this.onDragStart2)))},get:function(){return this._activeMouse}},{key:"visible",set:function(t){this._visible!=t&&(this._visible=t,this.content2d.visible=t)},get:function(){return this._visible}},{key:"otstup",set:function(t){this._otstup!=t&&(this._otstup=t,this.drag())},get:function(){return this._otstup}},{key:"life",set:function(t){this._life!=t&&(this._life=t,1==this._life?this.par.content2d.addChild(this.content2d):null!=this.content2d.parent&&this.content2d.parent.removeChild(this.content2d))},get:function(){return this._life}},{key:"addPoint",set:function(t){this._addPoint!=t&&(this._addPoint=t,null!=t&&t.addPol(this),this.draw())},get:function(){return this._addPoint}},{key:"addPoint1",set:function(t){this._addPoint1!=t&&(this._addPoint1=t,null!=t&&t.addPol(this),this.draw())},get:function(){return this._addPoint1}}])&&rt(i.prototype,e),s&&rt(i,s),t}();function at(t,i){for(var e=0;e<i.length;e++){var s=i[e];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}var ot=function(){function t(i,e){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,t),this.type="SPLine";var s=this;this.par=i,this.fun=e,this.sp=i.par,this._activeMouse=!0,this.array=[],this.arrayPosit=[],this.arrayPosit1=[],this.kol=0,this.content2d=new PIXI.Container,this.clear=function(){s.sp.render();for(var t=0;t<this.array.length;t++)this.array[t].visible=!1},this.craetLine=function(){var t=new nt(this);return t.life=!1,this.content2d.addChild(t.content2d),t.content2d.alpha=.5,t.render=s.sp.render(),t},this.visiOtstup=function(t,i){var e,r=this.pointOld.x-t.x,n=this.pointOld.y-t.y;Math.round(i)==-Math.round(Math.PI/2)&&(e=-r),Math.round(i)==-Math.round(Math.PI)&&(e=n);for(var a=0;a<this.arrayPosit1.length-1;a++)this.array[a].visible=!0,this.array[a].otstup=e;s.sp.render()},this.creatReal=function(){for(var t={array:[]},i=0;i<this.arrayPosit1.length-1;i++)t.array.push(this.array[i].getObj());s.par.setObj(t),s.sp.render()};new Position;var r,n=new Position;this.pointOld=new THREE.Vector3,this.visiPoint=function(t,i,e){this.clear(),this.pointOld.x=t.x,this.pointOld.y=t.y,calc.getVector(9999999,i,n),n.x+=t.x,n.y+=t.y,this.kol=0;for(var a=0;a<this.sp.arrSplice.length;a++)if(this.sp.arrSplice[a].life)for(var o=0;o<s.sp.arrSplice[a].arrGran.length;o+=2)(r=calc.getPointOfIntersection(s.sp.arrSplice[a].arrGran[o],s.sp.arrSplice[a].arrGran[o+1],t,n))&&(null==this.arrayPosit[this.kol]&&(this.arrayPosit[this.kol]=new THREE.Vector3),this.arrayPosit[this.kol].x=r.x,this.arrayPosit[this.kol].y=r.y,this.arrayPosit[this.kol].z=calc.getDistance(this.arrayPosit[this.kol],t),this.kol++);if(!(this.kol<2)){this.arrayPosit1.length=0;for(a=0;a<this.kol;a++)null==e?this.arrayPosit1.push(this.arrayPosit[a]):this.arrayPosit[a].x>=e.x&&this.arrayPosit[a].x<=e.x1&&this.arrayPosit[a].y>=e.y&&this.arrayPosit[a].y<=e.y1&&this.arrayPosit1.push(this.arrayPosit[a]);if(!(this.arrayPosit1.length<2)){this.arrayPosit1.sort(function(t,i){return t.z-i.z});for(a=0;a<this.arrayPosit1.length-1;a++)null==this.array[a]&&(this.array[a]=this.craetLine()),this.array[a].position.set(this.arrayPosit1[a].x,this.arrayPosit1[a].y),this.array[a].position1.set(this.arrayPosit1[a+1].x,this.arrayPosit1[a+1].y),this.array[a].visible=!0,this.array[a].otstup=0;s.sp.render()}}}}var i,e,s;return i=t,(e=[{key:"activeMouse",set:function(t){this._activeMouse!=t&&(this._activeMouse=t)},get:function(){return this._activeMouse}}])&&at(i.prototype,e),s&&at(i,s),t}();function ht(t,i){for(var e=0;e<i.length;e++){var s=i[e];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}var lt=function(){function t(i,e){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,t),this.type="SPLine";var s=this;this.par=i,this.fun=e,this._activeMouse=!0,this.array=[],this.content2d=new PIXI.Container,this.par.cont2dLine.addChild(this.content2d),this.debugPixi=new P.a,this.content2d.addChild(this.debugPixi.content2d),this.visiLine=new ot(this,function(t,i,e){}),this.par.cont2dLine.addChild(this.visiLine.content2d),this.sobSP=function(t,i,e){s.par.par.sobSP(t,i,e)},this.craetLine=function(){for(var t=0;t<this.array.length;t++)if(0==this.array[t].life)return this.array[t].life=!0,this.array[t];return this.array.push(new nt(this)),this.array[this.array.length-1].idArr=this.array.length-1,this.array[this.array.length-1]};var r,n,a,o={x:0,y:0,d:0,o:null};this.getPoint=function(t,i){r=99999999999999,a=-1;for(var e=0;e<this.array.length;e++)0!=this.array[e].life&&(i&&this.array[e].idArr==i.idArr||(n=calc.getDistance(t,this.array[e].p1),r>n&&(o.x=this.array[e].p.x,o.y=this.array[e].p.y,r=n,a=e),n=calc.getDistance(t,this.array[e].p),r>n&&(o.x=this.array[e].p1.x,o.y=this.array[e].p1.y,r=n,a=e)));return-1!=a?(o.d=r,o.o=this.array[a],o):null},this.clear=function(){for(var t=0;t<this.array.length;t++)this.array[t].life=!1},this.render=function(){this.par.render()},this.setObj=function(t){for(var i=0;i<t.array.length;i++){this.craetLine().setObj(t.array[i])}},this.getObj=function(){console.warn("########1########");for(var t={array:[]},i=0;i<this.array.length;i++)0!=this.array[i].life&&t.array.push(this.array[i].getObj());return t}}var i,e,s;return i=t,(e=[{key:"activeMouse",set:function(t){if(this._activeMouse!=t){this._activeMouse=t;for(var i=0;i<this.array.length;i++)this.array[i].activeMouse=t}},get:function(){return this._activeMouse}}])&&ht(i.prototype,e),s&&ht(i,s),t}();function ut(t,i){for(var e=0;e<i.length;e++){var s=i[e];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}var ct=function(){function t(){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,t),this.type="Body";var i=this;this.drag=void 0,this.target,this.rect={x:0,y:0,z:0,w:0,h:0,d:0,x1:0,y1:0,z1:0},this.col=parseInt("1110011100",2),this.col1=parseInt("111",2),this.offset=0,this.dragFun=function(){console.warn("$$$@@",this.y),i._parent&&i._parent.korektPosition(i),null!=i.drag&&i.drag()},this.position=new m(0,0,0,this.dragFun),this.children=this.array=[],this.uuid=1*(Math.round(1e11*Math.random())+""+Math.round(1e11*Math.random())),this.addShape=function(t){this.children.push(t),t.parent=this,this.korekt()},this.removeShape=function(t){},this.korekt=function(){if(0!=this.children.length){this.rect.x=this.rect.y=this.rect.z=999999999999999,this.rect.x1=this.rect.y1=this.rect.z1=-999999999999999,this.rect.w=this.rect.h=this.rect.d=0,trace(this.children);for(var t=0;t<this.children.length;t++)this.rect.x>this.children[t].rect.x&&(this.rect.x=this.children[t].rect.x),this.rect.y>this.children[t].rect.y&&(this.rect.y=this.children[t].rect.y),this.rect.z>this.children[t].rect.z&&(this.rect.z=this.children[t].rect.z),this.rect.x1<this.children[t].rect.x+this.children[t].rect.w&&(this.rect.x1=this.children[t].rect.x+this.children[t].rect.w),this.rect.y1<this.children[t].rect.y+this.children[t].rect.h&&(this.rect.y1=this.children[t].rect.y+this.children[t].rect.h),this.rect.z1<this.children[t].rect.z+this.children[t].rect.d&&(this.rect.z1=this.children[t].rect.z+this.children[t].rect.d);this.rect.w=this.rect.x1-this.rect.x,this.rect.h=this.rect.y1-this.rect.y,this.rect.d=this.rect.z1-this.rect.z}else this.rect.x=this.rect.y=this.rect.z=this.rect.x1=this.rect.y1=this.rect.z1=this.rect.w=this.rect.h=this.rect.d=0}}var i,e,s;return i=t,(e=[{key:"parent",set:function(t){this._parent!=t&&(this._parent=t)},get:function(){return this._parent}}])&&ut(i.prototype,e),s&&ut(i,s),t}();function pt(t,i){for(var e=0;e<i.length;e++){var s=i[e];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}var dt=function(){function t(){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,t),this.type="Shape";this.name="rect",this.rect=[0,0,0,100,100,100],this.uuid=1*(Math.round(1e11*Math.random())+""+Math.round(1e11*Math.random()));this.rect={x:-100,y:-100,z:-100,w:200,h:200,d:200},this.setRect=function(t){for(var i in t)this.rect[i]=t[i];null!=this._parent&&this._parent.korekt()}}var i,e,s;return i=t,(e=[{key:"parent",set:function(t){this._parent!=t&&(this._parent=t)},get:function(){return this._parent}}])&&pt(i.prototype,e),s&&pt(i,s),t}();function ft(t,i){for(var e=0;e<i.length;e++){var s=i[e];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}var gt=function(){function t(i,e,s){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,t),this.type="Blok";var r=this;this.par=i,this.objBase=e,this.obj=e.obj,this.fun=s,this.id=e.id,this.icon="resources/data/"+this.id+"/128.png",trace(e.icon),this.typeStr=this.obj.str[0],this.typeStr1=this.obj.str[1],this.idArr=-1,this._active=!1,this.sizeLine=this.par.par.sizeLine,this._width=100,this._height=100,this._delph=100,this._boolSten=!1,this._rotation=0,this.boxHelper=void 0,this._life=!0,this._parent=void 0,this.unik=void 0,this.uuid=calc.generateRendom(2),this.content2d=new PIXI.Container,this.content3d=new THREE.Object3D,this.cont3d=new THREE.Object3D,this.content3d.add(this.cont3d),this.cont3dL=new THREE.Object3D,this.content3d.add(this.cont3dL),this.funInit=void 0,this.body=void 0,this.shape=void 0,this.rect={},this.rect.x=this.obj.mod.r[0],this.rect.y=this.obj.mod.r[1],this.rect.z=this.obj.mod.r[2],this.rect.w=this.obj.mod.r[3],this.rect.h=this.obj.mod.r[4],this.rect.d=this.obj.mod.r[5],this._width=this.rect.w,this._height=this.rect.h,this._delph=this.rect.d,trace(">>>>>>>>@@>>>>>>",this._height,this.obj.mod.r),this.col=parseInt(this.obj.str[2],2),this.col1=parseInt(this.obj.str[3],2),this.offset=this.obj.num[0],this.init=function(){this.body=new ct,this.body.target=this,this.body.drag=this.drag,this.shape=new dt,this.shape.setRect(this.rect),this.body.addShape(this.shape),this.body.col=this.col,this.body.col1=this.col1,this.body.offset=this.offset,this.dragWHD(),null!=this.funInit&&this.funInit()},this.clear=function(){null!=this._parent&&this._parent.removeBlok(this),this.life=!1},this.vector,this.setPosition=function(t,i,e){null!=r._parent&&"SPLWindow"==r._parent.type&&(this.vector=r._parent.getGlob(t,i,this.body.position._y,this),this.body.position.x=this.vector.x,this.render())},this._x=0,this._y=0,this._z=0,this.setReal=function(t,i,e){this._x=t,this._y=i,this._z=e,this.body.position.set(t,i),this._parent&&this._parent.drawDeb()},this.drag=function(){r.content2d.x=r.body.position.x,r.content2d.y=0,trace(">>>",r.body.position),r.content3d.position.x=r.body.position.x,r.content3d.position.z=-r.body.position.y},this.redrahHHH=function(t,i){trace("#redrahHHH##",t)},this.render=function(){this.par.render()},this.dragWHD=function(t,i,e){void 0!==t&&(this._width=t,this._height=i,this._delph=e)},this.funSetObj=void 0,this.funGetObj=void 0;var n={};n.type=this.type,n.obj=this.obj,this.getInfo=function(t){t.push(n)},this.setObj=function(t){this._width=t.w||t.width,this._height=t.h||t.height,this._delph=t.d||t.delph,null!=this.unik&&null!=this.unik.setObj&&null!=t.unik&&this.unik.setObj(t.unik),this.setReal(t.x,t.y,t.z),this.dragWHD(),this.funSetObj&&this.funSetObj(t)},this.getObj=function(){var t={};return t.id=this.id,t.x=this._x,t.y=this._y,t.z=this._z,t.width=this._width,t.height=this._height,t.delph=this._delph,null!=this.unik&&null!=this.unik.getObj&&(t.unik=this.unik.getObj()),this.funGetObj&&this.funGetObj(t),trace(t),t},this.drawActive=void 0}var i,e,s;return i=t,(e=[{key:"active",set:function(t){this._active!=t&&(this._active=t,null!=this.drawActive&&this.drawActive())},get:function(){return this._active}},{key:"width",set:function(t){this._width!=t&&(this._width=t,this.dragWHD())},get:function(){return this._width}},{key:"height",set:function(t){this._height!=t&&(this._height=t,this.dragWHD(),trace("$$$3$$$$",this._height))},get:function(){return this._height}},{key:"delph",set:function(t){this._delph!=t&&(this._delph=t,this.dragWHD())},get:function(){return this._delph}},{key:"life",set:function(t){this._life!=t&&(this._life=t,null!=this._parent&&null!=this._parent.removeBlok&&this._parent.removeBlok(this),this.par.render())},get:function(){return this._life}},{key:"parent",set:function(t){this._parent!=t&&(this.parentOld=this._parent,this._parent=t,null==t?this._life=!1:(this._life=!0,this._parent.sizeLine&&(this.sizeLine=this._parent.sizeLine)),this.par.render(),null!=this.postParent&&this.postParent())},get:function(){return this._parent}}])&&ft(i.prototype,e),s&&ft(i,s),t}();function At(t,i){for(var e=0;e<i.length;e++){var s=i[e];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}var yt=function(){function t(i){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,t);this.type="Unik_Steps",this.par=i,this.graphics=this.par.graphics,this.par.planeXZ=new L,this.par.lineSegments.geometry=this.par.planeXZ,this.arrayInfo=[{tipe:"DSliderBig",name:"slider1",param:"w",title:"width",min:1,max:5e3,okrug:10},{tipe:"DSliderBig",name:"slider2",param:"h",title:"height",min:1,max:5e3,okrug:10}],this._w=100,this._h=100,this._d=50,this._height1=50;var e,s,r,n=0,a=0;this.arrP=[],this.getPoint=function(){return void 0===this.arrP[n]&&(this.arrP[n]=new THREE.Vector3),this.arrP[n]},this.array=[],this.setP=function(t,i,e){void 0===this.array[a]&&(this.array[a]=new THREE.Vector3),null!=t&&this.array[a].set(t,i,e),a++},this.array=[],this.upStart=function(){a=0,this.sizeLine=this.par.par._sizeLine,e=this.par._width-this.sizeLine,s=this.par._height,r=this.par._delph;if(this.step=Math.floor(this._height1/15),50*this.step>s){this.setP(0,15,s+r/2);for(var t=1,i=!1,n=30;n<this._height1;n+=15){if(s-50*t+r/2<r/2){this.setP(0,n,r/2),i=n;break}this.setP(0,n,s-50*t+r/2),t++}0==i&&this.setP(0,n-15,r/2)}else{var o=50*this.step,h=s-o+r/2;this.setP(0,this._height1,r/2),this.setP(0,this._height1,h);for(n=0;n<this.step;n++)this.setP(0,this._height1-15*(n+1),h+50*(n+1))}for(n=1;n<this.array.length;n++)for(var l=0;l<n;l++)if(this.array[n].z<this.array[l].z){var u=this.array[n];this.array[n]=this.array[l],this.array[l]=u}},this.drag3D=function(){n=0,this.par.planeXZ.clearPoint();for(var t=0;t<a;t++){var i=this.getPoint();i.set(this.array[t].x-e/2,-this.array[t].y,-this.array[t].z),n++;var s=this.getPoint();s.set(this.array[t].x+e/2,-this.array[t].y,-this.array[t].z),n++;var r=this.getPoint();this.array[t-1]?r.set(this.array[t].x-e/2,-this.array[t-1].y,-this.array[t].z):r.set(this.array[t].x-e/2,-this.array[t].y,-this.array[t].z),n++;var o=this.getPoint();this.array[t-1]?o.set(this.array[t].x+e/2,-this.array[t-1].y,-this.array[t].z):o.set(this.array[t].x+e/2,-this.array[t].y,-this.array[t].z),n++,this.par.planeXZ.addLine(r,o),this.par.planeXZ.addLine(i,s),t>0&&t<a&&(this.par.planeXZ.addLine(this.arrP[n-2],i),this.par.planeXZ.addLine(s,this.arrP[n-1]),this.par.planeXZ.addLine(this.arrP[n-7],o),this.par.planeXZ.addLine(this.arrP[n-8],r))}this.par.planeXZ.addLine({x:this.arrP[0].x,y:this.arrP[n-3].y,z:this.arrP[0].z},{x:this.arrP[1].x,y:this.arrP[n-3].y,z:this.arrP[1].z}),this.par.planeXZ.addLine({x:this.arrP[0].x,y:this.arrP[n-3].y,z:this.arrP[0].z},{x:this.arrP[0].x,y:this.arrP[0].y,z:this.arrP[0].z}),this.par.planeXZ.addLine({x:this.arrP[0].x,y:this.arrP[n-3].y,z:this.arrP[0].z},{x:this.arrP[0].x,y:this.arrP[n-3].y,z:this.arrP[n-3].z}),this.par.planeXZ.addLine({x:this.arrP[1].x,y:this.arrP[n-3].y,z:this.arrP[1].z},{x:this.arrP[1].x,y:this.arrP[1].y,z:this.arrP[1].z}),this.par.planeXZ.addLine({x:this.arrP[1].x,y:this.arrP[n-3].y,z:this.arrP[1].z},{x:this.arrP[n-3].x,y:this.arrP[n-3].y,z:this.arrP[n-3].z}),this.par.planeXZ.upDate()},this.drag2D=function(){n=0,this.graphics.clear(),this.graphics.beginFill(16777215,.2),this.graphics.drawRect(-e/2,-r/2,e,s+r),this.graphics.lineStyle(this.sizeLine,0,1);for(var t=0;t<a;t++){var i=this.getPoint();i.set(this.array[t].x-e/2,this.array[t].y,this.array[t].z),n++;var o=this.getPoint();o.set(this.array[t].x+e/2,this.array[t].y,this.array[t].z),n++,this.graphics.moveTo(i.x,i.z),this.graphics.lineTo(o.x,o.z),t>0&&(this.graphics.moveTo(this.arrP[n-4].x,this.arrP[n-4].z),this.graphics.lineTo(i.x,i.z),this.graphics.moveTo(o.x,o.z),this.graphics.lineTo(this.arrP[n-3].x,this.arrP[n-3].z))}this.par.stAct.draw1(-e/2,-r/2,e,s+r),this.graphics.endFill()},this.dragWHD=function(){this.upStart(),this.drag3D(),this.drag2D()},this.setObj=function(t){null!=t&&(this.par.dragWHD(),this.korWit())},this.getObj=function(){return{}},this.korWit=function(){this.par.rect.x=-this.par._width/2,this.par.rect.x1=this.par._width/2,this.par.rect.w=this.par._width,this.par.shape.setRect(this.par.rect),this.par.setReal(this.par._x,this.par._y,this.par._z)}}var i,e,s;return i=t,(e=[{key:"height1",set:function(t){this._height1!=t&&(this._height1=t,this.par.dragWHD(),this.par.par.render())},get:function(){return this._height1}},{key:"w",set:function(t){this._w!=t&&(this._w=t,this.par._width=t,this.korWit&&this.korWit(),this.par.dragWHD(),this.par.par.render())},get:function(){return this._w}},{key:"h",set:function(t){this._h!=t&&(this._h=t,this.par._height=t,this.par.dragWHD(),this.par.par.render())},get:function(){return this._h}},{key:"d",set:function(t){this._d!=t&&(this.par._delph=t,this.par.dragWHD(),this.par.par.render())},get:function(){return this._d}}])&&At(i.prototype,e),s&&At(i,s),t}();function xt(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function mt(t,i){for(var e=0;e<i.length;e++){var s=i[e];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}var vt=function(){function t(i){xt(this,t);var e=this;this.type="Unik_Vent",this.par=i,this.graphics=this.par.graphics,this.par.planeXZ=new L,this.par.lineSegments.geometry=this.par.planeXZ,this._delph=this.par._delph/2,this._wh=this.par._width,this._wh1=1==this._bool?this.par._width/2:this.par._width,this._glavBool=!0,this._bool=!1,this._bool1=!1,this._bool2=!1,this._bool3=!1,this._numHeightGlav=200,this._numHeight=-200,this._bottom=0,this._height=300,this._height1=100,this._wh=this.par._width,this.wh_but=48,this.arrayInfo=[{tipe:"DCheckBox",name:"check1",param:"bool",title:"",width:this.wh_but,height:this.wh_but,color1:"#008CBA",link0:"resources/image/unikVent_0_0.png",link1:"resources/image/unikVent_0_1.png",activMouse:!0},{tipe:"DCheckBox",name:"check4",param:"bool3",title:"",width:this.wh_but,height:this.wh_but,color1:"#008CBA",link0:"resources/image/unikVent_3_0.png",link1:"resources/image/unikVent_3_1.png",activMouse:!0,_param:{boolX:!0}},{tipe:"DCheckBox",name:"check2",param:"bool1",title:"",width:this.wh_but,height:this.wh_but,color1:"#008CBA",link0:"resources/image/unikVent_1_0.png",link1:"resources/image/unikVent_1_1.png",activMouse:!0,_param:{boolX:!0}},{tipe:"DCheckBox",name:"check3",param:"bool2",title:"",width:this.wh_but,height:this.wh_but,color1:"#008CBA",link0:"resources/image/unikVent_2_0.png",link1:"resources/image/unikVent_2_1.png",activMouse:!0,_param:{boolX:!0}},{tipe:"DSliderBig",name:"slider1",param:"wh",title:"wh",min:1,max:this._delph,okrug:10,activMouse:!0},{tipe:"DSliderBig",name:"slider2",param:"numHeightGlav",title:"numHeight",min:e._height1,max:e._height-e._wh,okrug:10,activMouse:!0}],this.t3D=new bt(this);var s,r,n,a,o=0,h=0;this.getSize=function(){1==this._bool&&(this.par._width=2*this.par._width,this._wh=this.par._width,this._wh1=this.par._width/2),1!=this._bool&&(this.par._width=this.par._width/2,this._wh=this.par._width,this._wh1=this.par._width),this.korWit()},this.array=[[],[],[],[]],this.setP=function(t,i,e,s){var r=s;void 0===this.array[r][o]&&(this.array[r][o]=new THREE.Vector3),null!=t&&this.array[r][o].set(t,i,e),o++},this.upStart=function(){this.control(),this._delph=this.par._delph/2,this._wh=this.par._width,this._wh1=1==this._bool?this.par._width/2:this.par._width,this.sizeLine=this.par.par._sizeLine,s=this._wh-this.sizeLine,r=this._wh1-this.sizeLine,this._wh,this._wh1,this._height,n=this._bottom,o=0,this.setP(s/2,n,r/2,0),this.setP(s/2,n,-r/2,0),this.setP(-s/2,n,-r/2,0),this.setP(-s/2,n,r/2,0),o=0,this.setP(s/2,n,r/2,1),this.setP(s/2,n,-r/2,1),this.setP(-s/2,n,-r/2,1),o=0,this.setP(s/2,n,r/2,2),this.setP(s/2,n,this._delph,2),this.setP(-s/2,n,this._delph,2),this.setP(-s/2,n,r/2,2),o=0,this.setP(0,n,1.1*this._delph,3),this.setP(r/4,n,this._delph+r/2,3),this.setP(-r/4,n,this._delph+r/2,3)},this.level=function(t,i,e){var s={x:t.x,y:t.y,z:-t.z};return"bot"==i&&(s.y=this._bottom),"mid"==i&&(s.y=this._height/2),"top"==i&&(s.y=this._height),"wallBot"==i&&(s.y=this._numHeight),"wallMid"==i&&(s.y=this._numHeight-this.wh/4),"wallTop"==i&&(s.y=1==this.bool?this._numHeight-this.wh/2:this._numHeight-this.wh),("wallBot"==i&&0==e||"wallTop"==i&&0==e)&&s.z==r/2&&(s.z=this._delph),("wallBot"==i&&0==e||"wallTop"==i&&0==e)&&s.z==-r/2&&(s.z=-this._delph),"path"==i&&(s.z=s.z>0?this._delph:-this._delph),s},this.getP=function(t,i){var e=t;return null!=this.array[e][h]?a=this.array[e][h]:(h=0,a=this.array[e][h]),h++,null!=i&&(a=this.level(a,i,e)),a},this.getStructures3D=function(t,i,e,s,r,n){o=4,h=0;var a=null!=i?i:"bot",l=null!=e?e:"top";if(0!=s)for(var u=0;u<o;u++){h--;var c=this.getP(t,a),p=this.getP(t,a);this.par.planeXZ.addLine(c,p)}if(0!=r)for(u=0;u<o;u++){h--;c=this.getP(t,l),p=this.getP(t,l);this.par.planeXZ.addLine(c,p)}if(0!=n)for(u=0;u<o;u++){c=this.getP(t,a);h--;p=this.getP(t,l);this.par.planeXZ.addLine(c,p)}},this.getStructures2D=function(t,i){o=this.array[t].length+1,h=0,this.graphics.beginFill(16720418,0),this.graphics.lineStyle(this.sizeLine,2236962,1),1==t&&(this.graphics.lineStyle(0,8421504,1),this.graphics.beginFill(8421504,1)),this.graphics.moveTo(this.array[t][0].x,this.array[t][0].z);for(var e=0;e<o+1;e++){var s=this.getP(t,i);this.graphics.lineTo(s.x,s.z)}this.graphics.endFill()},this.drag3D=function(){this.par.planeXZ.clearPoint(),1==this._bool3&&this.getStructures3D(0,"wallBot","wallTop"),1!=this._bool3&&(1==this._bool1&&this.getStructures3D(1,void 0,void 0,1,1,0),1==this._bool2&&(this.getStructures3D(2,"wallBot","wallTop"),this.getStructures3D(3,"wallMid","wallMid",1,0,0)),1==this.glavBool&&this.getStructures3D(0)),this.par.planeXZ.upDate()},this.drag2D=function(){this.graphics.clear(),this.par.stAct.clear(),1==this._bool3&&this.getStructures2D(0,"path"),1!=this._bool3&&(1==this._bool1&&this.getStructures2D(1),1==this._bool2&&(this.getStructures2D(2,1==this._bool3?"path":void 0),this.getStructures2D(3),this.par.stAct.drawTriangle(0,1.1*this._delph,this._wh1/4,this._delph+this._wh1/2,-this._wh1/4,this._delph+this._wh1/2)),1==this.glavBool&&this.getStructures2D(0)),this.par.stAct.drawRect1(-this.wh/2,-this._delph,this.wh,2*this._delph),this.graphics.endFill()},this.dragWHD=function(){this.upStart(),this.drag2D(),this.drag3D(),this.ddddd()},this.setObj=function(t){null!=t&&(this.par.dragWHD(),this.korWit())},this.getObj=function(){return{}},this.korWit=function(){this.par.rect.x=-this.par._width/2,this.par.rect.x1=this.par._width/2,this.par.rect.w=this.par._width,this.par.shape.setRect(this.par.rect),this.par.setReal(this.par._x,this.par._y,this.par._z)},this.par.redrahHHH=function(){null!=e.par.parent&&(e._height=-(e.par.parent._height+e.par.parent._height1),e._height1=-e.par.parent._height1,e.par.dragWHD())},this.postParent=function(){null!=this.par.parent&&this.par.redrahHHH()},this.control=function(){for(var t=0;t<this.arrayInfo.length;t++){var i=this.arrayInfo[t].param;"numHeightGlav"==i&&(this.arrayInfo[t].min=Math.abs(this._height1),this.numHeightGlav<this.arrayInfo[t].min&&(this.numHeightGlav=this.arrayInfo[t].min)),"numHeightGlav"==i&&(this.arrayInfo[t].max=Math.abs(this._height)-this._wh,this.numHeightGlav>this.arrayInfo[t].max&&(this.numHeightGlav=this.arrayInfo[t].max)),"wh"==i&&(this.arrayInfo[t].max=Math.abs(this._delph),this.wh>this.arrayInfo[t].max&&(this.wh=this.par._width))}},this.ddddd=function(){for(var t=0;t<this.arrayInfo.length;t++)1!=this.bool2&&1!=this._bool3?("numHeightGlav"==this.arrayInfo[t].param&&(this.arrayInfo[t].activMouse=!1),1!=this.bool3&&"bool1"==this.arrayInfo[t].param&&(this.arrayInfo[t].activMouse=!0),1!=this.bool3&&"bool2"==this.arrayInfo[t].param&&(this.arrayInfo[t].activMouse=!0)):(1==this.bool3?("bool1"==this.arrayInfo[t].param&&(this.arrayInfo[t].activMouse=!1),"bool2"==this.arrayInfo[t].param&&(this.arrayInfo[t].activMouse=!1)):("bool1"==this.arrayInfo[t].param&&(this.arrayInfo[t].activMouse=!0),"bool2"==this.arrayInfo[t].param&&(this.arrayInfo[t].activMouse=!0)),"numHeightGlav"==this.arrayInfo[t].param&&(this.arrayInfo[t].activMouse=!0));this.control()},this.t3D.setGrani()}var i,e,s;return i=t,(e=[{key:"wh",set:function(t){this._wh!=t&&(this.par._width=t,this._wh1=t,this._wh=t,this.korWit&&this.korWit(),this.par.dragWHD(),this.par.par.render())},get:function(){return this._wh}},{key:"numHeightGlav",set:function(t){this._numHeightGlav!=t&&(this._numHeightGlav=t,this._numHeight=-t,this.par.dragWHD(),this.par.par.render())},get:function(){return this._numHeightGlav}},{key:"glavBool",set:function(t){this._glavBool!=t&&(this._glavBool=t,this.par.dragWHD(),this.par.par.render())},get:function(){return this._glavBool}},{key:"bool",set:function(t){this._bool!=t&&(this._bool=t,this.getSize(),this.korWit&&this.korWit(),this.par.dragWHD(),this.par.par.render())},get:function(){return this._bool}},{key:"bool1",set:function(t){this._bool1!=t&&(this._bool1=t,this.par.dragWHD(),this.par.par.render())},get:function(){return this._bool1}},{key:"bool2",set:function(t){this._bool2!=t&&(this._bool2=t,this.par.dragWHD(),this.par.par.render())},get:function(){return this._bool2}},{key:"bool3",set:function(t){this._bool3!=t&&(this._bool3=t,this.par.dragWHD(),this.par.par.render())},get:function(){return this._bool3}}])&&mt(i.prototype,e),s&&mt(i,s),t}(),bt=function t(i){xt(this,t);this.type="tr3D",this.par=i,this.geometry=new L,this.rendSahTextur=0,this.texture=(new THREE.TextureLoader).load("resources/image/pic.png"),this.texture.wrapS=THREE.RepeatWrapping,this.texture.wrapT=THREE.RepeatWrapping,this.texture.repeat.y=-1,this._material=new THREE.MeshBasicMaterial({color:16777215,map:this.texture}),this.mesh=new THREE.Mesh(this.geometry,this._material),this.par.par.cont3d.add(this.mesh);this.setGrani=function(){this.geometry.clear();for(var t=33,i=0;i<400;i++)this.geometry.addTri(new THREE.Vector3(Math.random()*t-t/2,Math.random()*t-t/2,Math.random()*t-t/2),new THREE.Vector3(Math.random()*t-t/2,Math.random()*t-t/2,Math.random()*t-t/2),new THREE.Vector3(Math.random()*t-t/2,Math.random()*t-t/2,Math.random()*t-t/2),new THREE.Vector3(2*Math.random()-1,2*Math.random()-1,2*Math.random()-1),new THREE.Vector3(2*Math.random()-1,2*Math.random()-1,2*Math.random()-1),new THREE.Vector3(2*Math.random()-1,2*Math.random()-1,2*Math.random()-1),new THREE.Vector2(1*Math.random(),1*Math.random()),new THREE.Vector2(1*Math.random(),1*Math.random()));this.geometry.redrag(!0)}};function wt(t){return(wt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Pt(t){return(Pt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _t(t,i){return(_t=Object.setPrototypeOf||function(t,i){return t.__proto__=i,t})(t,i)}function St(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var It=function(t){function i(t,e,s){var r;!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,i),(r=function(t,i){return!i||"object"!==wt(i)&&"function"!=typeof i?St(t):i}(this,Pt(i).call(this,t,e,s))).type="BInSten";var n=St(St(r));return r.par=t,r.graphics=new PIXI.Graphics,r.content2d.addChild(r.graphics),r.graphics.beginFill(65280,.5),r.graphics.drawCircle(0,0,150),r.stAct=new Ct(St(St(r))),r.planeXZ=r.par.planeXZ,r.lineSegments=new THREE.LineSegments(r.planeXZ,r.par.lineBasicMaterial2),r.cont3dL.add(r.lineSegments),r.lineSegments.rotation.x=Math.PI/2,r.onDragStart=function(t){null!=n.par.par.par.sobSP&&n.par.par.par.sobSP("downBlok",n,t)},r.graphics.interactive=!0,r.graphics.on("mousedown",r.onDragStart),r.graphics.on("mouseover",function(t){n.stAct.sahPlus=10}),r.graphics.on("mouseout",function(t){n.stAct.sahPlus=0}),"Unik_Steps"==r.typeStr1&&(r.unik=new yt(n)),"Unik_Vent"==r.typeStr1&&(r.unik=new vt(n)),r.funInit=function(){},r.dragWHD=function(t,i,e){void 0!==t&&(this._width=t,this._height=i,this._delph=e),console.warn("$$$&&",this._height);var s=this.par._sizeLine,r=this.par._colorLine_;if(null==this.unik){if(this.graphics.clear(),this.graphics.beginFill(2236962,.01),this.graphics.drawRect(-this._width/2-s,-this._delph/2-s,this._width+2*s,this._delph+2*s),this.graphics.endFill(),"Window"==this.typeStr1&&(this.graphics.lineStyle(s,r,1),this.graphics.drawRect(this.rect.x,-this._delph/2-s/2,this.rect.w,this._delph+s),this.graphics.lineStyle(s/2,r,1),this.graphics.drawRect(this.rect.x,10*-s,this.rect.w,20*s),this.lineSegments.position.z=-this.rect.y,this.lineSegments.scale.set(this.rect.w,this.rect.h,1)),"Door"==this.typeStr1){this.graphics.lineStyle(s,r,1),this.graphics.drawRect(this.rect.x,-this._delph/2-s/2,this.rect.w,this._delph+s),this.graphics.lineStyle(s/2,r/2,1);var n=calc.getVector(-this._delph/2-this._delph/2,0),a=calc.getVector(this.rect.x-this.rect.w/5,90),o=calc.getVector(Math.abs(this.rect.x-this.rect.w/5),45);this.graphics.moveTo(this.rect.x,n.y),this.graphics.lineTo(this.rect.w/2,n.y),this.graphics.moveTo(this.rect.x,n.y),this.graphics.lineTo(a.x,a.y),this.graphics.moveTo(a.x,a.y),this.graphics.quadraticCurveTo(o.x+o.x/4,-o.y+o.y/4,this.rect.w/2,n.y),this.lineSegments.position.z=-this.rect.y,this.lineSegments.scale.set(this.rect.w,this.rect.h,1)}"Not"==this.typeStr1&&(this.graphics.lineStyle(s/2,r,1),this.graphics.drawRect(this.rect.x-1.5*s/2,-this._delph/2-1.5*s/2,this.rect.w+1.5*s,this._delph+1.5*s),this.lineSegments.scale.set(this.rect.w,this.rect.h,1),this.lineSegments.position.z=-this.rect.y),this.stAct.draw1()}else this.unik.dragWHD()},r.postParent=function(){null!=this.unik&&null!=this.unik.postParent&&this.unik.postParent()},r.drawActive=function(){this.stAct.sahAct=this._active?40:0},r.redrahHHH=function(t,i){"Window"==this.typeStr1&&(this.body.position.y=i+this._height+120),"Door"!=this.typeStr1&&"Not"!=this.typeStr1||(trace(">>>>>>>>>>>>>>>>>>>>>>>>>>>>>",this._height),this.body.position.y=i+this._height)},r.init(),r}return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&_t(t,i)}(i,gt),i}();function Ct(t){this.type="BTAct",this.par=t,this._sahAct=0,this._sahPlus=0,this.graphics=new PIXI.Graphics,this.par.content2d.addChild(this.graphics),this.graphics.alpha=this._sahAct/100,this.clear=function(){this.graphics.clear()},this.draw1=function(i,e,s,r){this.graphics.clear(),this.graphics.beginFill(t.par.par.colorUI),null==s?this.graphics.drawRect(-this.par._width/2,-this.par._delph/2,this.par._width,this.par._delph):this.graphics.drawRect(i,e,s,r),this.graphics.endFill()},this.drawRect1=function(i,e,s,r){this.graphics.beginFill(t.par.par.colorUI),null!=s&&this.graphics.drawRect(i,e,s,r),this.graphics.endFill()},this.drawTriangle=function(i,e,s,r,n,a){this.graphics.lineStyle(0,2236962,1),this.graphics.beginFill(t.par.par.colorUI),null!=i&&(this.graphics.moveTo(i,e),this.graphics.lineTo(s,r),this.graphics.lineTo(n,a),this.graphics.lineTo(i,e)),this.graphics.endFill()},this.corektSetGet=function(){this.graphics.alpha=(this._sahAct+this._sahPlus)/100,this.par.par.render()}}function Et(t,i){for(var e=0;e<i.length;e++){var s=i[e];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}Ct.prototype={set sahAct(t){this._sahAct!==t&&(this._sahAct=t,this.corektSetGet())},get sahAct(){return this._sahAct},set sahPlus(t){this._sahPlus!==t&&(this._sahPlus=t,this.corektSetGet())},get sahPlus(){return this._sahPlus}};var Tt=function(){function t(i,e){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,t),this.type="WorldBlok";this.par=i,this.fun=e,this._sizeLine=this.par._sizeLine,this._colorLine_=this.par._colorLine_,this.objectBase=i.objectBase,this.uuid=calc.generateRendom(2),this.planeXZ=i.planeXZ,this.lineBasicMaterial2=i.lineBasicMaterial2,this.array=[],this.content2d=new PIXI.Container,this.par.cont2dBlok.addChild(this.content2d),this.arrObj={};for(var s=0;s<this.objectBase.bd.length;s++)this.arrObj[this.objectBase.bd[s].id]=this.objectBase.bd[s];this.sobBlok=function(t,i,e){},this.getBlok=function(t){for(var i=this.arrObj[t],e=0;e<this.array.length;e++)if(1!=this.array[e].life&&this.array[e].id==t)return this.array[e];var s=void 0;return"BInSten"==i.obj.str[0]&&(s=new It(this,i,this.sobBlok)),null==s&&(s=new gt(this,i,this.sobBlok)),s.idArr=this.array.length,this.array.push(s),s},this.render=function(){this.par.render()},this.setObj=function(t){for(var i=0;i<t.array.length;i++);},this.getObj=function(){for(var t={array:[]},i=0;i<this.array.length;i++)0!=this.array[i].life&&this.array[i].parent.uuid==this.uuid&&t.array.push(this.array[i].getObj());return t}}var i,e,s;return i=t,(e=[{key:"activeMouse",set:function(t){if(this._activeMouse!=t){this._activeMouse=t;for(var i=0;i<this.array.length;i++)this.array[i].activeMouse=t}},get:function(){return this._activeMouse}},{key:"colorLine",set:function(t){if(this._colorLine!=t){this._colorLine=t;for(var i=0;i<this.array.length;i++)this.array[i].dragWHD()}},get:function(){return this._colorLine}},{key:"sizeLine",set:function(t){if(this._sizeLine!=t){this._sizeLine=t;for(var i=0;i<this.array.length;i++)this.array[i].dragWHD()}},get:function(){return this._sizeLine}}])&&Et(i.prototype,e),s&&Et(i,s),t}();function Mt(t,i){for(var e=0;e<i.length;e++){var s=i[e];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}var Dt=function(){function t(i,e){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,t),this.type="SPGroup";var s,r,n,a=this;this.par=i,this.fun=e,this.uuid=calc.generateRendom(2),this.funDragMenu=void 0,this._colorUI=this.par._colorUI,this._active=!1,this.array=[],this.content2d=new PIXI.Container,this.par.cont2dGroup.addChild(this.content2d),this.graphics=new PIXI.Graphics,this.content2d.addChild(this.graphics),this.graphicsBig=new PIXI.Graphics,this.content2d.addChild(this.graphicsBig),this.graphicsEvent=new PIXI.Graphics,this.par.contNiz.addChild(this.graphicsEvent),this.onDragStart=function(t){null!=a.par.par.sobSP&&a.par.par.sobSP("downGroup",a,t)},this.graphicsEvent.interactive=!0,this.graphicsEvent.on("mousedown",this.onDragStart),this.rectBig={x:0,y:0,x1:0,y1:0,w:0,h:0,o:null},this.addObj=function(t){for(var i=0;i<this.array.length;i++)if(this.array[i].uuid==t.uuid)return!1;return trace("####",t),this.array.push(t),this.korektRect(),this.drawRect(),null!=this.funDragMenu&&this.funDragMenu(),!0},this.removeObj=function(t){for(var i=!1,e=this.array.length-1;e>=0;e--)this.array[e].uuid==t.uuid&&(this.array.splice(e,1),i=!0);return 1==i&&(this.korektRect(),this.drawRect()),null!=this.funDragMenu&&this.funDragMenu(),i},this.korektRect=function(t){this.rectBig.x=99999999999,this.rectBig.y=99999999999,this.rectBig.x1=-29999999999,this.rectBig.y1=-29999999999;for(var i=0;i<this.array.length;i++)"SpliceSten"==this.array[i].type&&(1==t&&this.array[i].korectOffset(),n=this.array[i].rectBig,this.rectBig.x>n.x&&(this.rectBig.x=n.x),this.rectBig.x1<n.x+n.w&&(this.rectBig.x1=n.x+n.w),this.rectBig.y>n.y&&(this.rectBig.y=n.y),this.rectBig.y1<n.y+n.h&&(this.rectBig.y1=n.y+n.h));for(i=0;i<this.array.length;i++)"SpPointSten"!=this.array[i].type&&"SpVP"!=this.array[i].tipe||(n=this.array[i].position,this.rectBig.x>n.x&&(this.rectBig.x=n.x),this.rectBig.x1<n.x&&(this.rectBig.x1=n.x),this.rectBig.y>n.y&&(this.rectBig.y=n.y),this.rectBig.y1<n.y&&(this.rectBig.y1=n.y));this.rectBig.w=this.rectBig.x1-this.rectBig.x,this.rectBig.h=this.rectBig.y1-this.rectBig.y,99999999999==this.rectBig.x&&(this.rectBig.x=this.rectBig.y=this.rectBig.w=this.rectBig.h=0),1==t&&this.drawRect()},this.drawRect=function(){this.graphicsBig.clear(),this.graphicsBig.lineStyle(1,this._colorUI,.75),this.graphicsBig.beginFill(this._colorUI,.1),this.graphicsBig.drawRect(this.rectBig.x,this.rectBig.y,this.rectBig.w,this.rectBig.h),this.graphicsEvent.clear(),this.graphicsEvent.beginFill(16777215,.1),this.graphicsEvent.drawRect(this.rectBig.x,this.rectBig.y,this.rectBig.w,this.rectBig.h),this.par.render()},this.clear=function(){for(var t=0;t<this.array.length;t++)this.array[t].clear();this.array.length=0,this.par.render(),this.active=!1},this.setPosOffset=function(t,i){for(var e=0;e<this.array.length;e++)"SpPointSten"!=this.array[e].type&&"SpVP"!=this.array[e].tipe||((n=this.array[e].position).set(n.x+t,n.y+i),this.array[e].doFunRend());this.korektRect(!0)},this.addRect=function(t){if(s=this.par.getRect(),1==calc.isRectS(s,t)){for(var i=0;i<this.par.arrSplice.length;i++)if(0!=this.par.arrSplice[i].life&&null!=(r=this.par.arrSplice[i].isRect(t,!1)))for(var e=0;e<r.length;e++)this.addObj(r[e]);for(i=0;i<this.par.avp.length;i++)0!=this.par.avp[i].life&&this.par.avp[i].position.x>=t.x&&this.par.avp[i].position.x<=t.x+t.w&&this.par.avp[i].position.y>=t.y&&this.par.avp[i].position.y<=t.y+t.h&&this.addObj(this.par.avp[i]);for(i=0;i<this.par.arrPoint.length;i++)0!=this.par.arrPoint[i].life&&this.par.arrPoint[i].position.x>=t.x&&this.par.arrPoint[i].position.x<=t.x+t.w&&this.par.arrPoint[i].position.y>=t.y&&this.par.arrPoint[i].position.y<=t.y+t.h&&this.addObj(this.par.arrPoint[i])}},this.setRect=function(t){this.graphics.clear(),null!=t&&(this.graphics.lineStyle(1,this._colorUI,.3),this.graphics.beginFill(this._colorUI,.01),this.graphics.drawRect(t.x,t.y,t.w,t.h)),this.par.render()}}var i,e,s;return i=t,(e=[{key:"active",set:function(t){this._active!=t&&(this._active=t,this.array.length=0,this.graphicsBig.clear(),this.graphicsEvent.clear(),this.setRect(),this.graphicsEvent.visible=t,this.content2d.visible=t,this.par.render())},get:function(){return this._active}}])&&Mt(i.prototype,e),s&&Mt(i,s),t}();function Rt(t,i){for(var e=0;e<i.length;e++){var s=i[e];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}var Lt=function(){function t(i,e){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,t),this.type="SSPolygon2D",this.typeNa="SSPolygon2D";var s=this;this.par=i,this._active=!1,this.content2d=new PIXI.Container,this.par.content2d.addChild(this.content2d),this.cont2dVerh=new PIXI.Container,this.par.cont2dVerh.addChild(this.cont2dVerh),this.graphics=new PIXI.Graphics,this.content2d.addChild(this.graphics),this.text=new PIXI.Text("345634634",{fontFamily:"Arial"}),this.content2d.addChild(this.text),this.stAct=new Ot(this),this.onDragStart=function(t){null!=s.par.par.par.sobSP&&s.par.par.par.sobSP("downPol",s.par,t)},this.graphics.interactive=!0,this.graphics.on("mousedown",this.onDragStart),this.graphics.on("mouseover",function(t){s.stAct.sahPlus=10}),this.graphics.on("mouseout",function(t){s.stAct.sahPlus=0})}var i,e,s;return i=t,(e=[{key:"active",set:function(t){this._active!=t&&(this._active=t)},get:function(){return this._active}}])&&Rt(i.prototype,e),s&&Rt(i,s),t}();function Ot(t){this.type="STAct",this.par=t,this._sahAct=0,this._sahPlus=0,this.arrVorur=this.par.arrVorur,this.graphics=new PIXI.Graphics,this.par.content2d.addChild(this.graphics),this.graphics.alpha=this._sahAct/100,this.graphicsVV=new PIXI.Graphics,this.par.cont2dVerh.addChild(this.graphicsVV),this.graphicsVV.beginFill(16711680,.3),this.graphicsVV.drawCircle(0,0,350),this.draw1=function(){if(this.graphics.clear(),this.graphics.beginFill(t.par.colorUI),0!=this.par.par.array.length){this.graphics.moveTo(this.par.par.array[0].position.x,this.par.par.array[0].position.y);for(var i=1;i<this.par.par.array.length;i++)this.graphics.lineTo(this.par.par.array[i].position.x,this.par.par.array[i].position.y);this.graphics.lineTo(this.par.par.array[0].position.x,this.par.par.array[0].position.y)}if(this.graphicsVV.clear(),this.graphicsVV.beginFill(t.par.colorUI,.2),this.graphicsVV.lineStyle(2*this.par.par.par._sizeLine,this.par.par.par._colorLine_,1),0!=this.par.par.array.length){this.graphicsVV.moveTo(this.par.par.array[0].position.x,this.par.par.array[0].position.y);for(i=1;i<this.par.par.array.length;i++)this.graphicsVV.lineTo(this.par.par.array[i].position.x,this.par.par.array[i].position.y);this.graphicsVV.lineTo(this.par.par.array[0].position.x,this.par.par.array[0].position.y)}},this.corektSetGet=function(){this.graphics.alpha=(this._sahAct+this._sahPlus)/100,this.par.par.par.render()}}function Bt(t,i){for(var e=0;e<i.length;e++){var s=i[e];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}Ot.prototype={set sahAct(t){this._sahAct!==t&&(this._sahAct=t,this.corektSetGet())},get sahAct(){return this._sahAct},set sahPlus(t){this._sahPlus!==t&&(this._sahPlus=t,this.corektSetGet())},get sahPlus(){return this._sahPlus}};var jt=function(){function t(i,e){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,t),this.type="SSP3D";this.par=i,this._active=!1,this.content3d=new THREE.Object3D,this.par.par.content3d.add(this.content3d),this.cont3d=new THREE.Object3D,this.content3d.add(this.cont3d),this.cont3dL=new THREE.Object3D,this.content3d.add(this.cont3dL),this.planeXZ=new L,this.lineSegments=new THREE.LineSegments(this.planeXZ,this.par.par.lineBasicMaterial1),this.cont3dL.add(this.lineSegments)}var i,e,s;return i=t,(e=[{key:"active",set:function(t){this._active!=t&&(this._active=t)},get:function(){return this._active}},{key:"life",set:function(t){this._life!=t&&(this._life=t,1==this._life?this.par.par.content3d.add(this.content3d):null!=this.content3d.parent&&this.content3d.parent.remove(this.content3d))},get:function(){return this._life}}])&&Bt(i.prototype,e),s&&Bt(i,s),t}();var Ft=function t(i,e){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,t),this.type="PUnikBase";this.par=i,this.triangulateShape=this.par.triangulateShape,this.graphics=this.par.ssPolygon2d.graphics,this.color=10066329,this.draw2d=function(){if(this.par.ssPolygon2d.stAct.draw1(),this.graphics.clear(),this.graphics.lineStyle(1,16777215*Math.random(),.5),this.graphics.drawRect(this.par.rectBig.x,this.par.rectBig.y,this.par.rectBig.w,this.par.rectBig.h),this.graphics.beginFill(this.color,1),this.graphics.lineStyle(this.par.par._sizeLine,this.par.par._colorLine_,1),0!=this.par.array.length){this.graphics.moveTo(this.par.array[0].position.x,this.par.array[0].position.y);for(var t=1;t<this.par.array.length;t++)this.graphics.lineTo(this.par.array[t].position.x,this.par.array[t].position.y);this.graphics.lineTo(this.par.array[0].position.x,this.par.array[0].position.y)}this.text=this.par.ssPolygon2d.text,this.text.text=Math.abs(Math.round(this.triangulateShape.areaShape/1e3))/10+" m²";var i=this.text.text.length*this.text.style.fontSize/2,e=this.text.style.fontSize;this.text.x=this.triangulateShape.centerShape.x-i/2,this.text.y=this.triangulateShape.centerShape.y-e/2},this.kol=0,this.arrPoint=[],this.draw3d=function(){if(this.par.array.length>=2){this.par.ssP3d.lineSegments.visible=!0,this.par.ssP3d.planeXZ.clearPoint(),this.kolPointDrag();for(var t=0;t<this.kol;t++)t!=this.kol-1?this.par.ssP3d.planeXZ.addLine(this.arrPoint[t],this.arrPoint[t+1]):this.par.ssP3d.planeXZ.addLine(this.arrPoint[t],this.arrPoint[0]);this.par.ssP3d.planeXZ.upDate()}else this.par.ssP3d.lineSegments.visible=!1},this.kolPointDrag=function(){this.kol=this.par.array.length;for(var t=0;t<this.par.array.length;t++)null==this.arrPoint[t]&&(this.arrPoint[t]=new THREE.Vector3),this.arrPoint[t].x=this.par.array[t].position.x,this.arrPoint[t].y=this.par.array[t].position.y,this.arrPoint[t].z=0},this.draw1=function(){this.draw2d(),this.draw3d()}};var kt=function t(i,e){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,t),this.type="PubRoof";this.par=i,this.triangulateShape=this.par.triangulateShape,this.graphics=this.par.ssPolygon2d.graphics,this.color=10092441,this.draw2d=function(){if(this.par.ssPolygon2d.stAct.draw1(),this.graphics.clear(),this.graphics.lineStyle(1,16777215*Math.random(),.5),this.graphics.drawRect(this.par.rectBig.x,this.par.rectBig.y,this.par.rectBig.w,this.par.rectBig.h),this.graphics.beginFill(this.color,1),this.graphics.lineStyle(this.par.par._sizeLine,this.par.par._colorLine_,1),0!=this.par.array.length){this.graphics.moveTo(this.par.array[0].position.x,this.par.array[0].position.y);for(var t=1;t<this.par.array.length;t++)this.graphics.lineTo(this.par.array[t].position.x,this.par.array[t].position.y);this.graphics.lineTo(this.par.array[0].position.x,this.par.array[0].position.y)}this.text=this.par.ssPolygon2d.text,this.text.text=Math.abs(Math.round(this.triangulateShape.areaShape/1e3))/10+" m²";var i=this.text.text.length*this.text.style.fontSize/2,e=this.text.style.fontSize;this.text.x=this.triangulateShape.centerShape.x-i/2,this.text.y=this.triangulateShape.centerShape.y-e/2},this.kol=0,this.arrPoint=[],this.draw3d=function(){if(this.par.array.length>=2){this.par.ssP3d.lineSegments.visible=!0,this.par.ssP3d.planeXZ.clearPoint(),this.kolPointDrag();for(var t=0;t<this.kol;t++)t!=this.kol-1?this.par.ssP3d.planeXZ.addLine(this.arrPoint[t],this.arrPoint[t+1]):this.par.ssP3d.planeXZ.addLine(this.arrPoint[t],this.arrPoint[0]);this.par.ssP3d.planeXZ.upDate()}else this.par.ssP3d.lineSegments.visible=!1},this.kolPointDrag=function(){this.kol=this.par.array.length;for(var t=0;t<this.par.array.length;t++)null==this.arrPoint[t]&&(this.arrPoint[t]=new THREE.Vector3),this.arrPoint[t].x=this.par.array[t].position.x,this.arrPoint[t].y=this.par.array[t].position.y,this.arrPoint[t].z=-this.par.array[t].position.z},this.draw1=function(){this.draw2d(),this.draw3d()}};function Ht(t,i){et.call(this,t);var e=this;this.type="SpPolygon",this.tipe="SpPolygon",this.unikName="PUnikBase",null!=i&&(this.unikName=i),trace(">>>>>>>>>>>>>>>>>>>>>>>>>>>>",i),this.stage=t,this.par=t,this._boolText=!0,this._active=!1,this.idUi=Math.round(1e3*Math.random()),this.sUi=-1,this._offset=0,this._bChaz=!1,this._delph=t._delph,this._active=!1,this._uuid=calc.generateRendom(2),this.triangulateShape=this.stage.triangulateShape,this.arrayClass=[],this.content2d=new PIXI.Container,t.content2d1.addChild(this.content2d),this.cont2dVerh=new PIXI.Container,t.cont2dVerh.addChild(this.cont2dVerh),this.cont2dVerh.visible=!1,this.ssPolygon2d=new Lt(this),this.ssP3d=new jt(this),"PUnikBase"==this.unikName&&(this.unik=new Ft(this)),"PubRoof"==this.unikName&&(this.unik=new kt(this)),this.draw1=function(){this.dragRect(),this.dragNaTriang(),this.unik.draw1(),trace("##"),this.par.metodRezolk.setPol(this)},this.drag=function(){e.par.addObjFun(e)},this.dragPost=function(){this.draw1()};var s;this.rectBig={x:0,y:0,z:0,x1:0,y1:0,z1:0,w:0,h:0,d:0,o:null},this.dragRect=function(){this.rectBig.x=99999999999,this.rectBig.y=99999999999,this.rectBig.x1=-29999999999,this.rectBig.y1=-29999999999;for(var t=0;t<this.array.length;t++)this.rectBig.x>this.array[t].position.x&&(this.rectBig.x=this.array[t].position.x),this.rectBig.x1<this.array[t].position.x&&(this.rectBig.x1=this.array[t].position.x),this.rectBig.y>this.array[t].position.y&&(this.rectBig.y=this.array[t].position.y),this.rectBig.y1<this.array[t].position.y&&(this.rectBig.y1=this.array[t].position.y),this.rectBig.z>this.array[t].position.z&&(this.rectBig.z=this.array[t].position.z),this.rectBig.z1<this.array[t].position.z&&(this.rectBig.z1=this.array[t].position.z);this.rectBig.w=this.rectBig.x1-this.rectBig.x,this.rectBig.h=this.rectBig.y1-this.rectBig.y,this.rectBig.d=this.rectBig.z1-this.rectBig.z},this.arrPosition=[],this.arrTiang=[],this.shTr,this.dragNaTriang=function(){this.arrPosition.length=0;for(var t=0;t<this.array.length;t++)this.arrPosition.push(this.array[t].position);this.triangulateShape.segment.x=.5,this.triangulateShape.segment.y=.5,this.triangulateShape.segment.width=this.rectBig.w,this.triangulateShape.segment.height=this.rectBig.h,this.triangulateShape.segment.rotation=0,this.triangulateShape.start(this.arrPosition);var i=this.triangulateShape.arrTriangleBig;s=0;for(t=0;t<i.length;t++)null==this.arrTiang[s]&&(this.arrTiang[s]=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3]),this.arrTiang[s][0].set(i[t][0].x,i[t][0].y,-i[t][0].z),this.arrTiang[s][1].set(i[t][1].x,i[t][1].y,-i[t][1].z),this.arrTiang[s][2].set(i[t][2].x,i[t][2].y,-i[t][2].z),this.ssP3d.planeXZ.addLine(this.arrTiang[s][0],this.arrTiang[s][1]),this.ssP3d.planeXZ.addLine(this.arrTiang[s][1],this.arrTiang[s][2]),this.ssP3d.planeXZ.addLine(this.arrTiang[s][2],this.arrTiang[s][0]),s++,this.shTr=s;this.ssP3d.planeXZ.upDate()},this.isRect=function(t,i){}}Ht.prototype=Object.create(et.prototype),Ht.prototype.constructor=Ht,Ht.prototype.getObj=function(){var t=et.prototype.getObj.call(this);return t.unik=this.unikName,t},Ht.prototype.setObj=function(t){et.prototype.setObj.call(this,t)},Ht.prototype.compare=function(t){var i=!0;return et.prototype.compare(this,t)||(i=!1),i},Ht.prototype.setSten=function(t){et.prototype.setSten.call(this,t)},Ht.prototype.restart=function(){et.prototype.restart(this)},Ht.prototype.drag=function(){et.prototype.drag.call(this),this.stage.addObjFun(this)},Object.defineProperties(Ht.prototype,{life:{set:function(t){if(this._life!=t){this._life=t;for(var i=0;i<this.arrayClass.length;i++)"life"in this.arrayClass[i]&&(this.arrayClass[i].life=this._life);1==this._life?this.stage.cont2dVerh.addChild(this.cont2dVerh):null!=this.cont2dVerh.parent&&this.cont2dVerh.parent.removeChild(this.cont2dVerh),1==this._life?this.stage.content2d1.addChild(this.content2d):null!=this.content2d.parent&&this.content2d.parent.removeChild(this.content2d),this._setAllParam("life",this._life)}},get:function(){return this._life}},active:{set:function(t){this._active!==t&&(this._active=t,this.cont2dVerh.visible=this._active,this._setAllParam("active",this._active))},get:function(){return this._active}}});var zt=function t(i){var e,s,r,n,a;!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,t),this.type="SPMetod",this.par=i,this.getFloor=function(t){if(null!=t){this.par.clear();for(var i=0;i<t.arrSplice.length;i++)0!=t.arrSplice[i].life&&(e=t.arrSplice[i].getObj(),s=this.par.craetSplice1(),0==this.par.idArr&&(e.windows.array=[]),s.setObj(e));for(var o=0;o<t.arrPol.length;o++)if(0!=t.arrPol[o].life&&0==this.par.idArr){r=t.arrPol[o];for(i=0;i<r.array.length;i++)0==i?(n=r.array[i],a=r.array[r.array.length-1]):(n=r.array[i],a=r.array[i-1]),0==this.testAdAdSten(n,a)&&((e={position:{x:n.position.x,y:n.position.y},position1:{x:a.position.x,y:a.position.y}}).type="SpliceSten",e.adjacent=!0,e.bChaz=!1,e.carrier=!0,(s=this.par.craetSplice1()).setObj(e))}}},this.testAdAdSten=function(t,i){if(0==t.arrIdSten.length)return!1;if(0==i.arrIdSten.length)return!1;for(var e=0;e<t.arrIdSten.length;e++)for(var s=0;s<i.arrIdSten.length;s++)if(i.arrIdSten[s]==t.arrIdSten[e])return!0;return!1};var o,h={x:0,y:0,dist:0,os:0,pros:0,target:null};this.getPL=function(t,i){!1,h.dist=9999999999;for(var e=0;e<this.par.arrSplice.length;e++)0!=this.par.arrSplice[e].life&&null!=(o=this.par.arrSplice[e].vLines.getPL(t,i))&&o.dist<h.dist&&(h=o);return 9999999999!=h.dist?h:null},this.getPLUUID=function(t){for(var i=0;i<this.par.avp.length;i++)if(this.par.avp[i].uuid==t)return this.par.avp[i];return null}};function Nt(t,i,e){var s=i[0],r=i[1],n=i[2],a=e[0],o=e[1],h=e[2];return t[0]=r*h-n*o,t[1]=n*a-s*h,t[2]=s*o-r*a,t}function Gt(t,i,e){return t[0]=i[0]-e[0],t[1]=i[1]-e[1],t[2]=i[2]-e[2],t}function Xt(t,i){return t[0]*i[0]+t[1]*i[1]+t[2]*i[2]}var Ut=1e-6,Vt=[0,0,0],Qt=[0,0,0],Yt=[0,0,0],Wt=[0,0,0],Zt=[0,0,0];function Jt(t,i,e,s,r){Gt(Vt,s[1],s[0]),Gt(Qt,s[2],s[0]),Nt(Wt,e,Qt);var n=Xt(Vt,Wt);if(n<Ut)return null;Gt(Yt,i,s[0]);var a=Xt(Yt,Wt);if(r){if(a<=0||a>=n)return null}else if(a<0||a>n)return null;Nt(Zt,Yt,Vt);var o=Xt(e,Zt);if(r){if(o<=0||a+o>=n)return null}else if(o<0||a+o>n)return null;var h=Xt(Qt,Zt)/n;return t[0]=i[0]+h*e[0],t[1]=i[1]+h*e[1],t[2]=i[2]+h*e[2],t}class qt{constructor(){this.type="GronTriangle";this.t=[{x:0,y:0,z:0},{x:0,y:0,z:0},{x:0,y:0,z:0}],this.t1=[{x:0,y:0,z:0},{x:0,y:0,z:0},{x:0,y:0,z:0}],this.rezult=!1,this.point={x:0,y:0,z:0},this.point1={x:0,y:0,z:0},this.arrPCesh=[{x:0,y:0,z:0},{x:0,y:0,z:0}],this.arrPoint=[];var t,i=null;this.setT=function(t,e){t&&(this.t=t),e&&(this.t1=e),this.arrPoint.length=0,this.setTriangle(this.t[0],this.t[1],this.t[2]);for(var s=0;s<this.t1.length;s++)if(0==s&&(i=this.isIntersect(this.t1[0],this.t1[1],!0)),1==s&&(i=this.isIntersect(this.t1[1],this.t1[2],!0)),2==s&&(i=this.isIntersect(this.t1[2],this.t1[0],!0)),null!==i&&(this.arrPoint[this.arrPoint.length]=this.arrPCesh[this.arrPoint.length],this.arrPoint[this.arrPoint.length-1].x=i[0],this.arrPoint[this.arrPoint.length-1].y=i[1],this.arrPoint[this.arrPoint.length-1].z=i[2],2==this.arrPoint.length))return this.arrPoint;this.setTriangle(this.t1[0],this.t1[1],this.t1[2]);for(s=0;s<this.t.length;s++)if(0==s&&(i=this.isIntersect(this.t[0],this.t[1],!0)),1==s&&(i=this.isIntersect(this.t[1],this.t[2],!0)),2==s&&(i=this.isIntersect(this.t[2],this.t[0],!0)),null!==i&&(this.arrPoint[this.arrPoint.length]=this.arrPCesh[this.arrPoint.length],this.arrPoint[this.arrPoint.length-1].x=i[0],this.arrPoint[this.arrPoint.length-1].y=i[1],this.arrPoint[this.arrPoint.length-1].z=i[2],2==this.arrPoint.length))return this.arrPoint;return null},this.tria=[[10,0,0],[0,10,0],[0,0,10]],this.tri=[],this.pt=[],this.dir=[],this.upDate=function(t,i){},this.setTriangle=function(t,i,e){null!=t.x?(this.tria[0][0]=t.x,this.tria[0][1]=t.y,this.tria[0][2]=t.z,this.tria[1][0]=i.x,this.tria[1][1]=i.y,this.tria[1][2]=i.z,this.tria[2][0]=e.x,this.tria[2][1]=e.y,this.tria[2][2]=e.z):(this.tria[0]=t,this.tria[1]=i,this.tria[2]=e)};var e,s,r=new THREE.Vector3,n=new THREE.Vector3,a=new THREE.Vector3;this.isIntersect=function(i,o,h,l){return e=Math.sqrt(Math.pow(o.x-i.x,2)+Math.pow(o.y-i.y,2)+Math.pow(o.z-i.z,2)),r.set(i.x,i.y,i.z),n.set(o.x,o.y,o.z),n.sub(r).normalize(),!1,null!=(t=Jt([],Object.values(r),Object.values(n),this.tria,!1))&&(a.set(t[0],t[1],t[2]),s=Math.sqrt(Math.pow(i.x-a.x,2)+Math.pow(i.y-a.y,2)+Math.pow(i.z-a.z,2)),e>s)?t:void 0===l&&(r.set(o.x,o.y,o.z),n.set(i.x,i.y,i.z),n.sub(r).normalize(),null!=(t=Jt([],Object.values(r),Object.values(n),this.tria,!1))&&(a.set(t[0],t[1],t[2]),s=Math.sqrt(Math.pow(i.x-a.x,2)+Math.pow(i.y-a.y,2)+Math.pow(i.z-a.z,2)),e>s))?t:null},this.setObj=function(t){this.t=t.t,this.t1=t.t1},this.getObj=function(t){return(t={}).t=this.t,t.t1=this.t1,t}}}var Kt=function t(i){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,t),this.type="SPMetodRezolka",this.par=i;var e,s;this.gronTriangle=new qt,this.setSten=function(t){s=(e=t).ss3d.arrGrani;for(var i=0;i<t.ss3d.arrGrani.length;i++)t.ss3d.arrGrani[i].clearAL();this.sortStenPoint(t);for(i=0;i<this.par.arrPol.length;i++)0!=this.par.arrPol[i].life&&this.sort1(this.par.arrPol[i])},this.pol,this.setPol=function(t){this.pol=t;for(var i=0;i<this.par.arrSplice.length;i++)0!=this.par.arrSplice[i].life&&this.sort1OtPol(this.par.arrSplice[i],t.arrTiang,t.shTr)};var r,n,a,o;new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3;this.sortStenPoint=function(t){},this.sort1OtPol=function(t,i,s){0!=calc.isRectS(t.rectBig,this.pol.rectBig)&&(0!=t.par._boolMax?(this.setSten(t),e.ss3d.drawVerg()):t.par.addObjFun1(t))},this.arrTiang=[],this.aTSten=[[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3],[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3]],this.sort1=function(t){if(0!=calc.isRectS(e.rectBig,t.rectBig)){t.shTr,t.arrTiang;for(var i=0;i<5;i++)r=s[0].arr[i],n=s[2].arr[i],this.sort2(s[0].arrPGlob[i],s[0].arrPGlob[i+1],e.height+e.height1,t.arrTiang,t.shTr);for(i=0;i<5;i++)r=s[1].arr[i],n=s[3].arr[i],this.sort2(s[1].arrPGlob[i],s[1].arrPGlob[i+1],e.height+e.height1,t.arrTiang,t.shTr);this.par.render()}},this.arrLine3D=[],this.sort2=function(t,i,e,s,r){0!=(u=calc.getDistance(t,i))&&(this.aTSten[0][0].set(t.x,t.y,-e),this.aTSten[0][1].set(i.x,i.y,0),this.aTSten[0][2].set(t.x,t.y,0),this.aTSten[1][0].set(t.x,t.y,-e),this.aTSten[1][1].set(i.x,i.y,-e),this.aTSten[1][2].set(i.x,i.y,0),0,this.sort3(this.aTSten,2,s,r))},this.sort3=function(t,i,e,s){for(var r=0;r<i;r++)for(var n=0;n<s;n++)this.sort4(t[r],e[n])};var h=null,l=null;this.sort4=function(t,i){null!=(l=this.gronTriangle.setT(t,i))&&(a=r.getLine(),o=n.getLine(),h=r.isLocalToGlob(l[0],l[1]),o.p.x=a.p.x=h.p.x,o.p.y=a.p.y=h.p.z,o.p1.x=a.p1.x=h.p1.x,o.p1.y=a.p1.y=h.p1.z)};var u,c=new THREE.Vector3;this.zdvihPoint=function(t,i,e){c.set(i.x-t.x,i.y-t.y,i.z-t.z),u=calc.getDistance(t,i),i.x=t.x+c.x*((u+e)/u),i.y=t.y+c.y*((u+e)/u),i.z=t.z+c.z*((u+e)/u)}};function $t(){var t=this;this.segment={x:.5,y:.5,width:100,height:100,rotation:0},this.arrPoint=[],this.arrTriangle=[],this.arrTriangleBig=[],this.arrPosition=[],this.arrUV=[],this.lengthUV=0,this.lengthPosition=0,this.lengthTriangle=0,this.centerShape=new ti,this.areaShape=0,this._bound={min:new ti,max:new ti,center:new ti};var i,e,s,r,n,a,o,h=new ti,l=new ti,u=[0,0,this.segment.width,this.segment.height],c=[new ti,new ti,new ti,new ti,new ti,new ti,new ti,new ti,new ti],p=0,d=new ti;function f(i,e){return calc.getAngle(t._bound.center,i)-calc.getAngle(t._bound.center,e)}this.start=function(i){t.lengthUV=0,t.lengthTriangle=0,t.lengthPosition=0;for(var e=[],s=0;s<i.length;s++)e.push(new ti(i[s].x,i[s].y,i[s].z));if(0!==this.segment.rotation)for(s=0;s<e.length;s++)calc.rotationPoint(e[s],-this.segment.rotation);if(t.arrPoint=e,t.areaShape=t.area(t.arrPoint),t.areaShape){t.getCenterShape();for(s=0;s<t.arrTriangleBig.length;s++)t.segmentationTriangle(t.arrTriangleBig[s]);if(0!==this.segment.rotation){var r=new ti;for(s=0;s<t.arrPosition.length;s+=3)r.set(t.arrPosition[s],t.arrPosition[s+1]),calc.rotationPoint(r,this.segment.rotation),t.arrPosition[s]=r.x,t.arrPosition[s+1]=r.y}}},this.getCenterShape=function(i){t.arrPoint=i||t.arrPoint,t.arrTriangleBig.length=0,t.arrTriangleBig=t.triangulate(t.arrPoint),t.updateCenterShape()},this.updateCenterShape=function(){var i=0,e=0;t.centerShape.set(0,0);var s=t.convex(t.arrPoint);if(0===s||-1===s)for(var r=0;r<t.arrTriangleBig.length;r++)i<(e=t.area(t.arrTriangleBig[r]))&&(i=e,t.centerShape.x=(t.arrTriangleBig[r][0].x+t.arrTriangleBig[r][1].x+t.arrTriangleBig[r][2].x)/3,t.centerShape.y=(t.arrTriangleBig[r][0].y+t.arrTriangleBig[r][1].y+t.arrTriangleBig[r][2].y)/3);else{for(r=0;r<t.arrPoint.length;r++)t.centerShape.x+=t.arrPoint[r].x,t.centerShape.y+=t.arrPoint[r].y;t.centerShape.x/=t.arrPoint.length,t.centerShape.y/=t.arrPoint.length}},this.segmentationTriangle=function(i){s=this.getBound(this.arrPoint),r=(s.min.x-s.min.x%this.segment.width-2*this.segment.width||0)+this.segment.x*this.segment.width,n=(s.min.y-s.min.y%this.segment.height-2*this.segment.height||0)+this.segment.y*this.segment.height,a=(s.max.x-s.max.x%this.segment.width+2*this.segment.width||500)+this.segment.x*this.segment.width,o=(s.max.y-s.max.y%this.segment.height+2*this.segment.height||500)+this.segment.y*this.segment.height,u[2]=this.segment.width,u[3]=this.segment.height;for(var h=r;h<a;h+=this.segment.width)for(var l=n;l<o;l+=this.segment.height){u[0]=h,u[1]=l,e=t.triangulate(t.getArrPointTriangleSegment(i,u),!1);for(var c=0;c<e.length;c++){t.arrTriangle[t.lengthTriangle++]=e[c];for(var p=0;p<e[c].length;p++)t.generatePointUV(e[c][p],u),t.arrPosition[t.lengthPosition++]=e[c][p].x,t.arrPosition[t.lengthPosition++]=e[c][p].y,t.arrPosition[t.lengthPosition++]=0}}},this.getArrPointTriangleSegment=function(e,s){for(var r=c,n=0;n<r.length;n++)r[n].x=r[n].y=1/0;p=0;for(n=0;n<3;++n)h.x=s[0],h.y=s[1],l.x=s[0]+s[2],l.y=s[1],(i=calc.getPointOfIntersection(h,l,e[n],e[(n+1)%3]))&&(t.inArr(r,i)||r[p++].setPoint(i)),h.x=s[0]+s[2],h.y=s[1],l.x=s[0]+s[2],l.y=s[1]+s[3],(i=calc.getPointOfIntersection(h,l,e[n],e[(n+1)%3]))&&(t.inArr(r,i)||r[p++].setPoint(i)),h.x=s[0]+s[2],h.y=s[1]+s[3],l.x=s[0],l.y=s[1]+s[3],(i=calc.getPointOfIntersection(h,l,e[n],e[(n+1)%3]))&&(t.inArr(r,i)||r[p++].setPoint(i)),h.x=s[0],h.y=s[1],l.x=s[0],l.y=s[1]+s[3],(i=calc.getPointOfIntersection(h,l,e[n],e[(n+1)%3]))&&(t.inArr(r,i)||r[p++].setPoint(i)),h.x=s[0],h.y=s[1],l.x=s[0]+s[2],l.y=s[1]+s[3],t.pointInSegment(e[n],h,l)&&(t.inArr(r,e[n])||r[p++].setPoint(e[n]));return h.x=s[0],h.y=s[1],calc.isInTriangle(e[0],e[1],e[2],h)&&(t.inArr(r,h)||r[p++].setPoint(h)),h.x=s[0]+s[2],h.y=s[1],calc.isInTriangle(e[0],e[1],e[2],h)&&(t.inArr(r,h)||r[p++].setPoint(h)),h.x=s[0]+s[2],h.y=s[1]+s[3],calc.isInTriangle(e[0],e[1],e[2],h)&&(t.inArr(r,h)||r[p++].setPoint(h)),h.x=s[0],h.y=s[1]+s[3],calc.isInTriangle(e[0],e[1],e[2],h)&&(t.inArr(r,h)||r[p++].setPoint(h)),r=r.slice(0,p),t.getBound(r),r.sort(f),r},this.inArr=function(t,i){for(var e=0;e<t.length;++e)if(t[e].x===i.x&&t[e].y===i.y)return!0;return!1},this.getBound=function(t){this._bound.min.set(999999,999999),this._bound.max.set(-999999,-999999);for(var i=0;i<t.length;i++)this._bound.min.x=Math.min(this._bound.min.x,t[i].x),this._bound.max.x=Math.max(this._bound.max.x,t[i].x),this._bound.min.y=Math.min(this._bound.min.y,t[i].y),this._bound.max.y=Math.max(this._bound.max.y,t[i].y);return this._bound.center.set(this._bound.max.x/2+this._bound.min.x/2,this._bound.max.y/2+this._bound.min.y/2),this._bound},this.pointInSegment=function(t,i,e){return i.x<=t.x&&t.x<=e.x&&i.y<=t.y&&t.y<=e.y},this.generatePointUV=function(i,e){i.x===e[0]?d.x=0:i.x===e[0]+e[2]?d.x=1:d.x=(i.x-e[0])%t.segment.width/t.segment.width,i.y===e[1]?d.y=0:i.y===e[1]+e[3]?d.y=1:d.y=(i.y-e[1])%t.segment.height/t.segment.height,t.arrUV[t.lengthUV++]=d.x,t.arrUV[t.lengthUV++]=d.y},this.convex=function(t){var i,e,s,r,n=t.length,a=0;if(n<3)return 0;for(i=0;i<n;i++)if(s=(i+2)%n,r=(t[e=(i+1)%n].x-t[i].x)*(t[s].y-t[e].y),(r-=(t[e].y-t[i].y)*(t[s].x-t[e].x))<0?a|=1:r>0&&(a|=2),3===a)return-1;return 0!=a?1:0},this.area=function(t){for(var i=t.length,e=0,s=i-1,r=0;r<i;s=r++)e+=t[s].x*t[r].y-t[r].x*t[s].y;return.5*e},this.snip=function(t,i,e,s,r,n){var a,o,h,l,u,c,p,d,f,g,A,y,x,m,v,b,w;if(o=t[n[i]].x,h=t[n[i]].y,l=t[n[e]].x,u=t[n[e]].y,c=t[n[s]].x,p=t[n[s]].y,Number.EPSILON>(l-o)*(p-h)-(u-h)*(c-o))return!1;for(g=c-l,A=p-u,y=o-c,x=h-p,m=l-o,v=u-h,a=0;a<r;a++)if(d=t[n[a]].x,f=t[n[a]].y,!(d===o&&f===h||d===l&&f===u||d===c&&f===p)&&(b=m*(f-h)-v*(d-o),w=y*(f-p)-x*(d-c),g*(f-u)-A*(d-l)>=-Number.EPSILON&&w>=-Number.EPSILON&&b>=-Number.EPSILON))return!1;return!0},this.triangulate=function(i,e){var s=i.length;if(s<3)return[];var r,n,a,o=[],h=[],l=[];if(t.area(i)>0)for(n=0;n<s;n++)h[n]=n;else for(n=0;n<s;n++)h[n]=s-1-n;var u=s,c=2*u;for(n=u-1;u>2;){if(c--<=0)return e?l:o;if(u<=(r=n)&&(r=0),u<=(n=r+1)&&(n=0),u<=(a=n+1)&&(a=0),t.snip(i,r,n,a,u,h)){var p,d,f,g,A;for(p=h[r],d=h[n],f=h[a],o.push([i[p],i[d],i[f]]),l.push([h[r],h[n],h[a]]),g=n,A=n+1;A<u;g++,A++)h[g]=h[A];c=2*--u}}return e?l:o}}function ti(t,i,e){this.x=t,this.y=i,this.z=e}function ii(t,i){st.call(this);var e=this;function s(t,i){t.x>i.x&&(t.x=i.x),t.y>i.y&&(t.y=i.y),t.x1<i.x&&(t.x1=i.x),t.y1<i.y&&(t.y1=i.y)}this.type="SpStageSten",this.par=t,this.tipSplice="SpliceSten",this.tipPoint="SpPointSten",this.fun=i,this.uuid=calc.generateRendom(2),this.objectBase=t.objectBase,this.pm=t.pm,this.aDefolt=t.aDefolt,this._boolMax=!0,this.name="xzStart",this._delph=50,this._colorUI=36026,this._colorUI1=15987699,this._colorUIActive=15892548,this._color="#c5d6e0",this._colorP=12965600,this._colorP1=12965600,this._carrier=!0,this._out=!0,this._adjacent=!0,this._colorC0="#222222",this._colorC1="#222222",this._colorC0_=2236962,this._colorC1_=2236962,this._delphC0=100,this._delphC1=100,this._delphPlus=0,this._mashtab=t._mashtab,this._amSten=!1,this._amPoint=!0,this._amPol=!1,this._activMouse=!1,this._colorLine="#000000",this._colorLine_=0,this._sizeLine=10,this._height=300,this._height1=0,this._activeSten=-1,this._activePoint=-1,this._activePol=-1,this._alpha=1,this._status=2,this.boolText=!0,this.content2d=new PIXI.Container,this.par.content2d.addChild(this.content2d),this.contNiz=new PIXI.Container,this.content2d1=new PIXI.Container,this.content2d2=new PIXI.Container,this.content2dPoint=new PIXI.Container,this.cont2dLine=new PIXI.Container,this.cont2dBlok=new PIXI.Container,this.cont2dVerh=new PIXI.Container,this.cont2dGroup=new PIXI.Container,this.content2d.addChild(this.contNiz),this.content2d.addChild(this.content2d1),this.content2d.addChild(this.content2d2),this.content2d.addChild(this.content2dPoint),this.content2d.addChild(this.cont2dBlok),this.content2d.addChild(this.cont2dLine),this.content2d.addChild(this.cont2dVerh),this.content2d.addChild(this.cont2dGroup),this.content3d=new THREE.Object3D,this.par.content3d.add(this.content3d),this.planeXZ=new L,this.boxBufferGeometry=new THREE.BoxBufferGeometry(1,1,1),this.meshBasicMaterial=new THREE.MeshBasicMaterial({color:36026}),this.lineBasicMaterial=new THREE.LineBasicMaterial({color:65280,linewidth:10}),this.lineBasicMaterial1=new THREE.LineBasicMaterial({color:255,linewidth:10}),this.lineBasicMaterial2=new THREE.LineBasicMaterial({color:16711680,linewidth:10}),this.texture=(new THREE.TextureLoader).load("resources/image/pic.png"),this.texture.wrapS=THREE.RepeatWrapping,this.texture.wrapT=THREE.RepeatWrapping,this.texture.repeat.y=-1,this.mat=new THREE.MeshBasicMaterial({color:16747706,map:this.texture}),this.mat1=new THREE.MeshBasicMaterial({color:32778,map:this.texture}),this.lineWord=new lt(this),this.worldBlok=new Tt(this),this.group=new Dt(this),this.metod=new zt(this),this.metodRezolk=new Kt(this),this.triangulateShape=new $t,this.colorT=new THREE.Color,this.convertC=function(t,i){return this.colorT.set(t),null!=i&&(this.colorT.r*=i[0],this.colorT.g*=i[1],this.colorT.b*=i[2]),this.colorT.getHex()},this.getPoint=function(t){return new U(this)},this.getSplice=function(t){return new G(this)},this.getPol=function(t){return new Ht(this,t)},this.getVP=function(t){return new Q(this)},this.getInfo=function(t){for(var i=0;i<this.arrSplice.length;i++)0!=this.arrSplice[i].life&&this.arrSplice[i].getInfo(t)},this.render=function(){this.par.renderDebag&&this.par.renderDebag()},this.getRect=function(t,i,e){if(null==t){t=[];for(var r=0;r<this.arrPoint.length;r++)0!=this.arrPoint[r].life&&t.push(this.arrPoint[r])}if(null==i){i=[];for(r=0;r<this.arrSplice.length;r++)0!=this.arrSplice[r].life&&i.push(this.arrSplice[r])}if(null==e){e=[];for(r=0;r<this.avp.length;r++)0!=this.avp[r].life&&e.push(this.avp[r])}var n={x:9999999,y:999999,x1:-9999999,y1:-9999999,w:0,h:0};for(r=0;r<e.length;r++)s(n,e[r].position);for(r=0;r<t.length;r++)s(n,t[r].position);for(r=0;r<i.length;r++)i[r].poiskGran(),s(n,i[r].arrGran[0]),s(n,i[r].arrGran[1]),s(n,i[r].arrGran[2]),s(n,i[r].arrGran[3]);return n.w=n.x1-n.x,n.h=n.y1-n.y,n},this.dragStyleObj=function(t){for(var i in t)null!=this[i]&&(this[i]=t[i]);this.bigDrag()},this.getDelphToBoolS=function(t,i,e){var s=this._delphC0;return 1==t&&(s=this._delphC1),1==i&&1==t&&(s+=this._delphPlus),s};var r=[];this.setActive=function(t){if(r.length=0,null!=t)if(null!=t[0])for(var i=0;i<t.length;i++)r.push(t[i]);else r.push(t);null==t&&(this.group.active=!1);for(i=0;i<this.arrPoint.length;i++)0!=this.arrPoint[i].life&&(1==this.testSetActive(this.arrPoint[i])?this.arrPoint[i].active=!0:this.arrPoint[i].active=!1);for(i=0;i<this.arrSplice.length;i++)if(0!=this.arrSplice[i].life){1==this.testSetActive(this.arrSplice[i])?this.arrSplice[i].active=!0:this.arrSplice[i].active=!1;for(var e=0;e<this.arrSplice[i].windows.array.length;e++)1==this.testSetActive(this.arrSplice[i].windows.array[e])?this.arrSplice[i].windows.array[e].active=!0:this.arrSplice[i].windows.array[e].active=!1}for(i=0;i<this.arrPol.length;i++)0!=this.arrPol[i].life&&(1==this.testSetActive(this.arrPol[i])?this.arrPol[i].active=!0:this.arrPol[i].active=!1);for(i=0;i<this.avp.length;i++)0!=this.avp[i].life&&(1==this.testSetActive(this.avp[i])?this.avp[i].active=!0:this.avp[i].active=!1);this.render()},this.testSetActive=function(t){if(0==r.length)return!1;for(var i=0;i<r.length;i++)if(r[i].uuid==t.uuid)return!0;return!1},this.bigDrag=function(){for(var t=0;t<this.arrSplice.length;t++)0!=this.arrSplice[t].life&&this.arrSplice[t].dragPost();for(t=0;t<this.arrPoint.length;t++)0!=this.arrPoint[t].life&&this.arrPoint[t].dragPost()},this.arrFun=[],this.arrObj=[],this.addObjFun=function(t){for(var i=0;i<this.arrObj.length;i++)if(this.arrObj[i]._uuid==t._uuid)return;this.arrObj.push(t)},this.doRender=function(){if(0==e.arrObj.length)return!1;for(var t=0;t<e.arrObj.length;t++)e.arrObj[t].dragPost();return e.arrObj.length=0,!0},this.arrFun1=[],this.arrObj1=[],this.addObjFun1=function(t){for(var i=0;i<this.arrObj1.length;i++)if(this.arrObj1[i]._uuid==t._uuid)return;this.arrObj1.push(t)},this.doRender1=function(){if(0==e.arrObj1.length)return!1;for(var t=0;t<e.arrObj1.length;t++)e.arrObj1[t].dragPost();return e.arrObj1.length=0,e.fun("startTikInfo"),!0}}function ei(t){return(ei="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function si(t,i){return!i||"object"!==ei(i)&&"function"!=typeof i?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):i}function ri(t){return(ri=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ni(t,i){return(ni=Object.setPrototypeOf||function(t,i){return t.__proto__=i,t})(t,i)}function ai(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}ti.prototype.set=function(t,i,e){this.x=t,this.y=i,this.z=e},ti.prototype.setPoint=function(t){this.x=t.x,this.y=t.y,this.z=t.z},ii.prototype=Object.create(st.prototype),ii.prototype.constructor=ii,ii.prototype.getObj=function(t){var i=st.prototype.getObj.call(this,t);return i.height=this._height,i.height1=this._height1,i.lineWord=this.lineWord.getObj(),i.name=this.name,i},ii.prototype.setObj=function(t){st.prototype.setObj.call(this,t),t.height&&(this.height=t.height),t.height1&&(this.height1=t.height1),t.name&&(this.name=t.name),t.lineWord&&this.lineWord.setObj(t.lineWord),this.bigDrag()},ii.prototype.craetSplice1=function(){var t=st.prototype.craetSplice1.call(this);return t.col3d=this.col3d,t.col3d1=this.col3d1,t.activMouse=this._amSten,t.boolText=this.boolText,t},ii.prototype.craetPoint=function(){var t=st.prototype.craetPoint.call(this);return t.activMouse=this._amPoint,t.position._z=this.height+this.height1,t},ii.prototype.craetPol=function(t){var i=st.prototype.craetPol.call(this,t);return i.activMouse=this._amSten,i.col3d2=this.col3d2,i},ii.prototype.craetVP=function(){var t=st.prototype.craetVP.call(this);return t.activMouse=this._amPoint,t.position._z=this.height+this.height1,t},ii.prototype.getGronVP=function(t){var i=st.prototype.getGronVP.call(this,t);if(null!=i)return i;for(var e=0;e<this.arrSplice.length;e++)if(0!=this.arrSplice[e].life&&null!=this.arrSplice[e].getGronVP(t))return this.arrSplice[e].getGronVP(t);return null},ii.prototype.clear=function(){var t=st.prototype.clear.call(this);return this.lineWord.clear(),t},Object.defineProperties(ii.prototype,{status:{set:function(t){this._status!=t&&(this._status=t,2==this._status&&(this.content2d.visible=!1,this.content3d.visible=!1),1==this._status&&(this.content2d.visible=!0,this.content3d.visible=!0),0==this._status&&(this.content2d.visible=!0,this.content3d.visible=!0),this.render())},get:function(){return this._status}},boolMax:{set:function(t){this._boolMax!=t&&(this._boolMax=t,1==this._boolMax&&this.doRender1())},get:function(){return this._boolMax}},mashtab:{set:function(t){this._mashtab!=t&&(this._mashtab=t)},get:function(){return this._mashtab}},height:{set:function(t){for(var i=0;i<this.arrSplice.length;i++)this.arrSplice[i].height>=this._height&&(this.arrSplice[i].height=t,this.arrSplice[i].draw1());var e,s;s=Math.round(this._height+this._height1),e=Math.round(t+this._height1);for(i=0;i<this.avp.length;i++)this.avp[i].position.z;for(i=0;i<this.arrPoint.length;i++)this.arrPoint[i].position.z>=s&&(this.arrPoint[i].position.z=e);for(i=0;i<this.arrPoint.length;i++)this.arrPoint[i].life&&this.arrPoint[i].dragGG();this._height=t},get:function(){return this._height}},height1:{set:function(t){if(this._height1!=t){this._height1=t;for(var i=0;i<this.arrSplice.length;i++)this.arrSplice[i].height1=this._height1,this.arrSplice[i].draw1()}},get:function(){return this._height1}},carrier:{set:function(t){this._carrier!==t&&(this._carrier=t,this._delph=this.getDelphToBoolS(this._carrier,this._out,this._adjacent))},get:function(){return this._carrier}},out:{set:function(t){this._out!==t&&(this._out=t,this._delph=this.getDelphToBoolS(this._carrier,this._out,this._adjacent))},get:function(){return this._out}},adjacent:{set:function(t){this._adjacent!==t&&(this._adjacent=t,this._delph=this.getDelphToBoolS(this._carrier,this._out,this._adjacent))},get:function(){return this._adjacent}},colorC0:{set:function(t){if(this._colorC0!=t){this._colorC0=t,this._colorC0_=this.convertC(t);for(var i=0;i<this.arrSplice.length;i++)this.arrSplice[i].draw1()}},get:function(){return this._colorC0}},colorC1:{set:function(t){if(this._colorC1!=t){this._colorC1=t,this._colorC1_=this.convertC(t);for(var i=0;i<this.arrSplice.length;i++)this.arrSplice[i].draw1()}},get:function(){return this._colorC1}},delphC0:{set:function(t){if(this._delphC0!=t){this._delphC0=t,this._delph=this.getDelphToBoolS(this._carrier,this._out,this._adjacent);for(var i=0;i<this.arrSplice.length;i++)this.arrSplice[i].delph=this.getDelphToBoolS(this.arrSplice[i].carrier,this.arrSplice[i].out,this.arrSplice[i].adjacent)}},get:function(){return this._delphC0}},delphC1:{set:function(t){if(this._delphC1!=t){this._delphC1=t,this._delph=this.getDelphToBoolS(this._carrier,this._out,this._adjacent);for(var i=0;i<this.arrSplice.length;i++)this.arrSplice[i].delph=this.getDelphToBoolS(this.arrSplice[i].carrier,this.arrSplice[i].out,this.arrSplice[i].adjacent)}},get:function(){return this._delphC1}},delphPlus:{set:function(t){if(this._delphPlus!=t){this._delphPlus=t,this._delph=this.getDelphToBoolS(this._carrier,this._out,this._adjacent);for(var i=0;i<this.arrSplice.length;i++)1==this.arrSplice[i].carrier&&(this.arrSplice[i].delph=this.getDelphToBoolS(this.arrSplice[i].carrier,this.arrSplice[i].out,this.arrSplice[i].adjacent))}},get:function(){return this._delphPlus}},color:{set:function(t){this._color=t,this._colorP=this.convertC(t),this._colorP1=this.convertC(t,[.8,.8,.8]);for(var i=0;i<this.arrSplice.length;i++)this.arrSplice[i].colorP=this._colorP,this.arrSplice[i].colorP1=this._colorP1,this.arrSplice[i].draw1()},get:function(){return this._color}},alpha:{set:function(t){this._alpha=t;for(var i=0;i<this.arrSplice.length;i++)this.arrSplice[i].alpha=this._alpha,this.arrSplice[i].draw1()},get:function(){return this._alpha}},amSten:{set:function(t){if(this._amSten!=t){this._amSten=t;for(var i=0;i<this.arrSplice.length;i++)this.arrSplice[i].life&&(this.arrSplice[i].activMouse=t)}},get:function(){return this._amSten}},amPoint:{set:function(t){if(this._amPoint!=t){this._amPoint=t;for(var i=0;i<this.arrPoint.length;i++)this.arrPoint[i].life&&(this.arrPoint[i].activMouse=t)}},get:function(){return this._amPoint}},amPol:{set:function(t){if(this._amPol!=t){this._amPol=t;for(var i=0;i<this.arrPol.length;i++)this.arrPol[i].life&&(this.arrPol[i].activMouse=t)}},get:function(){return this._amPol}},activMouse:{set:function(t){this._activMouse=t,this.amPol=t,this.amPoint=t,this.amSten=t},get:function(){return this._activMouse}},colorLine:{set:function(t){if(this._colorLine!=t){this._colorLine=t,this._colorLine_=this.convertC(t),this.worldBlok._colorLine_=this._colorLine_,this.worldBlok.colorLine=this._colorLine_;for(var i=0;i<this.arrSplice.length;i++)this.arrSplice[i].draw1()}},get:function(){return this._colorLine}},sizeLine:{set:function(t){if(this._sizeLine!=t){this._sizeLine=t,this.worldBlok.sizeLine=t;for(var i=0;i<this.arrSplice.length;i++)this.arrSplice[i].delph=this.getDelphToBoolS(this.arrSplice[i].carrier,this.arrSplice[i].out,this.arrSplice[i].adjacent)}},get:function(){return this._sizeLine}},activeSten:{set:function(t){this._activeSten=t;for(var i=0;i<this.arrSplice.length;i++)this.arrSplice[i].life&&(i==this._activeSten?this.arrSplice[i].active=!0:this.arrSplice[i].active=!1)},get:function(){return this._activeSten}},activePoin:{set:function(t){this._activePoin=t;for(var i=0;i<this.arrPoint.length;i++)this.arrPoint[i].life&&(i==this._activePoin?this.arrPoint[i].active=!0:this.arrPoint[i].active=!1)},get:function(){return this._activePoin}},activePol:{set:function(t){this._activePol=t;for(var i=0;i<this.arrPol.length;i++)this.arrPol[i].life&&(i==this._activePol?this.arrPol[i].active=!0:this.arrPol[i].active=!1)},get:function(){return this._activePol}}});var oi=function t(i,e,s){ai(this,t),this.type="PGrid";this.content2d=new PIXI.Container,this.texture=PIXI.Texture.from("resources/image/fill.png"),this.wh=e;var r=new PIXI.extras.TilingSprite(this.texture,this.wh,this.wh);i&&i.addChild(this.content2d),this.content2d.addChild(r);var n=.390625/(s/100);r.tileScale.set(n,n),r.alpha=.9,r.position.x=-this.wh/2,r.position.y=-this.wh/2},hi=function(t){function i(t,e,s,r){var n;ai(this,i),(n=si(this,ri(i).call(this))).type="Grid";var a=new THREE.TextureLoader;n.texture=a.load(s),n.texture.wrapS=THREE.RepeatWrapping,n.texture.wrapT=THREE.RepeatWrapping,n.texture.repeat.set(e,e);var o=new THREE.MeshPhongMaterial({color:16777215,map:n.texture});o.side=THREE.DoubleSide;var h=new THREE.Mesh(new THREE.PlaneBufferGeometry(t,t,1,1),o);return n.add(h),h.castShadow=!0,h.receiveShadow=!0,h.renderOrder=1,h.position.z=20,null!=r&&(o.transparent=!0,o.opacity=r),n}return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&ni(t,i)}(i,THREE.Object3D),i}(),li=e(8),ui=e(1);function ci(){var t=this;this.segment={x:.5,y:.5,width:100,height:100,rotation:0},this.arrPoint=[],this.arrTriangle=[],this.arrTriangleBig=[],this.arrPosition=[],this.arrUV=[],this.lengthUV=0,this.lengthPosition=0,this.lengthTriangle=0,this.centerShape=new pi,this.areaShape=0,this.boolBig=!0,this._bound={min:new pi,max:new pi,center:new pi};var i,e,s,r,n,a,o,h=new pi,l=new pi,u=[0,0,this.segment.width,this.segment.height],c=[new pi,new pi,new pi,new pi,new pi,new pi,new pi,new pi,new pi],p=0,d=new pi,f=new ui.a;function g(i,e){return f.getAngle(t._bound.center,i)-f.getAngle(t._bound.center,e)}this.start=function(i){t.lengthUV=0,t.lengthTriangle=0,t.lengthPosition=0;for(var e=[],s=0;s<i.length;s++)e.push(new pi(i[s].x,i[s].y,i[s].z));if(0!==this.segment.rotation)for(s=0;s<e.length;s++)f.rotationPoint(e[s],-this.segment.rotation);if(t.arrPoint=e,t.areaShape=t.area(t.arrPoint),t.areaShape&&(t.getCenterShape(),0!=t.boolBig)){for(s=0;s<t.arrTriangleBig.length;s++)t.segmentationTriangle(t.arrTriangleBig[s]);if(0!==this.segment.rotation){var r=new pi;for(s=0;s<t.arrPosition.length;s+=3)r.set(t.arrPosition[s],t.arrPosition[s+1]),f.rotationPoint(r,this.segment.rotation),t.arrPosition[s]=r.x,t.arrPosition[s+1]=r.y}}},this.getCenterShape=function(i){t.arrPoint=i||t.arrPoint,t.arrTriangleBig.length=0,t.arrTriangleBig=t.triangulate(t.arrPoint),t.updateCenterShape()},this.updateCenterShape=function(){var i=0,e=0;t.centerShape.set(0,0);var s=t.convex(t.arrPoint);if(0===s||-1===s)for(var r=0;r<t.arrTriangleBig.length;r++)i<(e=t.area(t.arrTriangleBig[r]))&&(i=e,t.centerShape.x=(t.arrTriangleBig[r][0].x+t.arrTriangleBig[r][1].x+t.arrTriangleBig[r][2].x)/3,t.centerShape.y=(t.arrTriangleBig[r][0].y+t.arrTriangleBig[r][1].y+t.arrTriangleBig[r][2].y)/3);else{for(r=0;r<t.arrPoint.length;r++)t.centerShape.x+=t.arrPoint[r].x,t.centerShape.y+=t.arrPoint[r].y;t.centerShape.x/=t.arrPoint.length,t.centerShape.y/=t.arrPoint.length}},this.segmentationTriangle=function(i){s=this.getBound(this.arrPoint),r=(s.min.x-s.min.x%this.segment.width-2*this.segment.width||0)+this.segment.x*this.segment.width,n=(s.min.y-s.min.y%this.segment.height-2*this.segment.height||0)+this.segment.y*this.segment.height,a=(s.max.x-s.max.x%this.segment.width+2*this.segment.width||500)+this.segment.x*this.segment.width,o=(s.max.y-s.max.y%this.segment.height+2*this.segment.height||500)+this.segment.y*this.segment.height,u[2]=this.segment.width,u[3]=this.segment.height;for(var h=r;h<a;h+=this.segment.width)for(var l=n;l<o;l+=this.segment.height){u[0]=h,u[1]=l,e=t.triangulate(t.getArrPointTriangleSegment(i,u),!1);for(var c=0;c<e.length;c++){t.arrTriangle[t.lengthTriangle++]=e[c];for(var p=0;p<e[c].length;p++)t.generatePointUV(e[c][p],u),t.arrPosition[t.lengthPosition++]=e[c][p].x,t.arrPosition[t.lengthPosition++]=e[c][p].y,t.arrPosition[t.lengthPosition++]=0}}},this.getArrPointTriangleSegment=function(e,s){for(var r=c,n=0;n<r.length;n++)r[n].x=r[n].y=1/0;p=0;for(n=0;n<3;++n)h.x=s[0],h.y=s[1],l.x=s[0]+s[2],l.y=s[1],(i=f.getPointOfIntersection(h,l,e[n],e[(n+1)%3]))&&(t.inArr(r,i)||r[p++].setPoint(i)),h.x=s[0]+s[2],h.y=s[1],l.x=s[0]+s[2],l.y=s[1]+s[3],(i=f.getPointOfIntersection(h,l,e[n],e[(n+1)%3]))&&(t.inArr(r,i)||r[p++].setPoint(i)),h.x=s[0]+s[2],h.y=s[1]+s[3],l.x=s[0],l.y=s[1]+s[3],(i=f.getPointOfIntersection(h,l,e[n],e[(n+1)%3]))&&(t.inArr(r,i)||r[p++].setPoint(i)),h.x=s[0],h.y=s[1],l.x=s[0],l.y=s[1]+s[3],(i=f.getPointOfIntersection(h,l,e[n],e[(n+1)%3]))&&(t.inArr(r,i)||r[p++].setPoint(i)),h.x=s[0],h.y=s[1],l.x=s[0]+s[2],l.y=s[1]+s[3],t.pointInSegment(e[n],h,l)&&(t.inArr(r,e[n])||r[p++].setPoint(e[n]));return h.x=s[0],h.y=s[1],f.isInTriangle(e[0],e[1],e[2],h)&&(t.inArr(r,h)||r[p++].setPoint(h)),h.x=s[0]+s[2],h.y=s[1],f.isInTriangle(e[0],e[1],e[2],h)&&(t.inArr(r,h)||r[p++].setPoint(h)),h.x=s[0]+s[2],h.y=s[1]+s[3],f.isInTriangle(e[0],e[1],e[2],h)&&(t.inArr(r,h)||r[p++].setPoint(h)),h.x=s[0],h.y=s[1]+s[3],f.isInTriangle(e[0],e[1],e[2],h)&&(t.inArr(r,h)||r[p++].setPoint(h)),r=r.slice(0,p),t.getBound(r),r.sort(g),r},this.inArr=function(t,i){for(var e=0;e<t.length;++e)if(t[e].x===i.x&&t[e].y===i.y)return!0;return!1},this.getBound=function(t){this._bound.min.set(999999,999999),this._bound.max.set(-999999,-999999);for(var i=0;i<t.length;i++)this._bound.min.x=Math.min(this._bound.min.x,t[i].x),this._bound.max.x=Math.max(this._bound.max.x,t[i].x),this._bound.min.y=Math.min(this._bound.min.y,t[i].y),this._bound.max.y=Math.max(this._bound.max.y,t[i].y);return this._bound.center.set(this._bound.max.x/2+this._bound.min.x/2,this._bound.max.y/2+this._bound.min.y/2),this._bound},this.pointInSegment=function(t,i,e){return i.x<=t.x&&t.x<=e.x&&i.y<=t.y&&t.y<=e.y},this.generatePointUV=function(i,e){i.x===e[0]?d.x=0:i.x===e[0]+e[2]?d.x=1:d.x=(i.x-e[0])%t.segment.width/t.segment.width,i.y===e[1]?d.y=0:i.y===e[1]+e[3]?d.y=1:d.y=(i.y-e[1])%t.segment.height/t.segment.height,t.arrUV[t.lengthUV++]=d.x,t.arrUV[t.lengthUV++]=d.y},this.convex=function(t){var i,e,s,r,n=t.length,a=0;if(n<3)return 0;for(i=0;i<n;i++)if(s=(i+2)%n,r=(t[e=(i+1)%n].x-t[i].x)*(t[s].y-t[e].y),(r-=(t[e].y-t[i].y)*(t[s].x-t[e].x))<0?a|=1:r>0&&(a|=2),3===a)return-1;return 0!=a?1:0},this.area=function(t){for(var i=t.length,e=0,s=i-1,r=0;r<i;s=r++)e+=t[s].x*t[r].y-t[r].x*t[s].y;return.5*e},this.snip=function(t,i,e,s,r,n){var a,o,h,l,u,c,p,d,f,g,A,y,x,m,v,b,w;if(o=t[n[i]].x,h=t[n[i]].y,l=t[n[e]].x,u=t[n[e]].y,c=t[n[s]].x,p=t[n[s]].y,Number.EPSILON>(l-o)*(p-h)-(u-h)*(c-o))return!1;for(g=c-l,A=p-u,y=o-c,x=h-p,m=l-o,v=u-h,a=0;a<r;a++)if(d=t[n[a]].x,f=t[n[a]].y,!(d===o&&f===h||d===l&&f===u||d===c&&f===p)&&(b=m*(f-h)-v*(d-o),w=y*(f-p)-x*(d-c),g*(f-u)-A*(d-l)>=-Number.EPSILON&&w>=-Number.EPSILON&&b>=-Number.EPSILON))return!1;return!0},this.triangulate=function(i,e){var s=i.length;if(s<3)return[];var r,n,a,o=[],h=[],l=[];if(t.area(i)>0)for(n=0;n<s;n++)h[n]=n;else for(n=0;n<s;n++)h[n]=s-1-n;var u=s,c=2*u;for(n=u-1;u>2;){if(c--<=0)return e?l:o;if(u<=(r=n)&&(r=0),u<=(n=r+1)&&(n=0),u<=(a=n+1)&&(a=0),t.snip(i,r,n,a,u,h)){var p,d,f,g,A;for(p=h[r],d=h[n],f=h[a],o.push([i[p],i[d],i[f]]),l.push([h[r],h[n],h[a]]),g=n,A=n+1;A<u;g++,A++)h[g]=h[A];c=2*--u}}return e?l:o}}function pi(t,i,e){this.x=t,this.y=i,this.z=e}pi.prototype.set=function(t,i,e){this.x=t,this.y=i,this.z=e},pi.prototype.setPoint=function(t){this.x=t.x,this.y=t.y,this.z=t.z};class di{constructor(t){this.type="KorektLine";this.fun=t,this.boolDebug=!0,this.funRender=void 0,this.rect={x:0,y:0,z:0,w:300,h:300,d:0},this.arrLine=[];var i=new ui.a;this.calc=i,this.boolVergDrag=!1,this.triangul=new ci,this.triangul.boolBig=!1,this.start=function(){this.korectRect(),this.korectLine(),this.korectTriang()},this.arr=[],this.arrCesh=[],this.arrPointM=[],this.arrPointCeshM=[],this.aL=[],this.aR=[],this.arTriang=[],this.aTri=[],this.aTriCesh=[],this.getTri=function(){return null==this.aTriCesh[this.aTri.length]&&(this.aTriCesh[this.aTri.length]=new Ai(this),this.aTriCesh[this.aTri.length].idArr=this.aTri.length),this.aTriCesh[this.aTri.length].clear(),this.aTri.push(this.aTriCesh[this.aTri.length]),this.aTri[this.aTri.length-1]},this.getLine=function(){return null==this.arrCesh[this.arr.length]&&(this.arrCesh[this.arr.length]=new fi,this.arrCesh[this.arr.length].idArr=this.arr.length),this.arrCesh[this.arr.length].clear(),this.arr.push(this.arrCesh[this.arr.length]),this.arr[this.arr.length-1]},this.getLM=function(){return null==this.arrPointCeshM[this.arrPointM.length]&&(this.arrPointCeshM[this.arrPointM.length]=new gi(this),this.arrPointCeshM[this.arrPointM.length].idArr=this.arrPointM.length),this.arrPointCeshM[this.arrPointM.length].clear(),this.arrPointM.push(this.arrPointCeshM[this.arrPointM.length]),this.arrPointM[this.arrPointM.length-1]},this.sort=function(t,i){return t.dist-i.dist},this.korectLine=function(){for(var t=0;t<this.arrCesh.length;t++)this.arrCesh[t].clear();for(t=0;t<this.arrPointM.length;t++)this.arrPointM[t].clear();this.arr.length=0,this.arrPointM.length=0,this.arTriang.length=0;for(t=0;t<this.arrLine.length;t++)this.kL(this.arrLine[t]);this.aL.length=0,this.aR.length=0,this.aTri.length=0;for(t=0;t<this.arrPointM.length;t++)this.arrPointM[t].boolP=!1;for(t=0;t<this.arrPointM.length;t++)this.arrPointM[t].p.y<0?this.aL.push(this.arrPointM[t]):this.aR.push(this.arrPointM[t]);this.aL.sort(this.sort),this.aR.sort(this.sort)};var e,s,r,n,a,o,h,l,u,c,p,d,f,g,A,y,x,m,v=[];this.korectTriang=function(){this.arrPointM.sort(this.sort),-1,this.kTri1(),this.kTPoisk4()},this.kTri1=function(){0,e=!0,this.arTriang.length=0,s=-1;for(var t=0;t<this.arrPointM.length;t++)if(0==this.arrPointM[t].boolP){s=t;break}if(-1!=s){this.arTriang.length=0,r=this.arrPointM[s],this.kTpoint(r),s=-1;for(t=0;t<this.arrPointM.length;t++)if(0==this.arrPointM[t].boolP){s=t;break}}else this.kTPoisk4()},this.kTpoint=function(t){(n=t).boolP=!0,null,this.arTriang.push(n);for(var i=0;i<n.array.length;i++){if(0==n.array[i].point.boolP)return void this.kTpoint(n.array[i].point);if(0==n.array[i].point1.boolP)return void this.kTpoint(n.array[i].point1)}this.kTPoisk(n)},this.kTPoisk=function(t){o=this.getDist3D(r.p,t.p),l=999999,u=-1;for(var i=0;i<this.arrPointM.length;i++)1!=this.arrPointM[i].boolP&&1==this.arrPointM[i].array.length&&this.arrPointM[i].p.z===t.p.z&&(h=this.getDist3D(this.arrPointM[i].p,t.p))<l&&(l=h,u=i);if(-1===u){l=999999,u=-1;for(i=0;i<this.arrPointM.length;i++)1!=this.arrPointM[i].boolP&&1==this.arrPointM[i].array.length&&this.arrPointM[i].bM===!t.bM&&(h=this.getDist3D(this.arrPointM[i].p,t.p))<l&&(l=h,u=i);-1===u?(v.push(t,r),this.kTPoisk3(this.arTriang)):l>o&&0==e?(v.push(t,r),this.kTPoisk3(this.arTriang),this.kTri1()):(e=!1,v.push(t,this.arrPointM[u]),this.kTpoint(this.arrPointM[u]))}else l>o&&0==e?(v.push(t,r),this.kTPoisk3(this.arTriang),this.kTri1()):(e=!1,v.push(t,this.arrPointM[u]),this.kTpoint(this.arrPointM[u]))},this.arTDo=[],this.kTPoisk3=function(t){this.arTDo.length=0;for(var i=0;i<this.arTriang.length;i++)this.arTDo.push(this.arTriang[i].p);this.korectTriang3(this.arTDo)},this.kTPoisk4=function(){for(var t=0;t<v.length;t+=2)for(var i=t+2;i<v.length;i+=2)if(1==this.kT4(v[t],v[t+1],v[i],v[i+1]))return v.splice(i,2),v.splice(t,2),void this.kTPoisk4()},this.kT4=function(t,i,e,s){return d=null,c=this.getDist2D(t.p,e.p),p=this.getDist2D(t.p,s.p),c<.01&&this.getDist2D(i.p,s.p)<.01&&(d=t,f=i,g=e,A=s),p<.01&&this.getDist2D(i.p,e.p)<.01&&(d=t,f=i,g=s,A=e),null!=d&&((y=this.getTri()).p.setPoint(d.p),y.p1.setPoint(f.p),y.p2.setPoint(g.p),y.setRect(this.rect),(y=this.getTri()).p2.setPoint(d.p),y.p1.setPoint(f.p),y.p.setPoint(g.p),y.setRect(this.rect),(y=this.getTri()).p.setPoint(A.p),y.p1.setPoint(f.p),y.p2.setPoint(g.p),y.setRect(this.rect),(y=this.getTri()).p2.setPoint(A.p),y.p1.setPoint(f.p),y.p.setPoint(g.p),y.setRect(this.rect),!0)},this.getDist2D=function(t,i){return Math.sqrt(Math.pow(t.x-i.x,2)+Math.pow(t.y-i.y,2))},this.korectTriang3=function(t){this.triangul.start(t);for(var i=0;i<this.triangul.arrTriangleBig.length;i++)(a=this.getTri()).setP(this.triangul.arrTriangleBig[i]),a.setRect(this.rect)},this.kL=function(t){(x=this.getLine()).p.x=t.p.x,x.p.y=t.p.y,x.p.z=t.p.z,x.p1.x=t.p1.x,x.p1.y=t.p1.y,x.p1.z=t.p1.z,x.bool=!1,(x.p1.y<0||x.p.y<0)&&(x.bool=!0);for(var i=!0,e=0;e<this.arrPointM.length;e++)if(this.getDist3D(this.arrPointM[e].p,x.p)<.01){this.arrPointM[e].addLine(x,!0),i=!1;break}1==i&&((m=this.getLM()).set(x.p),m.addLine(x,!0)),i=!0;for(e=0;e<this.arrPointM.length;e++)if(this.getDist3D(this.arrPointM[e].p,x.p1)<.01){this.arrPointM[e].addLine(x,!1),i=!1;break}1==i&&((m=this.getLM()).set(x.p1),m.addLine(x,!1))},this.getDist3D=function(t,i){return Math.sqrt(Math.pow(t.x-i.x,2)+Math.pow(t.y-i.y,2)+Math.pow(t.z-i.z,2))},this.korectRect=function(){this.rect.x=999999999999,this.rect.y=999999999999,this.rect.z=999999999999,this.rect.x1=-999999999999,this.rect.y1=-999999999999,this.rect.z1=-999999999999;for(var t=0;t<this.arrLine.length;t++)this.korectRectPoint(this.arrLine[t].p),this.korectRectPoint(this.arrLine[t].p1);this.rect.w=this.rect.x1-this.rect.x,this.rect.h=this.rect.y1-this.rect.y,this.rect.d=this.rect.z1-this.rect.z},this.korectRectPoint=function(t){this.rect.x>t.x&&(this.rect.x=t.x),this.rect.y>t.y&&(this.rect.y=t.y),this.rect.z>t.z&&(this.rect.z=t.z),this.rect.x1<t.x&&(this.rect.x1=t.x),this.rect.y1<t.y&&(this.rect.y1=t.y),this.rect.z1<t.z&&(this.rect.z1=t.z)};var b=[],w=[],P=[];this.setGeom=function(t,i){0,null!=i&&i,b.length=0,w.length=0,P.length=0;for(var e=0;e<this.aTri.length;e++)this.setGeomB(this.aTri[e]);t.setAttribute("normal",new THREE.Float32BufferAttribute(P,3)),t.setAttribute("uv",new THREE.Float32BufferAttribute(w,2)),t.setAttribute("position",new THREE.Float32BufferAttribute(b,3)),t.computeBoundingBox(),t.computeBoundingSphere()},this.setGeomB=function(t){b.push(t.p2.x,t.p2.y,t.p2.z),b.push(t.p1.x,t.p1.y,t.p1.z),b.push(t.p.x,t.p.y,t.p.z),w.push(t.uv2.x,t.uv2.y),w.push(t.uv1.x,t.uv1.y),w.push(t.uv.x,t.uv.y),P.push(0,1,0),P.push(0,1,0),P.push(0,1,0)}}}class fi{constructor(){this.type="KLLine",this.idAr=-1,this.p=new ui.b,this.p1=new ui.b,this.point=void 0,this.point1=void 0,this.clear=function(){this.point=void 0,this.point1=void 0}}}class gi{constructor(t){this.type="KLPoint",this.idArr=-1,this.par=t,this.boolP=!1,this.p=new ui.b,this.pNull=new ui.b(0,0,0),this.dist=0,this.array=[],this.arrayBool=[],this.clear=function(){this.array.length=0,this.arrayBool.length=0,this.boolP=!1},this.bM=!1,this.set=function(t){this.bM=!0,t.y<0&&(this.bM=!1),this.p.set(t.x,t.y,t.z),this.dist=this.par.getDist3D(this.pNull,this.p)},this.addLine=function(t,i){this.array.push(t),this.arrayBool.push(i),1==i?t.point=this:t.point1=this}}}class Ai{constructor(t){this.type="KLTriangul",this.idArr=-1,this.par=t,this.p=new ui.b,this.p1=new ui.b,this.p2=new ui.b,this.uv=new ui.b,this.uv1=new ui.b,this.uv2=new ui.b,this.clear=function(){},this.setP=function(t){this.p.setPoint(t[0]),this.p1.setPoint(t[1]),this.p2.setPoint(t[2])},this.setRect=function(t){this.setRectUV(this.uv,this.p,t),this.setRectUV(this.uv1,this.p1,t),this.setRectUV(this.uv2,this.p2,t)},this.setRectUV=function(t,i,e){t.x=(i.x-e.x)/e.w,t.y=(i.y-e.y)/e.h}}}var yi=e(11);function xi(t,i,e){this.type="PMMat";this.par=t,this.visi3D=i,this.objbase=e,this.pmTexture=this.par.tex,this.ser=window.location.href;var s=window.location.href.split("?")[0].split("/");this.server="";for(var r=0;r<s.length-1;r++)this.server+=s[r]+"/";this.aOBase={};for(r=0;r<this.objbase.bd.length;r++)this.aOBase[this.objbase.bd[r].id]=this.objbase.bd[r].obj;this.aO={},this.getIDReturn=function(t){if(null!=this.aO[t])return this.aO[t];var i=this.aOBase[t],e=this.par.mat.getIDReturn(i.str[0],!0);if(e.userData=i,"null"!=i.str[1]){trace(">>>>>>>>>>>>>>>>>>>>>>>>>>>>>>",i.str[0],i.str[1]);var s=new THREE.Color(i.str[1]);new THREE.Color(16777215*Math.random());setTimeout(function(){e.color=s},1e3)}return this.aO[t]=e,this.aO[t]}}function mi(t){THREE.Group.call(this),this.type="MeshCombined",this._meshes=t,this._ready=!1,this.init()}mi.prototype=Object.create(THREE.Group.prototype),mi.constructor=mi,Object.defineProperties(mi.prototype,{}),mi.prototype.canAnalyze=function(){return this._meshes.reduce(function(t,i){return t&&i.geometry},!0)},mi.prototype._getMaterialKey=function(t){return t.material.uuid},mi.prototype.init=function(){var t=this;if(this._ready||!this.canAnalyze)return!1;var i=[],e={};return this._meshes.forEach(function(t){var i=t.geometry.uuid;e[i]||(e[i]=[]),e[i].push(t)}),Object.keys(e).forEach(function(s){var r=e[s],n=r[0].geometry;if(1!==r.length){var a={};r.forEach(function(i){var e=t._getMaterialKey(i);a[e]||(a[e]=[]),a[e].push(i)}),Object.keys(a).forEach(function(t){var e=a[t],s=e[0].material,r=e.length,o=new THREE.InstancedMesh(n,s.clone(),r);i.push(o),e.forEach(function(t,i){o.setQuaternionAt(i,t.quaternion),o.setPositionAt(i,t.position),o.setScaleAt(i,t.scale)}),o.needsUpdate()})}else i.push(r[0])}),i.forEach(function(i){return t.add(i)}),!0};var vi=new THREE.MeshDepthMaterial;vi.depthPacking=THREE.RGBADepthPacking,vi.clipping=!0,vi.defines={INSTANCE_TRANSFORM:""};var bi=THREE.ShaderLib.distanceRGBA,wi=THREE.UniformsUtils.clone(bi.uniforms),Pi=new THREE.ShaderMaterial({defines:{USE_SHADOWMAP:"",INSTANCE_TRANSFORM:""},uniforms:wi,vertexShader:bi.vertexShader,fragmentShader:bi.fragmentShader,clipping:!0});THREE.InstancedMesh=function(t,i,e){THREE.Mesh.call(this,(new Si).setGeometry(t),i);var s=this;this.type="InstancedMesh",this.numInstances=e||1,this.customDepthMaterial=vi,this.customDistanceMaterial=Pi,this.onAfterRender=function(t,i,e,r,n,a){s.geometry.update(e)}},THREE.InstancedMesh.prototype=Object.create(THREE.Mesh.prototype),THREE.InstancedMesh.constructor=THREE.InstancedMesh,Object.defineProperties(THREE.InstancedMesh.prototype,{material:{set:function(t){this._material=t,this._material.defines=this._material.defines||{},this._material.defines.INSTANCE_TRANSFORM="",this._material.needsUpdate=!0},get:function(){return this._material}},geometry:{set:function(t){t instanceof Si?this._geometry=t:this._geometry.setGeometry(t)},get:function(){return this._geometry}},numInstances:{set:function(t){this._numInstances=t,this.geometry.setCount(this.numInstances)},get:function(){return this._numInstances}}}),THREE.InstancedMesh.prototype.setPositionAt=function(t,i){this.geometry.setPositionAt(t,i)},THREE.InstancedMesh.prototype.setQuaternionAt=function(t,i){this.geometry.setQuaternionAt(t,i)},THREE.InstancedMesh.prototype.setScaleAt=function(t,i){this.geometry.setScaleAt(t,i)},THREE.InstancedMesh.prototype.getPositionAt=function(t,i){return this.geometry.getPositionAt(t,i)},THREE.InstancedMesh.prototype.getQuaternionAt=function(t,i){return this.geometry.getQuaternionAt(t,i)},THREE.InstancedMesh.prototype.getScaleAt=function(t,i){return this.geometry.getScaleAt(t,i)},THREE.InstancedMesh.prototype.needsUpdate=function(){this.geometry.needsUpdate=!0,this.geometry.computeBoundingSphere()};var _i;new THREE.BoxBufferGeometry(1,1,1),new THREE.MeshNormalMaterial({wireframe:!0});function Si(){THREE.InstancedBufferGeometry.call(this),this.count=0;var t=this;this.boundOrigin=new THREE.Box3,this.arrTransform=[],this.gridTransform=new Ci(this.arrTransform),this.setCount=function(t){if(this.count=t,(this.maxInstancedCount||0)<t&&(!this.attributes.instanceQuaternion||this.attributes.instanceQuaternion.count<t)){var i={instanceQuaternion:new Float32Array(4*t),instancePosition:new Float32Array(3*t),instanceScale:new Float32Array(3*t)};this.setAttribute("instanceQuaternion",new THREE.InstancedBufferAttribute(i.instanceQuaternion,4)),this.setAttribute("instancePosition",new THREE.InstancedBufferAttribute(i.instancePosition,3)),this.setAttribute("instanceScale",new THREE.InstancedBufferAttribute(i.instanceScale,3)),this.needsUpdate=!0}for(var e=0;e<t;e++)this.arrTransform[e]=new Ii(this.boundOrigin);this.maxInstancedCount=t},this.setGeometry=function(t){return this.copy(t),this.boundOrigin.setFromBufferAttribute(this.attributes.position),this};var i=new THREE.Frustum,e=new THREE.Matrix4;this.arrTransformVisible=[],this.update=function(s){e.multiplyMatrices(s.projectionMatrix,s.matrixWorldInverse),i.setFromMatrix(e);var r=0;this.arrTransformVisible=[];for(var n=0;n<this.gridTransform.arrGridIndex.length;n++){var a=this.gridTransform.arrGridIndex[n];if(i.intersectsBox(a.boundingBox))for(var o=0;o<a.arrTransform.length;o++){var h=a.arrTransform[o];this.arrTransformVisible.push(h),this.setTransformAt(r++,h)}}t.maxInstancedCount=r,t.needsUpdate=!0},this.updateGrid=function(){this.gridTransform.updateGrid()}}function Ii(t){this.boundOrigin=t,this._boundingBox=null,this.p=new THREE.Vector3,this.s=new THREE.Vector3(1,1,1),this.q=new THREE.Quaternion,this.setP=function(t){this.p.copy(t)},this.setS=function(t){this.s.copy(t)},this.setQ=function(t){this.q.copy(t)}}function Ci(t){var i=this;this.arrTransform=t;var e=100;function s(t){var s="x"+Math.floor(t.x/e)+"y"+Math.floor(t.y/e)+"z"+Math.floor(t.z/e);return i.cache[s]||(i.cache[s]=new Ei),i.cache[s]}this.arrGridIndex=[],this.cache={},this.updateGrid=function(){this.arrGridIndex.length=0,this.cache={};for(var t=0;t<this.arrTransform.length;t++){var i=this.arrTransform[t];s(i.p).arrTransform.push(i)}for(var e in this.cache)this.cache[e].computeBoundingBox(),this.arrGridIndex.push(this.cache[e])}}function Ei(){this.arrTransform=[],this._boundingBox=null}Si.prototype=Object.create(THREE.InstancedBufferGeometry.prototype),Si.constructor=Si,Si.prototype.setTransformAt=function(t,i){this.attributes.instanceScale.setXYZ(t,i.s.x,i.s.y,i.s.z),this.attributes.instancePosition.setXYZ(t,i.p.x,i.p.y,i.p.z),this.attributes.instanceQuaternion.setXYZW(t,i.q.x,i.q.y,i.q.z,i.q.w)},Si.prototype.setPositionAt=function(t,i){this.arrTransform[t].setP(i),this.setTransformAt(t,this.arrTransform[t])},Si.prototype.setQuaternionAt=function(t,i){this.arrTransform[t].setQ(i),this.setTransformAt(t,this.arrTransform[t])},Si.prototype.setScaleAt=function(t,i){this.arrTransform[t].setS(i),this.setTransformAt(t,this.arrTransform[t])},Si.prototype.getPositionAt=function(t,i){return i?i.copy(this.arrTransform[t].p):this.arrTransform[t].p},Si.prototype.getQuaternionAt=function(t,i){return i?i.copy(this.arrTransform[t].q):this.arrTransform[t].q},Si.prototype.getScaleAt=function(t,i){return i?i.copy(this.arrTransform[t].s):this.arrTransform[t].s},Si.prototype.computeBoundingSphere=function(){null===this.boundingSphere&&(this.boundingSphere=new THREE.Sphere),this.computeBoundingBox(),this.boundingBox.getBoundingSphere(this.boundingSphere),this.updateGrid()},Si.prototype.computeBoundingBox=function(){null===this.boundingBox&&(this.boundingBox=new THREE.Box3),this.boundingBox.makeEmpty();for(var t=0,i=this.count;t<i;t++)this.boundingBox.union(this.getBoundingBoxAt(t))},Si.prototype.getBoundingBoxAt=function(t){return this.arrTransform[t].boundingBox},Object.defineProperties(Si.prototype,{needsUpdate:{set:function(t){this.attributes.instancePosition.needsUpdate=t,this.attributes.instanceQuaternion.needsUpdate=t,this.attributes.instanceScale.needsUpdate=t},get:function(){return!1}}}),Ii.prototype.computeBoundingBox=(_i=new THREE.Matrix4,function(){return this._boundingBox||(this._boundingBox=new THREE.Box3),_i.compose(this.p,this.q,this.s),this.boundingBox.copy(this.boundOrigin),this.boundingBox.applyMatrix4(_i),this.boundingBox}),Object.defineProperties(Ii.prototype,{boundingBox:{set:function(t){this._boundingBox=t},get:function(){return this._boundingBox||this.computeBoundingBox()}}}),Ei.prototype.computeBoundingBox=function(){this._boundingBox||(this._boundingBox=new THREE.Box3),this.boundingBox.makeEmpty();for(var t=0,i=this.arrTransform.length;t<i;t++)this.boundingBox.union(this.arrTransform[t].boundingBox);return this.boundingBox},Object.defineProperties(Ei.prototype,{boundingBox:{set:function(t){this._boundingBox=t},get:function(){return this._boundingBox||this.computeBoundingBox()}}});var Ti=["#ifndef INSTANCE_TRANSFORM","vec3 transformed = vec3( position );","#else","#ifndef INSTANCE_MATRIX","mat4 _instanceMatrix = getInstanceMatrix();","#define INSTANCE_MATRIX","#endif","vec3 transformed = ( _instanceMatrix * vec4( position , 1. )).xyz;","#endif"].join("\n"),Mi=["#ifdef USE_COLOR","diffuseColor.rgb *= vColor;","#endif","#if defined(INSTANCE_COLOR)","diffuseColor.rgb *= vInstanceColor;","#endif"].join("\n"),Di=["#ifdef USE_COLOR","varying vec3 vColor;","#endif","#if defined( INSTANCE_COLOR )","varying vec3 vInstanceColor;","#endif"].join("\n"),Ri=["#ifdef USE_COLOR","vColor.xyz = color.xyz;","#endif","#if defined( INSTANCE_COLOR ) && defined( INSTANCE_TRANSFORM )","vInstanceColor = instanceColor;","#endif"].join("\n"),Li=["#ifdef FLIP_SIDED","objectNormal = -objectNormal;","#endif","#ifndef INSTANCE_TRANSFORM","vec3 transformedNormal = normalMatrix * objectNormal;","#else","#ifndef INSTANCE_MATRIX ","mat4 _instanceMatrix = getInstanceMatrix();","#define INSTANCE_MATRIX","#endif","#ifndef INSTANCE_UNIFORM","vec3 transformedNormal =  transposeMat3( inverse( mat3( modelViewMatrix * _instanceMatrix ) ) ) * objectNormal ;","#else","vec3 transformedNormal = ( modelViewMatrix * _instanceMatrix * vec4( objectNormal , 0.0 ) ).xyz;","#endif","#endif"].join("\n"),Oi=["#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )","varying vec2 vUv;","uniform mat3 uvTransform;","#endif","#ifdef INSTANCE_TRANSFORM","mat3 inverse(mat3 m) {","float a00 = m[0][0], a01 = m[0][1], a02 = m[0][2];","float a10 = m[1][0], a11 = m[1][1], a12 = m[1][2];","float a20 = m[2][0], a21 = m[2][1], a22 = m[2][2];","float b01 = a22 * a11 - a12 * a21;","float b11 = -a22 * a10 + a12 * a20;","float b21 = a21 * a10 - a11 * a20;","float det = a00 * b01 + a01 * b11 + a02 * b21;","return mat3(b01, (-a22 * a01 + a02 * a21), ( a12 * a01 - a02 * a11),","b11, ( a22 * a00 - a02 * a20), (-a12 * a00 + a02 * a10),","b21, (-a21 * a00 + a01 * a20), ( a11 * a00 - a01 * a10)) / det;","}","attribute vec3 instancePosition;","attribute vec4 instanceQuaternion;","attribute vec3 instanceScale;","#if defined( INSTANCE_COLOR )","attribute vec3 instanceColor;","varying vec3 vInstanceColor;","#endif","mat4 getInstanceMatrix(){","vec4 q = instanceQuaternion;","vec3 s = instanceScale;","vec3 v = instancePosition;","vec3 q2 = q.xyz + q.xyz;","vec3 a = q.xxx * q2.xyz;","vec3 b = q.yyz * q2.yzz;","vec3 c = q.www * q2.xyz;","vec3 r0 = vec3( 1.0 - (b.x + b.z) , a.y + c.z , a.z - c.y ) * s.xxx;","vec3 r1 = vec3( a.y - c.z , 1.0 - (a.x + b.z) , b.y + c.x ) * s.yyy;","vec3 r2 = vec3( a.z + c.y , b.y - c.x , 1.0 - (a.x + b.x) ) * s.zzz;","return mat4(","r0 , 0.0,","r1 , 0.0,","r2 , 0.0,","v  , 1.0",");","}","#endif"].join("\n");function Bi(t,i,e){this.type="PMFilt";var s=this;this.par=t,this.visi3D=i,this.objbase=e,this.ceshGeom=new Hi(this),this.setObjS=function(t,i){!0,t.object.filt&&0!=t.object.filt.length?new ji(this,t,i):this.finalObjS(t,i)},this.finalObjS=function(t,i){t.object.param&&(1==t.object.param.kesh&&s.ceshGeom.set(t.content3d),null!=t.object.param.sG&&1==t.object.param.sG&&s.ceshGeom.groupGeometri(t.content3d)),i()},this.dragParam=function(t,i){if(t.children)for(var e=t.children.length-1;e>=0;e--)this.dragParam(t.children[e],i);null==t.bs&&(t.castShadow=i.tOt,t.receiveShadow=i.tNa);var s=i.rO;t.iz&&t.iz.renderOrder&&(s=t.iz.renderOrder),t.renderOrder=s},this.dragPozition=function(t){var i=!1;t.object&&t.object.psm&&(i=!0,null!=t.object.psm.active&&0==t.object.psm.active&&(i=!1)),1==i?(t.content3d.position.set(t.object.psm.p[0],t.object.psm.p[1],t.object.psm.p[2]),t.content3d.rotation.set(t.object.psm.r[0],t.object.psm.r[1],t.object.psm.r[2]),t.content3d.scale.set(t.object.psm.s[0],t.object.psm.s[1],t.object.psm.s[2])):(t.content3d.position.set(0,0,0),t.content3d.rotation.set(0,0,0),t.content3d.scale.set(1,1,1))}}function ji(t,i,e){this.type="StartFilt";this.par=t,this.hron=i,this.fun=e,this.hron.filt=this,this.array=[];var s,r=0;this.dragFilt=function(){r!=this.hron.object.filt.length?(s=this.hron.object.filt[r].type,r++,"mark"==s&&this.array.push(new ki(this,this.hron.object.filt[r-1],this.array.length)),"material"==s&&this.array.push(new Fi(this,this.hron.object.filt[r-1],this.array.length))):this.par.finalObjS(this.hron,this.fun)},this.dragFilt()}function Fi(t,i,e){this.type="PMMaterial";this.par=t,this.obj=i,this.idArr=e,this.mat=this.par.par.par.mat.getTestTitle(i.id),null!=this.mat?(this.parsing=function(t){if(t.children)for(var i=t.children.length-1;i>=0;i--)this.parsing(t.children[i]);null!=t.material&&(t.material=this.mat)},this.parsing(t.hron.content3d),this.par.dragFilt()):this.par.dragFilt()}function ki(t,i,e){this.type="PMMark";var s=this;if(this.par=t,this.obj=i,this.idArr=e,this.idKey=i.id,this.c3d=t.hron.content3d,this.arrName=[],this.arrayObj=[],"null"!=this.idKey){var r,n=!0;if(-1!=i.id.indexOf("|")){for(var a=i.id.split("|"),o=a[0].split(","),h=a[1].split(","),l=0;l<o.length;l++)this.arrName[l]={name:o[l],id:1*h[l],obCont:null};n=!1}else n=!0,this.arrName[0]={name:"null",id:i.id,obCont:null};this.parsing=function(t){if(t.children)for(var i=t.children.length-1;i>=0;i--)this.parsing(t.children[i]);if("Mesh"==t.type)if(n)r=this.arrName[0].obCont.clone(),t.parent.add(r),r.position.set(t.position.x,t.position.y,t.position.z),r.rotation.set(t.rotation.x,t.rotation.y,t.rotation.z),r.scale.set(t.scale.x,t.scale.y,t.scale.z),t.parent.remove(t);else if(t.name)for(i=this.arrName.length-1;i>=0;i--)if(-1!=t.name.indexOf(this.arrName[i].name))return r=this.arrName[i].obCont.clone(),t.parent.add(r),r.position.set(t.position.x,t.position.y,t.position.z),r.rotation.set(t.rotation.x,t.rotation.y,t.rotation.z),r.scale.set(t.scale.x,t.scale.y,t.scale.z),void t.parent.remove(t)},this.loadMMM=function(t){this.par.par.par.getId(1*t.id,function(i){t.obCont=i,s.loadMod()})},this.loadMod=function(){for(var t=0;t<this.arrName.length;t++)if(null==this.arrName[t].obCont)return void this.loadMMM(this.arrName[t]);this.parsing(this.c3d),this.par.dragFilt()},this.loadMod()}else this.par.dragFilt()}function Hi(t){this.type="CeshGeom";var i=this;i.kolCount=9999,this.par=t;var e,s,r={};function n(t,i,e,s){e&&i.updateMatrixWorld(),s&&t.updateMatrixWorld();var r=(new THREE.Matrix4).getInverse(i.matrixWorld);t.parent&&r.multiply(t.parent.matrixWorld),t.applyMatrix(r),i.add(t)}this.set=function(t){for(var e in r={},i.fillObjMesh(t),r)r[e].length>=2&&new zi(this,t,r[e])},this.sliteGeom=new Ni,this.groupGeometri=function(t){r={},i.fillObjMesh(t);var a=!1;for(var o in r)if(r[o].length>=2){a=!0,this.sliteGeom.start(r[o][0].geometry.clone());for(var h=r[o].length-1;h>=0;h--)n(e=r[o][h],t),this.sliteGeom.setMesh(e),e.parent.remove(e);this.sliteGeom.final(),s=new THREE.Mesh(this.sliteGeom.creatGeom,e.material),t.add(s)}a&&i.killNull(t)},i.killNull=function(t){if(t.children)for(var e=t.children.length-1;e>=0;e--)i.killNull(t.children[e]);null!=t.geometry||null==t.children||0!=t.children.length||null==t.parent||t.parent.remove(t)},i.fillObjMesh=function(t){for(var e=function t(i){var e=[];i.updateMatrixWorld();i instanceof THREE.Mesh&&e.push(i);for(var s=0;s<i.children.length;s++)for(var r=t(i.children[s]),n=0;n<r.length;n++)e.push(r[n]);return e}(t),s=0;s<e.length;s++)e[s].geometry&&e[s].geometry.index&&e[s].geometry.index.count<i.kolCount&&(r[e[s].geometry.uuid]=r[e[s].geometry.uuid]||[],r[e[s].geometry.uuid].push(e[s]))},this.moveObject=function(t,i,e,s){n(t,i,e,s)}}function zi(t,i,e){this.type="LoadTime";var s,r=this;this.par=t,this.c3d=i,this.arr=e,this.mesh=e[0],this.geom=e[0].geometry,this.mate=e[0].material;var n=!0;this.initLoad=function(){n=!1,r.mate&&null!=r.mate.idObj&&0==r.mate.loadTexure&&(n=!0),0==n?setTimeout(function(){r.initLoad()},50):r.creat()},this.creat=function(){for(var t=e.length-1;t>=0;t--)s=e[t],this.par.moveObject(s,i),s.parent.remove(s);this.meshCombined=new mi(e),i.add(this.meshCombined);for(this.meshCombined._meshes,t=0;t<this.meshCombined.children.length;t++)this.meshCombined.children[t].castShadow=s.castShadow,this.meshCombined.children[t].receiveShadow=s.receiveShadow,this.meshCombined.children[t].renderOrder=s.renderOrder;this.par.killNull(i)},this.initLoad()}function Ni(){this.type="SliteGeom";var t;this.geometry,this.kol,this.ah=[],this.sah=0,this.sahMesh=0,this.creatGeom,this.ap=[],this.ai=[],this.auv=[],this.start=function(t){this.geometry=t,this.creatGeom=new THREE.BufferGeometry,this.sah=0,this.sahMesh=0,this.ap=[],this.ai=[],this.auv=[],this.sPosit()},this.sPosit=function(){for(var t=0;t<this.geometry.index.count;t++)null==this.ah[this.sah]&&(this.ah[this.sah]=new Gi),this.ah[this.sah].posOld.set(this.geometry.attributes.position.array[3*this.geometry.index.array[t]],this.geometry.attributes.position.array[3*this.geometry.index.array[t]+1],this.geometry.attributes.position.array[3*this.geometry.index.array[t]+2]),this.ah[this.sah].uv.set(this.geometry.attributes.uv.array[2*this.geometry.index.array[t]],this.geometry.attributes.uv.array[2*this.geometry.index.array[t]+1]),this.ah[this.sah].index=this.geometry.index.array[t],this.sah++},this.setMesh=function(i){t=this.sahMesh*this.sah;for(var e=0;e<this.sah;e++)this.ah[e].setMesh(i),this.ap.push(this.ah[e].pos.x,this.ah[e].pos.y,this.ah[e].pos.z),this.auv.push(this.ah[e].uv.x,this.ah[e].uv.y),this.ai.push(this.ah[e].index+t);this.sahMesh++},this.final=function(){this.creatGeom.setIndex(this.ai),this.creatGeom.addAttribute("position",new THREE.BufferAttribute(new Float32Array(this.ap),3)),this.creatGeom.addAttribute("uv",new THREE.BufferAttribute(new Float32Array(this.auv),2)),this.creatGeom.attributes.position.needsUpdate=!0,this.creatGeom.attributes.uv.needsUpdate=!0,this.creatGeom.computeVertexNormals(),this.creatGeom.attributes.normal.needsUpdate=!0,this.creatGeom.computeBoundingBox(),this.creatGeom.computeBoundingSphere()}}function Gi(){this.type="SliteGeom",this.pos=new THREE.Vector3,this.posOld=new THREE.Vector3,this.uv=new THREE.Vector2,this.index=0,this.setMesh=function(t){this.pos.set(this.posOld.x,this.posOld.y,this.posOld.z),this.pos.applyMatrix4(t.matrix)}}function Xi(t){return(Xi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ui(t,i,e){this.type="PMFilt";var s,r,n,a=this;this.par=t,this.visi3D=i,this.objbase=e,this.setHron=function(t,i){var e,s;e=t.object.iz,s=t.content3d,i&&(s=i),null!=s&&null!=e&&1==e.a&&this.setMod(s,this.strToObj(e.str),e.st)},this.strToObj=function(t){for(var i="",e=0;e<t.length;e++)"|"==t[e]?i+='"':i+=t[e];return JSON.parse(i)},this.getIz=function(t){if(s++,null!=t.iz){var i=0;null!=t.iz.renderOrder&&(0==i&&(i={}),i.renderOrder=t.iz.renderOrder),null!=t.iz.bs&&(0==i&&(i={}),i.bs=t.iz.bs),null!=t.iz.mod&&(0==i&&(i={}),i.mod=t.iz.mod),null!=t.iz.position&&(0==i&&(i={}),i.position=t.iz.position),null!=t.iz.scale&&(0==i&&(i={}),i.scale=t.iz.scale),null!=t.iz.rotation&&(0==i&&(i={}),i.rotation=t.iz.rotation),null!=t.iz.visible&&(0==i&&(i={}),i.visible=t.iz.visible),null!=t.iz.material&&(0==i&&(i={}),i.material=t.iz.material),0!=i&&(i.sah=s),r.push(i)}else r.push(0);if(t.children&&null==t.notPar)for(var e=0;e<t.children.length;e++)this.getIz(t.children[e])},this.getMod=function(t){return s=-1,r=[],this.getIz(t),r},this.setIz=function(t,i){if(n[++s]&&0!=n[s]){if(t.iz={},null!=n[s].mod){i&&(t.iz.mod=n[s].mod);for(var e=new THREE.Object3D,r=0,o=0;o<t.parent.children.length;o++)t.parent.children[o].uuid==t.uuid&&(r=o);e.notPar=!0,t.parent.add(e),t.parent.remove(t),e.parent.children.splice(e.parent.children.length-1,1),e.parent.children.splice(r,0,e),a.par.getId(n[s].mod,function(t){e.add(t)})}null!=n[s].renderOrder&&(i&&(t.iz.renderOrder=n[s].renderOrder),t.renderOrder=n[s].renderOrder),null!=n[s].bs&&(i&&(t.iz.bs=n[s].bs),t.bs=n[s].bs),null!=n[s].position&&(i&&(t.iz.position=n[s].position),t.position.set(n[s].position.x,n[s].position.y,n[s].position.z)),null!=n[s].scale&&(i&&(t.iz.scale=n[s].scale),t.scale.set(n[s].scale.x,n[s].scale.y,n[s].scale.z)),null!=n[s].rotation&&(i&&(t.iz.rotation=n[s].rotation),t.rotation.set(n[s].rotation.x,n[s].rotation.y,n[s].rotation.z)),null!=n[s].visible&&(i&&(t.iz.visible=n[s].visible),t.visible=n[s].visible),null!=n[s].material&&t.material&&(null==t.oldName&&(t.oldName=t.material.name),i&&(t.iz.material=n[s].material),t.material=a.par.mat.getIDReturn(n[s].material))}if(t.children&&null==t.notPar)for(o=0;o<t.children.length;o++)this.setIz(t.children[o])},this.setMod=function(t,i,e){"object"==Xi(i)&&null!=i[0]&&(n=i,s=-1,this.setIz(t,e))},this.setMat=function(t,i,e,s){if(null!=s&&(s=!0),null!=t.material&&(null==t.oldName&&(t.oldName=t.material.name),"string"==typeof i&&(i=this.par.mat.getIDReturn(i,s)),null==e?(t.material=i,null==t.iz&&(t.iz={}),t.iz.material=i.idUz):t.oldName&&-1!=t.oldName.indexOf(e)&&(t.material=i,null==t.iz&&(t.iz={}),t.iz.material=i.idUz)),t.children&&null==t.notPar)for(var r=0;r<t.children.length;r++)this.setMat(t.children[r],i,e,s)}}function Vi(t,i){for(var e=0;e<i.length;e++){var s=i[e];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}THREE.ShaderChunk.begin_vertex=Ti,THREE.ShaderChunk.color_fragment=Mi,THREE.ShaderChunk.color_pars_fragment=Di,THREE.ShaderChunk.color_vertex=Ri,THREE.ShaderChunk.defaultnormal_vertex=Li,THREE.ShaderChunk.uv_pars_vertex=Oi;var Qi=function(){function t(i,e,s){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,t),this.type="PMTexture",this.par=i,this.visi3D=e,this.objbase=s,this.loader=new THREE.TextureLoader,this.textureCache={},window.textureCache=this.textureCache}var i,e,s;return i=t,(e=[{key:"getById",value:function(t,i){var e=this;if(this.textureCache[t]&&this.textureCache[t].loaded)return i&&setTimeout(function(){return i(e.textureCache[t].texture)},0),this.textureCache[t].texture;var s=this.getObj(t);return this.loadTexture(s,i)}},{key:"loadTexture",value:function(t,i){var e=this;if(this.textureCache[t.id]&&this.textureCache[t.id].callbacks||(this.textureCache[t.id]={callbacks:[]}),!this.textureCache[t.id].texture){var s=window.location.href.split("/");s.pop();var r=s.join("/")+"/resources/data/"+t.id+"/pic."+t.type,n=this.loader.load(r,function(i){e.visi3D&&(e.visi3D.intRend=1),i.obj={},e.textureCache[t.id].callbacks.forEach(function(t){return t(i)}),delete e.textureCache[t.id].callbacks,e.textureCache[t.id].loaded=!0});n.arrMat=[],n.arrRun=[],n.wrapS=n.wrapT=THREE.RepeatWrapping,n.repeat.x=t.rx,n.repeat.y=t.ry,this.textureCache[t.id].texture=n}return i&&this.textureCache[t.id].callbacks.push(i),this.textureCache[t.id].texture}},{key:"updateTexture",value:function(t,i){var e=this;if(this.textureCache[t.id])if(i){var s=new Image,r=window.location.href.split("/");r.pop(),s.src=r.join("/")+"/resources/data/"+t.id+"/pic."+t.type,this.textureCache[t.id].texture.image=s,this.textureCache[t.id].loaded=!1,s.onload=function(){delete e.textureCache[t.id].callbacks,e.textureCache[t.id].loaded=!0,e.textureCache[t.id].texture.needsUpdate=!0}}else this.textureCache[t.id].texture.repeat.x=t.rx,this.textureCache[t.id].texture.repeat.y=t.ry}},{key:"getObj",value:function(t){return this.objbase.textures.find(function(i){return i.id===t})||null}}])&&Vi(i.prototype,e),s&&Vi(i,s),t}();function Yi(t){return(Yi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Wi(t,i){this.type="PM";this.objbase=i,this.visi3D=t,this.plus="?1",this.loaderGLTF=new THREE.GLTFLoader,this.tex=new Qi(this,t,i),this.mat=new yi.a(this,t,i),this.filt=new Bi(this,t,i),this.iz=new Ui(this,t,i),this.matDop=new xi(this,t,i),this.arrayHron=[],this.getId=function(t,i,e){if(1==e)for(var s=0;s<this.arrayHron.length;s++)1==this.arrayHron[s].testId(t)&&this.arrayHron.splice(s,1);for(s=0;s<this.arrayHron.length;s++)if(1==this.arrayHron[s].testId(t))return void this.arrayHron[s].setFun(i);this.arrayHron.push(new Zi(this,t,i))},this.clear=function(){}}function Zi(t,i,e){this.type="Hron";var s,r,n=this;this.par=t,this.idObj=i,this.id=void 0,this.object=void 0,this.link=void 0,this.filt=void 0,this.content3d=void 0,this.array=[],this.array.push(e),this.boolClone=!0,this.setFun=function(t){if(null!=this.content3d)return(s=1==n.boolClone?n.content3d.clone():n.content3d).hron=this,this.par.iz.setHron(this,s),this.object.param&&this.par.filt.dragParam(s,this.object.param),void t(s);this.array.push(t)},this.finalLoad=function(t){this.getObj3D(t),this.content3d=t,t.name="hron_"+this.id,this.par.mat.setObjS(this.content3d,this.object,this.finalLoad1)},this.finalLoad1=function(){n.par.filt.setObjS(n,n.finalLoad2)},this.finalLoad2=function(){for(var t=0;t<n.array.length;t++)(s=1==n.boolClone?n.content3d.clone():n.content3d).hron=n,n.par.iz.setHron(n,s),n.object.param&&n.par.filt.dragParam(s,n.object.param),n.array[t](s)},this.start=function(t){this.object=t,null!=this.object.param.clone&&0==this.object.param.clone&&(this.boolClone=!1),this.id=t.id,this.link="resources/data/"+this.id+"/mod/"+this.object.mod.name,"n"==this.object.mod.name?this.finalLoad(new THREE.Mesh(new THREE.BoxBufferGeometry(100,100,100))):this.par.loaderGLTF.load(this.link,function(t){n.finalLoad(t.scene)})},this.testId=function(t){return r="number"==typeof t?t:t.id,(null==this.id?this.idObj.id:this.id)==r},this.getObj3D=function(i){if(null!=i.material&&null!=i.material.roughnessMap&&t.visi3D&&(i.material.envMap=t.visi3D.cubeMap.getTexture()),null!=i){if(null!=i.children)for(var e=i.children.length-1;e>=0;e--)this.getObj3D(i.children[e]);"Default_light"==i.name&&i.parent.remove(i)}},"object"!=Yi(i)?"number"==typeof i&&$.ajax({url:"resources/data/"+i+"/config.json"+n.par.plus,success:function(t){"string"==typeof t?n.start(JSON.parse(t)):n.start(t)},error:function(t){console.log("Что то случилось с конфигом")}}):this.start(i)}function Ji(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function qi(t,i){for(var e=0;e<i.length;e++){var s=i[e];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function Ki(t,i,e){return i&&qi(t.prototype,i),e&&qi(t,e),t}var $i=function(){function t(i,e){Ji(this,t),this.type="P20";var s=this;this.par=i,this.fun=e,this.sizeMax=this.par.sizeMax,this.sobSP=void 0,this._boolMax=!0,this.startFund='{"colorC0":"#ffc0b0","colorC1":"#3a11b5","delphC0":27,"delphC1":75, "delphPlus":15, "sizeLine":1,"colorLine":"#000000"}',this.sOFund=JSON.parse(this.startFund),this.startStyle='{"colorC0":"#ffe4d4","colorC1":"#b0dfee","delphC0":20,"delphC1":50,"delphPlus":10,"sizeLine":1, "colorLine":"#000000"}',this.startObject=JSON.parse(this.startStyle),this._activObject=void 0,this.objectBase=this.par.par.objectBase,this.content3d=new THREE.Object3D,this.content2d=new PIXI.Container,this.rulimActivSP=new te(this),this.korektRect=new li.a,this.korektLine=new di,this.pm=new Wi(i.visi3D,this.objectBase),this.aDefolt=[13,13,13];for(var r=0;r<this.objectBase.three.length;r++)if("defolt"==this.objectBase.three[r].keyName)for(var n=this.objectBase.three[r].array,a=0;a<n.length;a++){var o=n[a].keyName.split("_");o[1]&&"defolt"==o[0]&&(this.aDefolt[1*o[1]]=n[a].id)}this.sobSP=function(t,i,e){"startTikInfo"!=t?s.fun(t,i,e):s.startTikInfo(100)},this._index=-1,this._mashtab=1,this.arrayChesh=[],this.array=[];for(r=0;r<2;r++)this.arrayChesh[r]=new ii(this,this.sobSP),this.arrayChesh[r].idArr=r,this.array[r]=this.arrayChesh[r];this.arrayChesh[0].dragStyleObj(this.sOFund),this.arrayChesh[1].dragStyleObj(this.startObject),this.setArrObj=function(t){if(this.sp.clear(),null!=t[0]||null==t.type){for(var i={type:"SpStageSten",tipPoint:"SpPointSten",arrPoint:[],arrSplice:[]},e={x:99999,y:99999,x1:-999999,y1:-99999},s=0;s<t.length;s++){var r={};r.position=t[s].point0,r.position1=t[s].point1,r.delph=t[s].width,r.idUi=t[s].id,t[s].alignmentId?(r.bChaz=!1,"left"==t[s].alignmentOtherSide&&(r.bChaz=!0),r.bChaz1=!1,"left"==t[s].alignmentThisSide&&(r.bChaz1=!0),r.sUi=t[s].alignmentId):r.sUi=-1,i.arrSplice.push(r),e.x>t[s].point0.x&&(e.x=t[s].point0.x),e.y>t[s].point0.y&&(e.y=t[s].point0.y),e.x1<t[s].point0.x&&(e.x1=t[s].point0.x),e.y1<t[s].point0.y&&(e.y1=t[s].point0.y)}this.setObj(i)}else this.setObj(t)},this.dragStyleObj=function(t){t&&(this.startObject=t);for(var i=0;i<this.array.length;i++)this.array[i].dragStyleObj(this.startObject)},this.renderDebag=function(){this.fun("render",-1)},this.creatFloor=function(){null==this.arrayChesh[this.array.length]&&(this.arrayChesh[this.array.length]=new ii(this,this.sobSP),this.arrayChesh[this.arrayChesh.length-1].idArr=this.array.length,this.arrayChesh[this.arrayChesh.length-1].dragStyleObj(this.startObject)),this.array[this.arrayChesh.length-1]=this.arrayChesh[this.arrayChesh.length-1],this.korektHeight()},this.clearFloor=function(t){if(t=null!=t?t:this._index,null!=this.array[this._index]){var i=this.array.splice(t,1);null!=i[0]&&i[0].clear();var e=this._index;null!=this.array[e]&&(this._index=-2,this.index=e)}else console.error("FIXE Передан этаж которого несуществует");this.korektHeight()},this.upDate=function(){return null!=this.sp&&this.sp.doRender()},this.clearBig=function(){for(var t=0;t<this.arrayChesh.length;t++)this.arrayChesh[t].clear();this.array=[]},this.setObjOpen=function(t){null==t.index?this.sp.setObj(t):(this.clearBig(),this.setObj(t),null!=t.position&&null!=this.sGposition?this.sGposition(t.position):setTimeout(function(){s.fun("rectSP")},1))},this.sGposition=void 0,this.korektHeight=function(){for(var t=0,i=0;i<this.array.length;i++)this.array[i].content3d.position.z=-(t-this.array[0].height),t+=this.array[i].height},this.getObj=function(){var t={};t.index=this._index,t.array=[];for(var i=0;i<this.array.length;i++)t.array[i]=this.array[i].getObj();return null!=this.sGposition&&(t.position=this.sGposition()),t},this.setObj=function(t){if(null!=t.index){for(var i=0;i<t.array.length;i++)null==this.array[i]&&(null==this.arrayChesh[i]&&(this.arrayChesh[i]=new ii(this,this.sobSP),this.arrayChesh[i].idArr=i,this.arrayChesh[i].dragStyleObj(this.startObject)),this.array[i]=this.arrayChesh[i]),this.array[i].setObj(t.array[i]);this._index=-1,this.index=t.index,this.startTikInfo()}else s.fun("message","Error Старая модель файла","Старый не опдерживал этажность")},this.getRect=function(t){var i=this.sp;if(null!=t){if(null==this.array[t])return null;i=this.array[t]}return i.getRect()};var h=[];this.getInfo=function(){h.length=0;for(var t=0;t<this.array.length;t++)this.array[t].getInfo(h);this.fun("getInfo",h)},this.sah=0,this.startTikInfo=function(t){null==t&&(t=500),this.sah++;var i=this.sah;setTimeout(function(){s.sah==i&&s.getInfo()},t)},this.mouseup=function(t){s.boolMax=!0,0==dcmParam.mobile?document.removeEventListener("mouseup",s.mouseup):document.removeEventListener("touchend",s.mouseup)},this.mousedown=function(t){s.boolMax=!1,0==dcmParam.mobile?document.addEventListener("mouseup",s.mouseup):document.addEventListener("touchend",s.mouseup)},0==dcmParam.mobile?document.addEventListener("mousedown",s.mousedown):document.addEventListener("touchstart",s.mousedown),this.korektHeight(),this.fun("complit")}return Ki(t,[{key:"boolMax",set:function(t){if(this._boolMax!=t){this._boolMax=t,trace("this._boolMax  >>",this._boolMax);for(var i=0;i<this.array.length;i++)this.array[i].boolMax=t}},get:function(){return this._boolMax}},{key:"index",set:function(t){if(this._index!=t){this._index=t;for(var i=0;i<this.array.length;i++){var e=2;this.array[t-1]&&i==t-1&&(e=1),this.array[i]&&t==i&&(e=0,this.sp=this.array[i],this.fun("indexSP",this.sp)),this.array[i].status=e}this.rulimActivSP.index=this._index,this.korektHeight(),this.content3d.position.z=-this.array[t].content3d.position.z}},get:function(){return this._index}},{key:"mashtab",set:function(t){if(this._mashtab!=t){this._mashtab=t;for(var i=0;i<this.array.length;i++)this.array[i].mashtab=t}},get:function(){return this._mashtab}}]),t}(),te=function(){function t(i,e){Ji(this,t),this.type="RulimActivSP";this.par=i,this.fun=e,this._index=this.par._index,this.grid=new oi(null,this.par.sizeMax,200),this.graphics=new PIXI.Graphics,this.graphics.name="xz";var s=this.par.sizeMax;this.graphics.beginFill(14479866,1.1),this.graphics.drawRect(-s/2,-s/2,s,s),this.graphics.interactive=!0,this.grid3d=new hi(this.par.sizeMax,1e3,"resources/image/fill.png",.9)}return Ki(t,[{key:"index",set:function(t){this._index!=t&&(this._index=t,null!=this.par.array[t]&&(this.par.array[t].content2d.addChildAt(this.grid.content2d,0),this.par.array[t].content2d.addChildAt(this.graphics,0),this.par.array[t].content3d.add(this.grid3d)))},get:function(){return this._index}}]),t}(),ie=e(12);var ee=function t(){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,t);var i=this;this._width=100,this._height=100,this.div=document.createElement("div"),this.div.style.position="fixed",this.div.style.top="0px",this.div.style.left="0px",this.stage=new PIXI.Container,this.content2d=new PIXI.Container,this.stage.addChild(this.content2d),this.renderer=new PIXI.autoDetectRenderer(this._width,this._height,{antialias:!0,transparent:!0,preserveDrawingBuffer:!0}),this.renderer.view.style.position="fixed",this.div.appendChild(this.renderer.view),this.render=function(){i.renderer.render(i.stage)},this.sizeWindow=function(t,e){t&&(i._width=t,i._height=e),i.renderer.view.style.width=i._width+"px",i.renderer.view.style.height=i._height+"px",i.renderer.resize(i._width,i._height)}};var se=function t(i){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,t),this.type="ViewServer";var e=this;this.fun=i,this.id=void 0,this.openId=function(t){this.id=t;var i={url:"https://alphakp.ru/catalog/plan/"+t+"/edit_scheme/set_scheme",type:"GET",data:{},cache:!1,async:!1,success:function(t){null!=t.json?e.fun("setObj",JSON.parse(t.json)):e.fun("setObj",null)},error:function(t){e.fun("message","Error","Чо то не грузит линк")}};$.ajax(i)},this.saveGetObjId=function(t){if(null!=this.id){var i={url:"https://alphakp.ru/catalog/plan/"+this.id+"/edit_scheme/set_scheme",type:"POST",data:{json:JSON.stringify(t)},cache:!1,async:!1,success:function(t){e.fun("message","Проект сохронен","Проект сохронен на сервере.",500)},error:function(t){e.fun("message","Error","Чо то не грузит линк")}};$.ajax(i)}else e.fun("message","Error Проект не имеет ИД","Этот проект не открыт, в плане не имеет связи с сервером")},this.openURL=function(){var t=function(t,i){var e=window.document.URL.toString();i&&(e=i);var s=e.split("/");if(e.indexOf("?")>0){var s=e.split("?"),r=s[1].split("&"),n=new Array(r.length),a=new Array(r.length);s=e.split("?"),r=s[1].split("&"),n=new Array(r.length),a=new Array(r.length);var o=0;for(o=0;o<r.length;o++){var h=r[o].split("=");n[o]=h[0],""!=h[1]?a[o]=unescape(h[1]):a[o]=null}for(o=0;o<r.length;o++)if(n[o]==t)return a[o];return null}}("id");null!=t?this.openId(t):e.fun("openStart")}},re=e(20);function ne(t){return(ne="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ae(t){this.type="SceneSB",this.visi3D=t;this.array=[],this.object=void 0,this.array.push(new ue("ambient",t)),this.array.push(new le("shadow",t)),this.array.push(new ce("sky",t)),this.array.push(new pe("mirror",t)),this.array.push(new de("visi3D",t)),this.array.push(new fe("effect",t)),this.array.push(new ge("fog",t)),this.setObj=function(t){this.object=t;for(var i=0;i<this.array.length;i++)void 0===this.object[this.array[i].name]&&(this.object[this.array[i].name]={}),this.array[i].setBasa(this.object[this.array[i].name]);visi3D.shadowNeedsUpdate=!0}}function oe(t,i){this.type="SceneBox";this.name=t,this.array=[],this.object=null,this.objArray={},this.plus=function(t,i){this.array.push(new he(t,i)),this.objArray[t.param]=this.array[this.array.length-1]},this.setValue=function(t,i,e){null==e?this.object[t]=i:this.drahKeyParam(t,i)},this.drahKey=function(t){null==this.objArray.works||0!=this.object.works?(null!=this.objArray[t]&&(1==this.objArray[t].tipP&&("object"===ne(this.objArray[t].param[t])?this.objArray[t].param[t]=this.object[t]:this.objArray[t].param[t]!=this.object[t]&&(this.objArray[t].param[t]=this.object[t])),2==this.objArray[t].tipP&&this.objArray[t].param(this.object[t])),i.intRend=1):"active"==t&&this.objArray.active.param&&(this.objArray.active.param(this.object.active),i.intRend=1)},this.drahKeyParam=function(t,e){null!=this.objArray[t]&&(1==this.objArray[t].tipP&&("object"===ne(this.objArray[t].param[t])?this.objArray[t].param[t]=e:this.objArray[t].param[t]!=e&&(this.objArray[t].param[t]=e)),2==this.objArray[t].tipP&&this.objArray[t].param(e)),i.intRend=1},this.setBasa=function(t){this.object=t;for(var i=0;i<this.array.length;i++)null==t[this.array[i].object.param]&&(t[this.array[i].object.param]=this.array[i].object.valueStart);this.drahKeys()},this.drahKeys=function(){for(var t=0;t<this.array.length;t++)this.drahKey(this.array[t].object.param)},this.plus({name:"check10",typeParam:"DCheckBox",param:"works",title:"works//false не работает",valueStart:!0})}function he(t,i){this.type="SceneGron";this.object=t,this.param=i,this.tipP=0,null!=i&&("object"===ne(i)&&(this.tipP=1),"function"==typeof i&&(this.tipP=2))}function le(t,i){oe.call(this,t,i),this.type="SceneBox1";this.plus({name:"check",typeParam:"DCheckBox",param:"active",title:"active",valueStart:!1},function(t){i.utility.sunActiv(t)}),this.plus({name:"slider10",typeParam:"DSliderBig",param:"mapSize",title:"mapSize",min:64,max:8192,value:2048,okrug:1,valueStart:i.SHADOW_WH},function(t){t=t||i.SHADOW_WH,i.sunLight.shadow.mapSize.width!=t&&(i.sunLight.shadow.mapSize.width=t,i.sunLight.shadow.mapSize.height=t)}),this.plus({name:"color",typeParam:"DColor",param:"color",title:"color",valueStart:i.LIGHT_COLOR},function(t){var e=t;if("string"==typeof e&&-1!=e.indexOf("x")){var s=e.split("x");e="#"+s[1]}i.sunLight.color=new THREE.Color(e)}),this.plus({name:"slider",typeParam:"DSliderBig",param:"bias",title:"bias",min:-.05,max:.05,value:0,okrug:1e4,valueStart:i.LIGHT_BIAS},i.sunLight.shadow),this.plus({name:"slider1",typeParam:"DSliderBig",param:"intensity",title:"intensity",min:0,max:5,value:1,okrug:100,valueStart:i.SHADOW_INTENSITY},i.sunLight),this.plus({name:"slider2",typeParam:"DSliderBig",param:"radius",title:"radius",min:0,max:50,value:1,valueStart:i.SHADOW_RADIUS},i.sunLight.shadow),this.plus({name:"check2",typeParam:"DCheckBox",param:"bAlphaForCoating",title:"SAMPLE_ALPHA..",value:!0,valueStart:!1},function(t){var e=i.renderer.getContext();t?e.enable(e.SAMPLE_ALPHA_TO_COVERAGE):e.disable(e.SAMPLE_ALPHA_TO_COVERAGE)}),this.plus({name:"check3",typeParam:"DCheckBox",param:"fixation",title:"fixation",value:!1,valueStart:i.utility.FIXATION},i.utility),this.plus({name:"slider4",typeParam:"DSliderBig",param:"rotationX",title:"rotationX",min:-Math.PI,max:Math.PI,okrug:100,value:0,valueStart:i.utility.ROTATION_X},i.utility),this.plus({name:"slider5",typeParam:"DSliderBig",param:"rotationZ",title:"rotationZ",min:-Math.PI,max:Math.PI,okrug:100,value:0,valueStart:i.utility.ROTATION_Z},i.utility),this.plus({name:"slider6",typeParam:"DSliderBig",param:"distance",title:"distance",min:0,max:1e4,value:0,valueStart:i.utility.DISTANCE},i.utility),this.plus({name:"slider7",typeParam:"DSliderBig",param:"cubWidth",title:"cubWidth",min:10,max:1e4,value:0,valueStart:i.utility.CUB_WIDTH},i.utility),this.plus({name:"slider8",typeParam:"DSliderBig",param:"cubHeight",title:"cubHeight",min:10,max:1e4,value:0,valueStart:i.utility.CUB_HEIGHT},i.utility),this.plus({name:"slider9",typeParam:"DSliderBig",param:"distanceUpdateShadow",title:"distUpdateShadow ",min:-1,max:500,value:0,valueStart:i.utility.distanceUpdateShadow},i.utility)}function ue(t,i){oe.call(this,t,i);var e=this;this.type="SceneBox2",this.plus({name:"check",typeParam:"DCheckBox",param:"active",title:"active",valueStart:!0},function(t){i.utility.ambientActiv(t)}),this.plus({name:"color",typeParam:"DColor",param:"color",title:"color",tipParam:2,valueStart:i.AMBIEN_COLOR},function(t){var s=t;if("string"==typeof s&&-1!=s.indexOf("x")){var r=s.split("x");s="#"+r[1]}e.setValue(this.object.param,s),i.ambientLight.color=new THREE.Color(s)}),this.plus({name:"slider",typeParam:"DSliderBig",param:"intensity",title:"intensity",min:0,max:5,okrug:100,valueStart:i.AMBIEN_INTENSITY},i.ambientLight)}function ce(t,i){oe.call(this,t,i),this.type="SceneBox3";this.plus({name:"check",typeParam:"DCheckBox",param:"active",title:"active",valueStart:!1},function(t){i.utility.sky.active=t}),this.plus({name:"color",typeParam:"DColor",param:"color",title:"color",valueStart:i.utility.sky.COLOR},i.utility.sky),this.plus({name:"contLoader",typeParam:"DVisualLoader",param:"link",title:"LoadPic",valueStart:i.utility.sky.LINK},i.utility.sky),this.plus({name:"slider",typeParam:"DSliderBig",param:"radius",title:"radius",min:10,max:15e3,okrug:1,valueStart:i.utility.sky.RADIUS},i.utility.sky)}function pe(t,i){oe.call(this,t,i),this.type="SceneBox5";this.plus({name:"text1",typeParam:"DLabel",param:"xz",title:"Load",valueStart:"reflect"}),this.plus({name:"contLoader",typeParam:"DVisualLoader",param:"link",title:"Load",valueStart:"null"},function(t){i.cubeMap.link=t}),this.plus({name:"sliderExp",typeParam:"DSliderBig",param:"exposure",title:"exposure",min:-10,max:10,okrug:100,valueStart:-1},function(t){i.cubeMap.exposure=t}),this.plus({name:"slider1",typeParam:"DSliderBig",param:"gamma",title:"gamma//в хдр",min:-10,max:10,okrug:100,valueStart:-1},function(t){i.cubeMap.gamma=t}),this.plus({name:"text1",typeParam:"DLabel",param:"xz",title:"Load",valueStart:"refract"}),this.plus({name:"contLoader1",typeParam:"DVisualLoader",param:"link1",title:"Load",valueStart:"null"},function(t){i.cubeMap1.link=t}),this.plus({name:"sliderExp1",typeParam:"DSliderBig",param:"exposure1",title:"exposure",min:-10,max:10,okrug:100,valueStart:-1},function(t){i.cubeMap1.exposure=t}),this.plus({name:"slider2",typeParam:"DSliderBig",param:"gamma1",title:"gamma//в хдр",min:-10,max:10,okrug:100,valueStart:-1},function(t){i.cubeMap1.gamma=t})}function de(t,i){oe.call(this,t,i),this.type="SceneBox6";var e=this;this.plus({name:"check0",typeParam:"DCheckBox",param:"alwaysRender",title:"autoRender",valueStart:!1},function(t){i.alwaysRender!==t&&(i.alwaysRender=t)}),this.plus({name:"slider",typeParam:"DSliderBig",param:"fov",title:"fov",min:0,max:90,okrug:1,valueStart:i.FOV}),this.plus({name:"slider1",typeParam:"DSliderBig",param:"far",title:"far",min:100,max:5e4,okrug:1,valueStart:i.FAR},function(t){i.camera.far!=t&&(i.camera.far=t,i.camera.updateProjectionMatrix())}),this.plus({name:"slider2",typeParam:"DSliderBig",param:"minZum",title:"minZum",min:0,max:2e4,okrug:1,valueStart:0},function(t){i.minZum=t,i.minZum>i.maxZum&&(i.maxZum=i.minZum,e.setValue("maxZum",t))}),this.plus({name:"slider3",typeParam:"DSliderBig",param:"maxZum",title:"maxZum",min:0,max:2e4,okrug:1,valueStart:2e4},function(t){i.maxZum=t,i.maxZum<i.minZum&&(i.minZum=i.maxZum,e.setValue("minZum",t))}),this.plus({name:"slider4",typeParam:"DSliderBig",param:"zume",title:"powerZum",min:1,max:2e4,okrug:1,valueStart:250}),this.plus({name:"slider11",typeParam:"DSliderBig",param:"powerZum",title:"zoom",min:1,max:100,okrug:1,valueStart:50},function(t){i.position3d.powerZum!==t&&(i.position3d.powerZum=t)}),this.plus({name:"slider5",typeParam:"DSliderBig",param:"minRotationX",title:"minAngel",min:0,max:3,okrug:100,valueStart:2.5},function(t){i.minRotationX!==t&&(i.minRotationX=t)}),this.plus({name:"slider6",typeParam:"DSliderBig",param:"maxRotationX",title:"maxAngel",min:0,max:3,okrug:100,valueStart:0},function(t){i.maxRotationX!==t&&(i.maxRotationX=t)}),this.plus({name:"check1",typeParam:"DCheckBox",param:"debug",title:"debug",valueStart:!0},function(t){i.utility.debug!==t&&(i.utility.debug=t)}),this.plus({name:"check2",typeParam:"DCheckBox",param:"isDragPan",title:"isDragPan",valueStart:!0},function(t){i.position3d.isDragPan!==t&&(i.position3d.isDragPan=t)}),this.plus({name:"check3",typeParam:"DCheckBox",param:"alphaAd",title:"alpha Админ для фотки",valueStart:!1}),this.plus({name:"slider7",typeParam:"DSliderBig",param:"zume",title:"zoom",min:5,max:2e3,okrug:1,valueStart:250},function(t){i.zume=t}),this.plus({name:"slider8",typeParam:"DSliderBig",param:"rotationX",title:"rotationX",min:-Math.PI,max:Math.PI,okrug:100,valueStart:0},function(t){i.rotationX=t}),this.plus({name:"slider9",typeParam:"DSliderBig",param:"rotationZ",title:"rotationZ",min:-Math.PI,max:Math.PI,okrug:100,valueStart:0},function(t){i.rotationZ=t}),this.plus({name:"slider10",typeParam:"DSliderBig",param:"globZ",title:"globZ",min:-1e3,max:1e3,okrug:1,valueStart:0},function(t){i.yVerh=t})}function fe(t,i){oe.call(this,t,i),this.type="SceneBox7";this.plus({name:"check",typeParam:"DCheckBox",param:"active",title:"active",valueStart:!1},i.efect),this.plus({name:"slider",typeParam:"DSliderBig",param:"edgeStrength",title:"edgeStrength",min:0,max:10,okrug:100,valueStart:i.efect.edgeStrength},i.efect),this.plus({name:"slider1",typeParam:"DSliderBig",param:"edgeGlow",title:"edgeGlow",min:0,max:1,okrug:100,valueStart:i.efect.edgeGlow},i.efect),this.plus({name:"slider2",typeParam:"DSliderBig",param:"edgeThickness",title:"edgeThickness",min:0,max:5,okrug:100,valueStart:i.efect.edgeThickness},i.efect),this.plus({name:"slider3",typeParam:"DSliderBig",param:"pulsePeriod",title:"pulsePeriod",min:0,max:5,okrug:100,valueStart:i.efect.pulsePeriod},i.efect),this.plus({name:"contLoader",typeParam:"DVisualLoader",param:"linkTextur",title:"linkTextur",valueStart:i.efect.linkTextur},i.efect),this.plus({name:"color",typeParam:"DColor",param:"visibleEdgeColor",title:"vEdgeColor",valueStart:i.efect.visibleEdgeColor},i.efect),this.plus({name:"color1",typeParam:"DColor",param:"hiddenEdgeColor",title:"hEdgeColor",valueStart:i.efect.hiddenEdgeColor},i.efect)}function ge(t,i){oe.call(this,t,i),this.type="SceneBox9";i.sbfog=new Ae(i),this.plus({name:"check",typeParam:"DCheckBox",param:"active",title:"active",valueStart:!1},function(t){i.sbfog.active=t}),this.plus({name:"color1",typeParam:"DColor",param:"color",title:"outlineColor1",valueStart:i.sbfog._color},function(t){var e=t;i.sbfog.color=e}),this.plus({name:"slider1",typeParam:"DSliderBig",param:"near",title:"near",min:0,max:1e4,okrug:1,valueStart:50},i.sbfog),this.plus({name:"slider2",typeParam:"DSliderBig",param:"far",title:"far",min:0,max:2e4,okrug:1,valueStart:100},i.sbfog)}function Ae(t){this._active=!1,this._color="#ffffff",this._near=50,this._far=1e3,this.visi=t,this.fog=new THREE.Fog(this._color,this._near,this._far)}function ye(t,i){for(var e=0;e<i.length;e++){var s=i[e];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}Ae.prototype={set active(t){this._active!=t&&(this._active=t,1==this._active?this.visi.scene.fog=this.fog:this.visi.scene.fog=null)},get active(){return this._active},set color(t){this._color!=t&&(this._color=t,this.fog.color=new THREE.Color(t))},get color(){return this._color},set near(t){this._near!=t&&(this._near=t,this.fog.near=t)},get near(){return this._near},set far(t){this._far!=t&&(this._far=t,this.fog.far=t)},get far(){return this._far}};var xe=function(){function t(i){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,t),this.type="Glaf";var e=this;this.par=i,this.sizeMax=1e4,this.dCont=new DCont(document.body),this.visiPixi=new ee,this.cont2d=new PIXI.Container,this.content2d=new PIXI.Container,this.visiPixi.content2d.addChild(this.cont2d),this.cont2d.addChild(this.content2d),this.c2dSloi=new PIXI.Container,this.c2dSloi1=new PIXI.Container,this.c2dSloi2=new PIXI.Container,this.c2dSloi3=new PIXI.Container,this.content2d.addChild(this.c2dSloi),this.content2d.addChild(this.c2dSloi1),this.content2d.addChild(this.c2dSloi2),this.content2d.addChild(this.c2dSloi3),this._intRend=-60,this.render=function(){this.intRend=1},this.div=document.createElement("div"),this.div.style.position="fixed",this.div.style.top="0px",this.div.style.left="0px",this.visi3D=new re.a(this.div,null,!1,!0,!1,!0,!1);var s=this.par.objectBase.scene;this.sceneSB=new ae(this.visi3D);for(var r=0;r<this.sceneSB.array.length;r++)void 0===s[this.sceneSB.array[r].name]&&(s[this.sceneSB.array[r].name]={}),this.sceneSB.array[r].setBasa(s[this.sceneSB.array[r].name]);this.visi3D.isDragPan=!0,this.viewServer=new se(function(t,i,s,r){return"setObj"==t?(null==i?e.menu.setMessage("message","ErrorПроект id ="+e.viewServer.id+" не создан. json еще не сохранен и нечего открывать"):e.p20.setObjOpen(i),void e.menu.mStart.visiId(e.viewServer.id)):"message"==t?(console.warn(i,s),e.menu.setMessage(i,s),void(null!=r&&setTimeout(function(){e.menu.setMessage("messageClose",500)},r))):void("openStart"!=t||(e.p20.index=1))}),this.p20=new $i(this,function(t,i,s){if("getInfo"==t)return e.render(),void e.menu.setInfoArr(i);"render"!=t?"complit"!=t&&("indexSP"==t&&e.menu.setSP(i),"message"!=t?("rectSP"==t&&e.menu.setSop(t,i,s),e.render()):e.menu.setMessage(i,s)):e.intRend=i||1}),this.menu=new ie.a(this,function(t,i,s){if("mashtab"==t&&(e.p20.mashtab=i,e.menu.mashtab=i),"setObjSP"==t&&e.p20.setObj(i),"dragStyleObj"==t&&e.p20.dragStyleObj(i),"openId"==t&&e.viewServer.openId(i),"message"!=t)return"saveGetObjId"==t?(console.warn("saveGetObjId@@@@"),void e.viewServer.saveGetObjId(e.p20.getObj())):void e.render();e.menu.setMessage(i,s)}),this.menu.setP20(this.p20),this.content2d.addChild(this.p20.content2d),this.menu.menuV3D.setVisi3D(this.visi3D),this.visi3D.groupObject.add(this.p20.content3d),this.update=function(){1==this.p20.upDate()&&(this.intRend=1),(this._intRend<=1||100==this._intRend)&&(this.visiPixi.render(),this.visi3D.intRend=1),this.visi3D.upDate(),this._intRend++,this._intRend>=100&&(this._intRend=1)},this.sizeWindow=function(t,i,e){this.scale=e,this.dCont.scale=e,this.menu.sizeWindow(t,i,e)},this.keydown=function(t){this.menu.keydown(t)},this.keyup=function(t){this.menu.keyup(t)},this.p20.index=1,this.viewServer.openURL()}var i,e,s;return i=t,(e=[{key:"intRend",set:function(t){this._intRend!=t&&this._intRend>t&&(this._intRend=t)},get:function(){return this._intRend}}])&&ye(i.prototype,e),s&&ye(i,s),t}();function me(t,i){this.fun=t;var e,s=this;this.object,this.key=i||"shirt",this.object,this.initLoad=function(){e=!0,this.object=window.localStorage[this.key],"undefined"==this.object&&(e=!1),null==this.object&&(e=!1),this.object=0==e?this.getStartObj():jQuery.parseJSON(this.object),this.fun&&s.fun()},this.getStartObj=function(){return{activ:!1,dubag:!1,menu:{},xz:{}}},this.save=function(){window.localStorage[this.key]=JSON.stringify(s.object)},this.clear=function(){window.localStorage[this.key]=void 0},s.initLoad()}e.d(i,"a",function(){return ve});var ve=function t(i){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,t),this.type="LMain",this.fun=i;var e=this;this.glaf=null,this._width=100,this._height=100,e.resolution=1,e.objectBase=null,e.confText=null,this.localStorage=void 0,this.debug=!1,this.contentHTML=document.createElement("div"),this.contentHTML.style.position="fixed",this.contentHTML.style.top="0px",this.contentHTML.style.left="0px",document.body.appendChild(this.contentHTML),this.start=function(){this.tick(),this.localStorage=new me(null,"localStorage"),null==e.localStorage.object.debug&&(e.localStorage.object.debug=!1),this.debug=e.localStorage.object.debug,this.fina()},this.fina=function(){e.localStorage.object.debug=!0,e.glaf=new xe(e),sizeWindow(),i("init")};var s,r=!0;this.tick=function(){1==(r=!r)&&(TWEEN.update(),e.glaf&&e.glaf.update()),requestAnimationFrame(e.tick)},this.boolCTRL=!1,this.keydown=function(t){17==event.keyCode&&(e.boolCTRL=!0),81==event.keyCode&&e.boolCTRL&&(e.localStorage.object.debug=!e.localStorage.object.debug,e.localStorage.save()),e.glaf.keydown(t)},this.keyup=function(t){17==event.keyCode&&(e.boolCTRL=!1),e.glaf.keyup(t)},window.addEventListener("keydown",this.keydown),window.addEventListener("keyup",this.keyup),this.scale=1,this.sizeWindow=function(t,i){e._width=t,e._height=i,e._width<800&&(e._width=800),e._height<600&&(e._height=600),(s=t/e._width)>i/e._height&&(s=i/e._height),this.scale=s,1==dcmParam.isIE&&(this.scale=1),e.glaf&&e.glaf.sizeWindow(t,i,this.scale)},$.ajax({url:"resources/config.json",success:function(t){if("string"==typeof t){var i=JSON.parse(t);e.objectBase=i}else e.objectBase=t;trace("$$$$$$",e.objectBase),e.start()},error:function(t){console.log("Что то случилось с конфигом")}})}},function(t,i,e){"use strict";e.d(i,"a",function(){return r});var s=e(7);function r(){var t,i=this;this.type="CubeMap",this.LINK="null",this.EXPOSURE=-1,this.GAMMA=-1,this._link="nullXZ",this._exposure=this.EXPOSURE,this._gamma=this.GAMMA,this.exposureStart=-1,this.gammaStart=-1,this._activDiz=!1,this._layer=1,this.otherLayer=31,this.renderer=void 0,this.scene=void 0,this.cubeCamera=new THREE.CubeCamera(1,1e4,512),this.geometry=new THREE.SphereBufferGeometry(1500,32,32),this.mesh=new THREE.Mesh(this.geometry),this.loader=void 0,this.loader=new s.a,this.init=function(t,i){void 0!==t&&void 0!==i&&(this.renderer=t,this.scene=i,this.scene.add(this.cubeCamera),this.scene.add(this.mesh),this.link="null")},this.setLayers=function(t){i.mesh.layers.set(t),i.cubeCamera.layers.set(t),i.cubeCamera.traverse(function(i){i.layers.set(t)})},this.upDate=function(t){this.setLayers(this.otherLayer),this.cubeCamera.update(t||this.renderer,this.scene),this.setLayers(this._layer)},this.material=void 0,this.dragMaterial=function(t){this.material=t,e==t.sahMin&&(this.mesh.material=t,this.upDate())},this.arrMat=[],this.testBD=function(t){for(var i=0;i<this.arrMat.length;i++)if(this.arrMat[i].linkMy==t)return this.arrMat[i];return null};var e=0;this.loadFun=function(){var s=++e,n=this._link+"";if(null!=(t=this.testBD(this._link))&&(t.sahMin=e,this.dragMaterial(t)),"null"!=this._link&&null!=this._link)-1==this._link.indexOf(".png")&&-1==this._link.indexOf(".jpg")&&-1==this._link.indexOf(".jpeg")?null!=this.loader?this.loader.load(this._link,function(t,e){var a=new THREE.ShaderMaterial({uniforms:{tDiffuse:{type:"t",value:t},exposure:{type:"f",value:e.exposure},gamma:{type:"f",value:e.gamma},offsetRepeat:{type:"v4",value:new THREE.Vector4(0,0,1,1)}},vertexShader:r.vertex,fragmentShader:r.fragment});t.minFilter=THREE.LinearFilter,t.magFilter=THREE.NearestFilter,t.flipY=!0,t.wrapS=t.wrapT=THREE.RepeatWrapping,t.anisotropy=i.renderer.capabilities.getMaxAnisotropy(),a.side=THREE.BackSide,a.linkMy=n,a.sahMin=s,i.arrMat.push(a),i.dragMaterial(a),i.exposureStart=e.exposure,i.gammaStart=e.gamma,1==i._activDiz&&(i._exposure=e.exposure,i._gamma=e.gamma)}):console.log("Подключи в загрущик RGBELoader токо если надо hdr загрузить!!!"):(new THREE.TextureLoader).load(this._link,a);else{(new THREE.TextureLoader).load("data:image/jpeg;base64,/9j/4RAiRXhpZgAATU0AKgAAAAgABwESAAMAAAABAAEAAAEaAAUAAAABAAAAYgEbAAUAAAABAAAAagEoAAMAAAABAAIAAAExAAIAAAAeAAAAcgEyAAIAAAAUAAAAkIdpAAQAAAABAAAApAAAANAACvyAAAAnEAAK/IAAACcQQWRvYmUgUGhvdG9zaG9wIENTNiAoV2luZG93cykAMjAxODoxMDowNSAxNjozMzo0MAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAQKADAAQAAAABAAAAQAAAAAAAAAAGAQMAAwAAAAEABgAAARoABQAAAAEAAAEeARsABQAAAAEAAAEmASgAAwAAAAEAAgAAAgEABAAAAAEAAAEuAgIABAAAAAEAAA7sAAAAAAAAAEgAAAABAAAASAAAAAH/2P/iDFhJQ0NfUFJPRklMRQABAQAADEhMaW5vAhAAAG1udHJSR0IgWFlaIAfOAAIACQAGADEAAGFjc3BNU0ZUAAAAAElFQyBzUkdCAAAAAAAAAAAAAAAAAAD21gABAAAAANMtSFAgIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEWNwcnQAAAFQAAAAM2Rlc2MAAAGEAAAAbHd0cHQAAAHwAAAAFGJrcHQAAAIEAAAAFHJYWVoAAAIYAAAAFGdYWVoAAAIsAAAAFGJYWVoAAAJAAAAAFGRtbmQAAAJUAAAAcGRtZGQAAALEAAAAiHZ1ZWQAAANMAAAAhnZpZXcAAAPUAAAAJGx1bWkAAAP4AAAAFG1lYXMAAAQMAAAAJHRlY2gAAAQwAAAADHJUUkMAAAQ8AAAIDGdUUkMAAAQ8AAAIDGJUUkMAAAQ8AAAIDHRleHQAAAAAQ29weXJpZ2h0IChjKSAxOTk4IEhld2xldHQtUGFja2FyZCBDb21wYW55AABkZXNjAAAAAAAAABJzUkdCIElFQzYxOTY2LTIuMQAAAAAAAAAAAAAAEnNSR0IgSUVDNjE5NjYtMi4xAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABYWVogAAAAAAAA81EAAQAAAAEWzFhZWiAAAAAAAAAAAAAAAAAAAAAAWFlaIAAAAAAAAG+iAAA49QAAA5BYWVogAAAAAAAAYpkAALeFAAAY2lhZWiAAAAAAAAAkoAAAD4QAALbPZGVzYwAAAAAAAAAWSUVDIGh0dHA6Ly93d3cuaWVjLmNoAAAAAAAAAAAAAAAWSUVDIGh0dHA6Ly93d3cuaWVjLmNoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGRlc2MAAAAAAAAALklFQyA2MTk2Ni0yLjEgRGVmYXVsdCBSR0IgY29sb3VyIHNwYWNlIC0gc1JHQgAAAAAAAAAAAAAALklFQyA2MTk2Ni0yLjEgRGVmYXVsdCBSR0IgY29sb3VyIHNwYWNlIC0gc1JHQgAAAAAAAAAAAAAAAAAAAAAAAAAAAABkZXNjAAAAAAAAACxSZWZlcmVuY2UgVmlld2luZyBDb25kaXRpb24gaW4gSUVDNjE5NjYtMi4xAAAAAAAAAAAAAAAsUmVmZXJlbmNlIFZpZXdpbmcgQ29uZGl0aW9uIGluIElFQzYxOTY2LTIuMQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAdmlldwAAAAAAE6T+ABRfLgAQzxQAA+3MAAQTCwADXJ4AAAABWFlaIAAAAAAATAlWAFAAAABXH+dtZWFzAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAACjwAAAAJzaWcgAAAAAENSVCBjdXJ2AAAAAAAABAAAAAAFAAoADwAUABkAHgAjACgALQAyADcAOwBAAEUASgBPAFQAWQBeAGMAaABtAHIAdwB8AIEAhgCLAJAAlQCaAJ8ApACpAK4AsgC3ALwAwQDGAMsA0ADVANsA4ADlAOsA8AD2APsBAQEHAQ0BEwEZAR8BJQErATIBOAE+AUUBTAFSAVkBYAFnAW4BdQF8AYMBiwGSAZoBoQGpAbEBuQHBAckB0QHZAeEB6QHyAfoCAwIMAhQCHQImAi8COAJBAksCVAJdAmcCcQJ6AoQCjgKYAqICrAK2AsECywLVAuAC6wL1AwADCwMWAyEDLQM4A0MDTwNaA2YDcgN+A4oDlgOiA64DugPHA9MD4APsA/kEBgQTBCAELQQ7BEgEVQRjBHEEfgSMBJoEqAS2BMQE0wThBPAE/gUNBRwFKwU6BUkFWAVnBXcFhgWWBaYFtQXFBdUF5QX2BgYGFgYnBjcGSAZZBmoGewaMBp0GrwbABtEG4wb1BwcHGQcrBz0HTwdhB3QHhgeZB6wHvwfSB+UH+AgLCB8IMghGCFoIbgiCCJYIqgi+CNII5wj7CRAJJQk6CU8JZAl5CY8JpAm6Cc8J5Qn7ChEKJwo9ClQKagqBCpgKrgrFCtwK8wsLCyILOQtRC2kLgAuYC7ALyAvhC/kMEgwqDEMMXAx1DI4MpwzADNkM8w0NDSYNQA1aDXQNjg2pDcMN3g34DhMOLg5JDmQOfw6bDrYO0g7uDwkPJQ9BD14Peg+WD7MPzw/sEAkQJhBDEGEQfhCbELkQ1xD1ERMRMRFPEW0RjBGqEckR6BIHEiYSRRJkEoQSoxLDEuMTAxMjE0MTYxODE6QTxRPlFAYUJxRJFGoUixStFM4U8BUSFTQVVhV4FZsVvRXgFgMWJhZJFmwWjxayFtYW+hcdF0EXZReJF64X0hf3GBsYQBhlGIoYrxjVGPoZIBlFGWsZkRm3Gd0aBBoqGlEadxqeGsUa7BsUGzsbYxuKG7Ib2hwCHCocUhx7HKMczBz1HR4dRx1wHZkdwx3sHhYeQB5qHpQevh7pHxMfPh9pH5Qfvx/qIBUgQSBsIJggxCDwIRwhSCF1IaEhziH7IiciVSKCIq8i3SMKIzgjZiOUI8Ij8CQfJE0kfCSrJNolCSU4JWgllyXHJfcmJyZXJocmtyboJxgnSSd6J6sn3CgNKD8ocSiiKNQpBik4KWspnSnQKgIqNSpoKpsqzysCKzYraSudK9EsBSw5LG4soizXLQwtQS12Last4S4WLkwugi63Lu4vJC9aL5Evxy/+MDUwbDCkMNsxEjFKMYIxujHyMioyYzKbMtQzDTNGM38zuDPxNCs0ZTSeNNg1EzVNNYc1wjX9Njc2cjauNuk3JDdgN5w31zgUOFA4jDjIOQU5Qjl/Obw5+To2OnQ6sjrvOy07azuqO+g8JzxlPKQ84z0iPWE9oT3gPiA+YD6gPuA/IT9hP6I/4kAjQGRApkDnQSlBakGsQe5CMEJyQrVC90M6Q31DwEQDREdEikTORRJFVUWaRd5GIkZnRqtG8Ec1R3tHwEgFSEtIkUjXSR1JY0mpSfBKN0p9SsRLDEtTS5pL4kwqTHJMuk0CTUpNk03cTiVObk63TwBPSU+TT91QJ1BxULtRBlFQUZtR5lIxUnxSx1MTU19TqlP2VEJUj1TbVShVdVXCVg9WXFapVvdXRFeSV+BYL1h9WMtZGllpWbhaB1pWWqZa9VtFW5Vb5Vw1XIZc1l0nXXhdyV4aXmxevV8PX2Ffs2AFYFdgqmD8YU9homH1YklinGLwY0Njl2PrZEBklGTpZT1lkmXnZj1mkmboZz1nk2fpaD9olmjsaUNpmmnxakhqn2r3a09rp2v/bFdsr20IbWBtuW4SbmtuxG8eb3hv0XArcIZw4HE6cZVx8HJLcqZzAXNdc7h0FHRwdMx1KHWFdeF2Pnabdvh3VnezeBF4bnjMeSp5iXnnekZ6pXsEe2N7wnwhfIF84X1BfaF+AX5ifsJ/I3+Ef+WAR4CogQqBa4HNgjCCkoL0g1eDuoQdhICE44VHhauGDoZyhteHO4efiASIaYjOiTOJmYn+imSKyoswi5aL/IxjjMqNMY2Yjf+OZo7OjzaPnpAGkG6Q1pE/kaiSEZJ6kuOTTZO2lCCUipT0lV+VyZY0lp+XCpd1l+CYTJi4mSSZkJn8mmia1ZtCm6+cHJyJnPedZJ3SnkCerp8dn4uf+qBpoNihR6G2oiailqMGo3aj5qRWpMelOKWpphqmi6b9p26n4KhSqMSpN6mpqhyqj6sCq3Wr6axcrNCtRK24ri2uoa8Wr4uwALB1sOqxYLHWskuywrM4s660JbSctRO1irYBtnm28Ldot+C4WbjRuUq5wro7urW7LrunvCG8m70VvY++Cr6Evv+/er/1wHDA7MFnwePCX8Lbw1jD1MRRxM7FS8XIxkbGw8dBx7/IPci8yTrJuco4yrfLNsu2zDXMtc01zbXONs62zzfPuNA50LrRPNG+0j/SwdNE08bUSdTL1U7V0dZV1tjXXNfg2GTY6Nls2fHadtr724DcBdyK3RDdlt4c3qLfKd+v4DbgveFE4cziU+Lb42Pj6+Rz5PzlhOYN5pbnH+ep6DLovOlG6dDqW+rl63Dr++yG7RHtnO4o7rTvQO/M8Fjw5fFy8f/yjPMZ86f0NPTC9VD13vZt9vv3ivgZ+Kj5OPnH+lf65/t3/Af8mP0p/br+S/7c/23////tAAxBZG9iZV9DTQAB/+4ADkFkb2JlAGSAAAAAAf/bAIQADAgICAkIDAkJDBELCgsRFQ8MDA8VGBMTFRMTGBEMDAwMDAwRDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAENCwsNDg0QDg4QFA4ODhQUDg4ODhQRDAwMDAwREQwMDAwMDBEMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwM/8AAEQgAQABAAwEiAAIRAQMRAf/dAAQABP/EAT8AAAEFAQEBAQEBAAAAAAAAAAMAAQIEBQYHCAkKCwEAAQUBAQEBAQEAAAAAAAAAAQACAwQFBgcICQoLEAABBAEDAgQCBQcGCAUDDDMBAAIRAwQhEjEFQVFhEyJxgTIGFJGhsUIjJBVSwWIzNHKC0UMHJZJT8OHxY3M1FqKygyZEk1RkRcKjdDYX0lXiZfKzhMPTdePzRieUpIW0lcTU5PSltcXV5fVWZnaGlqa2xtbm9jdHV2d3h5ent8fX5/cRAAICAQIEBAMEBQYHBwYFNQEAAhEDITESBEFRYXEiEwUygZEUobFCI8FS0fAzJGLhcoKSQ1MVY3M08SUGFqKygwcmNcLSRJNUoxdkRVU2dGXi8rOEw9N14/NGlKSFtJXE1OT0pbXF1eX1VmZ2hpamtsbW5vYnN0dXZ3eHl6e3x//aAAwDAQACEQMRAD8A88X0wkvmdJSl9MJL5nSUpfTCS+Z0lKX0wkvmdJT/AP/Q88X0wkvmdJSl9MJL5nSUpfTCS+Z0lKX0wkvmdJT/AP/R88X0wkvmdJSl9MJL5nSUpfTCS+Z0lKX0wkvmdJT/AP/S88X0wkvmdJSl9MJL5nSUpfTCS+Z0lKX0wkvmdJT/AP/Z/+0ZIlBob3Rvc2hvcCAzLjAAOEJJTQQlAAAAAAAQAAAAAAAAAAAAAAAAAAAAADhCSU0EOgAAAAAA5QAAABAAAAABAAAAAAALcHJpbnRPdXRwdXQAAAAFAAAAAFBzdFNib29sAQAAAABJbnRlZW51bQAAAABJbnRlAAAAAENscm0AAAAPcHJpbnRTaXh0ZWVuQml0Ym9vbAAAAAALcHJpbnRlck5hbWVURVhUAAAAAQAAAAAAD3ByaW50UHJvb2ZTZXR1cE9iamMAAAAMAFAAcgBvAG8AZgAgAFMAZQB0AHUAcAAAAAAACnByb29mU2V0dXAAAAABAAAAAEJsdG5lbnVtAAAADGJ1aWx0aW5Qcm9vZgAAAAlwcm9vZkNNWUsAOEJJTQQ7AAAAAAItAAAAEAAAAAEAAAAAABJwcmludE91dHB1dE9wdGlvbnMAAAAXAAAAAENwdG5ib29sAAAAAABDbGJyYm9vbAAAAAAAUmdzTWJvb2wAAAAAAENybkNib29sAAAAAABDbnRDYm9vbAAAAAAATGJsc2Jvb2wAAAAAAE5ndHZib29sAAAAAABFbWxEYm9vbAAAAAAASW50cmJvb2wAAAAAAEJja2dPYmpjAAAAAQAAAAAAAFJHQkMAAAADAAAAAFJkICBkb3ViQG/gAAAAAAAAAAAAR3JuIGRvdWJAb+AAAAAAAAAAAABCbCAgZG91YkBv4AAAAAAAAAAAAEJyZFRVbnRGI1JsdAAAAAAAAAAAAAAAAEJsZCBVbnRGI1JsdAAAAAAAAAAAAAAAAFJzbHRVbnRGI1B4bEBSAAAAAAAAAAAACnZlY3RvckRhdGFib29sAQAAAABQZ1BzZW51bQAAAABQZ1BzAAAAAFBnUEMAAAAATGVmdFVudEYjUmx0AAAAAAAAAAAAAAAAVG9wIFVudEYjUmx0AAAAAAAAAAAAAAAAU2NsIFVudEYjUHJjQFkAAAAAAAAAAAAQY3JvcFdoZW5QcmludGluZ2Jvb2wAAAAADmNyb3BSZWN0Qm90dG9tbG9uZwAAAAAAAAAMY3JvcFJlY3RMZWZ0bG9uZwAAAAAAAAANY3JvcFJlY3RSaWdodGxvbmcAAAAAAAAAC2Nyb3BSZWN0VG9wbG9uZwAAAAAAOEJJTQPtAAAAAAAQAEgAAAABAAIASAAAAAEAAjhCSU0EJgAAAAAADgAAAAAAAAAAAAA/gAAAOEJJTQQNAAAAAAAEAAAAeDhCSU0EGQAAAAAABAAAAB44QklNA/MAAAAAAAkAAAAAAAAAAAEAOEJJTScQAAAAAAAKAAEAAAAAAAAAAjhCSU0D9QAAAAAASAAvZmYAAQBsZmYABgAAAAAAAQAvZmYAAQChmZoABgAAAAAAAQAyAAAAAQBaAAAABgAAAAAAAQA1AAAAAQAtAAAABgAAAAAAAThCSU0D+AAAAAAAcAAA/////////////////////////////wPoAAAAAP////////////////////////////8D6AAAAAD/////////////////////////////A+gAAAAA/////////////////////////////wPoAAA4QklNBAAAAAAAAAIAQzhCSU0EAgAAAAAAiAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4QklNBDAAAAAAAEQBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAThCSU0ELQAAAAAARgARAAABTwAAAVAAAAFRAAABUgAAAVMAAAFUAAABVQAAAVYAAAFXAAABWAAAAVkAAAFaAAABWwAAAVwAAAFdAAABXgAAAV84QklNBAgAAAAAABAAAAABAAACQAAAAkAAAAAAOEJJTQQeAAAAAAAEAAAAADhCSU0EGgAAAAADSQAAAAYAAAAAAAAAAAAAAEAAAABAAAAACgBVAG4AdABpAHQAbABlAGQALQAxAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABAAAAABAAAAAAAAbnVsbAAAAAIAAAAGYm91bmRzT2JqYwAAAAEAAAAAAABSY3QxAAAABAAAAABUb3AgbG9uZwAAAAAAAAAATGVmdGxvbmcAAAAAAAAAAEJ0b21sb25nAAAAQAAAAABSZ2h0bG9uZwAAAEAAAAAGc2xpY2VzVmxMcwAAAAFPYmpjAAAAAQAAAAAABXNsaWNlAAAAEgAAAAdzbGljZUlEbG9uZwAAAAAAAAAHZ3JvdXBJRGxvbmcAAAAAAAAABm9yaWdpbmVudW0AAAAMRVNsaWNlT3JpZ2luAAAADWF1dG9HZW5lcmF0ZWQAAAAAVHlwZWVudW0AAAAKRVNsaWNlVHlwZQAAAABJbWcgAAAABmJvdW5kc09iamMAAAABAAAAAAAAUmN0MQAAAAQAAAAAVG9wIGxvbmcAAAAAAAAAAExlZnRsb25nAAAAAAAAAABCdG9tbG9uZwAAAEAAAAAAUmdodGxvbmcAAABAAAAAA3VybFRFWFQAAAABAAAAAAAAbnVsbFRFWFQAAAABAAAAAAAATXNnZVRFWFQAAAABAAAAAAAGYWx0VGFnVEVYVAAAAAEAAAAAAA5jZWxsVGV4dElzSFRNTGJvb2wBAAAACGNlbGxUZXh0VEVYVAAAAAEAAAAAAAlob3J6QWxpZ25lbnVtAAAAD0VTbGljZUhvcnpBbGlnbgAAAAdkZWZhdWx0AAAACXZlcnRBbGlnbmVudW0AAAAPRVNsaWNlVmVydEFsaWduAAAAB2RlZmF1bHQAAAALYmdDb2xvclR5cGVlbnVtAAAAEUVTbGljZUJHQ29sb3JUeXBlAAAAAE5vbmUAAAAJdG9wT3V0c2V0bG9uZwAAAAAAAAAKbGVmdE91dHNldGxvbmcAAAAAAAAADGJvdHRvbU91dHNldGxvbmcAAAAAAAAAC3JpZ2h0T3V0c2V0bG9uZwAAAAAAOEJJTQQoAAAAAAAMAAAAAj/wAAAAAAAAOEJJTQQUAAAAAAAEAAABXzhCSU0EDAAAAAAPCAAAAAEAAABAAAAAQAAAAMAAADAAAAAO7AAYAAH/2P/iDFhJQ0NfUFJPRklMRQABAQAADEhMaW5vAhAAAG1udHJSR0IgWFlaIAfOAAIACQAGADEAAGFjc3BNU0ZUAAAAAElFQyBzUkdCAAAAAAAAAAAAAAAAAAD21gABAAAAANMtSFAgIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEWNwcnQAAAFQAAAAM2Rlc2MAAAGEAAAAbHd0cHQAAAHwAAAAFGJrcHQAAAIEAAAAFHJYWVoAAAIYAAAAFGdYWVoAAAIsAAAAFGJYWVoAAAJAAAAAFGRtbmQAAAJUAAAAcGRtZGQAAALEAAAAiHZ1ZWQAAANMAAAAhnZpZXcAAAPUAAAAJGx1bWkAAAP4AAAAFG1lYXMAAAQMAAAAJHRlY2gAAAQwAAAADHJUUkMAAAQ8AAAIDGdUUkMAAAQ8AAAIDGJUUkMAAAQ8AAAIDHRleHQAAAAAQ29weXJpZ2h0IChjKSAxOTk4IEhld2xldHQtUGFja2FyZCBDb21wYW55AABkZXNjAAAAAAAAABJzUkdCIElFQzYxOTY2LTIuMQAAAAAAAAAAAAAAEnNSR0IgSUVDNjE5NjYtMi4xAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABYWVogAAAAAAAA81EAAQAAAAEWzFhZWiAAAAAAAAAAAAAAAAAAAAAAWFlaIAAAAAAAAG+iAAA49QAAA5BYWVogAAAAAAAAYpkAALeFAAAY2lhZWiAAAAAAAAAkoAAAD4QAALbPZGVzYwAAAAAAAAAWSUVDIGh0dHA6Ly93d3cuaWVjLmNoAAAAAAAAAAAAAAAWSUVDIGh0dHA6Ly93d3cuaWVjLmNoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGRlc2MAAAAAAAAALklFQyA2MTk2Ni0yLjEgRGVmYXVsdCBSR0IgY29sb3VyIHNwYWNlIC0gc1JHQgAAAAAAAAAAAAAALklFQyA2MTk2Ni0yLjEgRGVmYXVsdCBSR0IgY29sb3VyIHNwYWNlIC0gc1JHQgAAAAAAAAAAAAAAAAAAAAAAAAAAAABkZXNjAAAAAAAAACxSZWZlcmVuY2UgVmlld2luZyBDb25kaXRpb24gaW4gSUVDNjE5NjYtMi4xAAAAAAAAAAAAAAAsUmVmZXJlbmNlIFZpZXdpbmcgQ29uZGl0aW9uIGluIElFQzYxOTY2LTIuMQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAdmlldwAAAAAAE6T+ABRfLgAQzxQAA+3MAAQTCwADXJ4AAAABWFlaIAAAAAAATAlWAFAAAABXH+dtZWFzAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAACjwAAAAJzaWcgAAAAAENSVCBjdXJ2AAAAAAAABAAAAAAFAAoADwAUABkAHgAjACgALQAyADcAOwBAAEUASgBPAFQAWQBeAGMAaABtAHIAdwB8AIEAhgCLAJAAlQCaAJ8ApACpAK4AsgC3ALwAwQDGAMsA0ADVANsA4ADlAOsA8AD2APsBAQEHAQ0BEwEZAR8BJQErATIBOAE+AUUBTAFSAVkBYAFnAW4BdQF8AYMBiwGSAZoBoQGpAbEBuQHBAckB0QHZAeEB6QHyAfoCAwIMAhQCHQImAi8COAJBAksCVAJdAmcCcQJ6AoQCjgKYAqICrAK2AsECywLVAuAC6wL1AwADCwMWAyEDLQM4A0MDTwNaA2YDcgN+A4oDlgOiA64DugPHA9MD4APsA/kEBgQTBCAELQQ7BEgEVQRjBHEEfgSMBJoEqAS2BMQE0wThBPAE/gUNBRwFKwU6BUkFWAVnBXcFhgWWBaYFtQXFBdUF5QX2BgYGFgYnBjcGSAZZBmoGewaMBp0GrwbABtEG4wb1BwcHGQcrBz0HTwdhB3QHhgeZB6wHvwfSB+UH+AgLCB8IMghGCFoIbgiCCJYIqgi+CNII5wj7CRAJJQk6CU8JZAl5CY8JpAm6Cc8J5Qn7ChEKJwo9ClQKagqBCpgKrgrFCtwK8wsLCyILOQtRC2kLgAuYC7ALyAvhC/kMEgwqDEMMXAx1DI4MpwzADNkM8w0NDSYNQA1aDXQNjg2pDcMN3g34DhMOLg5JDmQOfw6bDrYO0g7uDwkPJQ9BD14Peg+WD7MPzw/sEAkQJhBDEGEQfhCbELkQ1xD1ERMRMRFPEW0RjBGqEckR6BIHEiYSRRJkEoQSoxLDEuMTAxMjE0MTYxODE6QTxRPlFAYUJxRJFGoUixStFM4U8BUSFTQVVhV4FZsVvRXgFgMWJhZJFmwWjxayFtYW+hcdF0EXZReJF64X0hf3GBsYQBhlGIoYrxjVGPoZIBlFGWsZkRm3Gd0aBBoqGlEadxqeGsUa7BsUGzsbYxuKG7Ib2hwCHCocUhx7HKMczBz1HR4dRx1wHZkdwx3sHhYeQB5qHpQevh7pHxMfPh9pH5Qfvx/qIBUgQSBsIJggxCDwIRwhSCF1IaEhziH7IiciVSKCIq8i3SMKIzgjZiOUI8Ij8CQfJE0kfCSrJNolCSU4JWgllyXHJfcmJyZXJocmtyboJxgnSSd6J6sn3CgNKD8ocSiiKNQpBik4KWspnSnQKgIqNSpoKpsqzysCKzYraSudK9EsBSw5LG4soizXLQwtQS12Last4S4WLkwugi63Lu4vJC9aL5Evxy/+MDUwbDCkMNsxEjFKMYIxujHyMioyYzKbMtQzDTNGM38zuDPxNCs0ZTSeNNg1EzVNNYc1wjX9Njc2cjauNuk3JDdgN5w31zgUOFA4jDjIOQU5Qjl/Obw5+To2OnQ6sjrvOy07azuqO+g8JzxlPKQ84z0iPWE9oT3gPiA+YD6gPuA/IT9hP6I/4kAjQGRApkDnQSlBakGsQe5CMEJyQrVC90M6Q31DwEQDREdEikTORRJFVUWaRd5GIkZnRqtG8Ec1R3tHwEgFSEtIkUjXSR1JY0mpSfBKN0p9SsRLDEtTS5pL4kwqTHJMuk0CTUpNk03cTiVObk63TwBPSU+TT91QJ1BxULtRBlFQUZtR5lIxUnxSx1MTU19TqlP2VEJUj1TbVShVdVXCVg9WXFapVvdXRFeSV+BYL1h9WMtZGllpWbhaB1pWWqZa9VtFW5Vb5Vw1XIZc1l0nXXhdyV4aXmxevV8PX2Ffs2AFYFdgqmD8YU9homH1YklinGLwY0Njl2PrZEBklGTpZT1lkmXnZj1mkmboZz1nk2fpaD9olmjsaUNpmmnxakhqn2r3a09rp2v/bFdsr20IbWBtuW4SbmtuxG8eb3hv0XArcIZw4HE6cZVx8HJLcqZzAXNdc7h0FHRwdMx1KHWFdeF2Pnabdvh3VnezeBF4bnjMeSp5iXnnekZ6pXsEe2N7wnwhfIF84X1BfaF+AX5ifsJ/I3+Ef+WAR4CogQqBa4HNgjCCkoL0g1eDuoQdhICE44VHhauGDoZyhteHO4efiASIaYjOiTOJmYn+imSKyoswi5aL/IxjjMqNMY2Yjf+OZo7OjzaPnpAGkG6Q1pE/kaiSEZJ6kuOTTZO2lCCUipT0lV+VyZY0lp+XCpd1l+CYTJi4mSSZkJn8mmia1ZtCm6+cHJyJnPedZJ3SnkCerp8dn4uf+qBpoNihR6G2oiailqMGo3aj5qRWpMelOKWpphqmi6b9p26n4KhSqMSpN6mpqhyqj6sCq3Wr6axcrNCtRK24ri2uoa8Wr4uwALB1sOqxYLHWskuywrM4s660JbSctRO1irYBtnm28Ldot+C4WbjRuUq5wro7urW7LrunvCG8m70VvY++Cr6Evv+/er/1wHDA7MFnwePCX8Lbw1jD1MRRxM7FS8XIxkbGw8dBx7/IPci8yTrJuco4yrfLNsu2zDXMtc01zbXONs62zzfPuNA50LrRPNG+0j/SwdNE08bUSdTL1U7V0dZV1tjXXNfg2GTY6Nls2fHadtr724DcBdyK3RDdlt4c3qLfKd+v4DbgveFE4cziU+Lb42Pj6+Rz5PzlhOYN5pbnH+ep6DLovOlG6dDqW+rl63Dr++yG7RHtnO4o7rTvQO/M8Fjw5fFy8f/yjPMZ86f0NPTC9VD13vZt9vv3ivgZ+Kj5OPnH+lf65/t3/Af8mP0p/br+S/7c/23////tAAxBZG9iZV9DTQAB/+4ADkFkb2JlAGSAAAAAAf/bAIQADAgICAkIDAkJDBELCgsRFQ8MDA8VGBMTFRMTGBEMDAwMDAwRDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAENCwsNDg0QDg4QFA4ODhQUDg4ODhQRDAwMDAwREQwMDAwMDBEMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwM/8AAEQgAQABAAwEiAAIRAQMRAf/dAAQABP/EAT8AAAEFAQEBAQEBAAAAAAAAAAMAAQIEBQYHCAkKCwEAAQUBAQEBAQEAAAAAAAAAAQACAwQFBgcICQoLEAABBAEDAgQCBQcGCAUDDDMBAAIRAwQhEjEFQVFhEyJxgTIGFJGhsUIjJBVSwWIzNHKC0UMHJZJT8OHxY3M1FqKygyZEk1RkRcKjdDYX0lXiZfKzhMPTdePzRieUpIW0lcTU5PSltcXV5fVWZnaGlqa2xtbm9jdHV2d3h5ent8fX5/cRAAICAQIEBAMEBQYHBwYFNQEAAhEDITESBEFRYXEiEwUygZEUobFCI8FS0fAzJGLhcoKSQ1MVY3M08SUGFqKygwcmNcLSRJNUoxdkRVU2dGXi8rOEw9N14/NGlKSFtJXE1OT0pbXF1eX1VmZ2hpamtsbW5vYnN0dXZ3eHl6e3x//aAAwDAQACEQMRAD8A88X0wkvmdJSl9MJL5nSUpfTCS+Z0lKX0wkvmdJT/AP/Q88X0wkvmdJSl9MJL5nSUpfTCS+Z0lKX0wkvmdJT/AP/R88X0wkvmdJSl9MJL5nSUpfTCS+Z0lKX0wkvmdJT/AP/S88X0wkvmdJSl9MJL5nSUpfTCS+Z0lKX0wkvmdJT/AP/ZOEJJTQQhAAAAAABVAAAAAQEAAAAPAEEAZABvAGIAZQAgAFAAaABvAHQAbwBzAGgAbwBwAAAAEwBBAGQAbwBiAGUAIABQAGgAbwB0AG8AcwBoAG8AcAAgAEMAUwA2AAAAAQA4QklNBAYAAAAAAAcACAAAAAEBAP/hDdZodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIiB4bWxuczpwaG90b3Nob3A9Imh0dHA6Ly9ucy5hZG9iZS5jb20vcGhvdG9zaG9wLzEuMC8iIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoV2luZG93cykiIHhtcDpDcmVhdGVEYXRlPSIyMDE4LTEwLTA1VDE2OjMzOjQwKzAzOjAwIiB4bXA6TWV0YWRhdGFEYXRlPSIyMDE4LTEwLTA1VDE2OjMzOjQwKzAzOjAwIiB4bXA6TW9kaWZ5RGF0ZT0iMjAxOC0xMC0wNVQxNjozMzo0MCswMzowMCIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpBNDI1QjQxNkEzQzhFODExODIxNzhEQTQ1NUFCNTJGMCIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpBMzI1QjQxNkEzQzhFODExODIxNzhEQTQ1NUFCNTJGMCIgeG1wTU06T3JpZ2luYWxEb2N1bWVudElEPSJ4bXAuZGlkOkEzMjVCNDE2QTNDOEU4MTE4MjE3OERBNDU1QUI1MkYwIiBkYzpmb3JtYXQ9ImltYWdlL2pwZWciIHBob3Rvc2hvcDpDb2xvck1vZGU9IjMiIHBob3Rvc2hvcDpJQ0NQcm9maWxlPSJzUkdCIElFQzYxOTY2LTIuMSI+IDx4bXBNTTpIaXN0b3J5PiA8cmRmOlNlcT4gPHJkZjpsaSBzdEV2dDphY3Rpb249ImNyZWF0ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6QTMyNUI0MTZBM0M4RTgxMTgyMTc4REE0NTVBQjUyRjAiIHN0RXZ0OndoZW49IjIwMTgtMTAtMDVUMTY6MzM6NDArMDM6MDAiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCBDUzYgKFdpbmRvd3MpIi8+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJzYXZlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDpBNDI1QjQxNkEzQzhFODExODIxNzhEQTQ1NUFCNTJGMCIgc3RFdnQ6d2hlbj0iMjAxOC0xMC0wNVQxNjozMzo0MCswMzowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoV2luZG93cykiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gPC9yZGY6U2VxPiA8L3htcE1NOkhpc3Rvcnk+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDw/eHBhY2tldCBlbmQ9InciPz7/4gxYSUNDX1BST0ZJTEUAAQEAAAxITGlubwIQAABtbnRyUkdCIFhZWiAHzgACAAkABgAxAABhY3NwTVNGVAAAAABJRUMgc1JHQgAAAAAAAAAAAAAAAQAA9tYAAQAAAADTLUhQICAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABFjcHJ0AAABUAAAADNkZXNjAAABhAAAAGx3dHB0AAAB8AAAABRia3B0AAACBAAAABRyWFlaAAACGAAAABRnWFlaAAACLAAAABRiWFlaAAACQAAAABRkbW5kAAACVAAAAHBkbWRkAAACxAAAAIh2dWVkAAADTAAAAIZ2aWV3AAAD1AAAACRsdW1pAAAD+AAAABRtZWFzAAAEDAAAACR0ZWNoAAAEMAAAAAxyVFJDAAAEPAAACAxnVFJDAAAEPAAACAxiVFJDAAAEPAAACAx0ZXh0AAAAAENvcHlyaWdodCAoYykgMTk5OCBIZXdsZXR0LVBhY2thcmQgQ29tcGFueQAAZGVzYwAAAAAAAAASc1JHQiBJRUM2MTk2Ni0yLjEAAAAAAAAAAAAAABJzUkdCIElFQzYxOTY2LTIuMQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWFlaIAAAAAAAAPNRAAEAAAABFsxYWVogAAAAAAAAAAAAAAAAAAAAAFhZWiAAAAAAAABvogAAOPUAAAOQWFlaIAAAAAAAAGKZAAC3hQAAGNpYWVogAAAAAAAAJKAAAA+EAAC2z2Rlc2MAAAAAAAAAFklFQyBodHRwOi8vd3d3LmllYy5jaAAAAAAAAAAAAAAAFklFQyBodHRwOi8vd3d3LmllYy5jaAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABkZXNjAAAAAAAAAC5JRUMgNjE5NjYtMi4xIERlZmF1bHQgUkdCIGNvbG91ciBzcGFjZSAtIHNSR0IAAAAAAAAAAAAAAC5JRUMgNjE5NjYtMi4xIERlZmF1bHQgUkdCIGNvbG91ciBzcGFjZSAtIHNSR0IAAAAAAAAAAAAAAAAAAAAAAAAAAAAAZGVzYwAAAAAAAAAsUmVmZXJlbmNlIFZpZXdpbmcgQ29uZGl0aW9uIGluIElFQzYxOTY2LTIuMQAAAAAAAAAAAAAALFJlZmVyZW5jZSBWaWV3aW5nIENvbmRpdGlvbiBpbiBJRUM2MTk2Ni0yLjEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHZpZXcAAAAAABOk/gAUXy4AEM8UAAPtzAAEEwsAA1yeAAAAAVhZWiAAAAAAAEwJVgBQAAAAVx/nbWVhcwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAo8AAAACc2lnIAAAAABDUlQgY3VydgAAAAAAAAQAAAAABQAKAA8AFAAZAB4AIwAoAC0AMgA3ADsAQABFAEoATwBUAFkAXgBjAGgAbQByAHcAfACBAIYAiwCQAJUAmgCfAKQAqQCuALIAtwC8AMEAxgDLANAA1QDbAOAA5QDrAPAA9gD7AQEBBwENARMBGQEfASUBKwEyATgBPgFFAUwBUgFZAWABZwFuAXUBfAGDAYsBkgGaAaEBqQGxAbkBwQHJAdEB2QHhAekB8gH6AgMCDAIUAh0CJgIvAjgCQQJLAlQCXQJnAnECegKEAo4CmAKiAqwCtgLBAssC1QLgAusC9QMAAwsDFgMhAy0DOANDA08DWgNmA3IDfgOKA5YDogOuA7oDxwPTA+AD7AP5BAYEEwQgBC0EOwRIBFUEYwRxBH4EjASaBKgEtgTEBNME4QTwBP4FDQUcBSsFOgVJBVgFZwV3BYYFlgWmBbUFxQXVBeUF9gYGBhYGJwY3BkgGWQZqBnsGjAadBq8GwAbRBuMG9QcHBxkHKwc9B08HYQd0B4YHmQesB78H0gflB/gICwgfCDIIRghaCG4IggiWCKoIvgjSCOcI+wkQCSUJOglPCWQJeQmPCaQJugnPCeUJ+woRCicKPQpUCmoKgQqYCq4KxQrcCvMLCwsiCzkLUQtpC4ALmAuwC8gL4Qv5DBIMKgxDDFwMdQyODKcMwAzZDPMNDQ0mDUANWg10DY4NqQ3DDd4N+A4TDi4OSQ5kDn8Omw62DtIO7g8JDyUPQQ9eD3oPlg+zD88P7BAJECYQQxBhEH4QmxC5ENcQ9RETETERTxFtEYwRqhHJEegSBxImEkUSZBKEEqMSwxLjEwMTIxNDE2MTgxOkE8UT5RQGFCcUSRRqFIsUrRTOFPAVEhU0FVYVeBWbFb0V4BYDFiYWSRZsFo8WshbWFvoXHRdBF2UXiReuF9IX9xgbGEAYZRiKGK8Y1Rj6GSAZRRlrGZEZtxndGgQaKhpRGncanhrFGuwbFBs7G2MbihuyG9ocAhwqHFIcexyjHMwc9R0eHUcdcB2ZHcMd7B4WHkAeah6UHr4e6R8THz4faR+UH78f6iAVIEEgbCCYIMQg8CEcIUghdSGhIc4h+yInIlUigiKvIt0jCiM4I2YjlCPCI/AkHyRNJHwkqyTaJQklOCVoJZclxyX3JicmVyaHJrcm6CcYJ0kneierJ9woDSg/KHEooijUKQYpOClrKZ0p0CoCKjUqaCqbKs8rAis2K2krnSvRLAUsOSxuLKIs1y0MLUEtdi2rLeEuFi5MLoIuty7uLyQvWi+RL8cv/jA1MGwwpDDbMRIxSjGCMbox8jIqMmMymzLUMw0zRjN/M7gz8TQrNGU0njTYNRM1TTWHNcI1/TY3NnI2rjbpNyQ3YDecN9c4FDhQOIw4yDkFOUI5fzm8Ofk6Njp0OrI67zstO2s7qjvoPCc8ZTykPOM9Ij1hPaE94D4gPmA+oD7gPyE/YT+iP+JAI0BkQKZA50EpQWpBrEHuQjBCckK1QvdDOkN9Q8BEA0RHRIpEzkUSRVVFmkXeRiJGZ0arRvBHNUd7R8BIBUhLSJFI10kdSWNJqUnwSjdKfUrESwxLU0uaS+JMKkxyTLpNAk1KTZNN3E4lTm5Ot08AT0lPk0/dUCdQcVC7UQZRUFGbUeZSMVJ8UsdTE1NfU6pT9lRCVI9U21UoVXVVwlYPVlxWqVb3V0RXklfgWC9YfVjLWRpZaVm4WgdaVlqmWvVbRVuVW+VcNVyGXNZdJ114XcleGl5sXr1fD19hX7NgBWBXYKpg/GFPYaJh9WJJYpxi8GNDY5dj62RAZJRk6WU9ZZJl52Y9ZpJm6Gc9Z5Nn6Wg/aJZo7GlDaZpp8WpIap9q92tPa6dr/2xXbK9tCG1gbbluEm5rbsRvHm94b9FwK3CGcOBxOnGVcfByS3KmcwFzXXO4dBR0cHTMdSh1hXXhdj52m3b4d1Z3s3gReG54zHkqeYl553pGeqV7BHtje8J8IXyBfOF9QX2hfgF+Yn7CfyN/hH/lgEeAqIEKgWuBzYIwgpKC9INXg7qEHYSAhOOFR4Wrhg6GcobXhzuHn4gEiGmIzokziZmJ/opkisqLMIuWi/yMY4zKjTGNmI3/jmaOzo82j56QBpBukNaRP5GokhGSepLjk02TtpQglIqU9JVflcmWNJaflwqXdZfgmEyYuJkkmZCZ/JpomtWbQpuvnByciZz3nWSd0p5Anq6fHZ+Ln/qgaaDYoUehtqImopajBqN2o+akVqTHpTilqaYapoum/adup+CoUqjEqTepqaocqo+rAqt1q+msXKzQrUStuK4trqGvFq+LsACwdbDqsWCx1rJLssKzOLOutCW0nLUTtYq2AbZ5tvC3aLfguFm40blKucK6O7q1uy67p7whvJu9Fb2Pvgq+hL7/v3q/9cBwwOzBZ8Hjwl/C28NYw9TEUcTOxUvFyMZGxsPHQce/yD3IvMk6ybnKOMq3yzbLtsw1zLXNNc21zjbOts83z7jQOdC60TzRvtI/0sHTRNPG1EnUy9VO1dHWVdbY11zX4Nhk2OjZbNnx2nba+9uA3AXcit0Q3ZbeHN6i3ynfr+A24L3hROHM4lPi2+Nj4+vkc+T85YTmDeaW5x/nqegy6LzpRunQ6lvq5etw6/vshu0R7ZzuKO6070DvzPBY8OXxcvH/8ozzGfOn9DT0wvVQ9d72bfb794r4Gfio+Tj5x/pX+uf7d/wH/Jj9Kf26/kv+3P9t////7gAOQWRvYmUAZEAAAAAB/9sAhAABAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAgICAgICAgICAgIDAwMDAwMDAwMDAQEBAQEBAQEBAQECAgECAgMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwP/wAARCABAAEADAREAAhEBAxEB/90ABAAI/8QBogAAAAYCAwEAAAAAAAAAAAAABwgGBQQJAwoCAQALAQAABgMBAQEAAAAAAAAAAAAGBQQDBwIIAQkACgsQAAIBAwQBAwMCAwMDAgYJdQECAwQRBRIGIQcTIgAIMRRBMiMVCVFCFmEkMxdScYEYYpElQ6Gx8CY0cgoZwdE1J+FTNoLxkqJEVHNFRjdHYyhVVlcassLS4vJkg3SThGWjs8PT4yk4ZvN1Kjk6SElKWFlaZ2hpanZ3eHl6hYaHiImKlJWWl5iZmqSlpqeoqaq0tba3uLm6xMXGx8jJytTV1tfY2drk5ebn6Onq9PX29/j5+hEAAgEDAgQEAwUEBAQGBgVtAQIDEQQhEgUxBgAiE0FRBzJhFHEIQoEjkRVSoWIWMwmxJMHRQ3LwF+GCNCWSUxhjRPGisiY1GVQ2RWQnCnODk0Z0wtLi8lVldVY3hIWjs8PT4/MpGpSktMTU5PSVpbXF1eX1KEdXZjh2hpamtsbW5vZnd4eXp7fH1+f3SFhoeIiYqLjI2Oj4OUlZaXmJmam5ydnp+So6SlpqeoqaqrrK2ur6/9oADAMBAAIRAxEAPwDTX9+6919yD37r3Xw3/fuvdfcg9+6918N/37r3X3IPfuvdfDf9+6919yD37r3X/9Df49+6918N/wB+6919yD37r3Xw3/fuvdfcg9+6918N/wB+6919yD37r3Xw3/fuvdf/0dNf37r3X3IPfuvdfDf9+6919yD37r3Xw3/fuvdfcg9+6918N/37r3X3IPfuvdf/0t/j37r3Xw3/AH7r3X3IPfuvdfDf9+6919yD37r3Xw3/AH7r3X3IPfuvdfDf9+691//T01/fuvdfcg9+6918N/37r3X3IPfuvdfDf9+6919yD37r3Xw3/fuvdfcg9+691//U3+PfuvdfDf8Afuvdfcg9+6918N/37r3X3IPfuvdfDf8Afuvdfcg9+6918N/37r3X/9XTX9+6919yD37r3Xw3/fuvdfcg9+6918N/37r3X3IPfuvdfDf9+6919yD37r3X/9bf49+6918N/wB+6919yD37r3Xw3/fuvdfcg9+6918N/wB+6919yD37r3Xw3/fuvdf/2Q==",a)}function a(t){t.minFilter=THREE.LinearFilter,t.magFilter=THREE.NearestFilter,t.flipY=!0,t.wrapS=t.wrapT=THREE.RepeatWrapping,t.anisotropy=i.renderer.capabilities.getMaxAnisotropy();var e=new THREE.MeshBasicMaterial({map:t,side:THREE.BackSide});e.linkMy=n,e.sahMin=s,i.arrMat.push(e),i.dragMaterial(e)}},this.getTexture=function(){return this.cubeCamera.renderTarget.texture};var r={vertex:["uniform vec4 offsetRepeat;","varying vec2 vUv;","void main() {","    // vUv  = uv;","    vUv = uv * offsetRepeat.zw + offsetRepeat.xy;","    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 3);","}"].join("\n"),fragment:["uniform sampler2D   tDiffuse;","uniform float       exposure;","uniform float       gamma;","varying vec2  vUv;","vec3 decode_pnghdr( const in vec4 color ) {","    vec4 rgbcolor = vec4( 0.0, 0.0, 0.0, 0.0 );","    if ( color.w > 0.0 ) {","        float f = pow(2.0, 127.0*(color.w-0.5));","        rgbcolor.xyz = color.xyz * f;","    }","    return rgbcolor.xyz;","    /*","    // remove gamma correction","    vec4 res = color * color;","    // decoded RI","    float ri = pow( 2.0, res.w * 32.0 - 16.0 );","    // decoded HDR pixel","    res.xyz = res.xyz * ri;","    return res.xyz;","    */","}","void main() {","    vec4 color = texture2D( tDiffuse, vUv );","    color.xyz  = decode_pnghdr( color );","    // apply gamma correction and exposure","    //gl_FragColor = vec4( pow( exposure * color.xyz, vec3( 0.474 ) ), 1.0 );","    // Perform tone-mapping","    float Y = dot(vec4(0.30, 0.59, 0.11, 0.0), color);","    float YD = exposure * (exposure/gamma + 1.0) / (exposure + 1.0);","    color *= YD;","    gl_FragColor = vec4( color.xyz, 1.0 );","}"].join("\n")};this.debug=!1}Object.defineProperties(r.prototype,{link:{set:function(t){this._link!=t&&(this._link=t,this.loadFun())},get:function(){return this._link}},activDiz:{set:function(t){this._activDiz!=t&&(this._activDiz=t)},get:function(){return this._activDiz}},exposure:{set:function(t){this._exposure!=t&&(this._exposure=t,this.material&&null!=this.material.uniforms&&(this.material.uniforms.exposure.value=t,this.upDate()))},get:function(){return this._exposure}},gamma:{set:function(t){this._gamma!=t&&(this._gamma=t,this.material&&null!=this.material.uniforms&&(this.material.uniforms.gamma.value=t,this.upDate()))},get:function(){return this._gamma}},debug:{set:function(t){this._debug!=t&&(this._debug=t,this._layer=t?0:31,this.setLayers(this._layer))},get:function(){return this._debug}}})},function(module,__webpack_exports__,__webpack_require__){"use strict";function PMMat(par,visi3D,objbase){this.type="PMMat";var self=this;this.par=par,this.visi3D=visi3D,this.objbase=objbase,this.pmTexture=this.par.tex,this.ser=window.location.href;var arrParams=window.location.href.split("?"),arrParams2=arrParams[0].split("/");this.server="";for(var i=0;i<arrParams2.length-1;i++)this.server+=arrParams2[i]+"/";this.setObjS=function(t,i,e){this.getTestTitleObj(t),e()},this.testObjMatLoad=function(t){if(t.children)for(var i=0;i<t.children.length;i++)if(0==this.testObjMatLoad(t.children[i]))return!1;return!t.material||null==t.material.bLoad||0!=t.material.bLoad},this.matarialArray=this.objbase.materials;var matarialArray=this.matarialArray;this.idColor=null;var loader=new THREE.TextureLoader,rt,textur;this.obj={},this.getTestTitle=function(t){var i=null;if(null!=t)for(var e=0;e<matarialArray.length;e++)if(-1!=t.indexOf(matarialArray[e].title))return i=this.getIDReturn(matarialArray[e].id);return i},this.getTestTitleObj=function(t){t.material&&null!=(rt=this.getTestTitle(t.material.name))&&(t.material=rt);for(var i=0;i<t.children.length;i++)this.getTestTitleObj(t.children[i])},this.getIDReturn=function(id,isBD){for(var r=null,p=-1,i=0;i<matarialArray.length;i++)matarialArray[i].id==id&&(p=i);if(-1==p)return null;if(null==isBD&&null!=this.obj[id])return this.obj[id];var comand="new THREE."+matarialArray[p].key+"()",m=eval(comand);return m.idObj=matarialArray[p],this.startMat(m,id),this.obj[id]=m,m.idUz=id,m},this.get=function(t,i,e){var s,r,n=-1;if(null!=e){s=t+"",t="2456567567867896789";for(var a=0;a<this.matarialArray.length;a++)if(r=this.matarialArray[a].title+"",-1!=s.indexOf(r)){t=this.matarialArray[a].title;break}}for(a=0;a<this.matarialArray.length;a++)this.matarialArray[a].title==t&&(n=a);-1!=n?this.getId(this.matarialArray[n].id,i):i(null)},this.getId=function(id,_fun){for(var p=-1,i=0;i<this.matarialArray.length;i++)if(this.matarialArray[i].id==id){p=i;break}if(-1!=p){if(null!=this.obj[id])return 1==this.obj[id].bLoad?_fun(this.obj[id]):this.obj[id].arrFun.push(_fun),this.obj[id];var comand="new THREE."+this.matarialArray[p].key+"()",m=eval(comand);return m.idObj=matarialArray[p],m.bLoad=!1,m.loadTexure=999,m.arrFun=[_fun],this.startMat(m,id),this.obj[id]=m,m}_fun(null)},this.objToMater=function(t,i){var e=this;for(var s in t)null!=i[s]&&(i[s]instanceof THREE.Color?i[s]=new THREE.Color(t[s]):i[s]=t[s]);if(i.loadTexure=0,t.textur){i.loadTexure=t.textur.length;for(var r=0;r<t.textur.length;r++)t.textur[r].id?function(){var s=r;textur=e.pmTexture.getById(t.textur[r].id,function(e){i[t.textur[s].name]=e,--i.loadTexure}),i[t.textur[r].name]=textur}():((textur=loader.load(t.textur[r].link,function(){self.visi3D&&(self.visi3D.intRend=1),i.loadTexure--})).wrapS=textur.wrapT=THREE.RepeatWrapping,textur.repeat.x=t.textur[r].rx,textur.repeat.y=t.textur[r].ry,i[t.textur[r].name]=textur)}if(i.needsUpdate=!0,i.bLoad=!0,i.arrFun)for(r=0;r<i.arrFun.length;r++)i.arrFun[r](i)},this.startMat=function(t,i){var e,s=this.server+"resources/data/"+i+"/config.json"+self.par.plus;$.ajax({url:s,success:function(i){if("string"==typeof i){var s=JSON.parse(i);e=s}else e=i;!0===e.mirro?self.visi3D&&(t.envMap=self.visi3D.getEnvMap()):(e.mirro,1==e.mirro&&self.visi3D&&(t.envMap=self.visi3D.getEnvMap()),2==e.mirro&&self.visi3D&&(t.envMap=self.visi3D.getEnvMap1())),self.objToMater(e.obj,t)},error:function(t){self.start()}})}}__webpack_require__.d(__webpack_exports__,"a",function(){return PMMat})},function(t,i,e){"use strict";(function(t){e.d(i,"a",function(){return d});var s=e(13),r=e(26),n=e(22),a=e(28),o=e(16),h=e(25),l=e(17),u=e(18),c=e(19);e(30);function p(t,i){for(var e=0;e<i.length;e++){var s=i[e];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}var d=function(){function i(e,p){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,i),this.type="Menu";var d=this;this.par=e,this.fun=p,this._mashtab=1,this.wh=48,this.objectBase=e.par.objectBase,this.otstup=5,this.otstup1=10,this.sizeMax=this.par.sizeMax,dcmParam.activButton="#f28044",this._menuIndex=-1,this.dCont=new DCont(this.par.dCont),this.localStorage=e.par.localStorage,this.array=[],this.array[this.array.length]=this.mGridDrag=new a.a(this,function(t,i,e){d.fun(t,i,e)}),this.array[this.array.length]=this.mStart=new h.a(this,function(t,i,e){"index"==t&&(d.menuIndex=i),d.fun(t,i,e)}),this.array[this.array.length]=this.mLeft=new s.a(this,function(t,i,e){"index"==t&&(d.menuIndex=i),"gIndex"==t&&d.mDragScane.sobMenu(t,i,e)}),this.array[this.array.length]=this.mDragScane=new r.a(this,function(t,i){}),this.array[this.array.length]=this.mObject=new n.a(this,function(t,i){}),this.array[this.array.length]=this.mCont2dHelp=new o.a(this,function(t,i){}),this.array[this.array.length]=this.menuV3D=new l.a(this,function(t,i){}),this.array[this.array.length]=this.mMani=new c.a(this,function(t,i){}),this.array[this.array.length]=t.mInfo=this.mInfo=new u.a(this.par.dCont),this.array[this.array.length]=t.dragPic=this.dragPic=new DDragPic(this.par.dCont),t.dragPic.whBase=this.wh,this.setP20=function(t){this.p20=t,this.mDragScane.setP20(t),this.mGridDrag.setP20(t),this.mStart.setP20(t)},this.sp=void 0,this.setSP=function(t){this.sp=t,this.mDragScane.setSP(t),this.mGridDrag.setSP(t),this.mCont2dHelp.setSP(t),this.mObject.setSP(t),this.mStart.setSP(t)},this.object,this.setObject=function(t){this.object=t;for(var i=0,e=this.array.length-1;e>=0;e--)if(this.array[e].testObj&&1==this.array[e].testObj(t)){i=e;break}this.openMenu(i)},this.setMessage=function(t,i){if("messageClose"!=t){var e=t||"Сообщение",s=i||"null";mInfo.setFun(e,s)}else mInfo.closeTime(i)},this.setApi=function(t,i,e){"activObject"==t&&this.setObject(i)},this.setObj=function(t){this.mStart.setObj(t)},this.setArrObj=function(t){this.mStart.setArrObj(t),this.mDragScane.redrag()},this.setInfoArr=function(t){this.mMani.setInfoArr(t)},this.setSop=function(t,i,e){if("rectSP"==t){var s=d.par.p20.getRect(d.par.p20.index);d.mGridDrag.setRect(s,10,!0)}},this.sizeWindow=function(t,i,e){null==e&&(e=1);for(var s=this.array.length-1;s>=0;s--)this.array[s].sizeWindow&&this.array[s].sizeWindow(t,i,e)},this.keydown=function(t){for(var i=this.array.length-1;i>=0;i--)this.array[i].keydown&&this.array[i].keydown(t)},this.keyup=function(t){for(var i=this.array.length-1;i>=0;i--)this.array[i].keyup&&this.array[i].keyup(t)},this.menuIndex=0}var e,d,f;return e=i,(d=[{key:"menuIndex",set:function(t){this._menuIndex!=t&&(this._menuIndex=t,this.mLeft.index=t,this.mDragScane.menuIndex=t,this.mGridDrag.menuIndex=t,this.mObject.clear(),this.sp&&this.sp.setActive())},get:function(){return this._menuIndex}},{key:"mashtab",set:function(t){if(this._mashtab!=t){this._mashtab=t;for(var i=this.array.length-1;i>=0;i--)null!=this.array[i]._mashtab&&(this.array[i].mashtab=t)}},get:function(){return this._mashtab}}])&&p(e.prototype,d),f&&p(e,f),i}()}).call(this,e(5))},function(t,i,e){"use strict";function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(t,i){return!i||"object"!==s(i)&&"function"!=typeof i?h(t):i}function n(t){return(n=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function a(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&o(t,i)}function o(t,i){return(o=Object.setPrototypeOf||function(t,i){return t.__proto__=i,t})(t,i)}function h(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function l(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function u(t,i){for(var e=0;e<i.length;e++){var s=i[e];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function c(t,i,e){return i&&u(t.prototype,i),e&&u(t,e),t}e.d(i,"a",function(){return p});var p=function(){function t(i,e){l(this,t),this.type="MLeft";var s=this;this.par=i,this.fun=e,this.otstup=this.par.otstup,this.otstup1=this.par.otstup1,this.wh=this.par.wh,this._index=-1,this._tipVisi=-1,this._tipDrav=-1,this.dCont=new DCont(i.dCont),this.dCont.x=2*this.otstup,this.dCont.y=5*this.otstup+this.wh,this.objectBase=void 0,this.objThree=void 0,this.panel=void 0,this.array=[],this.init=function(t){this.objectBase=t;for(var i=0;i<t.three.length;i++)"MLeft"==t.three[i].keyName&&(this.objThree=t.three[i]);for(i=0;i<this.objThree.array.length;i++)this.array[i]=new d(this,this.drag,i,this.objThree.array[i])},this.drag=function(t,i){s.fun(t,i)},this.init(this.par.objectBase),this.sobMenu=function(t,i,e){},this.sizeWindow=function(t,i,e){}}return c(t,[{key:"index",set:function(t){if(this._index!=t){this._index=t;for(var i=0;i<this.array.length;i++)i==this._index?this.array[i].active=!0:this.array[i].active=!1}},get:function(){return this._index}},{key:"tipVisi",set:function(t){this._tipVisi!=t&&(this._tipVisi=t)},get:function(){return this._tipVisi}},{key:"tipDrav",set:function(t){this._tipDrav!=t&&(this._tipDrav=t)},get:function(){return this._tipDrav}}]),t}(),d=function(){function t(i,e,s,r){l(this,t),this.type="MLButGal";var n=this;this.par=i,this.fun=e,this.idArr=s,this.obj=r,this._active=!1,this._startIndex=-1,this.otstup=this.par.otstup,this.otstup1=this.par.otstup1,this.wh=this.par.wh,this.gallery=void 0,this.dCont=new DCont(i.dCont),this.button=new DButton(this.dCont,0,s*(this.wh+this.otstup),"",function(){n.fun("index",n.idArr)},"resources/data/"+r.id+"/100.png"),this.button.width=this.button.height=this.wh,this.dCGal=new DCont(this.dCont),this.dCGal.x=this.wh+this.otstup,this.init=function(t){if(null==this.gallery&&0!=this.obj.array.length){2==this.idArr&&(this.gallery=new f(this.dCGal,0,0,function(t,i){},this)),0!=this.idArr&&1!=this.idArr&&3!=this.idArr&&4!=this.idArr||(this.gallery=new DGallery(this.dCGal,0,0,function(){var t={};t.idArr=n.idArr,t.index=this.index,t.obj=this.obj,n.fun("gIndex",t)})),this.gallery.kolII=3,this.gallery.widthPic=64,this.gallery.heightPic=64,this.gallery.width=66*this.gallery.kolII+2;for(var i=0;i<this.obj.array.length;i++)this.obj.array[i].title="",this.obj.array[i].src="resources/data/"+this.obj.array[i].id+"/128.png";this.gallery.start(this.obj.array),0==this.obj.array.length?this.gallery.visible=!1:(this.obj.array.length<=this.gallery.kolII&&(this.gallery.width=66*this.obj.array.length+2),this.gallery.height=66*Math.ceil(this.obj.array.length/this.gallery.kolII)+2,-1!=this._startIndex&&(this.gallery.index=this._startIndex))}}}return c(t,[{key:"active",set:function(t){this._active!=t&&(this._active=t,this.dCGal.visible=t,this.init(),1==this._active?this.button.color=dcmParam.activButton:this.button.color=dcmParam.color)},get:function(){return this._active}},{key:"startIndex",set:function(t){this._startIndex!=t&&(this._startIndex=t,null!=this.gallery&&(this.gallery.index=t))},get:function(){return this._startIndex}}]),t}(),f=function(t){function i(t,e,s,a,o){var u;l(this,i),(u=r(this,n(i).call(this,t,e,s,a))).par=o,u._index=-1,u.par=o;var c=h(h(u));u.downBtn=function(t,i){c.fun&&c.fun(t,i)},u.createZamen=function(){return new g(this.content,0,0,this.downBtn,this)};return u.dragIndex=function(){for(var t=0;t<this.array.length;t++)this._index1==t||this._index==t?(this._index==t&&(this.array[t].activ=!0,this.array[t].setAct(0,!0),this._index1!=t&&this.array[t].setAct(1,!1)),this._index1==t&&(this.array[t].activ=!0,this.array[t].setAct(1,!0),this._index!=t&&this.array[t].setAct(0,!1))):(this.array[t].activ=!1,this.array[t].setAct(0,!1),this.array[t].setAct(1,!1))},u}return a(i,DGallery),c(i,[{key:"index",set:function(t){this._index=t},get:function(){return this._index}}]),i}(),g=function(t){function i(t,e,s,a,o){var u;l(this,i),(u=r(this,n(i).call(this,t,e,s,a))).par=o,u.dragPic=u.par.par.par.par.dragPic;var c=h(h(u));return u.down=function(t){c.fun&&c.fun("indexBig")},u.drag=function(t){var i=c.object;i.typeThree="Blok";var e="resources/data/"+c.object.id+"/original.png";c.dragPic.start(32,e,i)},u.mouseDownNew=function(t){c.dragPic.testDrag(5,c.down,c.drag)},0==dcmParam.mobile?(u.image.image.removeEventListener("mousedown",u.mouseDown),u.panel.div.removeEventListener("mousedown",u.mouseDown)):(u.image.image.removeEventListener("touchstart",u.mouseDown),u.panel.div.removeEventListener("touchstart",u.mouseDown)),0==dcmParam.mobile?(u.image.image.addEventListener("mousedown",u.mouseDownNew),u.panel.div.addEventListener("mousedown",u.mouseDownNew)):(u.image.image.addEventListener("touchstart",u.mouseDownNew),u.panel.div.addEventListener("touchstart",u.mouseDownNew)),u}return a(i,DBox),i}()},function(t,i,e){"use strict";(function(t){e.d(i,"a",function(){return h});var s=e(3);function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function n(t){return(n=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function a(t,i){return(a=Object.setPrototypeOf||function(t,i){return t.__proto__=i,t})(t,i)}function o(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var h=function(i){function e(i,s){var a;!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,e),(a=function(t,i){return!i||"object"!==r(i)&&"function"!=typeof i?o(t):i}(this,n(e).call(this))).type="SobIndex3";var h=o(o(a));a.par=i,a.fun=s;var l,u,c,p,d,f={x:0,y:0,o:null,dist:0},g=void 0;return a.mousemove=function(i){h.getPositPlan(f),h.korektAP(f),null!=g&&(null==g.parent?f.o&&f.o.type&&"SpliceSten"==f.o.type&&1==f.o.windows.isBlokPlace(g)&&(f.o.addBlok(g),t.dragPic.stop()):null==f.o?(t.dragPic.start(48,g.icon,g,this.upDrag,1),g.parent.removeBlok(g)):g.parent.uuid!=f.o.windows.uuid&&f.o.addBlok(g),null!=g.parent&&g.setPosition(f.x,f.y,0))},a.mouseup=function(t){g&&null==g.parent&&(g.life=!1),document.removeEventListener("mouseup",h.mouseup),document.removeEventListener("mousemove",h.mousemove)},a.korektAP=function(t){t.o=null,l=-1,u=99999999;for(var i=0;i<h.p20.sp.arrSplice.length;i++)h.sp.arrSplice[i].life&&(c=calc.isPointInLin(h.sp.arrSplice[i].position,h.sp.arrSplice[i].position1,t,11111,0))&&Math.abs(c.z)<h.sp.arrSplice[i].delph+200&&Math.abs(c.z)<Math.abs(u)&&(u=c.z,l=i,p=c.x,d=c.y);-1!=l&&(t.o=h.sp.arrSplice[l],t.dist=u,t.x=p,t.y=d)},a.sobMenu=function(t,i,e){"gIndex"==t&&h.sobSP("creatObjDin",i.obj)},a.upDrag=function(){},a.sobSP=function(i,e,s){return e&&h.par.par.mObject.setObject(e),"downBlok"==i?(g=e,document.addEventListener("mouseup",h.mouseup),void document.addEventListener("mousemove",h.mousemove)):"creatObjDin"==i?(g=h.sp.worldBlok.getBlok(e.id),t.dragPic.start(48,g.icon,g,this.upDrag,1),document.addEventListener("mouseup",h.mouseup),void document.addEventListener("mousemove",h.mousemove)):void(s&&h.downFont(s))},a}return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&a(t,i)}(e,s["a"]),e}()}).call(this,e(5))},function(t,i,e){"use strict";(function(t){e.d(i,"a",function(){return u});var s=e(0);function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function n(t,i){for(var e=0;e<i.length;e++){var s=i[e];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function a(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function o(t){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function h(t,i){return(h=Object.setPrototypeOf||function(t,i){return t.__proto__=i,t})(t,i)}function l(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var u=function(t){function i(t,e){var s;a(this,i),(s=function(t,i){return!i||"object"!==r(i)&&"function"!=typeof i?l(t):i}(this,o(i).call(this,t,e))).type="MOSten",s.typeNa="SpliceSten";var n,h=l(l(s));return s.par=t,s.dCont=new DCont(t.dCont),s.button=void 0,s.slid,s.slid1,s.msUi=void 0,s.postIn=function(){this.window.title="Sten";var t=this.otstup1,i=this.otstup1,e=["carrier","out","adjacent"];n={};for(var s=0;s<e.length;s++)n[e[s]]={},n[e[s]][0]=new DButton(this.window.content,i,t,"",function(){h.object[this.name]=this.param,h.object._addPoint.dragGG(),h.object._addPoint1.dragGG(),h.drag(),h.object.par[this.name]=this.param},"resources/image/sten_"+e[s]+"0.png"),n[e[s]][0].width=n[e[s]][0].height=this.wh,n[e[s]][0].name=e[s],n[e[s]][0].param=!1,n[e[s]][1]=new DButton(this.window.content,i,t,"",function(){h.object[this.name]=this.param,h.object._addPoint.dragGG(),h.object._addPoint1.dragGG(),h.drag(),h.object.par[this.name]=this.param},"resources/image/sten_"+e[s]+"1.png"),n[e[s]][1].width=n[e[s]][1].height=this.wh,n[e[s]][1].name=e[s],n[e[s]][1].param=!0,i+=this.otstup1+this.wh;this.button=new DButton(this.window.content,i,t,"",function(){h.object.clear()},"resources/image/p0.png"),this.button.width=this.button.height=this.wh,t+=this.otstup1+this.wh,this.slid=new DSliderBig(this.window.content,this.otstup1,t,function(t){h.object.delph=h.slid.value,h.object._addPoint.dragGG(),h.object._addPoint1.dragGG()},"delph",5,1e3),this.slid.width=this.width-2*this.otstup1,this.slid.okrug=1,t+=this.otstup1+70,this.msUi=new c(this,this.dCont,this.otstup1,t),t+=this.otstup1+this.msUi.height;var r=0;for(e=this.par.par.objectBase.three,s=0;s<e.length;s++)if("test"==e[s].keyName){for(var a=e[s].array,o=0;o<a.length;o++){(l=new DButton(this.window.content,2+34*o,t,"",function(){0==r?h.object.color=this.obj.id:h.object["color"+r]=this.obj.id},"resources/data/"+a[o].id+"/128.png")).width=32,l.obj=a[o]}t+=36;for(o=0;o<5;o++){var l;(l=new DButton(this.window.content,2+34*o,t,o+"",function(){r=this.idArr})).width=32,l.idArr=o}}t+=this.otstup1+70,this.slidH=new DSliderBig(this.window.content,this.otstup1,t,function(t){h.object.height=this.value,h.object.par.addObjFun(h.object),h.object._addPoint.dragGG(),h.object._addPoint1.dragGG()},"height",0,500),this.slidH.width=this.width-2*this.otstup1,this.slidH.okrug=1,t+=this.otstup1+70,this.window.height=t+32},s.drag=function(){for(var t in h.slid.value=h.object.delph,h.slidH.value=h.object.height,h.msUi.drag(),n)n[t][0].visible=h.object[t],n[t][1].visible=!h.object[t]},s.postSO=function(){this.object.funDragMenu=this.drag,this.window.title="Sten "+this.object.idArr,this.object.par.setActive(this.object),this.drag()},s.clear=function(){null!=this.object&&(this.object.funDragMenu=void 0),this.active=!1},s.sizeWindow=function(t,i,e){this.dCont.x=t/e-this.width},s}return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&h(t,i)}(i,s["a"]),i}(),c=function(){function i(e,s,r,n){a(this,i),this.par=e;var o=this;this.otstup1=this.par.otstup1,this.wh=this.par.wh,this.height=this.par.wh+2*this.par.otstup1+20,this.dCont=new DCont(e.dCont),this.dCont.x=r,this.dCont.y=n,this.panel=new DPanel(this.dCont,0,0),this.panel.height=this.height,this.panel.width=this.par.window.width-2*this.par.otstup1,this.lebel=new DLabel(this.panel,this.otstup1,this.otstup1,"bChafghfghfhz"),this.lebel.fontSize=10,this.lebel.width=this.panel.width,this.aS,this.down=function(){if(2!=this.idArr&&3!=this.idArr||(o.par.object.bChaz=!o.par.object.bChaz,o.par.object._addPoint.dragVokrug(),o.par.object._addPoint1.dragVokrug(),o.drag()),1==this.idArr&&(o.par.object.sUi=-1,o.par.object.offset=0,o.par.object._addPoint.dragVokrug(),o.par.object._addPoint1.dragVokrug(),o.drag()),0==this.idArr){for(var i=[],e=[],s=0;s<o.par.object._addPoint.arrSHron.length;s++)trace(s+"  "+o.par.object._addPoint.arrSHron[s]),i.push(o.par.object._addPoint.arrSHron[s].sten);for(s=0;s<o.par.object._addPoint1.arrSHron.length;s++)trace(s+"  : "+o.par.object._addPoint1.arrSHron[s]),i.push(o.par.object._addPoint1.arrSHron[s].sten);for(s=0;s<i.length;s++)if(i[s].uuid!=o.par.object.uuid&&-1==i[s].sUi){for(var r=!0,n=0;n<e.length;n++)e[n].uuid==i[s].uuid&&(r=!1);r&&e.push(i[s])}if(o.aS=e,0==e.length)t.mInfo.setFun("Отсутствуют стены.","Необходимо что бы стенка привязывалась к стене с какой либо стороны от себя. Так же не отработает со стенами уже имеющими привязки");else{for(s=0;s<e.length;s++)e[s].animat(1e3);o.help(),o.par.par.perehvat=o.perehvat}}},this.lh,this.th;var h=5;this.help=function(){null==this.lh&&(this.lh=new DLabel(this.panel,-100,30,"Нажмите по подсвеченым стенкам"),this.th=new TWEEN.Tween(this.lh),this.lh.div.style.pointerEvents="none"),h>0&&(this.lh.alpha=1,this.th.to({alpha:0},3e3).start(),h--)},this.perehvat=function(i){if(i&&i.type&&"SpliceSten"==i.type){for(var e=!1,s=0;s<o.aS.length;s++)o.aS[s].uuid==i.uuid&&(e=!0);e?(o.par.object.sUi=i.uuid,o.par.object._addPoint.dragVokrug(),o.par.object._addPoint1.dragVokrug(),o.drag()):t.mInfo.setFun("Не та стена","нажать на стены прилегающие к выбранной")}else t.mInfo.setFun("Небыла нажата стена","надо тыкнуть по стенам который были анимированы в прозрачный цвет")},this.arrBut=[];for(var l=0;l<4;l++){var u=this.otstup1;l>=2&&(u=this.otstup1+this.otstup1+this.wh);var c=new DButton(this.dCont,u,this.otstup1+20,"",this.down,"resources/image/sUi_"+l+".png");c.width=c.height=this.wh,c.idArr=l,this.arrBut[l]=c}var p=this.otstup1+this.otstup1+this.wh;this.slid=new DSliderBig(this.dCont,p,20+this.otstup1,function(t){o.par.object.offset=this.value,o.par.object._addPoint.dragVokrug(),o.par.object._addPoint1.dragVokrug()},"offset",-1e3,1e3),this.slid.width=this.panel.width-this.slid.x-this.otstup1,this.slid.okrug=1,p=this.otstup1+2*(this.otstup1+this.wh),this.input=new DInput(this.dCont,p,20+this.otstup1,"",function(t){o.par.object.sUi=this.value,o.par.object._addPoint.dragVokrug(),o.par.object._addPoint1.dragVokrug(),o.drag()}),this.input.width=this.panel.width-p-this.otstup1,this.drag=function(){this.lebel.text="uuid :"+this.par.object.uuid,-1==this.par.object.sUi?(this.slid.visible=!0,this.arrBut[0].visible=!0,this.arrBut[1].visible=this.arrBut[2].visible=this.arrBut[3].visible=!1,this.input.visible=!1):(this.slid.visible=!1,this.input.visible=!0,this.input.value=this.par.object.sUi,this.arrBut[0].visible=!1,this.arrBut[1].visible=!0,this.arrBut[2].visible=this.par.object.bChaz,this.arrBut[3].visible=!this.par.object.bChaz)}}var e,s,r;return e=i,(s=[{key:"index",set:function(t){this._index=t,this.dragIndex()},get:function(){return this._index}}])&&n(e.prototype,s),r&&n(e,r),i}()}).call(this,e(5))},function(t,i,e){"use strict";e.d(i,"a",function(){return r});var s=e(2);var r=function t(i,e){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,t),this.type="MDragScane";this.par=i,this.fun=e,this.sp=void 0,this.helpDP=new s.a,this.helpDP.alpha=.3,this.helpDP.color=new THREE.Color(dcmParam.color).getHex(),this.helpDP.colorActiv=new THREE.Color(dcmParam.activButton).getHex(),this.clear=function(){this.helpDP.clear()},this.setSP=function(t){this.sp=t,this.sp.content2d.addChild(this.helpDP.content2d)},this.sizeWindow=function(t,i,e){this.cont}}},function(t,i,e){"use strict";function s(t,i){for(var e=0;e<i.length;e++){var s=i[e];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}e.d(i,"a",function(){return r});var r=function(){function t(i,e){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,t),this.type="MenuV3D";var s,r,n,a=this;this.par=i,this.fun=e,this._activeSah=0,this.otstup=this.par.otstup,this.wh=this.par.wh,this.whMin=400,this.dCont=new DCont(i.dCont),this.panel,this.init=function(){null==this.panel&&(this.button=new DButton(this.dCont,2*this.otstup,0,"",function(){a.activeSah=1},"resources/image/not3d.png"),this.button.width=this.button.height=this.wh,this.panel=new DPanel(this.dCont),this.panel.visible=!1,this.button1=new DButton(this.panel,0,this.otstup,"",function(){a.activeSah=2},"resources/image/not3d.png"),this.button1.width=this.button1.height=this.wh,this.button2=new DButton(this.panel,0,this.otstup,"",function(){a.activeSah=a.activeSah-1},"resources/image/not3d2.png"),this.button2.width=this.button2.height=this.wh)},this.visi3D,this.setVisi3D=function(t){this.visi3D=t,this.visi3D.contentHTML.style.position="fixed",this.visi3D.contentHTML.style.top="0px",this.visi3D.contentHTML.style.left="0px",this.panel.content.div.appendChild(this.visi3D.contentHTML),this.sizeWindow(),a.activeSah=1},this.sizeWindow=function(t,i,e){if(null!=t&&(s=t,r=i,n=e),this.button.y=r/n-3*this.otstup-this.wh/2-this.wh,1==this._activeSah){this.panel.x=2*this.otstup,this.panel.y=r/n-3*this.otstup-this.wh/2-this.whMin;var a=!1;this.panel.width!=this.whMin&&(a=!0),this.panel.height!=this.whMin&&(a=!0),this.panel.width=this.whMin,this.panel.height=this.whMin,this.button1.x=this.panel.width-this.wh-this.otstup,this.button2.x=this.panel.width-2*this.wh-2*this.otstup,this.visi3D&&1==a&&this.visi3D.sizeWindow(0,0,this.panel.width,this.panel.height)}2==this._activeSah&&(this.panel.x=this.otstup,this.panel.y=4*this.otstup+this.wh,this.panel.height=r/n-this.panel.y-this.otstup,this.panel.width=s/n-2*this.otstup,this.button2.x=this.panel.width-this.wh-this.otstup,this.visi3D&&this.visi3D.sizeWindow(0,0,this.panel.width,this.panel.height))},this.init()}var i,e,r;return i=t,(e=[{key:"activeSah",set:function(t){this._activeSah!=t&&(this._activeSah=t,this.button.visible=0==t,this.panel.visible=0!=t,this.button1.visible=1==t,this.sizeWindow())},get:function(){return this._activeSah}}])&&s(i.prototype,e),r&&s(i,r),t}()},function(t,i,e){"use strict";function s(t){var i,e,s,r=this;this.type="MInfo",this.fun=void 0,this.dC=t,this._width=100,this._height=100,this._active=!1,this.otstup=2,this.otstup2=10,this.dCont=new DCont,this.text="null",this.panel=new DPanel(this.dCont),this.window=new DWindow(this.dCont,0,0," "),this.window.dragBool=!1,this.window.hasMinimizeButton=!1,this.label=new DLabel(this.window,this.otstup2,this.otstup2+32," "),this.button=new DButton(this.window,0,0,"Да",function(){null!=r.fun&&r.fun(),r.active=!1}),this.button1=new DButton(this.window,0,0,"Нет",function(){r.active=!1}),this.button2=new DButton(this.window,this.otstup,this.otstup,"x",function(){r.active=!1}),this.button2.width=this.button2.height=32-2*this.otstup,this.input=new DInput(this.window,10,this.otstup,"x",function(){r.text=this.text}),this.input.timeFun=1,this.tween=new TWEEN.Tween(this.dC),this.tween.onComplete(function(){r.active=!1,r.dC.alpha=1}),this.closeTime=function(t){this.tween.to({alpha:0},t).start()},this.setFun=function(t,i,e){this.active=!0,this.fun=e,this.tween.stop(),this.dC.alpha=1,console.warn(":::",t,i),this.window.text=t,this.label.text=i;var s=this.otstup2;this.button1.visible=this.button.visible=!1,this.input.visible=!1,null!=this.fun&&(s=2*this.otstup2+32,this.button1.visible=this.button.visible=!0);var r=this.label.getRect();this.window.height=this.label.y+r.height+s,this.button1.y=this.button.y=this.label.y+r.height+this.otstup2,this.sizeWindow()},this.setFunInput=function(t,i,e,s){this.active=!0,this.fun=s,this.window.text=t,this.label.text=i,this.text=e;var r=this.otstup2;this.button1.visible=this.button.visible=!1,null!=this.fun&&(r=2*this.otstup2+32,this.button1.visible=this.button.visible=!0),this.input.text=e,this.input.visible=!0;var n=this.label.getRect();this.input.y=this.label.y+n.height+5,this.window.height=this.label.y+n.height+r+32+5,this.button1.y=this.button.y=this.label.y+n.height+this.otstup2+32+5,this.sizeWindow()},this.setW=function(t){this.window.width=t,this.label.width=t-2*this.otstup2,this.input.width=t-2*this.otstup2,this.button2.x=t-this.button2.width-this.otstup,this.button1.x=t-this.otstup2-this.button1.width,this.button.x=t-2*this.otstup2-2*this.button1.width},this.setW(300),this.sizeWindow=function(t,r,n){null!=t&&(i=t,e=r,s=n),this._width=i,this._height=e,0!=this._active&&(this.panel.width=i/s,this.panel.height=e/s,this.window.x=(i/s-this.window.width)/2,this.window.y=(e/s-this.window.height)/2)},this.panel.alpha=.4,this.panel.div.addEventListener("mousedown",function(){r.active=!1}),Object.defineProperty(this,"active",{set:function(t){this._active!=t&&(this._active=t,1==t?this.dC.add(this.dCont):this.dC.remove(this.dCont))},get:function(){return this._active}})}e.d(i,"a",function(){return s})},function(t,i,e){"use strict";function s(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function r(t,i){for(var e=0;e<i.length;e++){var s=i[e];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function n(t,i,e){return i&&r(t.prototype,i),e&&r(t,e),t}e.d(i,"a",function(){return a});var a=function(){function t(i,e){s(this,t),this.type="MMani";this.par=i,this.fun=e,this.otstup=this.par.otstup,this.otstup1=this.par.otstup1,this.wh=this.par.wh;var r=0;this.dCont=new DCont(i.dCont),this.window=new DWindow(this.dCont),this.window.width=200,this.window.height=200,this.mmBablo=new o(this,this.window.content,this.otstup,this.otstup,function(t,i,e){}),this.mmBablo.width=this.window.width-2*this.otstup,this.mmBablo.height=this.window.height-2*this.otstup-32,this.setInfoArr=function(t){r++,this.window.title="бабло. Счет: "+r+" : "+t.length,this.mmBablo.setInfoArr(t)},this.sizeWindow=function(t,i,e){this.window.x=t/e/2,this.window.y=10}}return n(t,[{key:"index",set:function(t){if(this._index!=t){this._index=t;for(var i=0;i<this.array.length;i++)i==this._index?this.array[i].active=!0:this.array[i].active=!1}},get:function(){return this._index}}]),t}(),o=function(){function t(i,e,r,n,a){s(this,t),this.type="MMBablo";this.par=i,this.fun=a,this._width=100,this._height=100,this.otstup=this.par.otstup,this.dCont=new DCont(e),this.dCont.x=r,this.dCont.y=n,this.down=function(t,i){},this.gallary=new l(this.dCont,0,0,this.down,this),this.gallary.kolII=1,this.gallary.widthPic=100,this.gallary.heightPic=64,this.gallary.width=this._width,this.gallary.otstup=5,this.gallary.height=200,this.gallary.boolPositOtctup=!1,this.gallary.zScrol=-7;var o=[],u=[];this.setInfoArr=function(t){o=t,this.draw()},this.arrGal=[],this.arrGalCesh=[],this.clearAL=function(){this.arrGal.length=0;for(var t=0;t<this.arrGalCesh.length;t++)this.arrGalCesh[t].clear()},this.getGal=function(){return null==this.arrGalCesh[this.arrGal.length]&&(this.arrGalCesh[this.arrGal.length]=new h),this.arrGal.push(this.arrGalCesh[this.arrGal.length]),this.arrGal[this.arrGal.length-1]},this.clear=function(){this.array.length=0,this.clearAL(),p.length=0,d.length=0,u.length=0,f.length=0;for(var t=0;t<o.length;t++)u.push(o[t])};var c,p=[],d=[],f=[];this.array=[],this.draw=function(){this.clear(),this.drawObj(),this.drawVso(),trace(p),trace(d),this.gallary.start(f)},this.drawVso=function(){for(var t=0;t<d.length;t++)f.push(d[t]);for(t=0;t<f.length;t++)f[t].dragText()},this.drawObj=function(){for(var t=u.length-1;t>=0;t--)"Blok"==u[t].type&&(p.push(u[t]),u.splice(t,1));for(t=0;t<p.length;t++){c=-1;for(var i=0;i<d.length;i++)d[i].obj.obj.id==p[t].obj.id&&(c=i);-1==c?(d.push(this.getGal()),d[d.length-1].setO(p[t])):d[c].setO(p[t])}}}return n(t,[{key:"width",set:function(t){this._width!=t&&(this._width=t,this.gallary.width=t,this.gallary.widthPic=t-2*this.gallary.otstup,this.draw())},get:function(){return this._width}},{key:"height",set:function(t){this._height!=t&&(this._height=t,this.gallary.height=t,this.draw())},get:function(){return this._height}}]),t}(),h=function t(){s(this,t),this.type="MMBGInfo",this.text="infoXZ",this.text1="infoXZ",this.text2="infoXZ",this.text3="infoXZ",this.src="null",this.obj=void 0,this.array=[],this.kol=0,this.clear=function(){this.kol=0,this.obj=void 0,this.array.length=0},this.setO=function(t){this.array.push(t),this.kol=this.array.length,1==this.kol&&(this.obj=t)},this.dragText=function(){"Blok"==this.obj.type&&(this.text="id : "+this.obj.obj.id,this.text1="количество : "+this.kol,this.src="resources/data/"+this.obj.obj.id+"/100.png")}};function l(t,i,e,s,r){DGallery.call(this,t,i,e,s),this.par=r,this.type="DGallary1",this.bRadius=r.bRadius,this.createZamen=function(){return new u(this.content,0,0,this.downBtn,this)}}function u(t,i,e,s,r){DBox.call(this,t,i,e,s),this.type="BXZ1";var n=this;this.par=r,this.label1=new DLabel(this),this.label2=new DLabel(this),this.label3=new DLabel(this),this.arLabel=[this.label,this.label1,this.label2,this.label3];for(var a=0;a<this.arLabel.length;a++)this.arLabel[a].fontSize=12,this.arLabel[a].activMouse=!1;this.startLoad=function(t){this.object=t,trace(this.object),this.image.link=this.object.src,this.label.text=this.object.text,this.label1.text=this.object.text1,this.label2.text=this.object.text2,this.label3.text=this.object.text3,n.funLoad(),this.draw(),n.funLoad()};var o;this.draw=function(){this.image.visible=!1,this.label.x=100,this.label.y=10;var t=this._height;(o=this._width/this.image.picWidth)>(t-2*this._otstup)/this.image.picHeight&&(o=(t-2*this._otstup)/this.image.picHeight),this.image.width=this.image.picWidth*o,this.image.height=this.image.picHeight*o,this.image.x=0,this.image.y=0;for(var i=0;i<this.arLabel.length;i++)this.arLabel[i].y=0==i?this.otstup:this.arLabel[i-1].fontSize+this.arLabel[i-1].y,this.arLabel[i].x=this.image.width+this.otstup,this.arLabel[i].width=this.panel.width-this.arLabel[i].x,this.arLabel[i].visible=!0;this.image.visible=!0,this.postDraw&&this.postDraw()}}l.prototype=Object.create(DGallery.prototype),l.prototype.constructor=l,Object.defineProperties(l.prototype,{index:{set:function(t){this._index!=t&&(this._index=t)},get:function(){return this._index}}}),u.prototype=Object.create(DBox.prototype),u.prototype.constructor=u,Object.defineProperties(u.prototype,{activ:{set:function(t){this._activ!=t&&(this._activ=t,this._activ?this.label.color="#93c32f":this.label.color="#000000",0==this._activ?this.panel.color1=this._color1:this.panel.color1=this._color)},get:function(){return this._activ}}})},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return MVisi3D});var _MEffectArray_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(23),_MPosition3d_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(21),_MEvent3DArr_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(27),_MUtility_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(24),_CubeMap_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(10);function MVisi3D(_contentHTML,_content2d,_devas,_directional,_efect,_event3DArr,_alpha){var self=this;this.contentHTML=_contentHTML,_devas=void 0!==_devas&&_devas,_directional=void 0===_directional||_directional,_efect=void 0===_efect||_efect,_event3DArr=void 0===_event3DArr||_event3DArr,_alpha=void 0!==_alpha&&_alpha,this.intRend=0,this.devas=_devas,this.alpha=_alpha,this.arrSetiScene=[],this._xVerh=0,this._yVerh=0,this._zVerh=0,this._rotationX=0,this._rotationZ=0,this._zume=1e3,this._arrOut=[],this._x=0,this._y=0,this._height=100,this._width=100,this.yes3d=!0,this.intRendOk=1,this._visible=!0,this._isDragPan=!1,this._activMouse=!0,this._staticShadow=!1,this._fov=45,this.alwaysRender=!1,this.AMBIEN_COLOR="#ffffff",this.AMBIEN_INTENSITY=.79,this.LIGHT_COLOR="#ffffff",this.LIGHT_BIAS=.001,this.SHADOW_INTENSITY=.22,this.SHADOW_RADIUS=1,this.SHADOW_WH=4096,this.DISTANCE=0,this.CUB_HEIGHT=500,this.CUB_WIDTH=500,this.FOV=45,this.FAR=45e3,this._fov=this.FOV,this.content=void 0,this.graphics=void 0,this.fun_sob=void 0,null!=_content2d&&(trace("########################"),this.content=eval("new PIXI.Container()"),this.graphics=eval("new PIXI.Graphics()"),_content2d.addChild(this.content),this.content.addChild(this.graphics),this.graphics.interactive=!0),this.camera,this.scene=new THREE.Scene;var color=16777215;this.color=color,this.camera=new THREE.PerspectiveCamera(this.FOV,this._width/this._height,1,this.FAR),this.renderer=new THREE.WebGLRenderer({antialias:!0,alpha:_alpha}),this.renderer.shadowMap.enabled=!0,this.renderer.setSize(this._width,this._height),1==_alpha?this.renderer.setClearColor(color,0):this.renderer.setClearColor(color,1),this.renderer.shadowMap.type=THREE.PCFSoftShadowMap,this.efect,this.efect=new _MEffectArray_js__WEBPACK_IMPORTED_MODULE_0__.a(this),_contentHTML.appendChild(this.renderer.domElement),this.renderer.domElement.style.zIndex=-10,this.event3DArr,1==_event3DArr&&(this.event3DArr=new _MEvent3DArr_js__WEBPACK_IMPORTED_MODULE_2__.a(this,this.camera,_contentHTML),this.scene.event3DArr=this.event3DArr,this.event3DArr.addDragEvent(this.graphics,_contentHTML),this.event3DArr.activ=this._activMouse),this.camera.position.set(0,0,-60),this.camera.rotation.set(Math.PI,0,0),this.renderer.domElement.style.position="fixed",this.renderer.domElement.style.top="0px",this.renderer.domElement.style.left="0px",this.group=new THREE.Object3D,this.group.rotation.x=Math.PI/2,this.scene.add(this.group),this.group1=new THREE.Object3D,this.group.add(this.group1),this.group2=new THREE.Object3D,this.group1.add(this.group2),this.groupObject=new THREE.Object3D,this.group2.add(this.groupObject),this.group3d=new THREE.Object3D,this.groupObject.add(this.group3d),this.gp=new THREE.Object3D,this.gp.rotation.x=Math.PI/2,this.scene.add(this.gp),this.gp1=new THREE.Object3D,this.gp.add(this.gp1),this.gp2=new THREE.Object3D,this.gp1.add(this.gp2),this.gpObject=new THREE.Object3D,this.gp2.add(this.gpObject),this.gpObject2=new THREE.Object3D,this.gp2.add(this.gpObject2),this.gpObject.position.z=1,this.gpObject.scale.set(.001,.001,.001),this.gpObject2.position.z=1,this.gpObject2.scale.set(.001,.001,.001),this.gCGG=new THREE.Object3D,this.group.add(this.gCGG),this.gCAngel=new THREE.Object3D,this.gCGG.add(this.gCAngel),this.gCam1=new THREE.Object3D,this.gCAngel.add(this.gCam1),this.gCam2=new THREE.Object3D,this.gCam1.add(this.gCam2),this.ggCam=new THREE.Object3D,this.gCam2.add(this.ggCam),this.ggCam.add(this.camera),this.ggCam.position.z=-this._zume,this.camera.position.z=0,this.axesHelper=new THREE.AxesHelper(100),this.scene.add(this.axesHelper),this.axesHelper.visible=!1,this.arrPoint=[];var disLig=4e3,powerLig=.4,dis=1e4,bbbbbb;if(this.sunLight,this.ambientLight=new THREE.AmbientLight(this.AMBIEN_COLOR,this.AMBIEN_INTENSITY),this.scene.add(this.ambientLight),this.ambientLight.castShadow=!1,1==_directional){var sunIntensity=this.SHADOW_INTENSITY;this.sunLight=new THREE.DirectionalLight(this.LIGHT_COLOR,sunIntensity,0,0,.2),this.sunLight.position.set(0,this.DISTANCE+2*this.CUB_HEIGHT,0),this.sunLight.castShadow=!0,this.sunLight.shadow.camera.near=this.CUB_HEIGHT,this.sunLight.shadow.camera.far=this.CUB_HEIGHT+2*this.CUB_HEIGHT,this.sunLight.shadow.camera.right=this.CUB_WIDTH,this.sunLight.shadow.camera.left=-this.CUB_WIDTH,this.sunLight.shadow.camera.top=this.CUB_WIDTH,this.sunLight.shadow.camera.bottom=-this.CUB_WIDTH,this.sunLight.shadow.mapSize.width=this.SHADOW_WH,this.sunLight.shadow.mapSize.height=this.SHADOW_WH,this.sunLight.shadow.bias=this.LIGHT_BIAS,this.sunLight.shadow.radius=this.SHADOW_RADIUS}this.initOut=function(){},this.position3d=new _MPosition3d_js__WEBPACK_IMPORTED_MODULE_1__.a(self,this.graphics,this.renderer.domElement),this.utility=new _MUtility_js__WEBPACK_IMPORTED_MODULE_3__.a(self),this.arrayDoRender=[],this.arrayDoRender2=[],this.shadowNeedsUpdate=!1,this.render=function(){if(0!=this.yes3d){if(0!=this.arrayDoRender2.length)for(var t=0;t<this.arrayDoRender2.length;t++)this.arrayDoRender2[t]();if(this.utility.render(),this.intRend=10,this.shadowNeedsUpdate&&(this.shadowNeedsUpdate=!1,this.renderer.shadowMap.needsUpdate=!0),this.efect?0==this.efect.render()&&this.renderer.render(this.scene,this.camera):this.renderer.render(this.scene,this.camera),0!=this.arrayDoRender.length)for(t=0;t<this.arrayDoRender.length;t++)this.arrayDoRender[t]()}},this.upDate=function(){(this.alwaysRender||this.intRend==this.intRendOk)&&this.render(),this.intRend<10&&this.intRend++},this.renderer.render(this.scene,this.camera),this.sizeWindow=function(t,i,e,s){null!=t&&(this._x=t),null!=i&&(this._y=i),null!=s&&(this._height=s),null!=e&&(this._width=e),null!=this.content&&(this.content.x=this._x,this.content.y=this._y,this.graphics.clear(),this.graphics.beginFill(16711680,0),this.graphics.drawRect(0,0,this._width,this._height),this.graphics.endFill()),this.renderer.domElement.style.left=this._x+"px",this.renderer.domElement.style.top=this._y+"px",this.camera.aspect=this._width/this._height,this.camera.updateProjectionMatrix(),this.renderer.setSize(this._width,this._height),this.intRend=1;var r=87e-5*this.camera.aspect;this.gpObject2.scale.set(r,87e-5,1),this.gpObject.scale.set(r/(this._width/1e3),87e-5/(this._height/1e3),1),this.event3DArr&&(this.event3DArr.sizeWindow(this._width,this._height),this.event3DArr.setRect(this._x,this._y,this._width,this._height)),this.efect&&this.efect.sizeWindow(this._width,this._height)},this.render(),this.sizeWindow(),this.objShadow=function(t,i){if(null==i&&(i=!0),bbbbbb=!0,t.material&&1==t.material.transparent&&t.material.opacity<1&&(bbbbbb=!1),1==bbbbbb&&(t.castShadow=i,t.receiveShadow=i),null!=t.children)for(var e=0;e<t.children.length;e++)null!=t.children?this.objShadow(t.children[e],i):(bbbbbb=!0,t.children[e].material&&1==t.material.transparent&&t.material.opacity<1&&(bbbbbb=!1),1==bbbbbb&&(t.children[e].castShadow=i,t.children[e].receiveShadow=i))},this.cubeMap=new _CubeMap_js__WEBPACK_IMPORTED_MODULE_4__.a,this.cubeMap.init(this.renderer,this.scene),this.getEnvMap=function(){return self.cubeMap.getTexture()},this.cubeMap1=new _CubeMap_js__WEBPACK_IMPORTED_MODULE_4__.a,this.cubeMap1.init(this.renderer,this.scene);var t=this.cubeMap1.getTexture();t.mapping=THREE.CubeRefractionMapping,this.cubeMap1.upDate(),this.getEnvMap1=function(){return self.cubeMap1.getTexture()},this.getObj=function(){var t={};return t.xVerh=this._xVerh,t.yVerh=this._yVerh,t.zVerh=this._zVerh,t.rotationX=this._rotationX,t.rotationZ=this._rotationZ,t.zume=this._zume,t},this.setObj=function(t){null!=t&&(this.xVerh=t.xVerh,this.yVerh=t.yVerh,this.zVerh=t.zVerh,this.rotationX=t.rotationX,this.rotationZ=t.rotationZ,this.zume=t.zume)},this.mousemove=function(t){self.position3d.stageMoveNew(t),self.event3DArr.mousemove(t)},this.getFunMouseMove=function(){return 0==self.devas?self.position3d.div.removeEventListener("mousemove",self.mousemove):self.position3d.div.removeEventListener("touchmove",self.mousemove),self.mousemove},null==_content2d?0==self.devas?self.position3d.div.addEventListener("mousemove",self.mousemove):self.position3d.div.addEventListener("touchmove",self.mousemove):(self.stageM2=function(t){self.position3d.stageMoveNew(t.data.originalEvent),self.event3DArr.mousemove(t.data.originalEvent)},0==self.devas?this.graphics.on("mousemove",self.stageM2):this.graphics.on("touchmove",self.stageM2)),document.oncontextmenu=function(t){return!1},this.addEvent=function(t,i){this.event3DArr&&this.event3DArr.eventSob.addEvent(t,i)},this.removeEvent=function(t,i){this.event3DArr&&this.event3DArr.eventSob.removeEvent(t,i)},this.addChildMouse=function(t){this.event3DArr&&this.event3DArr.addChild(t)},this.removeChildMouse=function(t){this.event3DArr&&this.event3DArr.removeChild(t)},this.fun_rotationX,this.fun_rotationZ}MVisi3D.prototype={set staticShadow(t){this.renderer.shadowMap.autoUpdate=!t,this._staticShadow=t},get staticShadow(){return this._staticShadow},set rotationX(t){this._rotationX!==t&&(this._rotationX=t,this.intRend=1,this.gCam2.rotation.x=t,this.gp2.rotation.x=t,this.fun_rotationX&&this.fun_rotationX())},get rotationX(){return this._rotationX},set rotationZ(t){this._rotationZ!==t&&(this._rotationZ=t,this.gCam1.rotation.z=t,this.gp1.rotation.z=t,this.intRend=1,this.fun_rotationZ&&this.fun_rotationZ())},get rotationZ(){return this._rotationZ},set zume(t){this._zume!==t&&(this.gpObject.position.z=1-t,this.gpObject2.position.z=1-t,this._zume=t,this.ggCam.position.z=-t,this.camera.position.z=0,this.intRend=1)},get zume(){return this._zume},set fov(t){this._fov=t,this.camera.fov=t,this.camera.updateProjectionMatrix()},get fov(){return this._fov},set yVerh(t){this._yVerh=t,this.gCGG.position.z=t,this.intRend=1},get yVerh(){return this.gCGG.position.z},set xVerh(t){this._xVerh=t,this.gCGG.position.x=t,this.intRend=1},get xVerh(){return this.gCGG.position.x},set zVerh(t){this._zVerh=t,this.gCGG.position.y=t,this.intRend=1},get zVerh(){return this.gCGG.position.y},set arrOut(t){this._arrOut=t,1!=this.alpha&&(this.efect&&this.efect.setValue(this._arrOut),this.intRend=1)},get arrOut(){return this._arrOut},set x(t){this._x=t,this.sizeWindow()},get x(){return this._x},set y(t){this._y=t,this.sizeWindow()},get y(){return this._y},set height(t){this._height=t,this.sizeWindow()},get height(){return this._height},set width(t){this._width=t,this.sizeWindow()},get width(){return this._width},set visible(t){this._visible=t,this.content.visible=t,this.renderer.domElement.style.visibility=t?"visible":"hidden"},get visible(){return this._visible},set isDragPan(t){this._isDragPan=t,this.position3d.isDragPan=t},get isDragPan(){return this._isDragPan},set activMouse(t){this._activMouse=t,this.event3DArr&&(this.event3DArr.activ=this._activMouse)},get activMouse(){return this._activMouse},set minZum(t){this.position3d.minZum=t},get minZum(){return this.position3d.minZum},set maxZum(t){this.position3d.maxZum=t},get maxZum(){return this.position3d.maxZum},set maxRotationX(t){this.position3d.minMaxX.x=t},get maxRotationX(){return this.position3d.minMaxX.x},set minRotationX(t){t<this.rotationX&&(this.rotationX=t),this.position3d.minMaxX.y=t},get minRotationX(){return this.position3d.minMaxX.y}}},function(t,i,e){"use strict";function s(t,i,e){var s=this;this.parent=t,this.content2d=i,this.drag=!0,this.zdvigX=0,this.sPixi=void 0,this.div=e,this.devas=t.devas,this.pause=!1,this.minMaxX=new THREE.Vector2(0,2.5),this.zume=new THREE.Vector3(1,30,10),this.point=new THREE.Vector2(0,0),this.point1=new THREE.Vector2(0,0),this.b=0,this.minZum=0,this.maxZum=5e3,this.powerZum=50,this.distMinMaxBox=1e4,this.boolDrahXZ=!0,this.isDragPan=t._isDragPan,this.isRotateScene=!1;var r=0;this.isIE=!1,(-1!==navigator.userAgent.indexOf("MSIE")||navigator.appVersion.indexOf("Trident/")>0)&&(this.isIE=!0),this.getStage=function(t){return null==t.parent?t:this.getStage(t.parent)},this.stageMoveNew=function(t){0!=s.boolDrag&&1!=s.pause&&0!=s.drag&&(t&&s.isDragPan&&h?d(t):(null==t.touches?s.isRotateScene&&t.data.originalEvent.shiftKey?(s.parent.scene.rotation.y=r+.01*(t.clientX-s.point1.x),s.parent.intRend=1):s.boolDrahXZ&&(s.parent.rotationX=s.point.y-.01*(t.clientY-s.point1.y),s.minMaxX.x>s.parent.rotationX&&(s.parent.rotationX=s.minMaxX.x),s.minMaxX.y<s.parent.rotationX&&(s.parent.rotationX=s.minMaxX.y),s.parent.rotationZ=s.point.x+.01*(t.clientX-s.point1.x)):1==t.touches.length?s.boolDrahXZ&&(s.parent.rotationX=s.point.y-.01*(t.touches[0].clientY-s.point1.y),s.minMaxX.x>s.parent.rotationX&&(s.parent.rotationX=s.minMaxX.x),s.minMaxX.y<s.parent.rotationX&&(s.parent.rotationX=s.minMaxX.y),s.parent.rotationZ=s.point.x+.01*(t.touches[0].clientX-s.point1.x)):t.touches.length>=2&&(s.pT.x=t.touches[0].clientX,s.pT.y=t.touches[0].clientY,s.pT1.x=t.touches[1].clientX,s.pT1.y=t.touches[1].clientY,0==s.distTach?(s.distTach=calc.getDistance(s.pT,s.pT1),n=0,u.set(Math.round(1*s.pT.x),Math.round(1*s.pT.y))):(a=calc.getDistance(s.pT,s.pT1),n=a-s.distTach,s.distTach=a),o=s.parent._zume-n*(s.parent._zume/100),s.zumNEW(o),d(null,Math.round(1*s.pT.x),Math.round(1*s.pT.y))),s.parent.fun_sob&&s.parent.fun_sob("mouseMove")))},this.pT=new THREE.Vector2(0,0),this.pT1=new THREE.Vector2(0,0);var n=0,a=0;this.boolDrag=!1,this.stageUpNew=function(t){s.boolDrag=!1,0==s.devas?window.removeEventListener("mouseup",s.stageUpNew):(s.distTach=0,window.removeEventListener("touchend",s.stageUpNew)),s.parent.fun_sob&&s.parent.fun_sob("mouseUp")},this.mouseUpp=function(t){s.parent.intRend=1};var o,h=!1;if(this.distTach=0,this.mouseDown=function(t){var i;1!=s.pause&&(0!=s.drag&&(h=!1,s.boolDrag=!0,s.parent.fun_sob&&s.parent.fun_sob("mouseDown"),s.distTach=0,s.point.y=s.parent.rotationX,s.point.x=s.parent.rotationZ,s.isRotateScene&&(r=s.parent.scene.rotation.y),s.isDragPan&&t&&1===t.button&&(h=!0,i=t,u.set(i.clientX,i.clientY)),0==s.devas?(s.point1.x=t.clientX,s.point1.y=t.clientY,window.addEventListener("mouseup",s.stageUpNew)):(s.point1.x=t.touches[0].clientX,s.point1.y=t.touches[0].clientY,window.addEventListener("touchend",s.stageUpNew))))},this.dragscrol=void 0,this.mousewheel=function(t){if(0!=s.drag){var i=-1;t.delta;null==t.wheelDelta&&t.wheelDelta,t.delta&&t.delta<0&&(i=1),t.deltaY&&t.deltaY<0&&(i=1),t.detail&&t.detail<0&&(i=1),null!=t.wheelDelta&&(i=t.wheelDelta>0?-1:1),o=s.parent._zume+i*(s.powerZum/100)*s.parent._zume,s.zumNEW(o),s.dragscrol&&s.dragscrol(t)}},this.zumNEW=function(t){t<s.minZum&&(t=s.minZum),t>s.maxZum&&(t=s.maxZum),s.parent.zume=t,s.parent.intRend=1},this.mouseDown2=function(t){s.mouseDown(t.data.originalEvent)},null!=this.content2d)if(this.sPixi=this.content2d,this.sPixi.interactive=!0,0==s.devas){this.content2d.on("mousedown",this.mouseDown2);document.addEventListener("mousewheel",this.mousewheel),document.addEventListener("DOMMouseScroll",this.mousewheel)}else this.content2d.on("touchstart",this.mouseDown2);else if(0==s.devas){e.addEventListener("mousedown",this.mouseDown);e.addEventListener("mousewheel",this.mousewheel),e.addEventListener("DOMMouseScroll",this.mousewheel)}else e.addEventListener("touchstart",this.mouseDown,{passive:!1,capture:!0});var l=new THREE.Vector3,u=new THREE.Vector2,c=new THREE.Vector2,p=new THREE.Vector2;function d(t,i,e){null!=t?c.set(t.clientX,t.clientY):c.set(i,e),p.subVectors(c,u),s.moveCamXY(p),u.copy(c)}var f=function(){var t=new THREE.Vector3;return function(i,e){t.setFromMatrixColumn(e,0),t.multiplyScalar(-i),l.add(t)}}(),g=function(){var t=new THREE.Vector3;return function(i,e){t.setFromMatrixColumn(e,1),t.multiplyScalar(i),l.add(t)}}(),A=function(t,i){var e=s.parent.renderer.domElement;if(s.parent.camera.isPerspectiveCamera){var r=Math.max(s.parent.zume,10);r*=Math.tan(s.parent.camera.fov/2*Math.PI/180),f(2*t*r/e.clientHeight,s.parent.camera.matrixWorld),g(2*i*r/e.clientHeight,s.parent.camera.matrixWorld)}else console.warn("WARNING: camera neither perspective.")};this.moveCamXY=function(t){l.set(0,0,0),s.parent.camera.updateMatrixWorld(),s.parent.scene.updateMatrixWorld(),arguments.length>1&&(t={x:arguments[0],y:arguments[1]}),A(t.x||0,t.y||0),s.parent.xVerh+=l.x,s.parent.yVerh+=-l.y,s.parent.zVerh+=l.z,s.parent.xVerh=Math.max(Math.min(s.parent.xVerh,s.distMinMaxBox),-s.distMinMaxBox),s.parent.zVerh=Math.max(Math.min(s.parent.zVerh,s.distMinMaxBox),-s.distMinMaxBox),s.parent.yVerh=Math.max(Math.min(s.parent.yVerh,s.distMinMaxBox),-s.distMinMaxBox),l.set(0,0,0)}}e.d(i,"a",function(){return s})},function(t,i,e){"use strict";var s=e(0);function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function n(t,i){for(var e=0;e<i.length;e++){var s=i[e];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function a(t){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function o(t,i){return(o=Object.setPrototypeOf||function(t,i){return t.__proto__=i,t})(t,i)}function h(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var l=function(t){function i(t,e){var s;!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,i),(s=function(t,i){return!i||"object"!==r(i)&&"function"!=typeof i?h(t):i}(this,a(i).call(this,t,e))).type="MOPoint",s.typeNa="SpPointSten";var n=h(h(s));return s.whSize=5555555,s.dCont=new DCont(t.dCont),s.button=void 0,s.slid,s.slid1,s.bool=!0,s.postIn=function(){this.window.title="Point",this.button=new DButton(this.window.content,this.otstup1,this.otstup1,"",function(){n.bool=!1,n.object.clear()},"resources/image/p0.png"),this.button.width=this.button.height=this.wh,this.slid=new DSliderBig(this.window.content,this.otstup1,this.otstup1+1*(this.otstup1+this.wh),function(t){n.bool=!1,n.object.position.x=n.slid.value},"x",-this.whSize/2,this.whSize/2),this.slid.width=this.width-2*this.otstup1,this.slid.okrug=1,this.slid.funChange=function(){n.bool=!0,n.drag()},this.slid1=new DSliderBig(this.window.content,this.otstup1,this.otstup1+2*(this.otstup1+this.wh),function(t){n.bool=!1,n.object.position.y=n.slid1.value},"y",-this.whSize/2,this.whSize/2),this.slid1.width=this.width-2*this.otstup1,this.window.height=210,this.slid1.okrug=1,this.slid1.funChange=function(){n.bool=!0,n.drag()}},s.drag=function(){0!=n.bool&&(n.slid.min=n.object.position.x-500,n.slid.max=n.object.position.x+500,n.slid.value=Math.round(n.object.position.x),n.slid1.min=n.object.position.y-500,n.slid1.max=n.object.position.y+500,n.slid1.value=Math.round(n.object.position.y))},s.postSO=function(){this.bool=!0,this.object.funDragMenu=this.drag,this.object.par.setActive(this.object),this.window.title="MOPoint  "+this.object.idArr,this.drag()},s.clear=function(){null!=this.object&&(this.bool=!0,this.object.funDragMenu=void 0),this.active=!1},s.sizeWindow=function(t,i,e){this.dCont.x=t/e-this.width},s}var e,l,u;return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&o(t,i)}(i,s["a"]),e=i,(l=[{key:"index",set:function(t){this._index!=t&&(this._index=t)}}])&&n(e.prototype,l),u&&n(e,u),i}(),u=e(15);function c(t){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function p(t,i){for(var e=0;e<i.length;e++){var s=i[e];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function d(t){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function f(t,i){return(f=Object.setPrototypeOf||function(t,i){return t.__proto__=i,t})(t,i)}function g(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var A=function(t){function i(t,e){var s;!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,i),(s=function(t,i){return!i||"object"!==c(i)&&"function"!=typeof i?g(t):i}(this,d(i).call(this,t,e))).type="MOSp",s.typeNa="SpStageSten";var r=g(g(s));return s.whSize=5555555,s.dCont=new DCont(t.dCont),s.button=void 0,s.slid,s.slid1,s.bool=!0,s.postIn=function(){this.window.title="SP";var t=this.otstup1;this.slidH=new DSliderBig(this.window.content,this.otstup1,t,function(t){r.bool=!1,r.object.height=this.value},"height",1,5e3),this.slidH.width=this.width-2*this.otstup1,this.slidH.okrug=1,t+=this.otstup1+this.wh,this.slidH1=new DSliderBig(this.window.content,this.otstup1,t,function(t){r.bool=!1,r.object.height1=this.value},"height1",0,2e3),this.slidH1.width=this.width-2*this.otstup1,this.slidH1.okrug=100,t+=this.otstup1+this.wh,this.button=new DButton(this.window.content,this.otstup1,t,"Взять сверху",function(){r.object.metod.getFloor(r.object.par.array[r.object.idArr+1])}),this.button.width=this.width-2*this.otstup1,t+=this.otstup1+32,this.window.height=210},s.drag=function(){0!=r.bool&&(r.slidH.value=r.object.height,r.slidH1.value=r.object.height1)},s.postSO=function(){this.bool=!0,this.drag()},s.clear=function(){null!=this.object&&(this.bool=!0,this.object.funDragMenu=void 0),this.active=!1},s.sizeWindow=function(t,i,e){this.dCont.x=t/e-this.width},s}var e,r,n;return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&f(t,i)}(i,s["a"]),e=i,(r=[{key:"index",set:function(t){this._index!=t&&(this._index=t)}}])&&p(e.prototype,r),n&&p(e,n),i}();function y(t){return(y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function x(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function m(t,i){return!i||"object"!==y(i)&&"function"!=typeof i?P(t):i}function v(t){return(v=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function b(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&w(t,i)}function w(t,i){return(w=Object.setPrototypeOf||function(t,i){return t.__proto__=i,t})(t,i)}function P(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var _=function(t){function i(t,e){var s;x(this,i),(s=m(this,v(i).call(this,t,e))).type="MOLine",s.typeNa="SPLine";var r=P(P(s));return s.dCont=new DCont(t.dCont),s.button=void 0,s.slid,s.slid1,s.postIn=function(){this.window.title="SPLine";var t=this.otstup1;this.button=new DButton(this.window.content,this.otstup1,t,"",function(){r.object.clear()},"resources/image/p0.png"),this.button.width=this.button.height=this.wh,t+=this.otstup1+this.wh,this.slid=new DSliderBig(this.window.content,this.otstup1,t,function(t){r.object.otstup=r.slid.value},"otstup",-2e3,2e3),this.slid.width=this.width-2*this.otstup1,this.slid.okrug=1,t+=50,this.window.height=t+32},s.drag=function(){r.slid.value=r.object.otstup},s.postSO=function(){this.object.funDragMenu=this.drag,this.window.title="SPLine "+this.object.idArr,this.drag()},s.clear=function(){null!=this.object&&(this.object.funDragMenu=void 0),this.active=!1},s.sizeWindow=function(t,i,e){this.dCont.x=t/e-this.width},s}return b(i,s["a"]),i}();function S(t){return(S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function I(t,i){for(var e=0;e<i.length;e++){var s=i[e];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function C(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function E(t){return(E=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function T(t,i){return(T=Object.setPrototypeOf||function(t,i){return t.__proto__=i,t})(t,i)}function M(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var D=function(t){function i(t,e){var s;C(this,i),(s=function(t,i){return!i||"object"!==S(i)&&"function"!=typeof i?M(t):i}(this,E(i).call(this,t,e))).type="MOP20",s.typeNa="P20";var r=M(M(s));return s.otstup=5,s.wh=32,s.dCont=new DCont(t.dCont),s.bool=!0,s.button=void 0,s.postIn=function(){this.window.title="P20",this.button=new DButton(this.window.content,this.otstup,this.otstup,"Добавить этаж",function(){r.object.creatFloor(),r.drag()}),this.button.width=this.window.width-2*this.otstup,this.button.height=this.wh,this.image=new DImage(this.button,this.otstup,this.otstup,"../resources/image/plus.png"),this.image.height=this.image.width=this.wh-this.otstup},s.array=[],s.arrayF=[],s.getM20Gron=function(){},s.sobbb=function(t,i,e){"index"==t&&(r.object.index=i),"clear"==t&&r.object.clearFloor(i),r.drag(i)},s.drag=function(t){if(0!=r.bool){for(var i=0;i<r.array.length;i++)r.array[i].active=!1,r.array[i].bool=!1;for(i=0;i<r.object.array.length;i++)null==r.array[i]&&(r.array[i]=new R(r,i,r.sobbb)),r.array[i].active=i!=r.object.index,r.array[i].bool=i==r.object.index,r.array[i].setObject(r.object.array[i]),0!=i&&(r.array[i].y=r.array[i-1].y+r.array[i-1].height),(r.object.array.length<=2||0==i)&&(r.array[i].button1.activMouse=!1),r.object.array.length>2&&0!=i&&(r.array[i].button1.activMouse=!0);var e=r.array[r.object.array.length-1].y+r.array[r.object.array.length-1].height;this.button.y=e,r.object.array.length>=5?(this.button.activMouse=!1,this.button.visible=!1):(this.button.activMouse=!0,this.button.visible=!0,e=this.button.y+this.button.height+this.otstup+32),this.window.height=e}},s.postSO=function(){this.bool=!0,this.object.sp.setActive(),this.drag()},s.clear=function(){null!=this.object&&(this.bool=!0,this.object.funDragMenu=void 0),this.active=!1},s.sizeWindow=function(t,i,e){this.dCont.x=t/e-this.width},s}return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&T(t,i)}(i,s["a"]),i}(),R=function(){function t(i,e,s,r){C(this,t),this.type="M20Gron";var n=this;this.par=i,this.idArr=e,this.otstup=i.otstup,this.height=0,this.wh=i.wh,this._y=e*this.wh+this.otstup,this._butText=this.par.object.name,this._active=!0,this.dCont=new DCont(i.window.content),this.dCont.visible=this._active,this.dCont.x=this.otstup,this.dCont.y=this._y,this.button=new DButton(this.dCont,0,0,this._butText,function(){s("index",n.idArr)},"../resources/image/floor"+e+".png"),this.button.width=i.window.width-2*this.otstup,this.button.color=dcmParam.color,this.object,this.setObject=function(t){this.object=t;var i="этаж:"+n.idArr;null!=this.object.name?"xzStart"==this.object.name&&(this.object.name=i):this.object.name=i,this.input.text=this.button.text=this.object.name},this.dCont.height=this.button.height+this.otstup,this._bool=!1,this.dCont1=new DCont(i.window.content),this.dCont1.visible=this._bool,this.dCont1.x=this.otstup,this.dCont1.y=this._y,this.panel=new DPanel(this.dCont1,0,0),this.panel.height=2*this.wh+3*this.otstup,this.panel.width=i.window.width-2*this.otstup,this.panel.color=dcmParam.activButton,this.image1=new DImage(this.panel.content,0,this.otstup,"../resources/image/floor"+e+".png"),this.image1.height=this.image1.width=this.wh-this.otstup,this.input=new DInput(this.panel.content,2*this.otstup+this.image1.width-2,this.otstup,this._butText,function(){n.object.name=this.value}),this.input.width=this.panel.width-this.image1.width-3*this.otstup,this.input.timeFun=1,this.button1=new DButton(this.panel.content,this.panel.width-this.wh-this.otstup,this.input.height+2*this.otstup,"X",function(){s("clear",n.idArr)},"../resources/image/p0.png"),this.button1.width=this.wh,this.dCont1.height=this.panel.height+this.otstup,this.height=1==this._active?this.dCont.height:this.dCont1.height}var i,e,s;return i=t,(e=[{key:"active",set:function(t){this._active!=t&&(this._active=t,this.dCont.visible=t,1==this._active&&(this.height=this.dCont.height))},get:function(){return this._active}},{key:"bool",set:function(t){this._bool!=t&&(this._bool=t,this.dCont1.visible=t,1==this._bool&&(this.height=this.dCont1.height))},get:function(){return this._bool}},{key:"y",set:function(t){this._y!=t&&(this._y=t,this.dCont.y=t,this.dCont1.y=t)},get:function(){return this._y}},{key:"butText",set:function(t){this._butText!=t&&(this._butText=t,this.button.text=t,this.input.text=t)},get:function(){return this._butText}}])&&I(i.prototype,e),s&&I(i,s),t}();function L(t,i){for(var e=0;e<i.length;e++){var s=i[e];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}var O=function(){function t(i,e){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,t);var s=this;this.type="MOWUnik",this.par=i,this._active=!1,this.fun=e,this.otstup=this.par.otstup,this.dCont=new DCont(this.par.window.content),this.pObject=new DParamObject(this.dCont,this.otstup+.5,0,function(){s.postSO()},!1),this.drag=function(){},this.postSO=function(){if(null==this.par.object)return this.dCont.visible=!1,void(this.active=!1);null==this.par.object.unik&&null==this.par.object.unik1?(this.dCont.visible=!1,this.active=!1):(null!=this.par.object.unik&&(this.pObject.usingShablon=this.par.object.unik.arrayInfo,this.pObject.addObject(this.par.object.unik)),null!=this.par.object.unik1&&(this.pObject.usingShablon=this.par.object.unik1.arrayInfo,this.pObject.addObject(this.par.object.unik1)),this.dCont.visible=!0,this.active=!0),this.height=this.pObject.height+4}}var i,e,s;return i=t,(e=[{key:"active",set:function(t){this._active!=t&&(this._active=t)},get:function(){return this._active}}])&&L(i.prototype,e),s&&L(i,s),t}();function B(t){return(B="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function j(t,i){for(var e=0;e<i.length;e++){var s=i[e];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function F(t){return(F=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function k(t,i){return(k=Object.setPrototypeOf||function(t,i){return t.__proto__=i,t})(t,i)}function H(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var z=function(t){function i(t,e){var s;!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,i),(s=function(t,i){return!i||"object"!==B(i)&&"function"!=typeof i?H(t):i}(this,F(i).call(this,t,e))).type="MOWindow",s.typeNa="BInSten";var r=H(H(s));return s.whSize=5555555,s.dCont=new DCont(t.dCont),s.mowUnik,s.button=void 0,s.slid,s.slid1,s.bool=!0,s.arrBut=[],s.arrButLink=["resources/image/p1.png","resources/image/p1.png","resources/image/p1.png","resources/image/p0.png"],s.postIn=function(){this.window.title="Blok";this.otstup1;this.window.width=200+2*this.otstup1,this.wh=(this.window.width-this.otstup1)/this.arrButLink.length-this.otstup1;for(var t=this.otstup1,i=0;i<this.arrButLink.length;i++)this.arrBut[i]=new DButton(this.window.content,t,this.otstup1,"",void 0,this.arrButLink[i]),this.arrBut[i].width=this.arrBut[i].height=this.wh,this.arrBut[i].idArr=i,3==i&&(this.arrBut[i].fun=function(){r.bool=!1,r.object.clear()}),t+=this.otstup1+this.wh;this.mowUnik=new O(this,function(t,i){}),this.mowUnik.dCont.y=this.arrBut[0].y+this.wh+this.otstup1,this.yy=this.arrBut[0].y+this.wh+2*this.otstup1+32,this.window.height=this.yy},s.drag=function(){r.bool},s.postSO=function(){this.bool=!0,this.drag(),this.window.title="Blok: "+this.object.idArr,this.object._parent&&this.object._parent.par.par.setActive(this.object),null!=r.mowUnik.postSO&&this.mowUnik.postSO(),this.yy=this.arrBut[0].y+this.wh+2*this.otstup1+32+this.mowUnik.height,this.window.height=this.yy},s.clear=function(){null!=this.object&&(this.bool=!0,this.object.funDragMenu=void 0),this.active=!1},s.sizeWindow=function(t,i,e){this.dCont.x=t/e-this.width},s}var e,r,n;return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&k(t,i)}(i,s["a"]),e=i,(r=[{key:"index",set:function(t){this._index!=t&&(this._index=t)}}])&&j(e.prototype,r),n&&j(e,n),i}();function N(t){return(N="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function G(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function X(t,i){for(var e=0;e<i.length;e++){var s=i[e];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function U(t){return(U=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function V(t,i){return(V=Object.setPrototypeOf||function(t,i){return t.__proto__=i,t})(t,i)}function Q(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var Y=function(t){function i(t,e){var s;G(this,i),(s=function(t,i){return!i||"object"!==N(i)&&"function"!=typeof i?Q(t):i}(this,U(i).call(this,t,e))).type="MOGroup",s.typeNa="SPGroup";var r=Q(Q(s));return s.whSize=5555555,s.dCont=new DCont(t.dCont),s.button=void 0,s.slid,s.slid1,s.bool=!0,s.postIn=function(){this.window.title="GROUP";this.otstup1;this.button=new DButton(this.window.content,this.window.width-this.otstup1-this.wh,this.otstup1,"",function(){r.bool=!1,r.object.clear(),r.active=!1},"resources/image/p0.png"),this.button.width=this.button.height=this.wh,this.window.height=210,this.mogObj=new W(this,function(t,i){})},s.drag=function(){0!=r.bool&&(r.mogObj.drag(),r.object.par.setActive(r.object.array),r.window.height=r.mogObj.height+32+2*r.otstup1+r.wh)},s.postSO=function(){this.bool=!0,this.object.funDragMenu=this.drag,this.drag()},s.clear=function(){null!=this.object&&(this.bool=!0,this.object.funDragMenu=void 0),this.active=!1},s.sizeWindow=function(t,i,e){this.dCont.x=t/e-this.width},s}var e,r,n;return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&V(t,i)}(i,s["a"]),e=i,(r=[{key:"index",set:function(t){this._index!=t&&(this._index=t)}}])&&X(e.prototype,r),n&&X(e,n),i}(),W=function t(i,e){G(this,t);var s=this;this.par=i,this.fun=e,this.height=0,this.otstup=this.par.otstup1,this.otstup1=this.par.otstup1,this.whSize=5555555,this.width=this.par.window.width-2*this.otstup,this.wh=(this.width-this.otstup)/4-this.otstup,this.arrSt=[],this.arrWin=[],this.arrPoint=[];var r,n,a,o,h,l,u,c={};this.dCont=new DCont(this.par.window.content),this.dCont.y=2*this.otstup+this.par.wh,this.panelSt=void 0,this.init=function(){if(null==this.panelSt){var t;this.panelSt=new DPanel(this.dCont,this.otstup,0),this.panelSt.width=this.par.window.width-2*this.otstup,this.panelSt.height=this.wh+this.otstup+20,this.labelSt=new DLabel(this.panelSt,this.otstup,this.otstup,""),this.labelSt.fontSize=12,this.labelSt.width=this.width;this.otstup1;var i=this.otstup1;r=["carrier","out","adjacent"];for(var e=0;e<r.length;e++)c[r[e]]={},c[r[e]][0]=new DButton(this.panelSt,i,20,"",function(){trace(this.name,this.param,s.arrSt.length);for(var i=0;i<s.arrSt.length;i++)(t=s.arrSt[i])[this.name]=this.param,t._addPoint.dragGG(),t._addPoint1.dragGG(),s.drag();t.par[this.name]=this.param},"resources/image/sten_"+r[e]+"0.png"),c[r[e]][0].width=c[r[e]][0].height=this.wh,c[r[e]][0].name=r[e],c[r[e]][0].param=!1,c[r[e]][1]=new DButton(this.panelSt,i,20,"",function(){for(var i=0;i<s.arrSt.length;i++)(t=s.arrSt[i])[this.name]=this.param,t._addPoint.dragGG(),t._addPoint1.dragGG(),s.drag();t.par[this.name]=this.param},"resources/image/sten_"+r[e]+"1.png"),c[r[e]][1].width=c[r[e]][1].height=this.wh,c[r[e]][1].name=r[e],c[r[e]][1].param=!0,i+=this.otstup1+this.wh;this.butClearSt=new DButton(this.panelSt,this.panelSt.width-this.otstup1-this.wh,20,"",function(){s.clearSim("SpliceSten")},"resources/image/p0.png"),this.butClearSt.width=this.butClearSt.height=this.wh,this.panelWin=new DPanel(this.dCont,this.otstup,0),this.panelWin.width=this.par.window.width-2*this.otstup,this.panelWin.height=this.wh+this.otstup+20,this.labelWin=new DLabel(this.panelWin,this.otstup,this.otstup,""),this.labelWin.fontSize=12,this.labelWin.width=this.width,this.butClearWin=new DButton(this.panelWin,this.panelSt.width-this.otstup1-this.wh,20,"",function(){s.clearSim("BInSten")},"resources/image/p0.png"),this.butClearWin.width=this.butClearWin.height=this.wh,this.panelPoint=new DPanel(this.dCont,this.otstup,0),this.panelPoint.width=this.par.window.width-2*this.otstup,this.panelPoint.height=this.wh+this.otstup+20,this.labelPoint=new DLabel(this.panelPoint,this.otstup,this.otstup,""),this.labelPoint.fontSize=12,this.labelPoint.width=this.width,this.butClearPoint=new DButton(this.panelPoint,this.panelSt.width-this.otstup1-this.wh,20,"",function(){s.clearSim("SpPointSten")},"resources/image/p0.png"),this.butClearPoint.width=this.butClearPoint.height=this.wh,this.slid=new DSliderBig(this.panelPoint,this.otstup1,20,function(t){s.par.bool=!1;for(var i=0;i<s.arrPoint.length;i++)s.arrPoint[i].position.x=this.value,s.arrPoint[i].doFunRend();s.par.object.korektRect(!0)},"x",-this.whSize/2,this.whSize/2),this.slid.width=this.width-3*this.otstup1-this.wh,this.slid.okrug=1,this.slid.funChange=function(){s.par.bool=!0,s.par.drag()},this.slid1=new DSliderBig(this.panelPoint,this.otstup1,70,function(t){s.par.bool=!1;for(var i=0;i<s.arrPoint.length;i++)s.arrPoint[i].position.y=this.value,s.arrPoint[i].doFunRend();s.par.object.korektRect(!0)},"y",-this.whSize/2,this.whSize/2),this.slid1.width=this.width-3*this.otstup1-this.wh,this.slid1.okrug=1,this.slid1.funChange=function(){s.par.bool=!0,s.par.drag()},this.slid2=new DSliderBig(this.panelPoint,this.otstup1,120,function(t){s.par.bool=!1;for(var i=0;i<s.arrPoint.length;i++)s.arrPoint[i].position.z=this.value,s.arrPoint[i].doFunRend();s.par.object.korektRect(!0)},"z",-this.whSize/2,this.whSize/2),this.slid2.width=this.width-3*this.otstup1-this.wh,this.slid2.okrug=1,this.slid2.funChange=function(){s.par.bool=!0,s.par.drag()}}},this.clearSim=function(t){for(var i=s.par.object.array.length-1;i>=0;i--)s.par.object.array[i].type==t&&(s.par.object.array[i].clear(),s.par.object.array.splice(i,1));s.par.drag(),s.par.object.korektRect(!0)},this.drag=function(){var t=0;this.init(),this.arrSt.length=0;for(var i=0;i<this.par.object.array.length;i++)"SpliceSten"==this.par.object.array[i].type&&this.arrSt.push(this.par.object.array[i]);if(0==this.arrSt.length)this.panelSt.visible=!1;else{this.panelSt.visible=!0,this.labelSt.text="Sten: "+this.arrSt.length,t+=this.panelSt.height+this.otstup;for(i=0;i<r.length;i++){a=this.arrSt[0][r[i]],n=!0;for(var e=0;e<this.arrSt.length;e++)this.arrSt[e][r[i]]!=a&&(n=!1);0==n?(c[r[i]][0].alpha=.5,c[r[i]][1].alpha=.5):(c[r[i]][0].alpha=1,c[r[i]][1].alpha=1),c[r[i]][0].visible=a,c[r[i]][1].visible=!a}}this.arrWin.length=0;for(i=0;i<this.par.object.array.length;i++)"BInSten"==this.par.object.array[i].type&&this.arrWin.push(this.par.object.array[i]);0==this.arrWin.length?this.panelWin.visible=!1:(this.panelWin.visible=!0,this.labelWin.text="Object: "+this.arrWin.length,this.panelWin.y=t,t+=this.panelWin.height+this.otstup),this.arrPoint.length=0;for(i=0;i<this.par.object.array.length;i++)"SpPointSten"!=this.par.object.array[i].type&&"SpVPXz"!=this.par.object.array[i].type||this.arrPoint.push(this.par.object.array[i]);if(0==this.arrPoint.length)this.panelPoint.visible=!1;else{this.panelPoint.visible=!0,this.labelPoint.text="Point: "+this.arrPoint.length,this.panelPoint.y=t,h=Math.round(this.arrPoint[0].position.x),l=Math.round(this.arrPoint[0].position.y),u=Math.round(this.arrPoint[0].position.z),n=!0,a=!0,o=!0;for(i=1;i<this.arrPoint.length;i++)h!=Math.round(this.arrPoint[i].position.x)&&(n=!1),l!=Math.round(this.arrPoint[i].position.y)&&(a=!1),u!=Math.round(this.arrPoint[i].position.z)&&(o=!1);this.slid.alpha=1==n?1:.3,this.slid1.alpha=1==a?1:.3,this.slid2.alpha=1==o?1:.3,s.slid.min=Math.round(h-100),s.slid.max=Math.round(h+100),s.slid.value=Math.round(h),s.slid1.min=Math.round(l-100),s.slid1.max=Math.round(l+100),s.slid1.value=Math.round(l),s.slid2.min=Math.round(u-100),s.slid2.max=Math.round(u+100),s.slid2.value=Math.round(u),this.panelPoint.height=this.slid2.y+50,0==this.arrPoint.length&&0==this.arrWin.length&&0==this.arrSt.length&&(this.par.object.active=!1),t+=this.panelPoint.height+this.otstup}this.height=t}};function Z(t){return(Z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function J(t,i){for(var e=0;e<i.length;e++){var s=i[e];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function q(t){return(q=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function K(t,i){return(K=Object.setPrototypeOf||function(t,i){return t.__proto__=i,t})(t,i)}function $(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var tt=function(t){function i(t,e){var s;!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,i),(s=function(t,i){return!i||"object"!==Z(i)&&"function"!=typeof i?$(t):i}(this,q(i).call(this,t,e))).type="MOPolygon",s.typeNa="SpPolygon";var r=$($(s));return s.whSize=5555555,s.dCont=new DCont(t.dCont),s.button=void 0,s.slid,s.slid1,s.bool=!0,s.postIn=function(){this.window.title="Polygon",this.button=new DButton(this.window.content,this.otstup1,this.otstup1,"",function(){r.bool=!1,r.object.clear()},"resources/image/p0.png"),this.button.width=this.button.height=this.wh},s.drag=function(){r.bool},s.postSO=function(){this.bool=!0,this.object.funDragMenu=this.drag,this.object.par.setActive(this.object),this.window.title="Polygon: "+this.object.idArr,this.drag()},s.clear=function(){null!=this.object&&(this.bool=!0,this.object.funDragMenu=void 0),this.active=!1},s.sizeWindow=function(t,i,e){this.dCont.x=t/e-this.width},s}var e,r,n;return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&K(t,i)}(i,s["a"]),e=i,(r=[{key:"index",set:function(t){this._index!=t&&(this._index=t)}}])&&J(e.prototype,r),n&&J(e,n),i}();function it(t){return(it="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function et(t,i){for(var e=0;e<i.length;e++){var s=i[e];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function st(t){return(st=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function rt(t,i){return(rt=Object.setPrototypeOf||function(t,i){return t.__proto__=i,t})(t,i)}function nt(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var at=function(t){function i(t,e){var s;!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,i),(s=function(t,i){return!i||"object"!==it(i)&&"function"!=typeof i?nt(t):i}(this,st(i).call(this,t,e))).type="MOVP",s.typeNa="SpVPXz";var r=nt(nt(s));return s.whSize=5555555,s.dCont=new DCont(t.dCont),s.button=void 0,s.slid,s.slid1,s.bool=!0,s.postIn=function(){this.window.title=this.type;var t=this.otstup1;this.button=new DButton(this.window.content,this.otstup1,t,"",function(){r.bool=!1,r.object.clear()},"resources/image/p0.png"),this.button.width=this.button.height=this.wh,t+=this.wh+this.otstup1,this.slid=new DSliderBig(this.window.content,this.otstup1,t,function(t){r.bool=!1,r.object.position.x=r.slid.value},"x",-this.whSize/2,this.whSize/2),this.slid.width=this.width-2*this.otstup1,this.slid.okrug=1,this.slid.funChange=function(){r.bool=!0,r.drag()},t+=this.otstup1+this.wh,this.slid1=new DSliderBig(this.window.content,this.otstup1,t,function(t){r.bool=!1,r.object.position.y=r.slid1.value},"y",-this.whSize/2,this.whSize/2),this.slid1.width=this.width-2*this.otstup1,this.slid1.okrug=1,this.slid1.funChange=function(){r.bool=!0,r.drag()},t+=this.otstup1+this.wh,this.slid2=new DSliderBig(this.window.content,this.otstup1,t,function(t){r.bool=!1,r.object.position.z=r.slid2.value},"z",-this.whSize/2,this.whSize/2),this.slid2.width=this.width-2*this.otstup1,this.slid2.okrug=1,this.slid2.funChange=function(){r.bool=!0,r.drag()},t+=this.otstup1+this.wh,this.window.height=t+32},s.drag=function(){0!=r.bool&&(r.slid.min=r.object.position.x-500,r.slid.max=r.object.position.x+500,r.slid.value=Math.round(r.object.position.x),r.slid1.min=r.object.position.y-500,r.slid1.max=r.object.position.y+500,r.slid1.value=Math.round(r.object.position.y),r.slid2.min=r.object.position.z-500,r.slid2.max=r.object.position.z+500,r.slid2.value=Math.round(r.object.position.z))},s.postSO=function(){this.bool=!0,this.object.funDragMenu=this.drag,this.object.par.setActive(this.object),this.window.title="MOVP  "+this.object.idArr,this.drag()},s.clear=function(){null!=this.object&&(this.bool=!0,this.object.funDragMenu=void 0),this.active=!1},s.sizeWindow=function(t,i,e){this.dCont.x=t/e-this.width},s}var e,r,n;return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&rt(t,i)}(i,s["a"]),e=i,(r=[{key:"index",set:function(t){this._index!=t&&(this._index=t)}}])&&et(e.prototype,r),n&&et(e,n),i}();e.d(i,"a",function(){return ot});var ot=function t(i,e){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,t),this.type="MObject";this.par=i,this.fun=e,this.otstup=this.par.otstup,this.otstup1=this.par.otstup1,this.wh=this.par.wh,this.width=222,this.whSize=1e3,this.dCont=new DCont(i.dCont),this.dCont.y=this.wh+4*this.otstup,this.perehvat,this.array=[],this.dragPic=this.par.dragPic,this.array[0]=this.moPoint=new l(this,function(t,i){}),this.array[1]=this.moSten=new u.a(this,function(t,i){}),this.array[2]=this.moSp=new A(this,function(t,i){}),this.array[3]=this.moLine=new _(this,function(t,i){}),this.array[4]=this.moP20=new D(this,function(t,i){}),this.array[5]=this.moWindow=new z(this,function(t,i){}),this.array[6]=this.moGroup=new Y(this,function(t,i){}),this.array[7]=this.moPolygon=new tt(this,function(t,i){}),this.array[8]=this.moVP=new at(this,function(t,i){}),this.clear=function(){for(var t=0;t<this.array.length;t++)this.array[t].clear()},this.clearActive=function(){for(var t=0;t<this.array.length;t++)this.array[t].active=!1},this.setObject=function(t){if(null!=this.perehvat)return this.perehvat(t),void(this.perehvat=void 0);if(this.clear(),t)for(var i=0;i<this.array.length;i++)this.array[i].typeNa==t.type&&(this.array[i].setObject(t),this.dCont.visible=!0)},this.keydown=function(t){if(46==t.keyCode)for(var i=this.array.length-1;i>=0;i--)1==this.array[i].active&&this.array[i].deleteObj()},this.keyup=function(t){},this.sp=void 0,this.setSP=function(t){this.sp=t;for(var i=0;i<this.array.length;i++)this.array[i].setSP(t)},this.sizeWindow=function(t,i,e){this.dCont.x=t/e-this.width-this.otstup}}},function(t,i,e){"use strict";function s(){this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}var r,n,a;Object.assign(s.prototype,{setSize:function(){},render:function(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}}),s.FullScreenQuad=(r=new THREE.OrthographicCamera(-1,1,1,-1,0,1),n=new THREE.PlaneBufferGeometry(2,2),a=function(t){this._mesh=new THREE.Mesh(n,t)},Object.defineProperty(a.prototype,"material",{get:function(){return this._mesh.material},set:function(t){this._mesh.material=t}}),Object.assign(a.prototype,{render:function(t){t.render(this._mesh,r)}}),a);var o=function(t,i){s.call(this),this.textureID=void 0!==i?i:"tDiffuse",t instanceof THREE.ShaderMaterial?(this.uniforms=t.uniforms,this.material=t):t&&(this.uniforms=THREE.UniformsUtils.clone(t.uniforms),this.material=new THREE.ShaderMaterial({defines:Object.assign({},t.defines),uniforms:this.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader})),this.fsQuad=new s.FullScreenQuad(this.material)};o.prototype=Object.assign(Object.create(s.prototype),{constructor:o,render:function(t,i,e){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=e.texture),this.fsQuad.material=this.material,this.renderToScreen?(t.setRenderTarget(null),this.fsQuad.render(t)):(t.setRenderTarget(i),this.clear&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),this.fsQuad.render(t))}});var h=function(t,i){if(this.renderer=t,void 0===i){var e={minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:THREE.RGBAFormat,stencilBuffer:!1},s=t.getSize(new THREE.Vector2);this._pixelRatio=t.getPixelRatio(),this._width=s.width,this._height=s.height,(i=new THREE.WebGLRenderTarget(this._width*this._pixelRatio,this._height*this._pixelRatio,e)).texture.name="EffectComposer.rt1"}else this._pixelRatio=1,this._width=i.width,this._height=i.height;this.renderTarget1=i,this.renderTarget2=i.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],this.copyPass=new o(THREE.CopyShader),this.clock=new THREE.Clock};Object.assign(h.prototype,{swapBuffers:function(){var t=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=t},addPass:function(t){this.passes.push(t),t.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)},insertPass:function(t,i){this.passes.splice(i,0,t)},isLastEnabledPass:function(t){for(var i=t+1;i<this.passes.length;i++)if(this.passes[i].enabled)return!1;return!0},render:function(t){void 0===t&&(t=this.clock.getDelta());var i,e,s=this.renderer.getRenderTarget(),r=!1,n=this.passes.length;for(e=0;e<n;e++)if(!1!==(i=this.passes[e]).enabled){if(i.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(e),i.render(this.renderer,this.writeBuffer,this.readBuffer,t,r),i.needsSwap){if(r){var a=this.renderer.getContext(),o=this.renderer.state.buffers.stencil;o.setFunc(a.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,t),o.setFunc(a.EQUAL,1,4294967295)}this.swapBuffers()}void 0!==THREE.MaskPass&&(i instanceof THREE.MaskPass?r=!0:i instanceof THREE.ClearMaskPass&&(r=!1))}this.renderer.setRenderTarget(s)},reset:function(t){if(void 0===t){var i=this.renderer.getSize(new THREE.Vector2);this._pixelRatio=this.renderer.getPixelRatio(),this._width=i.width,this._height=i.height,(t=this.renderTarget1.clone()).setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=t,this.renderTarget2=t.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2},setSize:function(t,i){this._width=t,this._height=i;var e=this._width*this._pixelRatio,s=this._height*this._pixelRatio;this.renderTarget1.setSize(e,s),this.renderTarget2.setSize(e,s);for(var r=0;r<this.passes.length;r++)this.passes[r].setSize(e,s)},setPixelRatio:function(t){this._pixelRatio=t,this.setSize(this._width,this._height)}});var l=function(t,i,e,r,n){s.call(this),this.scene=t,this.camera=i,this.overrideMaterial=e,this.clearColor=r,this.clearAlpha=void 0!==n?n:0,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1};l.prototype=Object.assign(Object.create(s.prototype),{constructor:l,render:function(t,i,e){var s,r,n=t.autoClear;t.autoClear=!1,this.scene.overrideMaterial=this.overrideMaterial,this.clearColor&&(s=t.getClearColor().getHex(),r=t.getClearAlpha(),t.setClearColor(this.clearColor,this.clearAlpha)),this.clearDepth&&t.clearDepth(),t.setRenderTarget(this.renderToScreen?null:e),this.clear&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),t.render(this.scene,this.camera),this.clearColor&&t.setClearColor(s,r),this.scene.overrideMaterial=null,t.autoClear=n}});var u={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float opacity;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","\tvec4 texel = texture2D( tDiffuse, vUv );","\tgl_FragColor = opacity * texel;","}"].join("\n")},c=function(t,i,e,r){this.renderScene=i,this.renderCamera=e,this.selectedObjects=void 0!==r?r:[],this.visibleEdgeColor=new THREE.Color(1,1,1),this.hiddenEdgeColor=new THREE.Color(.1,.04,.02),this.edgeGlow=0,this.usePatternTexture=!1,this.edgeThickness=1,this.edgeStrength=3,this.downSampleRatio=2,this.pulsePeriod=0,s.call(this),this.resolution=void 0!==t?new THREE.Vector2(t.x,t.y):new THREE.Vector2(256,256);var n={minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:THREE.RGBAFormat},a=Math.round(this.resolution.x/this.downSampleRatio),o=Math.round(this.resolution.y/this.downSampleRatio);this.maskBufferMaterial=new THREE.MeshBasicMaterial({color:16777215}),this.maskBufferMaterial.side=THREE.DoubleSide,this.renderTargetMaskBuffer=new THREE.WebGLRenderTarget(this.resolution.x,this.resolution.y,n),this.renderTargetMaskBuffer.texture.name="OutlinePass.mask",this.renderTargetMaskBuffer.texture.generateMipmaps=!1,this.depthMaterial=new THREE.MeshDepthMaterial,this.depthMaterial.side=THREE.DoubleSide,this.depthMaterial.depthPacking=THREE.RGBADepthPacking,this.depthMaterial.blending=THREE.NoBlending,this.prepareMaskMaterial=this.getPrepareMaskMaterial(),this.prepareMaskMaterial.side=THREE.DoubleSide,this.prepareMaskMaterial.fragmentShader=function(t,i){var e=i.isPerspectiveCamera?"perspective":"orthographic";return t.replace(/DEPTH_TO_VIEW_Z/g,e+"DepthToViewZ")}(this.prepareMaskMaterial.fragmentShader,this.renderCamera),this.renderTargetDepthBuffer=new THREE.WebGLRenderTarget(this.resolution.x,this.resolution.y,n),this.renderTargetDepthBuffer.texture.name="OutlinePass.depth",this.renderTargetDepthBuffer.texture.generateMipmaps=!1,this.renderTargetMaskDownSampleBuffer=new THREE.WebGLRenderTarget(a,o,n),this.renderTargetMaskDownSampleBuffer.texture.name="OutlinePass.depthDownSample",this.renderTargetMaskDownSampleBuffer.texture.generateMipmaps=!1,this.renderTargetBlurBuffer1=new THREE.WebGLRenderTarget(a,o,n),this.renderTargetBlurBuffer1.texture.name="OutlinePass.blur1",this.renderTargetBlurBuffer1.texture.generateMipmaps=!1,this.renderTargetBlurBuffer2=new THREE.WebGLRenderTarget(Math.round(a/2),Math.round(o/2),n),this.renderTargetBlurBuffer2.texture.name="OutlinePass.blur2",this.renderTargetBlurBuffer2.texture.generateMipmaps=!1,this.edgeDetectionMaterial=this.getEdgeDetectionMaterial(),this.renderTargetEdgeBuffer1=new THREE.WebGLRenderTarget(a,o,n),this.renderTargetEdgeBuffer1.texture.name="OutlinePass.edge1",this.renderTargetEdgeBuffer1.texture.generateMipmaps=!1,this.renderTargetEdgeBuffer2=new THREE.WebGLRenderTarget(Math.round(a/2),Math.round(o/2),n),this.renderTargetEdgeBuffer2.texture.name="OutlinePass.edge2",this.renderTargetEdgeBuffer2.texture.generateMipmaps=!1;this.separableBlurMaterial1=this.getSeperableBlurMaterial(4),this.separableBlurMaterial1.uniforms.texSize.value=new THREE.Vector2(a,o),this.separableBlurMaterial1.uniforms.kernelRadius.value=1,this.separableBlurMaterial2=this.getSeperableBlurMaterial(4),this.separableBlurMaterial2.uniforms.texSize.value=new THREE.Vector2(Math.round(a/2),Math.round(o/2)),this.separableBlurMaterial2.uniforms.kernelRadius.value=4,this.overlayMaterial=this.getOverlayMaterial(),void 0===u&&console.error("OutlinePass relies on CopyShader");var h=u;this.copyUniforms=THREE.UniformsUtils.clone(h.uniforms),this.copyUniforms.opacity.value=1,this.materialCopy=new THREE.ShaderMaterial({uniforms:this.copyUniforms,vertexShader:h.vertexShader,fragmentShader:h.fragmentShader,blending:THREE.NoBlending,depthTest:!1,depthWrite:!1,transparent:!0}),this.enabled=!0,this.needsSwap=!1,this.oldClearColor=new THREE.Color,this.oldClearAlpha=1,this.fsQuad=new s.FullScreenQuad(null),this.tempPulseColor1=new THREE.Color,this.tempPulseColor2=new THREE.Color,this.textureMatrix=new THREE.Matrix4};c.prototype=Object.assign(Object.create(s.prototype),{constructor:c,dispose:function(){this.renderTargetMaskBuffer.dispose(),this.renderTargetDepthBuffer.dispose(),this.renderTargetMaskDownSampleBuffer.dispose(),this.renderTargetBlurBuffer1.dispose(),this.renderTargetBlurBuffer2.dispose(),this.renderTargetEdgeBuffer1.dispose(),this.renderTargetEdgeBuffer2.dispose()},setSize:function(t,i){this.renderTargetMaskBuffer.setSize(t,i);var e=Math.round(t/this.downSampleRatio),s=Math.round(i/this.downSampleRatio);this.renderTargetMaskDownSampleBuffer.setSize(e,s),this.renderTargetBlurBuffer1.setSize(e,s),this.renderTargetEdgeBuffer1.setSize(e,s),this.separableBlurMaterial1.uniforms.texSize.value=new THREE.Vector2(e,s),e=Math.round(e/2),s=Math.round(s/2),this.renderTargetBlurBuffer2.setSize(e,s),this.renderTargetEdgeBuffer2.setSize(e,s),this.separableBlurMaterial2.uniforms.texSize.value=new THREE.Vector2(e,s)},changeVisibilityOfSelectedObjects:function(t){function i(i){i.isMesh&&(t?(i.visible=i.userData.oldVisible,delete i.userData.oldVisible):(i.userData.oldVisible=i.visible,i.visible=t))}for(var e=0;e<this.selectedObjects.length;e++){this.selectedObjects[e].traverse(i)}},changeVisibilityOfNonSelectedObjects:function(t){var i=[];function e(t){t.isMesh&&i.push(t)}for(var s=0;s<this.selectedObjects.length;s++){this.selectedObjects[s].traverse(e)}this.renderScene.traverse(function(e){if(e.isMesh||e.isLine||e.isSprite){for(var s=!1,r=0;r<i.length;r++)if(i[r].id===e.id){s=!0;break}if(!s){var n=e.visible;t&&!e.bVisible||(e.visible=t),e.bVisible=n}}})},updateTextureMatrix:function(){this.textureMatrix.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),this.textureMatrix.multiply(this.renderCamera.projectionMatrix),this.textureMatrix.multiply(this.renderCamera.matrixWorldInverse)},render:function(t,i,e,s,r){if(this.selectedObjects.length>0){this.oldClearColor.copy(t.getClearColor()),this.oldClearAlpha=t.getClearAlpha();var n=t.autoClear;t.autoClear=!1,r&&t.state.buffers.stencil.setTest(!1),t.setClearColor(16777215,1),this.changeVisibilityOfSelectedObjects(!1);var a=this.renderScene.background;if(this.renderScene.background=null,this.renderScene.overrideMaterial=this.depthMaterial,t.setRenderTarget(this.renderTargetDepthBuffer),t.clear(),t.render(this.renderScene,this.renderCamera),this.changeVisibilityOfSelectedObjects(!0),this.updateTextureMatrix(),this.changeVisibilityOfNonSelectedObjects(!1),this.renderScene.overrideMaterial=this.prepareMaskMaterial,this.prepareMaskMaterial.uniforms.cameraNearFar.value=new THREE.Vector2(this.renderCamera.near,this.renderCamera.far),this.prepareMaskMaterial.uniforms.depthTexture.value=this.renderTargetDepthBuffer.texture,this.prepareMaskMaterial.uniforms.textureMatrix.value=this.textureMatrix,t.setRenderTarget(this.renderTargetMaskBuffer),t.clear(),t.render(this.renderScene,this.renderCamera),this.renderScene.overrideMaterial=null,this.changeVisibilityOfNonSelectedObjects(!0),this.renderScene.background=a,this.fsQuad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.renderTargetMaskBuffer.texture,t.setRenderTarget(this.renderTargetMaskDownSampleBuffer),t.clear(),this.fsQuad.render(t),this.tempPulseColor1.copy(this.visibleEdgeColor),this.tempPulseColor2.copy(this.hiddenEdgeColor),this.pulsePeriod>0){var o=.625+.75*Math.cos(.01*performance.now()/this.pulsePeriod)/2;this.tempPulseColor1.multiplyScalar(o),this.tempPulseColor2.multiplyScalar(o)}this.fsQuad.material=this.edgeDetectionMaterial,this.edgeDetectionMaterial.uniforms.maskTexture.value=this.renderTargetMaskDownSampleBuffer.texture,this.edgeDetectionMaterial.uniforms.texSize.value=new THREE.Vector2(this.renderTargetMaskDownSampleBuffer.width,this.renderTargetMaskDownSampleBuffer.height),this.edgeDetectionMaterial.uniforms.visibleEdgeColor.value=this.tempPulseColor1,this.edgeDetectionMaterial.uniforms.hiddenEdgeColor.value=this.tempPulseColor2,t.setRenderTarget(this.renderTargetEdgeBuffer1),t.clear(),this.fsQuad.render(t),this.fsQuad.material=this.separableBlurMaterial1,this.separableBlurMaterial1.uniforms.colorTexture.value=this.renderTargetEdgeBuffer1.texture,this.separableBlurMaterial1.uniforms.direction.value=c.BlurDirectionX,this.separableBlurMaterial1.uniforms.kernelRadius.value=this.edgeThickness,t.setRenderTarget(this.renderTargetBlurBuffer1),t.clear(),this.fsQuad.render(t),this.separableBlurMaterial1.uniforms.colorTexture.value=this.renderTargetBlurBuffer1.texture,this.separableBlurMaterial1.uniforms.direction.value=c.BlurDirectionY,t.setRenderTarget(this.renderTargetEdgeBuffer1),t.clear(),this.fsQuad.render(t),this.fsQuad.material=this.separableBlurMaterial2,this.separableBlurMaterial2.uniforms.colorTexture.value=this.renderTargetEdgeBuffer1.texture,this.separableBlurMaterial2.uniforms.direction.value=c.BlurDirectionX,t.setRenderTarget(this.renderTargetBlurBuffer2),t.clear(),this.fsQuad.render(t),this.separableBlurMaterial2.uniforms.colorTexture.value=this.renderTargetBlurBuffer2.texture,this.separableBlurMaterial2.uniforms.direction.value=c.BlurDirectionY,t.setRenderTarget(this.renderTargetEdgeBuffer2),t.clear(),this.fsQuad.render(t),this.fsQuad.material=this.overlayMaterial,this.overlayMaterial.uniforms.maskTexture.value=this.renderTargetMaskBuffer.texture,this.overlayMaterial.uniforms.edgeTexture1.value=this.renderTargetEdgeBuffer1.texture,this.overlayMaterial.uniforms.edgeTexture2.value=this.renderTargetEdgeBuffer2.texture,this.overlayMaterial.uniforms.patternTexture.value=this.patternTexture,this.overlayMaterial.uniforms.edgeStrength.value=this.edgeStrength,this.overlayMaterial.uniforms.edgeGlow.value=this.edgeGlow,this.overlayMaterial.uniforms.usePatternTexture.value=this.usePatternTexture,r&&t.state.buffers.stencil.setTest(!0),t.setRenderTarget(e),this.fsQuad.render(t),t.setClearColor(this.oldClearColor,this.oldClearAlpha),t.autoClear=n}this.renderToScreen&&(this.fsQuad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=e.texture,t.setRenderTarget(null),this.fsQuad.render(t))},getPrepareMaskMaterial:function(){return new THREE.ShaderMaterial({uniforms:{depthTexture:{value:null},cameraNearFar:{value:new THREE.Vector2(.5,.5)},textureMatrix:{value:new THREE.Matrix4}},vertexShader:["varying vec4 projTexCoord;","varying vec4 vPosition;","uniform mat4 textureMatrix;","void main() {","\tvPosition = modelViewMatrix * vec4( position, 1.0 );","\tvec4 worldPosition = modelMatrix * vec4( position, 1.0 );","\tprojTexCoord = textureMatrix * worldPosition;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#include <packing>","varying vec4 vPosition;","varying vec4 projTexCoord;","uniform sampler2D depthTexture;","uniform vec2 cameraNearFar;","void main() {","\tfloat depth = unpackRGBAToDepth(texture2DProj( depthTexture, projTexCoord ));","\tfloat viewZ = - DEPTH_TO_VIEW_Z( depth, cameraNearFar.x, cameraNearFar.y );","\tfloat depthTest = (-vPosition.z > viewZ) ? 1.0 : 0.0;","\tgl_FragColor = vec4(0.0, depthTest, 1.0, 1.0);","}"].join("\n")})},getEdgeDetectionMaterial:function(){return new THREE.ShaderMaterial({uniforms:{maskTexture:{value:null},texSize:{value:new THREE.Vector2(.5,.5)},visibleEdgeColor:{value:new THREE.Vector3(1,1,1)},hiddenEdgeColor:{value:new THREE.Vector3(1,1,1)}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"varying vec2 vUv;\t\t\t\tuniform sampler2D maskTexture;\t\t\t\tuniform vec2 texSize;\t\t\t\tuniform vec3 visibleEdgeColor;\t\t\t\tuniform vec3 hiddenEdgeColor;\t\t\t\t\t\t\t\tvoid main() {\n\t\t\t\t\tvec2 invSize = 1.0 / texSize;\t\t\t\t\tvec4 uvOffset = vec4(1.0, 0.0, 0.0, 1.0) * vec4(invSize, invSize);\t\t\t\t\tvec4 c1 = texture2D( maskTexture, vUv + uvOffset.xy);\t\t\t\t\tvec4 c2 = texture2D( maskTexture, vUv - uvOffset.xy);\t\t\t\t\tvec4 c3 = texture2D( maskTexture, vUv + uvOffset.yw);\t\t\t\t\tvec4 c4 = texture2D( maskTexture, vUv - uvOffset.yw);\t\t\t\t\tfloat diff1 = (c1.r - c2.r)*0.5;\t\t\t\t\tfloat diff2 = (c3.r - c4.r)*0.5;\t\t\t\t\tfloat d = length( vec2(diff1, diff2) );\t\t\t\t\tfloat a1 = min(c1.g, c2.g);\t\t\t\t\tfloat a2 = min(c3.g, c4.g);\t\t\t\t\tfloat visibilityFactor = min(a1, a2);\t\t\t\t\tvec3 edgeColor = 1.0 - visibilityFactor > 0.001 ? visibleEdgeColor : hiddenEdgeColor;\t\t\t\t\tgl_FragColor = vec4(edgeColor, 1.0) * vec4(d);\t\t\t\t}"})},getSeperableBlurMaterial:function(t){return new THREE.ShaderMaterial({defines:{MAX_RADIUS:t},uniforms:{colorTexture:{value:null},texSize:{value:new THREE.Vector2(.5,.5)},direction:{value:new THREE.Vector2(.5,.5)},kernelRadius:{value:1}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"#include <common>\t\t\t\tvarying vec2 vUv;\t\t\t\tuniform sampler2D colorTexture;\t\t\t\tuniform vec2 texSize;\t\t\t\tuniform vec2 direction;\t\t\t\tuniform float kernelRadius;\t\t\t\t\t\t\t\tfloat gaussianPdf(in float x, in float sigma) {\t\t\t\t\treturn 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;\t\t\t\t}\t\t\t\tvoid main() {\t\t\t\t\tvec2 invSize = 1.0 / texSize;\t\t\t\t\tfloat weightSum = gaussianPdf(0.0, kernelRadius);\t\t\t\t\tvec4 diffuseSum = texture2D( colorTexture, vUv) * weightSum;\t\t\t\t\tvec2 delta = direction * invSize * kernelRadius/float(MAX_RADIUS);\t\t\t\t\tvec2 uvOffset = delta;\t\t\t\t\tfor( int i = 1; i <= MAX_RADIUS; i ++ ) {\t\t\t\t\t\tfloat w = gaussianPdf(uvOffset.x, kernelRadius);\t\t\t\t\t\tvec4 sample1 = texture2D( colorTexture, vUv + uvOffset);\t\t\t\t\t\tvec4 sample2 = texture2D( colorTexture, vUv - uvOffset);\t\t\t\t\t\tdiffuseSum += ((sample1 + sample2) * w);\t\t\t\t\t\tweightSum += (2.0 * w);\t\t\t\t\t\tuvOffset += delta;\t\t\t\t\t}\t\t\t\t\tgl_FragColor = diffuseSum/weightSum;\t\t\t\t}"})},getOverlayMaterial:function(){return new THREE.ShaderMaterial({uniforms:{maskTexture:{value:null},edgeTexture1:{value:null},edgeTexture2:{value:null},patternTexture:{value:null},edgeStrength:{value:1},edgeGlow:{value:1},usePatternTexture:{value:0}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"varying vec2 vUv;\t\t\t\tuniform sampler2D maskTexture;\t\t\t\tuniform sampler2D edgeTexture1;\t\t\t\tuniform sampler2D edgeTexture2;\t\t\t\tuniform sampler2D patternTexture;\t\t\t\tuniform float edgeStrength;\t\t\t\tuniform float edgeGlow;\t\t\t\tuniform bool usePatternTexture;\t\t\t\t\t\t\t\tvoid main() {\t\t\t\t\tvec4 edgeValue1 = texture2D(edgeTexture1, vUv);\t\t\t\t\tvec4 edgeValue2 = texture2D(edgeTexture2, vUv);\t\t\t\t\tvec4 maskColor = texture2D(maskTexture, vUv);\t\t\t\t\tvec4 patternColor = texture2D(patternTexture, 6.0 * vUv);\t\t\t\t\tfloat visibilityFactor = 1.0 - maskColor.g > 0.0 ? 1.0 : 0.5;\t\t\t\t\tvec4 edgeValue = edgeValue1 + edgeValue2 * edgeGlow;\t\t\t\t\tvec4 finalColor = edgeStrength * maskColor.r * edgeValue;\t\t\t\t\tif(usePatternTexture)\t\t\t\t\t\tfinalColor += + visibilityFactor * (1.0 - maskColor.r) * (1.0 - patternColor.r);\t\t\t\t\tgl_FragColor = finalColor;\t\t\t\t}",blending:THREE.AdditiveBlending,depthTest:!1,depthWrite:!1,transparent:!0})}}),c.BlurDirectionX=new THREE.Vector2(1,0),c.BlurDirectionY=new THREE.Vector2(0,1);var p={uniforms:{tDiffuse:{value:null},resolution:{value:new THREE.Vector2(1/1024,1/512)}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["precision highp float;","","uniform sampler2D tDiffuse;","","uniform vec2 resolution;","","varying vec2 vUv;","","// FXAA 3.11 implementation by NVIDIA, ported to WebGL by Agost Biro (biro@archilogic.com)","","//----------------------------------------------------------------------------------","// File:        es3-keplerFXAAassetsshaders/FXAA_DefaultES.frag","// SDK Version: v3.00","// Email:       gameworks@nvidia.com","// Site:        http://developer.nvidia.com/","//","// Copyright (c) 2014-2015, NVIDIA CORPORATION. All rights reserved.","//","// Redistribution and use in source and binary forms, with or without","// modification, are permitted provided that the following conditions","// are met:","//  * Redistributions of source code must retain the above copyright","//    notice, this list of conditions and the following disclaimer.","//  * Redistributions in binary form must reproduce the above copyright","//    notice, this list of conditions and the following disclaimer in the","//    documentation and/or other materials provided with the distribution.","//  * Neither the name of NVIDIA CORPORATION nor the names of its","//    contributors may be used to endorse or promote products derived","//    from this software without specific prior written permission.","//","// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS ``AS IS'' AND ANY","// EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE","// IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR","// PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE COPYRIGHT OWNER OR","// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,","// EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,","// PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR","// PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY","// OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT","// (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE","// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.","//","//----------------------------------------------------------------------------------","","#define FXAA_PC 1","#define FXAA_GLSL_100 1","#define FXAA_QUALITY_PRESET 12","","#define FXAA_GREEN_AS_LUMA 1","","/*--------------------------------------------------------------------------*/","#ifndef FXAA_PC_CONSOLE","    //","    // The console algorithm for PC is included","    // for developers targeting really low spec machines.","    // Likely better to just run FXAA_PC, and use a really low preset.","    //","    #define FXAA_PC_CONSOLE 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_GLSL_120","    #define FXAA_GLSL_120 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_GLSL_130","    #define FXAA_GLSL_130 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_HLSL_3","    #define FXAA_HLSL_3 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_HLSL_4","    #define FXAA_HLSL_4 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_HLSL_5","    #define FXAA_HLSL_5 0","#endif","/*==========================================================================*/","#ifndef FXAA_GREEN_AS_LUMA","    //","    // For those using non-linear color,","    // and either not able to get luma in alpha, or not wanting to,","    // this enables FXAA to run using green as a proxy for luma.","    // So with this enabled, no need to pack luma in alpha.","    //","    // This will turn off AA on anything which lacks some amount of green.","    // Pure red and blue or combination of only R and B, will get no AA.","    //","    // Might want to lower the settings for both,","    //    fxaaConsoleEdgeThresholdMin","    //    fxaaQualityEdgeThresholdMin","    // In order to insure AA does not get turned off on colors","    // which contain a minor amount of green.","    //","    // 1 = On.","    // 0 = Off.","    //","    #define FXAA_GREEN_AS_LUMA 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_EARLY_EXIT","    //","    // Controls algorithm's early exit path.","    // On PS3 turning this ON adds 2 cycles to the shader.","    // On 360 turning this OFF adds 10ths of a millisecond to the shader.","    // Turning this off on console will result in a more blurry image.","    // So this defaults to on.","    //","    // 1 = On.","    // 0 = Off.","    //","    #define FXAA_EARLY_EXIT 1","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_DISCARD","    //","    // Only valid for PC OpenGL currently.","    // Probably will not work when FXAA_GREEN_AS_LUMA = 1.","    //","    // 1 = Use discard on pixels which don't need AA.","    //     For APIs which enable concurrent TEX+ROP from same surface.","    // 0 = Return unchanged color on pixels which don't need AA.","    //","    #define FXAA_DISCARD 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_FAST_PIXEL_OFFSET","    //","    // Used for GLSL 120 only.","    //","    // 1 = GL API supports fast pixel offsets","    // 0 = do not use fast pixel offsets","    //","    #ifdef GL_EXT_gpu_shader4","        #define FXAA_FAST_PIXEL_OFFSET 1","    #endif","    #ifdef GL_NV_gpu_shader5","        #define FXAA_FAST_PIXEL_OFFSET 1","    #endif","    #ifdef GL_ARB_gpu_shader5","        #define FXAA_FAST_PIXEL_OFFSET 1","    #endif","    #ifndef FXAA_FAST_PIXEL_OFFSET","        #define FXAA_FAST_PIXEL_OFFSET 0","    #endif","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_GATHER4_ALPHA","    //","    // 1 = API supports gather4 on alpha channel.","    // 0 = API does not support gather4 on alpha channel.","    //","    #if (FXAA_HLSL_5 == 1)","        #define FXAA_GATHER4_ALPHA 1","    #endif","    #ifdef GL_ARB_gpu_shader5","        #define FXAA_GATHER4_ALPHA 1","    #endif","    #ifdef GL_NV_gpu_shader5","        #define FXAA_GATHER4_ALPHA 1","    #endif","    #ifndef FXAA_GATHER4_ALPHA","        #define FXAA_GATHER4_ALPHA 0","    #endif","#endif","","","/*============================================================================","                        FXAA QUALITY - TUNING KNOBS","------------------------------------------------------------------------------","NOTE the other tuning knobs are now in the shader function inputs!","============================================================================*/","#ifndef FXAA_QUALITY_PRESET","    //","    // Choose the quality preset.","    // This needs to be compiled into the shader as it effects code.","    // Best option to include multiple presets is to","    // in each shader define the preset, then include this file.","    //","    // OPTIONS","    // -----------------------------------------------------------------------","    // 10 to 15 - default medium dither (10=fastest, 15=highest quality)","    // 20 to 29 - less dither, more expensive (20=fastest, 29=highest quality)","    // 39       - no dither, very expensive","    //","    // NOTES","    // -----------------------------------------------------------------------","    // 12 = slightly faster then FXAA 3.9 and higher edge quality (default)","    // 13 = about same speed as FXAA 3.9 and better than 12","    // 23 = closest to FXAA 3.9 visually and performance wise","    //  _ = the lowest digit is directly related to performance","    // _  = the highest digit is directly related to style","    //","    #define FXAA_QUALITY_PRESET 12","#endif","","","/*============================================================================","","                           FXAA QUALITY - PRESETS","","============================================================================*/","","/*============================================================================","                     FXAA QUALITY - MEDIUM DITHER PRESETS","============================================================================*/","#if (FXAA_QUALITY_PRESET == 10)","    #define FXAA_QUALITY_PS 3","    #define FXAA_QUALITY_P0 1.5","    #define FXAA_QUALITY_P1 3.0","    #define FXAA_QUALITY_P2 12.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 11)","    #define FXAA_QUALITY_PS 4","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 3.0","    #define FXAA_QUALITY_P3 12.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 12)","    #define FXAA_QUALITY_PS 5","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 4.0","    #define FXAA_QUALITY_P4 12.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 13)","    #define FXAA_QUALITY_PS 6","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 4.0","    #define FXAA_QUALITY_P5 12.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 14)","    #define FXAA_QUALITY_PS 7","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 4.0","    #define FXAA_QUALITY_P6 12.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 15)","    #define FXAA_QUALITY_PS 8","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 4.0","    #define FXAA_QUALITY_P7 12.0","#endif","","/*============================================================================","                     FXAA QUALITY - LOW DITHER PRESETS","============================================================================*/","#if (FXAA_QUALITY_PRESET == 20)","    #define FXAA_QUALITY_PS 3","    #define FXAA_QUALITY_P0 1.5","    #define FXAA_QUALITY_P1 2.0","    #define FXAA_QUALITY_P2 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 21)","    #define FXAA_QUALITY_PS 4","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 22)","    #define FXAA_QUALITY_PS 5","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 23)","    #define FXAA_QUALITY_PS 6","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 24)","    #define FXAA_QUALITY_PS 7","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 3.0","    #define FXAA_QUALITY_P6 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 25)","    #define FXAA_QUALITY_PS 8","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 4.0","    #define FXAA_QUALITY_P7 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 26)","    #define FXAA_QUALITY_PS 9","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 4.0","    #define FXAA_QUALITY_P8 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 27)","    #define FXAA_QUALITY_PS 10","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 2.0","    #define FXAA_QUALITY_P8 4.0","    #define FXAA_QUALITY_P9 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 28)","    #define FXAA_QUALITY_PS 11","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 2.0","    #define FXAA_QUALITY_P8 2.0","    #define FXAA_QUALITY_P9 4.0","    #define FXAA_QUALITY_P10 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 29)","    #define FXAA_QUALITY_PS 12","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 2.0","    #define FXAA_QUALITY_P8 2.0","    #define FXAA_QUALITY_P9 2.0","    #define FXAA_QUALITY_P10 4.0","    #define FXAA_QUALITY_P11 8.0","#endif","","/*============================================================================","                     FXAA QUALITY - EXTREME QUALITY","============================================================================*/","#if (FXAA_QUALITY_PRESET == 39)","    #define FXAA_QUALITY_PS 12","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.0","    #define FXAA_QUALITY_P2 1.0","    #define FXAA_QUALITY_P3 1.0","    #define FXAA_QUALITY_P4 1.0","    #define FXAA_QUALITY_P5 1.5","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 2.0","    #define FXAA_QUALITY_P8 2.0","    #define FXAA_QUALITY_P9 2.0","    #define FXAA_QUALITY_P10 4.0","    #define FXAA_QUALITY_P11 8.0","#endif","","","","/*============================================================================","","                                API PORTING","","============================================================================*/","#if (FXAA_GLSL_100 == 1) || (FXAA_GLSL_120 == 1) || (FXAA_GLSL_130 == 1)","    #define FxaaBool bool","    #define FxaaDiscard discard","    #define FxaaFloat float","    #define FxaaFloat2 vec2","    #define FxaaFloat3 vec3","    #define FxaaFloat4 vec4","    #define FxaaHalf float","    #define FxaaHalf2 vec2","    #define FxaaHalf3 vec3","    #define FxaaHalf4 vec4","    #define FxaaInt2 ivec2","    #define FxaaSat(x) clamp(x, 0.0, 1.0)","    #define FxaaTex sampler2D","#else","    #define FxaaBool bool","    #define FxaaDiscard clip(-1)","    #define FxaaFloat float","    #define FxaaFloat2 float2","    #define FxaaFloat3 float3","    #define FxaaFloat4 float4","    #define FxaaHalf half","    #define FxaaHalf2 half2","    #define FxaaHalf3 half3","    #define FxaaHalf4 half4","    #define FxaaSat(x) saturate(x)","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_GLSL_100 == 1)","  #define FxaaTexTop(t, p) texture2D(t, p, 0.0)","  #define FxaaTexOff(t, p, o, r) texture2D(t, p + (o * r), 0.0)","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_GLSL_120 == 1)","    // Requires,","    //  #version 120","    // And at least,","    //  #extension GL_EXT_gpu_shader4 : enable","    //  (or set FXAA_FAST_PIXEL_OFFSET 1 to work like DX9)","    #define FxaaTexTop(t, p) texture2DLod(t, p, 0.0)","    #if (FXAA_FAST_PIXEL_OFFSET == 1)","        #define FxaaTexOff(t, p, o, r) texture2DLodOffset(t, p, 0.0, o)","    #else","        #define FxaaTexOff(t, p, o, r) texture2DLod(t, p + (o * r), 0.0)","    #endif","    #if (FXAA_GATHER4_ALPHA == 1)","        // use #extension GL_ARB_gpu_shader5 : enable","        #define FxaaTexAlpha4(t, p) textureGather(t, p, 3)","        #define FxaaTexOffAlpha4(t, p, o) textureGatherOffset(t, p, o, 3)","        #define FxaaTexGreen4(t, p) textureGather(t, p, 1)","        #define FxaaTexOffGreen4(t, p, o) textureGatherOffset(t, p, o, 1)","    #endif","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_GLSL_130 == 1)",'    // Requires "#version 130" or better',"    #define FxaaTexTop(t, p) textureLod(t, p, 0.0)","    #define FxaaTexOff(t, p, o, r) textureLodOffset(t, p, 0.0, o)","    #if (FXAA_GATHER4_ALPHA == 1)","        // use #extension GL_ARB_gpu_shader5 : enable","        #define FxaaTexAlpha4(t, p) textureGather(t, p, 3)","        #define FxaaTexOffAlpha4(t, p, o) textureGatherOffset(t, p, o, 3)","        #define FxaaTexGreen4(t, p) textureGather(t, p, 1)","        #define FxaaTexOffGreen4(t, p, o) textureGatherOffset(t, p, o, 1)","    #endif","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_HLSL_3 == 1)","    #define FxaaInt2 float2","    #define FxaaTex sampler2D","    #define FxaaTexTop(t, p) tex2Dlod(t, float4(p, 0.0, 0.0))","    #define FxaaTexOff(t, p, o, r) tex2Dlod(t, float4(p + (o * r), 0, 0))","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_HLSL_4 == 1)","    #define FxaaInt2 int2","    struct FxaaTex { SamplerState smpl; Texture2D tex; };","    #define FxaaTexTop(t, p) t.tex.SampleLevel(t.smpl, p, 0.0)","    #define FxaaTexOff(t, p, o, r) t.tex.SampleLevel(t.smpl, p, 0.0, o)","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_HLSL_5 == 1)","    #define FxaaInt2 int2","    struct FxaaTex { SamplerState smpl; Texture2D tex; };","    #define FxaaTexTop(t, p) t.tex.SampleLevel(t.smpl, p, 0.0)","    #define FxaaTexOff(t, p, o, r) t.tex.SampleLevel(t.smpl, p, 0.0, o)","    #define FxaaTexAlpha4(t, p) t.tex.GatherAlpha(t.smpl, p)","    #define FxaaTexOffAlpha4(t, p, o) t.tex.GatherAlpha(t.smpl, p, o)","    #define FxaaTexGreen4(t, p) t.tex.GatherGreen(t.smpl, p)","    #define FxaaTexOffGreen4(t, p, o) t.tex.GatherGreen(t.smpl, p, o)","#endif","","","/*============================================================================","                   GREEN AS LUMA OPTION SUPPORT FUNCTION","============================================================================*/","#if (FXAA_GREEN_AS_LUMA == 0)","    FxaaFloat FxaaLuma(FxaaFloat4 rgba) { return rgba.w; }","#else","    FxaaFloat FxaaLuma(FxaaFloat4 rgba) { return rgba.y; }","#endif","","","","","/*============================================================================","","                             FXAA3 QUALITY - PC","","============================================================================*/","#if (FXAA_PC == 1)","/*--------------------------------------------------------------------------*/","FxaaFloat4 FxaaPixelShader(","    //","    // Use noperspective interpolation here (turn off perspective interpolation).","    // {xy} = center of pixel","    FxaaFloat2 pos,","    //","    // Used only for FXAA Console, and not used on the 360 version.","    // Use noperspective interpolation here (turn off perspective interpolation).","    // {xy_} = upper left of pixel","    // {_zw} = lower right of pixel","    FxaaFloat4 fxaaConsolePosPos,","    //","    // Input color texture.","    // {rgb_} = color in linear or perceptual color space","    // if (FXAA_GREEN_AS_LUMA == 0)","    //     {__a} = luma in perceptual color space (not linear)","    FxaaTex tex,","    //","    // Only used on the optimized 360 version of FXAA Console.",'    // For everything but 360, just use the same input here as for "tex".',"    // For 360, same texture, just alias with a 2nd sampler.","    // This sampler needs to have an exponent bias of -1.","    FxaaTex fxaaConsole360TexExpBiasNegOne,","    //","    // Only used on the optimized 360 version of FXAA Console.",'    // For everything but 360, just use the same input here as for "tex".',"    // For 360, same texture, just alias with a 3nd sampler.","    // This sampler needs to have an exponent bias of -2.","    FxaaTex fxaaConsole360TexExpBiasNegTwo,","    //","    // Only used on FXAA Quality.","    // This must be from a constant/uniform.","    // {x_} = 1.0/screenWidthInPixels","    // {_y} = 1.0/screenHeightInPixels","    FxaaFloat2 fxaaQualityRcpFrame,","    //","    // Only used on FXAA Console.","    // This must be from a constant/uniform.","    // This effects sub-pixel AA quality and inversely sharpness.","    //   Where N ranges between,","    //     N = 0.50 (default)","    //     N = 0.33 (sharper)","    // {x__} = -N/screenWidthInPixels","    // {_y_} = -N/screenHeightInPixels","    // {_z_} =  N/screenWidthInPixels","    // {__w} =  N/screenHeightInPixels","    FxaaFloat4 fxaaConsoleRcpFrameOpt,","    //","    // Only used on FXAA Console.","    // Not used on 360, but used on PS3 and PC.","    // This must be from a constant/uniform.","    // {x__} = -2.0/screenWidthInPixels","    // {_y_} = -2.0/screenHeightInPixels","    // {_z_} =  2.0/screenWidthInPixels","    // {__w} =  2.0/screenHeightInPixels","    FxaaFloat4 fxaaConsoleRcpFrameOpt2,","    //","    // Only used on FXAA Console.","    // Only used on 360 in place of fxaaConsoleRcpFrameOpt2.","    // This must be from a constant/uniform.","    // {x__} =  8.0/screenWidthInPixels","    // {_y_} =  8.0/screenHeightInPixels","    // {_z_} = -4.0/screenWidthInPixels","    // {__w} = -4.0/screenHeightInPixels","    FxaaFloat4 fxaaConsole360RcpFrameOpt2,","    //","    // Only used on FXAA Quality.","    // This used to be the FXAA_QUALITY_SUBPIX define.","    // It is here now to allow easier tuning.","    // Choose the amount of sub-pixel aliasing removal.","    // This can effect sharpness.","    //   1.00 - upper limit (softer)","    //   0.75 - default amount of filtering","    //   0.50 - lower limit (sharper, less sub-pixel aliasing removal)","    //   0.25 - almost off","    //   0.00 - completely off","    FxaaFloat fxaaQualitySubpix,","    //","    // Only used on FXAA Quality.","    // This used to be the FXAA_QUALITY_EDGE_THRESHOLD define.","    // It is here now to allow easier tuning.","    // The minimum amount of local contrast required to apply algorithm.","    //   0.333 - too little (faster)","    //   0.250 - low quality","    //   0.166 - default","    //   0.125 - high quality","    //   0.063 - overkill (slower)","    FxaaFloat fxaaQualityEdgeThreshold,","    //","    // Only used on FXAA Quality.","    // This used to be the FXAA_QUALITY_EDGE_THRESHOLD_MIN define.","    // It is here now to allow easier tuning.","    // Trims the algorithm from processing darks.","    //   0.0833 - upper limit (default, the start of visible unfiltered edges)","    //   0.0625 - high quality (faster)","    //   0.0312 - visible limit (slower)","    // Special notes when using FXAA_GREEN_AS_LUMA,","    //   Likely want to set this to zero.","    //   As colors that are mostly not-green","    //   will appear very dark in the green channel!","    //   Tune by looking at mostly non-green content,","    //   then start at zero and increase until aliasing is a problem.","    FxaaFloat fxaaQualityEdgeThresholdMin,","    //","    // Only used on FXAA Console.","    // This used to be the FXAA_CONSOLE_EDGE_SHARPNESS define.","    // It is here now to allow easier tuning.","    // This does not effect PS3, as this needs to be compiled in.","    //   Use FXAA_CONSOLE_PS3_EDGE_SHARPNESS for PS3.","    //   Due to the PS3 being ALU bound,","    //   there are only three safe values here: 2 and 4 and 8.","    //   These options use the shaders ability to a free *|/ by 2|4|8.","    // For all other platforms can be a non-power of two.","    //   8.0 is sharper (default!!!)","    //   4.0 is softer","    //   2.0 is really soft (good only for vector graphics inputs)","    FxaaFloat fxaaConsoleEdgeSharpness,","    //","    // Only used on FXAA Console.","    // This used to be the FXAA_CONSOLE_EDGE_THRESHOLD define.","    // It is here now to allow easier tuning.","    // This does not effect PS3, as this needs to be compiled in.","    //   Use FXAA_CONSOLE_PS3_EDGE_THRESHOLD for PS3.","    //   Due to the PS3 being ALU bound,","    //   there are only two safe values here: 1/4 and 1/8.","    //   These options use the shaders ability to a free *|/ by 2|4|8.","    // The console setting has a different mapping than the quality setting.","    // Other platforms can use other values.","    //   0.125 leaves less aliasing, but is softer (default!!!)","    //   0.25 leaves more aliasing, and is sharper","    FxaaFloat fxaaConsoleEdgeThreshold,","    //","    // Only used on FXAA Console.","    // This used to be the FXAA_CONSOLE_EDGE_THRESHOLD_MIN define.","    // It is here now to allow easier tuning.","    // Trims the algorithm from processing darks.","    // The console setting has a different mapping than the quality setting.","    // This only applies when FXAA_EARLY_EXIT is 1.","    // This does not apply to PS3,","    // PS3 was simplified to avoid more shader instructions.","    //   0.06 - faster but more aliasing in darks","    //   0.05 - default","    //   0.04 - slower and less aliasing in darks","    // Special notes when using FXAA_GREEN_AS_LUMA,","    //   Likely want to set this to zero.","    //   As colors that are mostly not-green","    //   will appear very dark in the green channel!","    //   Tune by looking at mostly non-green content,","    //   then start at zero and increase until aliasing is a problem.","    FxaaFloat fxaaConsoleEdgeThresholdMin,","    //","    // Extra constants for 360 FXAA Console only.","    // Use zeros or anything else for other platforms.","    // These must be in physical constant registers and NOT immediates.","    // Immediates will result in compiler un-optimizing.","    // {xyzw} = float4(1.0, -1.0, 0.25, -0.25)","    FxaaFloat4 fxaaConsole360ConstDir",") {","/*--------------------------------------------------------------------------*/","    FxaaFloat2 posM;","    posM.x = pos.x;","    posM.y = pos.y;","    #if (FXAA_GATHER4_ALPHA == 1)","        #if (FXAA_DISCARD == 0)","            FxaaFloat4 rgbyM = FxaaTexTop(tex, posM);","            #if (FXAA_GREEN_AS_LUMA == 0)","                #define lumaM rgbyM.w","            #else","                #define lumaM rgbyM.y","            #endif","        #endif","        #if (FXAA_GREEN_AS_LUMA == 0)","            FxaaFloat4 luma4A = FxaaTexAlpha4(tex, posM);","            FxaaFloat4 luma4B = FxaaTexOffAlpha4(tex, posM, FxaaInt2(-1, -1));","        #else","            FxaaFloat4 luma4A = FxaaTexGreen4(tex, posM);","            FxaaFloat4 luma4B = FxaaTexOffGreen4(tex, posM, FxaaInt2(-1, -1));","        #endif","        #if (FXAA_DISCARD == 1)","            #define lumaM luma4A.w","        #endif","        #define lumaE luma4A.z","        #define lumaS luma4A.x","        #define lumaSE luma4A.y","        #define lumaNW luma4B.w","        #define lumaN luma4B.z","        #define lumaW luma4B.x","    #else","        FxaaFloat4 rgbyM = FxaaTexTop(tex, posM);","        #if (FXAA_GREEN_AS_LUMA == 0)","            #define lumaM rgbyM.w","        #else","            #define lumaM rgbyM.y","        #endif","        #if (FXAA_GLSL_100 == 1)","          FxaaFloat lumaS = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 0.0, 1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaE = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 1.0, 0.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaN = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 0.0,-1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaW = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2(-1.0, 0.0), fxaaQualityRcpFrame.xy));","        #else","          FxaaFloat lumaS = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 0, 1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1, 0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaN = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 0,-1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 0), fxaaQualityRcpFrame.xy));","        #endif","    #endif","/*--------------------------------------------------------------------------*/","    FxaaFloat maxSM = max(lumaS, lumaM);","    FxaaFloat minSM = min(lumaS, lumaM);","    FxaaFloat maxESM = max(lumaE, maxSM);","    FxaaFloat minESM = min(lumaE, minSM);","    FxaaFloat maxWN = max(lumaN, lumaW);","    FxaaFloat minWN = min(lumaN, lumaW);","    FxaaFloat rangeMax = max(maxWN, maxESM);","    FxaaFloat rangeMin = min(minWN, minESM);","    FxaaFloat rangeMaxScaled = rangeMax * fxaaQualityEdgeThreshold;","    FxaaFloat range = rangeMax - rangeMin;","    FxaaFloat rangeMaxClamped = max(fxaaQualityEdgeThresholdMin, rangeMaxScaled);","    FxaaBool earlyExit = range < rangeMaxClamped;","/*--------------------------------------------------------------------------*/","    if(earlyExit)","        #if (FXAA_DISCARD == 1)","            FxaaDiscard;","        #else","            return rgbyM;","        #endif","/*--------------------------------------------------------------------------*/","    #if (FXAA_GATHER4_ALPHA == 0)","        #if (FXAA_GLSL_100 == 1)","          FxaaFloat lumaNW = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2(-1.0,-1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaSE = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 1.0, 1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaNE = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 1.0,-1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaSW = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2(-1.0, 1.0), fxaaQualityRcpFrame.xy));","        #else","          FxaaFloat lumaNW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1,-1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaSE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1, 1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaNE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1,-1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaSW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 1), fxaaQualityRcpFrame.xy));","        #endif","    #else","        FxaaFloat lumaNE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(1, -1), fxaaQualityRcpFrame.xy));","        FxaaFloat lumaSW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 1), fxaaQualityRcpFrame.xy));","    #endif","/*--------------------------------------------------------------------------*/","    FxaaFloat lumaNS = lumaN + lumaS;","    FxaaFloat lumaWE = lumaW + lumaE;","    FxaaFloat subpixRcpRange = 1.0/range;","    FxaaFloat subpixNSWE = lumaNS + lumaWE;","    FxaaFloat edgeHorz1 = (-2.0 * lumaM) + lumaNS;","    FxaaFloat edgeVert1 = (-2.0 * lumaM) + lumaWE;","/*--------------------------------------------------------------------------*/","    FxaaFloat lumaNESE = lumaNE + lumaSE;","    FxaaFloat lumaNWNE = lumaNW + lumaNE;","    FxaaFloat edgeHorz2 = (-2.0 * lumaE) + lumaNESE;","    FxaaFloat edgeVert2 = (-2.0 * lumaN) + lumaNWNE;","/*--------------------------------------------------------------------------*/","    FxaaFloat lumaNWSW = lumaNW + lumaSW;","    FxaaFloat lumaSWSE = lumaSW + lumaSE;","    FxaaFloat edgeHorz4 = (abs(edgeHorz1) * 2.0) + abs(edgeHorz2);","    FxaaFloat edgeVert4 = (abs(edgeVert1) * 2.0) + abs(edgeVert2);","    FxaaFloat edgeHorz3 = (-2.0 * lumaW) + lumaNWSW;","    FxaaFloat edgeVert3 = (-2.0 * lumaS) + lumaSWSE;","    FxaaFloat edgeHorz = abs(edgeHorz3) + edgeHorz4;","    FxaaFloat edgeVert = abs(edgeVert3) + edgeVert4;","/*--------------------------------------------------------------------------*/","    FxaaFloat subpixNWSWNESE = lumaNWSW + lumaNESE;","    FxaaFloat lengthSign = fxaaQualityRcpFrame.x;","    FxaaBool horzSpan = edgeHorz >= edgeVert;","    FxaaFloat subpixA = subpixNSWE * 2.0 + subpixNWSWNESE;","/*--------------------------------------------------------------------------*/","    if(!horzSpan) lumaN = lumaW;","    if(!horzSpan) lumaS = lumaE;","    if(horzSpan) lengthSign = fxaaQualityRcpFrame.y;","    FxaaFloat subpixB = (subpixA * (1.0/12.0)) - lumaM;","/*--------------------------------------------------------------------------*/","    FxaaFloat gradientN = lumaN - lumaM;","    FxaaFloat gradientS = lumaS - lumaM;","    FxaaFloat lumaNN = lumaN + lumaM;","    FxaaFloat lumaSS = lumaS + lumaM;","    FxaaBool pairN = abs(gradientN) >= abs(gradientS);","    FxaaFloat gradient = max(abs(gradientN), abs(gradientS));","    if(pairN) lengthSign = -lengthSign;","    FxaaFloat subpixC = FxaaSat(abs(subpixB) * subpixRcpRange);","/*--------------------------------------------------------------------------*/","    FxaaFloat2 posB;","    posB.x = posM.x;","    posB.y = posM.y;","    FxaaFloat2 offNP;","    offNP.x = (!horzSpan) ? 0.0 : fxaaQualityRcpFrame.x;","    offNP.y = ( horzSpan) ? 0.0 : fxaaQualityRcpFrame.y;","    if(!horzSpan) posB.x += lengthSign * 0.5;","    if( horzSpan) posB.y += lengthSign * 0.5;","/*--------------------------------------------------------------------------*/","    FxaaFloat2 posN;","    posN.x = posB.x - offNP.x * FXAA_QUALITY_P0;","    posN.y = posB.y - offNP.y * FXAA_QUALITY_P0;","    FxaaFloat2 posP;","    posP.x = posB.x + offNP.x * FXAA_QUALITY_P0;","    posP.y = posB.y + offNP.y * FXAA_QUALITY_P0;","    FxaaFloat subpixD = ((-2.0)*subpixC) + 3.0;","    FxaaFloat lumaEndN = FxaaLuma(FxaaTexTop(tex, posN));","    FxaaFloat subpixE = subpixC * subpixC;","    FxaaFloat lumaEndP = FxaaLuma(FxaaTexTop(tex, posP));","/*--------------------------------------------------------------------------*/","    if(!pairN) lumaNN = lumaSS;","    FxaaFloat gradientScaled = gradient * 1.0/4.0;","    FxaaFloat lumaMM = lumaM - lumaNN * 0.5;","    FxaaFloat subpixF = subpixD * subpixE;","    FxaaBool lumaMLTZero = lumaMM < 0.0;","/*--------------------------------------------------------------------------*/","    lumaEndN -= lumaNN * 0.5;","    lumaEndP -= lumaNN * 0.5;","    FxaaBool doneN = abs(lumaEndN) >= gradientScaled;","    FxaaBool doneP = abs(lumaEndP) >= gradientScaled;","    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P1;","    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P1;","    FxaaBool doneNP = (!doneN) || (!doneP);","    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P1;","    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P1;","/*--------------------------------------------------------------------------*/","    if(doneNP) {","        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","        doneN = abs(lumaEndN) >= gradientScaled;","        doneP = abs(lumaEndP) >= gradientScaled;","        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P2;","        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P2;","        doneNP = (!doneN) || (!doneP);","        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P2;","        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P2;","/*--------------------------------------------------------------------------*/","        #if (FXAA_QUALITY_PS > 3)","        if(doneNP) {","            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","            doneN = abs(lumaEndN) >= gradientScaled;","            doneP = abs(lumaEndP) >= gradientScaled;","            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P3;","            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P3;","            doneNP = (!doneN) || (!doneP);","            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P3;","            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P3;","/*--------------------------------------------------------------------------*/","            #if (FXAA_QUALITY_PS > 4)","            if(doneNP) {","                if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                doneN = abs(lumaEndN) >= gradientScaled;","                doneP = abs(lumaEndP) >= gradientScaled;","                if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P4;","                if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P4;","                doneNP = (!doneN) || (!doneP);","                if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P4;","                if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P4;","/*--------------------------------------------------------------------------*/","                #if (FXAA_QUALITY_PS > 5)","                if(doneNP) {","                    if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                    if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                    if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                    if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                    doneN = abs(lumaEndN) >= gradientScaled;","                    doneP = abs(lumaEndP) >= gradientScaled;","                    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P5;","                    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P5;","                    doneNP = (!doneN) || (!doneP);","                    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P5;","                    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P5;","/*--------------------------------------------------------------------------*/","                    #if (FXAA_QUALITY_PS > 6)","                    if(doneNP) {","                        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                        doneN = abs(lumaEndN) >= gradientScaled;","                        doneP = abs(lumaEndP) >= gradientScaled;","                        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P6;","                        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P6;","                        doneNP = (!doneN) || (!doneP);","                        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P6;","                        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P6;","/*--------------------------------------------------------------------------*/","                        #if (FXAA_QUALITY_PS > 7)","                        if(doneNP) {","                            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                            doneN = abs(lumaEndN) >= gradientScaled;","                            doneP = abs(lumaEndP) >= gradientScaled;","                            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P7;","                            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P7;","                            doneNP = (!doneN) || (!doneP);","                            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P7;","                            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P7;","/*--------------------------------------------------------------------------*/","    #if (FXAA_QUALITY_PS > 8)","    if(doneNP) {","        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","        doneN = abs(lumaEndN) >= gradientScaled;","        doneP = abs(lumaEndP) >= gradientScaled;","        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P8;","        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P8;","        doneNP = (!doneN) || (!doneP);","        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P8;","        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P8;","/*--------------------------------------------------------------------------*/","        #if (FXAA_QUALITY_PS > 9)","        if(doneNP) {","            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","            doneN = abs(lumaEndN) >= gradientScaled;","            doneP = abs(lumaEndP) >= gradientScaled;","            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P9;","            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P9;","            doneNP = (!doneN) || (!doneP);","            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P9;","            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P9;","/*--------------------------------------------------------------------------*/","            #if (FXAA_QUALITY_PS > 10)","            if(doneNP) {","                if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                doneN = abs(lumaEndN) >= gradientScaled;","                doneP = abs(lumaEndP) >= gradientScaled;","                if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P10;","                if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P10;","                doneNP = (!doneN) || (!doneP);","                if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P10;","                if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P10;","/*--------------------------------------------------------------------------*/","                #if (FXAA_QUALITY_PS > 11)","                if(doneNP) {","                    if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                    if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                    if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                    if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                    doneN = abs(lumaEndN) >= gradientScaled;","                    doneP = abs(lumaEndP) >= gradientScaled;","                    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P11;","                    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P11;","                    doneNP = (!doneN) || (!doneP);","                    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P11;","                    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P11;","/*--------------------------------------------------------------------------*/","                    #if (FXAA_QUALITY_PS > 12)","                    if(doneNP) {","                        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                        doneN = abs(lumaEndN) >= gradientScaled;","                        doneP = abs(lumaEndP) >= gradientScaled;","                        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P12;","                        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P12;","                        doneNP = (!doneN) || (!doneP);","                        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P12;","                        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P12;","/*--------------------------------------------------------------------------*/","                    }","                    #endif","/*--------------------------------------------------------------------------*/","                }","                #endif","/*--------------------------------------------------------------------------*/","            }","            #endif","/*--------------------------------------------------------------------------*/","        }","        #endif","/*--------------------------------------------------------------------------*/","    }","    #endif","/*--------------------------------------------------------------------------*/","                        }","                        #endif","/*--------------------------------------------------------------------------*/","                    }","                    #endif","/*--------------------------------------------------------------------------*/","                }","                #endif","/*--------------------------------------------------------------------------*/","            }","            #endif","/*--------------------------------------------------------------------------*/","        }","        #endif","/*--------------------------------------------------------------------------*/","    }","/*--------------------------------------------------------------------------*/","    FxaaFloat dstN = posM.x - posN.x;","    FxaaFloat dstP = posP.x - posM.x;","    if(!horzSpan) dstN = posM.y - posN.y;","    if(!horzSpan) dstP = posP.y - posM.y;","/*--------------------------------------------------------------------------*/","    FxaaBool goodSpanN = (lumaEndN < 0.0) != lumaMLTZero;","    FxaaFloat spanLength = (dstP + dstN);","    FxaaBool goodSpanP = (lumaEndP < 0.0) != lumaMLTZero;","    FxaaFloat spanLengthRcp = 1.0/spanLength;","/*--------------------------------------------------------------------------*/","    FxaaBool directionN = dstN < dstP;","    FxaaFloat dst = min(dstN, dstP);","    FxaaBool goodSpan = directionN ? goodSpanN : goodSpanP;","    FxaaFloat subpixG = subpixF * subpixF;","    FxaaFloat pixelOffset = (dst * (-spanLengthRcp)) + 0.5;","    FxaaFloat subpixH = subpixG * fxaaQualitySubpix;","/*--------------------------------------------------------------------------*/","    FxaaFloat pixelOffsetGood = goodSpan ? pixelOffset : 0.0;","    FxaaFloat pixelOffsetSubpix = max(pixelOffsetGood, subpixH);","    if(!horzSpan) posM.x += pixelOffsetSubpix * lengthSign;","    if( horzSpan) posM.y += pixelOffsetSubpix * lengthSign;","    #if (FXAA_DISCARD == 1)","        return FxaaTexTop(tex, posM);","    #else","        return FxaaFloat4(FxaaTexTop(tex, posM).xyz, lumaM);","    #endif","}","/*==========================================================================*/","#endif","","void main() {","  gl_FragColor = FxaaPixelShader(","    vUv,","    vec4(0.0),","    tDiffuse,","    tDiffuse,","    tDiffuse,","    resolution,","    vec4(0.0),","    vec4(0.0),","    vec4(0.0),","    0.75,","    0.166,","    0.0833,","    0.0,","    0.0,","    0.0,","    vec4(0.0)","  );","","  // TODO avoid querying texture twice for same texel","  gl_FragColor.a = texture2D(tDiffuse, vUv).a;","}"].join("\n")};function d(t,i){for(var e=0;e<i.length;e++){var s=i[e];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}e.d(i,"a",function(){return f});var f=function(){function t(i,e){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,t),this._width=100,this._height=100,this.visi3D=i,this._active=!1,this._edgeStrength=3,this._edgeGlow=0,this._edgeThickness=1,this._pulsePeriod=0,this._visibleEdgeColor="#ffffff",this._hiddenEdgeColor="#190a05",this._boolTextur=!1,this._linkTextur="null";var s=new h(i.renderer),r=new l(i.scene,i.camera);s.addPass(r);var n=new c(new THREE.Vector2(window.innerWidth,window.innerHeight),i.scene,i.camera);s.addPass(n),this.outlinePass=n;var a=new o(p);a.uniforms.resolution.value.set(1/window.innerWidth,1/window.innerHeight),s.addPass(a),this.outlinePass.edgeStrength=this._edgeStrength,this.outlinePass.edgeGlow=this._edgeGlow,this.outlinePass.edgeThickness=this._edgeThickness,this.outlinePass.pulsePeriod=this._pulsePeriod,this.outlinePass.visibleEdgeColor.set(this._visibleEdgeColor),this.outlinePass.hiddenEdgeColor.set(this._hiddenEdgeColor),this._visibleEdgeColor="#ffffff",this._hiddenEdgeColor="#190a05",this.dragLink=function(){(new THREE.TextureLoader).load(this._linkTextur,function(t){n.patternTexture=t,t.wrapS=THREE.RepeatWrapping,t.wrapT=THREE.RepeatWrapping,i.intRend=1})},this.sizeWindow=function(t,i){this._width=t,this._height=i,a.uniforms.resolution.value.set(1/t,1/i),s.setSize(t,i)},this.render=function(){return 0==this._active?this._active:(s.render(),!0)},this.setValue=function(t){1!=Array.isArray(t)?n.selectedObjects=null!=t||null!=t?[t]:[]:n.selectedObjects=t}}var i,e,s;return i=t,(e=[{key:"active",set:function(t){this._active!=t&&(this._active=t,this.visi3D.intRend=1)},get:function(){return this._active}},{key:"edgeStrength",set:function(t){this._edgeStrength!=t&&(this._edgeStrength=t,this.outlinePass.edgeStrength=this._edgeStrength)},get:function(){return this._edgeStrength}},{key:"edgeGlow",set:function(t){this._edgeGlow!=t&&(this._edgeGlow=t,this.outlinePass.edgeGlow=this._edgeGlow)},get:function(){return this._edgeGlow}},{key:"pulsePeriod",set:function(t){this._pulsePeriod!=t&&(this._pulsePeriod=t,this.outlinePass.pulsePeriod=this._pulsePeriod)},get:function(){return this._pulsePeriod}},{key:"linkTextur",set:function(t){this._linkTextur!=t&&(this._linkTextur=t,"null"==this._linkTextur?this.outlinePass.usePatternTexture=!1:(this.outlinePass.usePatternTexture=!0,this.dragLink()))},get:function(){return this._linkTextur}},{key:"visibleEdgeColor",set:function(t){this._visibleEdgeColor!=t&&(this._visibleEdgeColor=t,this.outlinePass.visibleEdgeColor.set(this._visibleEdgeColor))},get:function(){return this._visibleEdgeColor}},{key:"hiddenEdgeColor",set:function(t){this._hiddenEdgeColor!=t&&(this._hiddenEdgeColor=t,this.outlinePass.hiddenEdgeColor.set(this._hiddenEdgeColor))},get:function(){return this._hiddenEdgeColor}}])&&d(i.prototype,e),s&&d(i,s),t}()},function(t,i,e){"use strict";var s=e(7);function r(t){this.parent=t;var i,e=this;this._active=!1,this.RADIUS=1e3,this.POS_X=0,this.POS_Y=0,this.POS_Z=0,this.LINK="nullMy",this.COLOR="0xffffff",this._radius=this.RADIUS,this._link=this.LINK,this._color=this.COLOR,this._shadRotZ=this.parent.ROTATION_Z,this._rotZ=0,this._x=this.POS_X,this._y=this.POS_Y,this._z=this.POS_Z,this.mesh=void 0,this.cont3d=void 0,this.cont3d1=void 0,this.textur=void 0,this.loaderHDR=void 0,this.onLoad=void 0,this.onComplete=void 0,this.init=function(){null==this.mesh&&(this.geometry=new THREE.SphereGeometry(1,32,32),this.loader=new THREE.TextureLoader,this.loaderHDR=new s.a,this.material=new THREE.MeshBasicMaterial({side:THREE.BackSide,color:16777215}),this.mesh=new THREE.Mesh(this.geometry,this.material),this.mesh.scale.set(this._radius,this._radius,this._radius),this.cont3d=new THREE.Object3D,this.cont3d1=new THREE.Object3D,this.cont3d.add(this.cont3d1),this.cont3d1.add(this.mesh),this.cont3d1.rotation.y=0,this.mesh.rotation.y=this._rotZ,this.cont3d.rotation.x=-Math.PI/2)},this.dergActiv=function(){1==this._active?null==this.cont3d.parent&&this.parent.parent.groupObject.add(this.cont3d):null!=this.cont3d.parent&&this.parent.parent.groupObject.remove(this.cont3d)},this.canvasTexture,this.linkNull=null,this.creatLink=function(){if(null!=this.linkNull)return this.linkNull;var t=document.createElement("canvas"),i=t.getContext("2d");t.height=t.width=2048;var e=t.height/26;i.fillStyle="rgba(100, 100, 100, 0.5)";for(var s=!0,r=!0,n=0;n<26;n++){r=s;for(var a=0;a<26;a++)r&&i.fillRect(n*e,a*e,e,e),r=!r;s=!s}this.linkNull=t.toDataURL("image/png"),this.canvasTexture=new THREE.CanvasTexture(t)},this.dergLink=function(){if("null"==this._link||null==this._link){null!=this.material.map&&(this.material.map=null,this.material.needsUpdate=!0);var t=this._link+"";this.creatLink(),e.textur=this.canvasTexture,e.textur.linkMy=t,e.material.map=e.textur,e.material.needsUpdate=!0,e.parent.parent.intRend=1,e.onComplete&&e.onComplete()}else{if(this.onLoad&&this.onLoad(),0==(i=this.checkFormat(this._link))){var s=this._link+"";if(e.textur&&e.textur.linkMy&&e.textur.linkMy==s)return void(e.onComplete&&e.onComplete());this.loader.load(this._link,function(t){e.textur=t,e.textur.linkMy=s,e.material.map=t,e.material.needsUpdate=!0,e.parent.parent.intRend=1,e.onComplete&&e.onComplete()},function(t){},function(t){})}if(1==i)return}},this.checkFormat=function(t){return-1!==t.indexOf(".png")?0:-1!==t.indexOf(".jpeg")?0:-1!==t.indexOf(".jpg")?0:t.length>150?-1!==t.indexOf("png")?0:-1!==t.indexOf("jpeg")?0:-1!==t.indexOf("jpg")?0:1:1},this.render=function(){}}function n(){var t=this,i=256,e=256,s=new THREE.Scene,r=new THREE.OrthographicCamera(i/-2,i/2,e/2,e/-2,.001,1e4),n=(new THREE.Clock,new THREE.WebGLRenderer({antialias:!0,alpha:!0,preserveDrawingBuffer:!0}));r.position.set(200,200,200),s.add(r),this.camera=r,this.fotoContainer=new THREE.Object3D,s.add(this.fotoContainer),s.background=new THREE.Color(38655),n.setPixelRatio(window.devicePixelRatio),n.setSize(i,e),n.localClippingEnabled=!0;var a=document.createElement("div");a.style.position="absolute",a.style.bottom="0px",a.style.left="0px",a.appendChild(n.domElement),this.contentHTML=a,this.canvas=n.domElement,this.contentHTML=a;var o=new THREE.AmbientLight("#ffffff",1);s.add(o);var h=new THREE.GridHelper(1e3,10),l=new THREE.AxesHelper(100),u=new THREE.BoxHelper(this.fotoContainer,16776960);s.add(h),s.add(l),s.add(u);var c=[l,h,u];function p(){n.render(s,r)}this.render=p,p(),u.setFromObject(t.fotoContainer);var d=new THREE.Box3,f=new THREE.Vector3;this.box=d,this.center=f,this.setSize=function(t,s){i=t,e=s,n.setSize(i,e),r.aspect=i/e,r.updateProjectionMatrix()},this.addObjFoto=function(t){this.fotoContainer.add(t),u.setFromObject(this.fotoContainer)},this.removeObjFoto=function(t){this.fotoContainer.remove(t)},this.moveToObj=function(i){d.setFromObject(i||t.fotoContainer);var e=d.max.x-d.min.x,s=d.max.z-d.min.z;t.moveToRect(d.min.x,d.min.z,e,s)},this.moveToRect=function(t,i,e,s){if(t+=e/2,i+=s/2,f.set(t,0,i),r.position.set(f.x,9e3,f.z),r.lookAt(f),"OrthographicCamera"===r.type){var n=Math.max(s,e);r.zoom=1,r.left=n/-2,r.right=n/2,r.top=n/2,r.bottom=n/-2,r.aspect=n/n}r.updateProjectionMatrix()},this.getFoto=function(t){t=t||1024;for(var r=0;r<c.length;r++)c[r].visible=!1;var a=s.background;s.background=null,n.setSize(t,t),p();var o=n.domElement.toDataURL("image/png");n.setSize(i,e),s.background=a;for(var h=0;h<c.length;h++)c[h].visible=!0;return p(),o},this.getCanvas=function(t){t=t||1024;for(var i=0;i<c.length;i++)c[i].visible=!1;s.background;s.background=null;var e=n.getSize();return e.width==t&&e.height==t||n.setSize(t,t),p(),n.domElement}}function a(t){var i=this,e=THREE.Math.generateUUID(),s=new THREE.Vector3(0,1,0),r=(new THREE.Plane(s,.01),new THREE.Vector4(0,999,0,.001)),a=new THREE.Box3,u=t||new n;this.foto3D=u;var c=new THREE.Vector2(0,0),p=100,d=new h;this.canvas=d.canvas,this.isTime=!1;var f=new THREE.Texture(d.canvas);this.texturePlan=f,this.matPlan=new THREE.MeshPhongMaterial({transparent:!0,side:THREE.DoubleSide,map:f});var g=new l;this.canvasGG=g,g.arrColorStopTranspanent[0]=.15,g.arrProcent[0]=.82,g.arrColorStopTranspanent[1]=1,g.arrProcent[1]=1,g.update();var A=new THREE.Texture(g.canvas);A.needsUpdate=!0,this.textureShadow=A,this.content3d=new THREE.Object3D,this.shadowContent3d=new THREE.Object3D,this.meshPlan=new THREE.Mesh(new THREE.PlaneBufferGeometry(1,1),this.matPlan),this.meshPlan.rotation.x=-Math.PI/2,this.content3d.add(this.meshPlan);var y=new THREE.Mesh(new THREE.SphereBufferGeometry(10,16,16));y.position.set(r.x,r.y,r.z),this.arrShadowMesh=[],this.arrObj=[],this._dunamic=!0,this.dirty=!0,this._lightPosition4D=r,this._fotoPosition=new THREE.Vector2(0,0),this._fotoWH=150,this._imgWH=512,this._imgBlur=1,this._imgAlpha=1,this._offsetY=0,this._scaleShadow=1,this._isDinamFotoRect=!1,this._opacityMat=1;var x=[new THREE.Plane(new THREE.Vector3(0,-1,0),100),new THREE.Plane(new THREE.Vector3(0,1,0),0)];this._shadowMaterial=new THREE.MeshBasicMaterial({side:THREE.DoubleSide,transparent:!0,opacity:this._opacityMat,depthWrite:!1,map:A,clippingPlanes:x,clipIntersection:!1}),this.arrDataSempl=[],this.arrDataSempl.push(new o(0,200,3,1));var m=new THREE.Group;this.content3d.add(m);var v=new THREE.Mesh(new THREE.PlaneBufferGeometry(1,1),new THREE.MeshBasicMaterial({side:THREE.DoubleSide,map:A,transparent:!0}));v.scale.set(1,30,1),v.rotation.z=-Math.PI/2,m.add(v),m.visible=!1,this.helpers=m,this.setConstMax=function(t){x[0].constant=t},this.setConstMin=function(t){x[1].constant=-t},this.addObj=function(t){if(-1==i.arrObj.indexOf(t)){t.updateMatrixWorld();var e=t.clone();!function t(i,e){i.userData.targetObject=e;for(var s=0;s<i.children.length;s++){if(!e.children[s])throw new Error("обекты не одинаковы");t(i.children[s],e.children[s])}}(e,t),function(t){var e=[];!function t(i,e){"Mesh"==i.type&&e.push(i);for(var s=0;s<i.children.length;s++)"Mesh"==i.type?e.push(i.children[s]):t(i.children[s],e)}(t,e);for(var s=0;s<e.length;s++)e[s].material=i._shadowMaterial}(e),i.arrShadowMesh.push(e),i.arrObj.push(t),i.shadowContent3d.add(e),this.dirty=!0}},this.removeObj=function(t){var e=i.arrObj.indexOf(t);-1!=e&&(i.arrObj.splice(e,1),i.shadowContent3d.remove(i.arrShadowMesh[e]),i.arrShadowMesh.splice(e,1),this.dirty=!0)},this.clear=function(){for(var t=0;(t=i.arrObj.length)>0;)if(i.removeObj(i.arrObj[t-1]),t===i.arrObj.length)throw new Error("object not remove")},this.intRend=1,this.intRendOk=1,this.upDate=function(){i.opacityMat&&(i.dunamic&&(i.intRend=i.intRendOk),i.intRend==i.intRendOk&&(i.dirty||function(){for(var t=0;t<i.arrShadowMesh.length;t++)if((i._isDinamFotoRect||b(i.arrShadowMesh[t]))&&w(i.arrShadowMesh[t]))return!0;return!1}())&&i.render(),i.intRend++)};function b(t){var e=!1,s=!1,r=a.min.x,n=a.min.z,o=a.max.x-a.min.x,h=a.max.z-a.min.z;if(a.setFromObject(t.userData.targetObject),e=T(r=a.min.x,n=a.min.z,o=a.max.x-a.min.x,h=a.max.z-a.min.z,i.fotoPosition.x,i.fotoPosition.y,i.fotoWH,i.fotoWH),a.setFromObject(t),s=T(r=a.min.x,n=a.min.z,o=a.max.x-a.min.x,h=a.max.z-a.min.z,i.fotoPosition.x,i.fotoPosition.y,i.fotoWH,i.fotoWH),!e&&!s)return!1;e=!1,s=!1;for(var l=0;l<t.children.length;l++)if(a.setFromObject(t.children[l].userData.targetObject),r=a.min.x,n=a.min.z,o=a.max.x-a.min.x,h=a.max.z-a.min.z,e=e||T(r,n,o,h,i.fotoPosition.x,i.fotoPosition.y,i.fotoWH,i.fotoWH),a.setFromObject(t.children[l]),r=a.min.x,n=a.min.z,o=a.max.x-a.min.x,h=a.max.z-a.min.z,s=s||T(r,n,o,h,i.fotoPosition.x,i.fotoPosition.y,i.fotoWH,i.fotoWH),e||s)return!0;return!0}function w(t){if(!function(t,i){if(t.position.equals(i.position)&&t.quaternion.equals(i.quaternion)&&t.scale.equals(i.scale)&&t.visible===i.visible)return!0;return!1}(t,t.userData.targetObject))return!0;for(var i=0;i<t.children.length;i++)if(w(t.children[i]))return!0;return!1}function P(t){!function(t,i){t.position.copy(i.position),t.quaternion.copy(i.quaternion),t.scale.copy(i.scale),t.visible=i.visible}(t,t.userData.targetObject);for(var i=0;i<t.children.length;i++)P(t.children[i])}this.render=function(){i.isTime&&console.time("render "+e),i.dirty=!1,function(){r.w=.001,y.position.set(r.x,r.y,r.z);for(var t=0;t<i.arrShadowMesh.length;t++)P(i.arrShadowMesh[t]);C()}(),u.addObjFoto(i.shadowContent3d),p=i.fotoWH,c.x=i.fotoPosition.x,c.y=i.fotoPosition.y,i.isDinamFotoRect&&(a.setFromObject(i.shadowContent3d),c.x=a.min.x,c.y=a.min.z,p=Math.max(a.max.x-a.min.x,a.max.z-a.min.z),c.x-=100,c.y-=100,p+=200),u.moveToRect(c.x,c.y,p,p),function(){var t=u.getCanvas(i.imgWH);d.setCanvas(t),0==i.arrDataSempl.length&&d.update();for(var e=0;e<i.arrDataSempl.length;e++)i.setConstMin(i.arrDataSempl[e].min*i._scaleShadow+i._offsetY),i.setConstMax(i.arrDataSempl[e].max*i._scaleShadow+i._offsetY),u.render(),d._blur=i.arrDataSempl[e].blur+(i._scaleShadow>1?i._scaleShadow:0),d._alpha=i.arrDataSempl[e].alpha,d.update();i.setConstMin(-999999),i.setConstMax(999999),f.needsUpdate=!0}(),i.meshPlan.scale.set(p,p,1),i.meshPlan.position.set(c.x+p/2,0,c.y+p/2),i.isTime&&console.timeEnd("render "+e),i.onUpdate&&i.onUpdate()};var _=new THREE.Box3(new THREE.Vector3,new THREE.Vector3(300,300,300));this.boundingBoxUv=_;var S=new THREE.Vector3;function I(t){if("Mesh"===t.type){var e=!1,s=t.getWorldPosition(t.position),r=t.getWorldQuaternion(t.quaternion),n=i.maxHeight;s.y-=i._offsetY,t.userData.pos?t.userData.pos.y!=s.y?e=!0:t.userData.rot.equals(r)?t.userData.maxHeight!==n?e=!0:t.userData.scaleShadow!==i._scaleShadow&&(e=!0):e=!0:e=!0,i._isDinamFotoRect||(a.setFromObject(t),T(a.min.x,a.min.z,a.max.x-a.min.x,a.max.z-a.min.z,i.fotoPosition.x,i.fotoPosition.y,i.fotoWH,i.fotoWH)||(e=!1)),e&&(!function(t){t.geometry.uuid===t.userData.targetObject.geometry.uuid&&(t.geometry=t.userData.targetObject.geometry.clone());var e=_,s=0;if(t.geometry instanceof THREE.Geometry){for(var r=t.geometry.faces,n=t.geometry.vertices,a=t.geometry.faceVertexUvs[0],o=0;o<r.length;o++)S.set(n[r[o].a].x,n[r[o].a].y,n[r[o].a].z),t.localToWorld(S),s=1-M(S.y-i._offsetY,e.min.y,e.min.y+e.max.y)/100,a[o][0].set(s,s),S.set(n[r[o].b].x,n[r[o].b].y,n[r[o].b].z),t.localToWorld(S),s=1-M(S.y-i._offsetY,e.min.y,e.min.y+e.max.y)/100,a[o][1].set(s,s),S.set(n[r[o].c].x,n[r[o].c].y,n[r[o].c].z),t.localToWorld(S),s=1-M(S.y-i._offsetY,e.min.y,e.min.y+e.max.y)/100,a[o][2].set(s,s);t.geometry.uvsNeedUpdate=!0}else{var h=t.geometry.attributes.position.array;t.geometry.attributes.uv||(arrUvAttribut=new Float32Array(h.length/3*2),t.geometry.addAttribute("uv",new THREE.BufferAttribute(arrUvAttribut,2)));var l=t.geometry.attributes.uv.array,u=(t.geometry.attributes.uv.itemSize,t.geometry.index.array),c=t.geometry.index.count;for(o=0;o<c;o++){var p=u[o],d=3*p,f=2*p;S.set(h[d],h[d+1],h[d+2]),t.localToWorld(S),s=1-M(S.y-i._offsetY,e.min.y,e.min.y+e.max.y*i._scaleShadow)/100,l[f]=s,l[f+1]=s}t.geometry.attributes.uv.needsUpdate=!0}}(t),t.userData.pos=s,t.userData.rot=r,t.userData.maxHeight=n,t.userData.scaleShadow=i._scaleShadow)}for(var o=0;o<t.children.length;o++)I(t.children[o])}function C(){v.scale.x=(i.boundingBoxUv.max.y||1)*i._scaleShadow,v.position.y=v.scale.x/2+i.boundingBoxUv.min.y;for(var t=0;t<i.arrShadowMesh.length;t++)(i._isDinamFotoRect||(a.setFromObject(i.arrShadowMesh[t]),T(a.min.x,a.min.z,a.max.x-a.min.x,a.max.z-a.min.z,i.fotoPosition.x,i.fotoPosition.y,i.fotoWH,i.fotoWH)))&&I(i.arrShadowMesh[t])}this.updateShadowUv=C,this.updateShadowTexture=function(){this.canvasGG.update(),this.textureShadow.needsUpdate=!0},this.setShadowColor=function(t,e,s){g.r=t,g.g=e,g.b=s,i.updateShadowTexture()},this.getConfig=function(){var t={};return t.imgWH=i.imgWH,t.fotoPosition={x:i._fotoPosition.x,y:i._fotoPosition.y},t.fotoWH=i.fotoWH,t.maxHeight=i.maxHeight,t.isDinamFotoRect=i.isDinamFotoRect,t.arrDataSempl=i.arrDataSempl,t.opacityMat=i.opacityMat,t.dunamic=i.dunamic,t.canvasGG={arrColorStopTranspanent:i.canvasGG.arrColorStopTranspanent,arrProcent:i.canvasGG.arrProcent},t},this.setConfig=function(t){i.canvasGG.arrColorStopTranspanent=t.canvasGG.arrColorStopTranspanent,i.canvasGG.arrProcent=t.canvasGG.arrProcent,i.fotoPosition.x=t.fotoPosition.x,i.fotoPosition.y=t.fotoPosition.y,i.fotoWH=t.fotoWH,i.isDinamFotoRect=t.isDinamFotoRect,i.arrDataSempl=t.arrDataSempl,i.opacityMat=t.opacityMat,i.imgWH=t.imgWH,i.dunamic=t.dunamic,i.updateShadowTexture(),i.maxHeight=t.maxHeight};var E={imgWH:1024,fotoPosition:{x:0,y:0},fotoWH:150,maxHeight:300,isDinamFotoRect:!1,arrDataSempl:[{min:0,max:6,blur:.8,alpha:.25},{min:4,max:15,blur:3,alpha:.64},{min:10,max:23,blur:4,alpha:.5},{min:15,max:50,blur:15,alpha:1},{min:20,max:198.09,blur:15,alpha:.7},{min:0,max:2,blur:1.02,alpha:1}],opacityMat:1,dunamic:!0,canvasGG:{arrColorStopTranspanent:[0,1,.25],arrProcent:[.4,1,.96]}};function T(t,i,e,s,r,n,a,o){return t<r+a&&i<n+o&&t+e>r&&i+s>n}function M(t,i,e,s){return i=null!=i?i:0,e=null!=e?e:100,s=s||100,isNaN(parseFloat(t))&&(t=i),t<i&&(t=i),t>e&&(t=e),t=Math.round(t*s)/s,i<0?100*(Math.abs(i)+t)/(Math.abs(i)+Math.abs(e)||1):100*(Math.abs(i)-t)/(Math.abs(i)-Math.abs(e)||1)}this.sss=E,this.setConfig(E),this.getBase64=function(){return i.render(),d.canvas.toDataURL()},this.debug=!1}function o(t,i,e,s){this.min=t||0,this.max=i||1,this.blur=e||0,this.alpha=s||1}function h(){var t=this,i=document.createElement("canvas");this.canvas=i,i.width=256,i.height=256;var e=i.getContext("2d"),s=new Image;this.b64=null,this._blur=0,this._blur1=1,this._alpha=1,this.image=new Image,this.setBase64=function(e,r){this.b64=e,(s=new Image).onload=function(){i.clearRect(0,0,i.width,i.height),i.width=s.width,i.height=s.height,t.update(),r&&r(i.toDataURL())},s.src=e},this.setCanvas=function(t){s=t,i.width=t.width,i.height=t.height},this.update=function(){e.filter="blur("+t._blur+"px)",e.globalAlpha=t._alpha,e.drawImage(s,0,0)}}function l(){var t=this,i=document.createElement("canvas");i.width=i.height=256,this.canvas=i;var e=i.getContext("2d");this._blur=0,this._alpha=1,this.arrColorStopTranspanent=[0,1],this.arrProcent=[0,1],this.position=new THREE.Vector2,this.position1=new THREE.Vector2(1,0),this.r=0,this.g=0,this.b=0,this.update=function(){var s=i.width,r=i.height;e.clearRect(0,0,s,r),e.rect(0,0,s,r),e.filter="blur("+t._blur+"px)",e.globalAlpha=t._alpha;for(var n=t.position.x*s,a=t.position.y*r,o=t.position1.x*s,h=t.position1.y*r,l=e.createLinearGradient(n,a,o,h),u=0;u<t.arrColorStopTranspanent.length;u++)l.addColorStop(t.arrProcent[u],"rgba("+t.r+","+t.g+","+t.b+","+t.arrColorStopTranspanent[u]+")");e.fillStyle=l,e.fill()},this.update()}function u(t){this.parent=t;this._active=!1,this._visible=!0,this.WH=512,this._wn=this.WH,this._obj3d=void 0,this.smc=void 0,this.init=function(){null==this.smc&&(this.smc=new a,this.smc.fotoPosition.set(-this._wn/2,-this._wn/2),this.smc.fotoWH=this._wn,this.smc.content3d.rotation.x=-Math.PI/2,this.smc.content3d.position.y=-1,this.smc.content3d.visible=this._visible,this.dergObj())},this.dergActiv=function(){1==this._active?null==this.smc.content3d.parent&&this.parent.parent.groupObject.add(this.smc.content3d):null!=this.smc.content3d.parent&&this.parent.parent.groupObject.remove(this.smc.content3d)},this.render=function(){null!=this.smc&&null!=this.smc.content3d.parent&&this.smc.upDate()},this.dergObj=function(){null!=this.smc&&(null!=this._obj3d?this.smc.arrObj[0]==this._obj3d||(this.smc.clear(),this.smc.addObj(this._obj3d)):this.smc.clear())}}function c(t){var i=this;this.visi3D=t,this.box3=new THREE.Box3,this.rectScreen=new d,this.world=new d(0,0,100,100),this.targetObject=null,this.arrPoint=[],this.isMoveCam=!1,this.isFromGeometry=!1,this._offset=0,this._active=!0,this._debug=!1;var e=new THREE.Vector2,s=new THREE.Vector2,r=new THREE.Vector3;function n(){i.zumeVisi3D(),e.set(i.world.x+i.world.width/2,i.world.y+i.world.height/2),s.set(i.rectScreen.x+i.rectScreen.width/2,i.rectScreen.y+i.rectScreen.height/2),e.sub(s).divideScalar(2)}this.upDate=function(){if(i.active&&(this.updateBound3d(),!i.box3.isEmpty())){if(this.visi3D.xVerh=r.x,this.visi3D.zVerh=r.z,this.visi3D.yVerh=-r.y,i.zumeVisi3D(),i.isMoveCam){n();for(var t=0;e.length()>2&&++t<10;)this.visi3D.position3d.moveCamXY(e),n()}i.debugFocus&&i.debugFocus.upDate()}},this.zumeVisi3D=function(){for(var t,e,s=0,r=6e4,n=0;s<r&&!(++n>20)&&(e=t=(s+r)/2,i.visi3D.zume=e,!(Math.abs(s-t)<.01||Math.abs(r-t)<.01||t<.01));)i.updateRectScreen(),i.isZoomIn()?r=t:s=t+1},this.updateBound3d=function(){if(i.box3.makeEmpty(),i.targetObject)i.box3.copy(i.getCompoundBoundingBox(i.targetObject));else for(var t=0;t<i.arrPoint.length;t++)i.box3.expandByPoint(i.arrPoint[t]);i.box3.getCenter(r)},this.updateRectScreen=function(){if(this.visi3D.camera.updateMatrixWorld(),this.visi3D.scene.updateMatrixWorld(),i.targetObject&&i.isFromGeometry){var t=i.getBoxObject(i.targetObject);i.box3.copy(t.box3),i.box3.getCenter(r),i.setRectFromBox(i.rectScreen,t.box2)}else i.setRectFromBox(i.rectScreen,i.boxToScreen(i.box3));i.updateWorldSize()},this.setRectFromBox=function(t,i){t.x=i.min.x,t.y=i.min.y,t.width=i.max.x-i.min.x,t.height=i.max.y-i.min.y},this.getCompoundBoundingBox=function(){var t=new THREE.Box3,i=new THREE.Box3;function e(e){var s=e.geometry;void 0!==s&&(s.boundingBox||s.computeBoundingBox(),i.copy(s.boundingBox),i.applyMatrix4(e.matrixWorld),t.union(i))}return function(i){return i.updateMatrixWorld(!0),t.makeEmpty(),i.traverseVisible(e),t}}(),this.boxToScreen=function(){for(var t=new THREE.Box2,e=[],s=0;s<8;s++)e[s]=new THREE.Vector3;return function(s){t.makeEmpty(),e[0].set(s.min.x,s.min.y,s.min.z),e[1].set(s.min.x,s.max.y,s.min.z),e[2].set(s.max.x,s.min.y,s.min.z),e[3].set(s.max.x,s.max.y,s.min.z),e[4].set(s.min.x,s.min.y,s.max.z),e[5].set(s.min.x,s.max.y,s.max.z),e[6].set(s.max.x,s.min.y,s.max.z),e[7].set(s.max.x,s.max.y,s.max.z);for(var r=0;r<e.length;r++)t.expandByPoint(i.toScreenXY(e[r]));return t}}(),this.getBoxObject=function(){var t,e,s=new THREE.Box2,r=new THREE.Box3,n={box2:s,box3:r},a=new THREE.Vector3;function o(n){var o=n.geometry;if(void 0!==o)if(o.isGeometry){var h=o.vertices;for(t=0,e=h.length;t<e;t++)a.copy(h[t]).applyMatrix4(n.matrixWorld),r.expandByPoint(a),s.expandByPoint(i.toScreenXY(a))}else if(o.isBufferGeometry){var l=o.attributes.position;if(void 0!==l)for(t=0,e=l.count;t<e;t++)a.fromBufferAttribute(l,t).applyMatrix4(n.matrixWorld),r.expandByPoint(a),s.expandByPoint(i.toScreenXY(a))}}return function(t){return t.updateMatrixWorld(!0),s.makeEmpty(),r.makeEmpty(),t.traverseVisible(o),n}}();var a=new THREE.Vector2,o=new THREE.Vector3;this.toScreenXY=function(t){return o.copy(t),o.project(i.visi3D.camera),a.x=Math.round((o.x+1)*i.visi3D._width/2),a.y=Math.round((1-o.y)*i.visi3D._height/2),a},this.updateWorldSize=function(){i.world.x=i.offset,i.world.y=i.offset,i.world.width=this.visi3D._width-2*i.offset,i.world.height=this.visi3D._height-2*i.offset},this.isZoomIn=function(){return i.rectScreen.x>i.world.x&&i.rectScreen.x+i.rectScreen.width<i.world.x+i.world.width&&i.rectScreen.y>i.world.y&&i.rectScreen.y+i.rectScreen.height<i.world.y+i.world.height}}function p(t){var i=this;this.mFocus=t;var e=visi3D.scene,s=main.stage,r=new BoxHelper(1,materialAlphaRed);e.add(r);var n=new PIXI.Graphics;n.hitArea=new PIXI.Rectangle(0,0,0,0),s.addChild(n),i.active=!1,r.visible=n.visible=i.active,this.upDate=function(){r.visible=n.visible=i.active,i.active&&(n.clear(),n.position.set(visi3D._x,visi3D._y),n.lineStyle(1,0,1),n.drawRect(t.world.x,t.world.y,t.world.width,t.world.height),n.lineStyle(1,16711680,1),n.drawRect(t.rectScreen.x,t.rectScreen.y,t.rectScreen.width,t.rectScreen.height),r.width=t.box3.max.x-t.box3.min.x,r.depth=t.box3.max.y-t.box3.min.y,r.height=t.box3.max.z-t.box3.min.z,t.box3.getCenter(r.position))}}function d(t,i,e,s,r){this._x=t||0,this._y=i||0,this._width=void 0!==e?e:100,this._height=void 0!==s?s:100,this.angel=0,this.p=new f,this.fun,this.set=function(t,i,e,s){this._x=t||0,this._y=i||0,this._width=void 0!==e?e:100,this._height=void 0!==s?s:100},this.setRect=function(t){this._x=t.x,this._y=t.y,this._width=t.width,this._height=t.height,this.p.setPoint(t.p),this.angel=t.angel}}function f(t,i,e){this._x=t||0,this._y=i||0,this._z=e||0,this.xx=0,this.yy=0,this.zz=0,this.set=function(t,i,e){this._x=t||0,this._y=i||0,void 0!==e&&(this._z=e)},this.setPoint=function(t){this._x=t.x,this._y=t.y,void 0!==t.z&&(this._z=t.z)},this.getObj=function(){var t={};return t.x=this._x,t.y=this._y,t.z=this._z,t},this.copy=function(){return new f(this._x,this._y,this._z)}}function g(t){var i=this;this.parent=t,this._debug=!1,this.debugInit=!1,this.shadowHelper=void 0,this.spotLightHelper=void 0,this.gridHelper=void 0,this.FIXATION=!1,this.ROTATION_X=0,this.ROTATION_Z=0,this.DISTANCE=this.parent.DISTANCE,this.CUB_HEIGHT=this.parent.CUB_HEIGHT,this.CUB_WIDTH=this.parent.CUB_WIDTH,this.SKY_X=0,this.SKY_Y=0,this.SKY_Z=0,this._fixation=this.FIXATION,this._rotationX=this.ROTATION_X,this._rotationZ=this.ROTATION_Z,this._distance=this.DISTANCE,this._cubHeight=this.CUB_HEIGHT,this._cubWidth=this.CUB_WIDTH,this.sky=new r(this),this.smc=new u(this),this.focus=new c(this.parent),this.funDebug=function(){1!=this.debugInit&&(this.debugInit=!0,this.plane=new THREE.Mesh(new THREE.PlaneBufferGeometry(1e3,1e3).rotateX(-Math.PI),new THREE.MeshPhongMaterial({color:11316396,transparent:!0,opacity:.5})),this.plane.castShadow=this.plane.receiveShadow=!0,this.plane.position.z=2,this.plane.renderOrder=1,this.gridHelper=new THREE.GridHelper(1e3,10),this.gridHelper.rotation.x=-Math.PI/2,this.shadowHelper=new THREE.CameraHelper(this.parent.sunLight.shadow.camera),this.parent.sunLight&&(this.spotLightHelper=new THREE.DirectionalLightHelper(this.parent.sunLight))),1==this._debug?(null==this.gridHelper.parent&&this.parent.groupObject.add(this.gridHelper),null==this.plane.parent&&this.parent.groupObject.add(this.plane),null==this.shadowHelper.parent&&this.parent.scene.add(this.shadowHelper),this.parent.sunLight&&(null!=this.parent.sunLight.parent||(null!=this.spotLightHelper.parent&&this.parent.scene.remove(this.spotLightHelper),null!=this.shadowHelper.parent&&this.parent.scene.remove(this.shadowHelper)))):(null!=this.gridHelper.parent&&this.parent.groupObject.remove(this.gridHelper),null!=this.plane.parent&&this.parent.groupObject.remove(this.plane),null!=this.shadowHelper.parent&&this.parent.scene.remove(this.shadowHelper),this.parent.sunLight&&null!=this.spotLightHelper.parent&&this.parent.scene.remove(this.spotLightHelper))},this.render=function(){1==this._debug&&null!=this.spotLightHelper&&this.spotLightHelper.update(),this.smc.render(),this.sky.render(),this.focus.upDate(),this.dragSunLight()};var e=0;this.dragSunLight=function(){var t;null!=this.parent.sunLight&&(null!=this.parent.sunLight.parent&&(!0===i._fixation?(e=this._distance+2*this._cubHeight,i.parent.sunLight.position.set(0,e,0),i.parent.sunLight.position.applyAxisAngle(new THREE.Vector3(1,0,0),i._rotationX),i.parent.sunLight.position.applyAxisAngle(new THREE.Vector3(0,1,0),i._rotationZ-i.parent._rotationZ)):(e=this._distance+this._cubHeight,this.parent.sunLight.position.set(0,e,0),this.parent.sunLight.position.applyAxisAngle(new THREE.Vector3(1,0,0),this._rotationX),this.parent.sunLight.position.applyAxisAngle(new THREE.Vector3(0,1,0),this._rotationZ),this.parent.staticShadow&&(t=new THREE.Vector3(i.parent.xVerh,i.parent.yVerh,i.parent.zVerh),i.parent.sunLight.position.add(t),i.parent.sunLight.target.position.copy(t),s.distanceTo(t)>i.distanceUpdateShadow&&(s.copy(t),i.parent.shadowNeedsUpdate=!0)))))};var s=new THREE.Vector3;this.distanceUpdateShadow=500,this.dragSunLight2=function(){null!=this.parent.sunLight&&null!=this.parent.sunLight.parent&&(!0===this._fixation||(e=this._distance+2*this._cubHeight,this.parent.sunLight.position.set(0,e,0),this.parent.sunLight.position.applyAxisAngle(new THREE.Vector3(1,0,0),this._rotationX),this.parent.sunLight.position.applyAxisAngle(new THREE.Vector3(0,1,0),this._rotationZ)))},this.dragSunLight3=function(){this.parent.sunLight&&(this.parent.sunLight.shadow.camera.near=0+this._cubHeight,this.parent.sunLight.shadow.camera.far=2*this._cubHeight+this._cubHeight,this.parent.sunLight.shadow.camera.updateProjectionMatrix(),this.shadowHelper&&this.shadowHelper.update())},this.sunActiv=function(t){this.parent.objShadow(this.parent.group,t),1==t?null==this.parent.sunLight.parent&&(this.parent.scene.add(this.parent.sunLight),this.parent.scene.add(i.parent.sunLight.target)):null!=this.parent.sunLight.parent&&(this.parent.scene.remove(this.parent.sunLight),this.parent.scene.remove(i.parent.sunLight.target)),this.funDebug()},this.ambientActiv=function(t){1==t?null==this.parent.ambientLight.parent&&this.parent.scene.add(this.parent.ambientLight):null!=this.parent.ambientLight.parent&&this.parent.scene.remove(this.parent.ambientLight)}}r.prototype={set x(t){this._x!==t&&(this._x=t,this.cont3d.position.x=t,this.parent.parent.intRend=1)},get x(){return this._x},set y(t){this._y!==t&&(this._y=t,this.cont3d.position.y=t,this.parent.parent.intRend=1)},get y(){return this._y},set z(t){this._z!==t&&(this._z=t,this.cont3d.position.z=t,this.parent.parent.intRend=1)},get z(){return this._z},set active(t){this._active!==t&&(this._active=t,this.init(),this.dergActiv())},get active(){return this._active},set radius(t){this._radius!==t&&(this._radius=t,null!=this.mesh&&this.mesh.scale.set(this._radius,this._radius,this._radius))},get radius(){return this._radius},set link(t){this._link!==t&&(this._link=t,this.init(),this.dergLink())},get link(){return this._link},set color(t){if(this._color!==t){this._color=t,this.init();var i=this._color;if("string"==typeof i&&-1!=i.indexOf("x")){var e=i.split("x");i="#"+e[1]}this.material.color=new THREE.Color(i)}},get color(){return this._color}},Object.defineProperties(a.prototype,{scaleShadow:{set:function(t){this.dirty=!0,this._scaleShadow=t},get:function(){return this._scaleShadow}},debug:{set:function(t){this.helpers.visible=t},get:function(){return this.helpers.visible}},offsetY:{set:function(t){this._offsetY=t,this.dirty=!0},get:function(){return this._offsetY}},maxHeight:{set:function(t){this.dirty=!0,this.boundingBoxUv.max.y=t,this.updateShadowUv()},get:function(){return this.boundingBoxUv.max.y}},dunamic:{set:function(t){this.dirty=!0,this._dunamic=t},get:function(){return this._dunamic}},fotoPosition:{set:function(t){this.dirty=!0,this._fotoPosition=t},get:function(){return this._fotoPosition}},fotoWH:{set:function(t){this.dirty=!0,this._fotoWH=t},get:function(){return this._fotoWH}},imgWH:{set:function(t){this.dirty=!0,this._imgWH=t},get:function(){return this._imgWH}},imgBlur:{set:function(t){this.dirty=!0,this._imgBlur=t},get:function(){return this.dirty=!0,this._imgBlur}},imgAlpha:{set:function(t){this.dirty=!0,this._imgAlpha=t},get:function(){return this._imgAlpha}},isDinamFotoRect:{set:function(t){this.dirty=!0,this._isDinamFotoRect=t},get:function(){return this._isDinamFotoRect}},opacityMat:{set:function(t){this.dirty=!0,this._opacityMat=t,this.matPlan.opacity=this._opacityMat},get:function(){return this._opacityMat}},shadowMaterial:{set:function(t){if(t!==this._shadowMaterial){this._shadowMaterial=t;for(var i=0;i<this.arrShadowMesh.length;i++)if(this.arrShadowMesh[i]instanceof THREE.ShadowMesh)this.arrShadowMesh[i].material=this._shadowMaterial;else for(var e=0;e<this.arrShadowMesh[i].children.length;e++)this.arrShadowMesh[i].children[e]instanceof THREE.ShadowMesh&&(this.arrShadowMesh[i].children[e].material=this._shadowMaterial)}},get:function(){return this._shadowMaterial}},lightPosition4D:{set:function(t){this._lightPosition4D.set(t.x,t.y,t.z,.001)},get:function(){return this._lightPosition4D}}}),Object.defineProperties(h.prototype,{blur:{set:function(t){this._blur=t},get:function(){return this._blur}},alpha:{set:function(t){this._alpha=t},get:function(){return this._alpha}}}),Object.defineProperties(l.prototype,{}),u.prototype={set active(t){this._active!==t&&(this._active=t,this.init(),this.dergActiv())},get active(){return this._active},set visible(t){this._visible!==t&&(this._visible=t,null!=this.smc&&(this.smc.content3d.visible=t))},get visible(){return this._visible},set obj3d(t){this._obj3d!==t&&(this._obj3d=t,this.dergObj())},get obj3d(){return this._obj3d},set wh(t){this._wh!==t&&(this._wh=t,null!=this.smc&&(this.smc.fotoPosition.set(-this._wn/2,-this._wn/2),this.smc.fotoWH=this._wn))},get wh(){return this._wh}},c.prototype={set offset(t){this._offset=t||0},get offset(){return this._offset},set debug(t){this._debug=t,t&&!this.debugFocus&&(this.debugFocus=new p(this)),this.debugFocus&&(this.debugFocus.active=t)},get debug(){return this._debug},set active(t){this._active=t,t||(this.debug=!1)},get active(){return this._active}},d.prototype={set x(t){this._x!==t&&(this._x=t)},get x(){return this._x},set y(t){this._y!==t&&(this._y=t)},get y(){return this._y},set width(t){this._width!==t&&(this._width=t)},get width(){return this._width},set height(t){this._height!==t&&(this._height=t)},get height(){return this._height}},f.prototype={set x(t){this._x=t},get x(){return this._x},set y(t){this._y=t},get y(){return this._y},set z(t){this._z=t},get z(){return this._z}},e.d(i,"a",function(){return g}),g.prototype={set debug(t){this._debug!==t&&(this._debug=t,this.funDebug())},get debug(){return this._debug},set rotationX(t){this._rotationX!==t&&(this._rotationX=t,null!=this.spotLightHelper&&(this.parent.sunLight.shadow.camera.updateProjectionMatrix(),this.spotLightHelper.update()),this.dragSunLight2())},get rotationX(){return this._rotationX},set rotationZ(t){this._rotationZ!==t&&(this._rotationZ=t,this.sky.shadRotZ=t,null!=this.spotLightHelper&&this.spotLightHelper.update(),this.dragSunLight2())},get rotationZ(){return this._rotationZ},set fixation(t){this._fixation!==t&&(this._fixation=t,this.dragSunLight2())},get fixation(){return this._fixation},set distance(t){this._distance!==t&&(this._distance=t,this.dragSunLight3(),this.dragSunLight2())},get distance(){return this._distance},set cubHeight(t){this._cubHeight!==t&&(this._cubHeight=t,this.dragSunLight3(),this.dragSunLight2())},get cubHeight(){return this._cubHeight},set cubWidth(t){this._cubWidth!==t&&(this._cubWidth=t,this.parent.sunLight&&(this.parent.sunLight.shadow.camera.right=this._cubWidth,this.parent.sunLight.shadow.camera.left=-this._cubWidth,this.parent.sunLight.shadow.camera.top=this._cubWidth,this.parent.sunLight.shadow.camera.bottom=-this._cubWidth,this.parent.sunLight.shadow.camera.updateProjectionMatrix(),this.shadowHelper&&this.shadowHelper.update()))},get cubWidth(){return this._cubWidth}}},function(t,i,e){"use strict";function s(t,i){for(var e=0;e<i.length;e++){var s=i[e];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}var r=function(){function t(i,e){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,t),this.type="MStyle";var s=this;this.par=i,this.fun=e,this._active=!1,this.otstup=this.par.otstup,this.wh=this.par.wh,this.dCont=new DCont(i.dCont),this.dCont.x=4*this.otstup+this.wh,this.dCont.y=4*this.otstup+this.wh;var r=['{"colorC0":"#ffe4d4","colorC1":"#b0dfee","delphC0":200,"delphC1":500,"delphPlus":100,"sizeLine":10, "colorLine":"#000000"}','{"colorC0":"#ffc0b0","colorC1":"#3a11b5","delphC0":262.33,"delphC1":744.91, "delphPlus":150, "sizeLine":10,"colorLine":"#000000"}','{"colorC0":"#89ffa3","colorC1":"#07419b","delphC0":824.43,"delphC1":206.37, "delphPlus":100,"sizeLine":10, "colorLine":"#000000"}'];this.dCont.visible=this._active,this.object=JSON.parse(r[0]),this.init=function(){if(null==this.window){this.window=new DWindow(this.dCont,0,0,"style"),this.pObject=new DParamObject(this.window.content,this.otstup,this.otstup,function(){s.dragObj(s.object)}),this.pObject.tipRide=!0,this.pObject.w.hasMinimizeButton=!1,this.pObject.w.dragBool=!1,this.pObject.w.text="Project styles",this.pObject.width=this.pObject.w.width=250,this.pObject.addObject(this.object),this.panel=new DPanel(this.window.content,this.pObject.width+2*this.otstup,this.otstup);for(var t=0;t<r.length;t++){var i=new DButton(this.panel,this.otstup+t*(this.otstup+this.wh),this.otstup,""+t,function(){var t=JSON.parse(r[this.idArr]);s.object=t,s.pObject.addObject(s.object),s.dragObj(t)});i.idArr=t,i.width=i.height=this.wh}this.panel.width=r.length*(this.otstup+this.wh)+this.otstup,this.panel.height=this.pObject.w.height,this.window.width=this.panel.width+this.panel.x+this.otstup,this.window.height=this.pObject.w.height+32+2*this.otstup,this.textArea=new DTextArea(this.panel,this.otstup,2*this.otstup+this.wh,"null"),this.textArea.width=this.panel.width-2*this.otstup,this.textArea.height=this.panel.height-this.textArea.y-this.otstup}},this.dragObj=function(t){var i=JSON.stringify(t);s.textArea.value=i,s.fun("dragStyleObj",t)}}var i,e,r;return i=t,(e=[{key:"active",set:function(t){this._active!=t&&(this._active=t,this.init(),this.dCont.visible=t)},get:function(){return this._active}}])&&s(i.prototype,e),r&&s(i,r),t}();e(8);function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}e.d(i,"a",function(){return a});var a=function t(i,e){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,t),this.type="MStart";var s=this;this.par=i,this.fun=e,this.dCont=new DCont(i.dCont),this.otstup=this.par.otstup,this.wh=this.par.wh,this.w=new DPanel(this.dCont,this.par.otstup,this.par.otstup),this.w.height=i.wh+2*this.par.otstup,this.dCont1=new DCont(this.w),s.input=void 0,this.menuScene=void 0,s.localStorage=this.par.localStorage,this.opentScane=function(){bopent.visible=!1;var t=s.par.fun("returnHoneycomb");s.menuScene=new MenuScene(s.w.content,t.visi3D,function(t,i){trace(t,i)}),s.menuScene.sceneSB.setObj(JSON.parse(t.jsonCamera)),s.menuScene.setObj()},this.init1=function(){var t,e=0;(t=new DButton(this.dCont1,e,this.par.otstup,"SP",function(){s.par.mObject.setObject(s.par.p20.sp)})).width=t.height=i.wh,e+=i.wh+this.par.otstup,(t=new DButton(this.dCont1,e,this.par.otstup,"P20",function(){s.par.mObject.setObject(s.par.p20)})).width=t.height=i.wh,e+=i.wh+this.par.otstup,this.dCont1.width=e},this.init1(),this.openJSON=function(t){var i;i="object"==n(t)?t:JSON.parse(t),s.par.fun("setObjSP",i);var e=s.par.par.p20.getRect(s.par.par.p20.index);null!=e&&s.par.mGridDrag.setRect(e,this.par.otstup,!0)},this.inputS,this.visiId=function(t){this.inputS&&(this.inputS.text=t+"")},this.init=function(){var t,e=0;(t=new DButton(this.w,this.par.otstup+(i.wh+this.par.otstup)*e,this.par.otstup,"clear",function(){trace(s.sp),s.sp.clear()})).width=t.height=i.wh,e++,(t=new DButton(this.w,this.par.otstup+(i.wh+this.par.otstup)*e,this.par.otstup,"rect",function(){var t=s.par.par.p20.getRect(s.par.par.p20.index);s.par.mGridDrag.setRect(t,s.par.otstup,!0)})).width=t.height=i.wh,e++;var n=new DButton(this.w,this.par.otstup+(i.wh+this.par.otstup)*e,this.par.otstup,"style",function(){s.sStyle.active=!0});n.width=n.height=i.wh,e++;var a=new DButton(this.w,this.par.otstup+(i.wh+this.par.otstup)*e,this.par.otstup,"dev",function(){s.dev.active=!s.dev.active});a.width=a.height=i.wh,e++;var o=new DButton(this.w,this.par.otstup+(i.wh+this.par.otstup)*e,this.par.otstup,"saveL",function(){s.par.localStorage.object.model=s.par.mDragScane.p20.getObj(),s.par.localStorage.save(),h.visible=!0});o.width=i.wh,o.height=i.wh/2;var h=new DButton(this.w,this.par.otstup+(i.wh+this.par.otstup)*e,this.par.otstup+i.wh/2,"clearL",function(){s.par.localStorage.object.model=null,s.par.localStorage.save(),h.visible=!1});h.width=i.wh,h.height=i.wh/2,h.visible=!1,e++,s.inputS=new DInput(this.w,this.par.otstup+(i.wh+this.par.otstup)*e,this.par.otstup,"20"),s.inputS.height=i.wh/2-2,s.inputS.width=2*i.wh+this.par.otstup-3;var l=new DButton(this.w,this.par.otstup+(i.wh+this.par.otstup)*e,this.par.otstup+i.wh/2,"open",function(){s.fun("openId",s.inputS.text)});l.width=i.wh,l.height=i.wh/2,e++;var u=new DButton(this.w,this.par.otstup+(i.wh+this.par.otstup)*e,this.par.otstup+i.wh/2,"save",function(){trace("###########################################"),s.fun("saveGetObjId")});u.width=i.wh,u.height=i.wh/2,setTimeout(function(){null==s.par.localStorage.object.model||(s.openJSON(s.par.localStorage.object.model),h.visible=!0)},10),this.par.array[this.par.array.length]=this.sStyle=new r(this,function(t,i){s.par.fun(t,i)}),setTimeout(function(){s.init3()},10)},this.init3=function(t){var i=document.createElement("script");i.src="src/libMy/divLibPlus.js",document.head.append(i),i.onload=function(){s.dev=new DCompDev(s.dCont,64,80,"DevWindow",function(){}),s.dev.active=!1}},s.dev=void 0,this.p20=void 0,this.setP20=function(t){this.p20=t},this.sp=void 0,this.setSP=function(t){this.sp=t},this.setObj=function(t){if(null!=s.textArea){var i=JSON.stringify(t);1==s.check.value&&(i=JSON.stringify(t,null,"\t")),s.textArea.value=i}},this.startObj=void 0,this.setArrObj=function(t){if(this.startObj=t,null!=s.textArea){var i=JSON.stringify(t);s.textArea.value=i}},this.setObject=function(t){null!=s.textArea&&(this.object=s.par.fun("returnScane"),s.input.value=s.object.startVisi,"null"==s.input.value?bGetScane.text="<":bGetScane.text="x",s.par.fun("index",-1),rot.value=this.object.time)},this.sizeWindow=function(t,e,s){this.w.width=t/s-2*i.otstup,this.dCont1.x=this.w.width-this.dCont1.width};var a=function(t){var i=window.document.URL.toString();if(i.split("/"),i.indexOf("?")>0){var e=i.split("?")[1].split("&"),s=new Array(e.length),r=new Array(e.length);e=i.split("?")[1].split("&"),s=new Array(e.length),r=new Array(e.length);var n=0;for(n=0;n<e.length;n++){var a=e[n].split("=");s[n]=a[0],""!=a[1]?r[n]=unescape(a[1]):r[n]=null}for(n=0;n<e.length;n++)if(s[n]==t)return r[n];return null}}("infoDlaVorodis2");null!=a&&(new DLabel(this.w,500,20,"infoDlaVorodis2=  "+a).fontSize=32);s.localStorage.object.debug&&1==s.localStorage.object.debug&&this.init()}},function(t,i,e){"use strict";var s=e(3);function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function n(t){return(n=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function a(t,i){return(a=Object.setPrototypeOf||function(t,i){return t.__proto__=i,t})(t,i)}function o(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var h=function(t){function i(t,e){var s;!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,i),(s=function(t,i){return!i||"object"!==r(i)&&"function"!=typeof i?o(t):i}(this,n(i).call(this,t,e))).type="SobIndex0";var a=o(o(s));s.par=t,s.fun=e;var h={x:0,y:0,o:null},l={x1:0,y1:0,o:null},u={x:0,y:0,x1:0,y1:0,s:0,o:null};s.mousemove=function(t){h.x=u.x+(t.clientX-u.x1)/u.s,h.y=u.y+(t.clientY-u.y1)/u.s,a.korektAP(h,u.o),u.o.position.x=h.x,u.o.position.y=h.y,a.p20.sp.addObjFun(u.o)},s.mouseup=function(t){h.x=u.o.position.x,h.y=u.o.position.y,a.korektAP(h,u.o),null!=h.o&&null!=h.o.type&&("SpPointSten"==h.o.type&&(u.o.slitie(h.o),u.o.dragVokrug()),"SpliceSten"==h.o.type&&u.o.dragVokrug()),document.removeEventListener("mouseup",a.mouseup),document.removeEventListener("mousemove",a.mousemove)};var c={x:0,y:0,x1:0,y1:0,w:0,h:0,o:null};s.mousemove1=function(t){if(a.getPositPlan(l),0==p)return h.x<l.x?(c.x=h.x,c.w=l.x-h.x):(c.x=l.x,c.w=h.x-l.x),h.y<l.y?(c.y=h.y,c.h=l.y-h.y):(c.y=l.y,c.h=h.y-l.y),void a.sp.group.setRect(c);1==p&&(a.sp.group.setPosOffset(l.x-h.x,l.y-h.y),h.x=l.x,h.y=l.y)},s.mouseup1=function(t){0==p&&(a.mousemove1(),a.sp.group.addRect(c),a.sp.group.setRect()),document.removeEventListener("mouseup",a.mouseup1),document.removeEventListener("mousemove",a.mousemove1)};var p=0;return s.sobSP=function(t,i,e){if(void 0!==e&&void 0!==e.data){if(2==e.data.originalEvent.button)return 0==a.boolCTRL&&(a.sp.group.active=!1),0==a.sp.group.active&&(a.sp.group.active=!0,a.par.par.mObject.setObject(a.sp.group)),p=0,a.getPositPlan(h),document.addEventListener("mouseup",a.mouseup1),void document.addEventListener("mousemove",a.mousemove1);if("downGroup"==t)return p=1,a.getPositPlan(h),document.addEventListener("mouseup",a.mouseup1),void document.addEventListener("mousemove",a.mousemove1);if(trace(t,i,e),1==a.boolCTRL)if(i&&i.uuid)return 0==a.sp.group.active&&(a.sp.group.active=!0,a.par.par.mObject.setObject(a.sp.group)),void(0==a.sp.group.addObj(i)&&a.sp.group.removeObj(i));return a.sp.group.active=!1,i&&a.par.par.mObject.setObject(i),"downPoint"==t&&(a.sp.group.active=!1,a.par.par.mObject.setObject(i),0==e.data.originalEvent.button)?(u.x=i.position.x,u.y=i.position.y,u.x1=e.data.originalEvent.clientX,u.y1=e.data.originalEvent.clientY,u.s=a.sp._mashtab,u.o=i,document.addEventListener("mouseup",a.mouseup),void document.addEventListener("mousemove",a.mousemove)):"downVP"==t?(a.sp.group.active=!1,a.par.par.mObject.setObject(i),void a.par.sobIndex[4].dragVP(i)):void a.downFont(e)}},s}return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&a(t,i)}(i,s["a"]),i}();e(6);function l(t){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function u(t,i){for(var e=0;e<i.length;e++){var s=i[e];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function p(t,i){return(p=Object.setPrototypeOf||function(t,i){return t.__proto__=i,t})(t,i)}function d(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var f=function(t){function i(t,e){var s;!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,i),(s=function(t,i){return!i||"object"!==l(i)&&"function"!=typeof i?d(t):i}(this,c(i).call(this,t,e))).type="SobIndex1";var r=d(d(s));s.par=t,s.fun=e,s.aTool=["Sten","Pol"],s._tool="Sten";var n,a,o,h={x:0,y:0,o:null},u={x:0,y:0,x1:0,y1:0,s:0,o:null,oy:null,ox:null};s.mousemove=function(t){h.x=u.x+(t.clientX-u.x1)/u.s,h.y=u.y+(t.clientY-u.y1)/u.s,r.korektAP(h,u.o),u.o.position.x=h.x,u.o.position.y=h.y,r.p20.sp.addObjFun(u.o),r.helpDP.clear(),null!=h.oy&&r.helpDP.dLineParam(u.o.position.x,u.o.position.y,u.o.position.x,h.oy),null!=h.ox&&r.helpDP.dLineParam(u.o.position.x,u.o.position.y,h.ox,u.o.position.y)},s.mouseup=function(t){if(null!=u.o&&(h.x=u.o.position.x,h.y=u.o.position.y,r.korektAP(h,u.o),"Sten"==r._tool&&(null!=h.o&&null!=h.o.type&&("SpPointSten"==h.o.type&&(u.o.slitie(h.o),u.o.dragVokrug()),"SpliceSten"==h.o.type&&u.o.dragVokrug()),r.pointOld=void 0,r.helpDP.clear(),u.o=void 0,r.stopUp()),"Pol"==r._tool)){var i=!1;if(null!=h.o&&null!=h.o.type){if("SpPointSten"==h.o.type){if(a=h.o,o.array.length>3&&o.array[0].idArr==a.idArr)return void r.stopUp();o.array[o.array.length-1].idArr!=a.idArr&&o.addPoint(a,o.array.length-1),i=!0}"SpliceSten"==h.o.type&&((a=r.p20.sp.craetPoint()).position.setPoint(h),o.addPoint(a,o.array.length-1),i=!0)}0==i&&((a=r.p20.sp.craetPoint()).position.setPoint(g),o.addPoint(a,o.array.length-1));for(var e=o.array.length-1;e>=1;e--)o.array[e].idArr==o.array[e-1].idArr&&(o.array.splice(e,1),o.drag())}},s.sobMenu=function(t,i,e){"gIndex"!=t||(r.tool=r.aTool[i.index])},s.boolUp=!1,s.startUp=function(){1!=r.boolUp&&(r.boolUp=!0,console.warn(">>>>>>>>>>>>startUp********>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>"),document.addEventListener("mouseup",r.mouseup))},s.stopUp=function(){if(0!=r.boolUp){if(r.boolUp=!1,"Pol"==r._tool){o.removePoint(n),trace(n.idArr),trace(o);for(var t=0;t<o.array.length;t++)trace(t+"  "+o.array[t].idArr);o.array.length<=2&&o.clear(),n.clear(),u.o=void 0}console.warn("<<<<<<<<<<<<<<stopUp********<<<<<<<<<<<<<<<<<"),document.addEventListener("mouseup",r.mouseup)}},s.sobSP=function(t,i,e){if(1!=e.data.originalEvent.button)if(1!=r.boolUp||"Pol"!=r._tool){if(trace("@@@@@@@@@@@@@@@@@@",t,i,e),"downFont"==t){if(n=r.p20.sp.craetPoint(),a=r.p20.sp.craetPoint(),"Sten"==r._tool&&(o=r.p20.sp.craetSplice1(),n.addSplice(o,!0),a.addSplice(o,!1)),"Pol"==r._tool){(o=r.p20.sp.craetPol()).activMouse=!1,o.activMouse=!1,o.addPoint(a),o.addPoint(n),n.activMouse=!1,trace("%%%%%%%%%%%%%%%%%%%",o.idArr);for(var s=0;s<o.array.length;s++)trace(s+"@@"+o.array[s].idArr)}n.position.set(g.x,g.y),a.position.set(g.x,g.y),a.dragPost(),r.par.par.mObject.setObject(o),u.x=g.x,u.y=g.y,u.x1=e.data.originalEvent.clientX,u.y1=e.data.originalEvent.clientY,u.s=r.sp._mashtab,u.o=n,r.pointOld={x:g.x,y:g.y,uuidArr:[n.uuid,a.uuid]},r.startUp()}if("downSten"==t){var h=this.getPositPlan(),l=calc.isPointInLin(i.position,i.position1,h,11111,0);if(null==l)return;n=r.p20.sp.craetPoint(),(a=r.p20.sp.craetPoint()).position.set(l.x,l.y),"Sten"==r._tool&&(o=r.p20.sp.craetSplice1(),n.addSplice(o,!0),a.addSplice(o,!1)),"Pol"==r._tool&&((o=r.p20.sp.craetPol()).activMouse=!1,o.activMouse=!1,o.addPoint(a),o.addPoint(n),n.activMouse=!1),n.position.set(l.x,l.y),a.position.set(l.x,l.y),a.dragPost(),r.par.par.mObject.setObject(o),u.x=l.x,u.y=l.y,u.x1=e.data.originalEvent.clientX,u.y1=e.data.originalEvent.clientY,u.s=r.sp._mashtab,u.o=n,r.pointOld={x:l.x,y:l.y,uuidArr:[n.uuid,a.uuid]},r.startUp()}if("downPoint"==t){(n=r.p20.sp.craetPoint()).position.setPoint(i.position),"Sten"==r._tool&&(o=r.p20.sp.craetSplice1(),n.addSplice(o,!0),i.addSplice(o,!1)),"Pol"==r._tool&&((o=r.p20.sp.craetPol()).activMouse=!1,o.activMouse=!1,o.addPoint(i),o.addPoint(n),n.activMouse=!1),r.par.par.mObject.setObject(o),u.x=i.position.x,u.y=i.position.y,u.x1=e.data.originalEvent.clientX,u.y1=e.data.originalEvent.clientY,u.s=r.sp._mashtab,u.o=n;var c=[];"Sten"==r._tool&&(c=[o._addPoint.uuid,o._addPoint.uuid]),r.pointOld={x:i.position.x,y:i.position.y,uuidArr:c},r.startUp()}}else 2==e.data.originalEvent.button&&r.stopUp();else r.downFont(e)};var p,f,g={x:0,y:0,x1:0,y1:0,s:0,o:null,oy:null,ox:null};return s.mouseMoveAll=function(t){r.par.par.mGridDrag.getPositPlan(g),r.korektAP(g),r.helpDP.clear(),r.helpDP.alpha=1,p=1/r._mashtab,f=5/r._mashtab,null!=g.ox&&(r.helpDP.dLineParam(g.x,g.y,g.ox,g.y,void 0,p),r.helpDP.dPointParam(g.ox,g.y,f,void 0,f),r.helpDP.dPointParam(g.ox,g.y,f/2,15892548,f/2)),null!=g.oy&&(r.helpDP.dLineParam(g.x,g.y,g.x,g.oy,void 0,p),r.helpDP.dPointParam(g.x,g.oy,f,void 0,f),r.helpDP.dPointParam(g.x,g.oy,f/2,15892548,f/2)),r.sp.render(),null!=u.o&&"SpPointSten"==u.o.type&&(u.o.position.x=g.x,u.o.position.y=g.y,r.p20.sp.addObjFun(u.o))},s.funActive=function(){1==this._active?dcmParam.addFunMove(r.mouseMoveAll):dcmParam.removeFunMove(r.mouseMoveAll),this.stopUp()},s}var e,r,n;return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&p(t,i)}(i,s["a"]),e=i,(r=[{key:"tool",set:function(t){this._tool!=t&&(this._tool=t,this.stopUp())},get:function(){return this._tool}}])&&u(e.prototype,r),n&&u(e,n),i}();function g(t){return(g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function A(t,i){for(var e=0;e<i.length;e++){var s=i[e];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function y(t){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function x(t,i){return(x=Object.setPrototypeOf||function(t,i){return t.__proto__=i,t})(t,i)}function m(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var v=function(t){function i(t,e){var s;!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,i),(s=function(t,i){return!i||"object"!==g(i)&&"function"!=typeof i?m(t):i}(this,y(i).call(this,t,e))).type="SobIndex2";var r=m(m(s));s.par=t,s.fun=e,s.aTool=["spLine","Pol"],s._tool="spLine";var n,a,o,h={x:0,y:0,x1:0,y1:0,s:0,o:null,oy:null,ox:null};s.mouseup=function(t){null!=h.o&&(2!=t.button?("vp"==r._tool&&r.stopUp(),"spLine"!=r._tool?"spLine2"!=r._tool||r.stopUp():r._tool="spLine2"):r.stopUp())},s.sobMenu=function(t,i,e){"gIndex"!=t||(r.tool=r.aTool[i.index])},s.boolUp=!1,s.startUp=function(){1!=r.boolUp&&(r.boolUp=!0,dcmParam.addFunMove(r.mouseMoveAll),console.warn(">>>>>>>>>>>>startUp********>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>"),document.addEventListener("mouseup",r.mouseup))},s.stopUp=function(){0!=r.boolUp&&(r.boolUp=!1,h.o.activMouse=!0,dcmParam.removeFunMove(r.mouseMoveAll),h.o=void 0,r._tool="spLine",console.warn("<<<<<<<<<<<<<<stopUp********<<<<<<<<<<<<<<<<<"),document.addEventListener("mouseup",r.mouseup))},s.sobSP=function(t,i,e){1!=e.data.originalEvent.button?2!=e.data.originalEvent.button?0==r.boolUp&&(n=r.p20.sp.craetVP(),a=r.p20.sp.craetVP(),r.korekt2222(),n.position.set(l.x,l.y),a.position.set(l.x,l.y),h.o=n,null!=l.ePL&&(l.ePL.targetGron.add(n).pros=l.ePL.pros,l.ePL.targetGron.add(a).pros=l.ePL.pros),(o=r.p20.sp.lineWord.craetLine()).addPoint1=a,o.addPoint=n,n.activMouse=!1,n.position.setPoint(l),r._tool="spLine",r.startUp()):r.stopUp():r.downFont(e)},s.korekt2222=function(){r.par.par.mGridDrag.getPositPlan(l),l.ePL=null,null!=(u=r.p20.sp.metod.getPL(l,50))?(l.x=u.x,l.y=u.y,l.ePL=u):r.korektAP(l,null,!0)};var l={x:0,y:0,x1:0,y1:0,s:0,o:null,oy:null,ox:null},u=null;return s.mouseMoveAll=function(t){trace(r._tool),"spLine"==r._tool&&null!=h.o&&(r.korekt2222(),null!=h.o.gronVL&&h.o.gronVL.par.remove(h.o),null!=l.ePL&&(l.ePL.targetGron.add(h.o).pros=l.ePL.pros),h.o.position.setPoint(l)),"spLine2"==r._tool&&(trace(h.o),r.korekt2222(),o.poiskOt(l))},s}var e,r,n;return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&x(t,i)}(i,s["a"]),e=i,(r=[{key:"tool",set:function(t){this._tool!=t&&(this._tool=t,this.stopUp())},get:function(){return this._tool}}])&&A(e.prototype,r),n&&A(e,n),i}(),b=e(14);function w(t){return(w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function P(t,i){for(var e=0;e<i.length;e++){var s=i[e];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function _(t){return(_=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function S(t,i){return(S=Object.setPrototypeOf||function(t,i){return t.__proto__=i,t})(t,i)}function I(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var C=function(t){function i(t,e){var s;!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,i),(s=function(t,i){return!i||"object"!==w(i)&&"function"!=typeof i?I(t):i}(this,_(i).call(this,t,e))).type="SobIndex4";var r=I(I(s));s.par=t,s.fun=e,s.aTool=["Sten","Pol"],s._tool="Pol",s._unikName="PubRoof";var n,a,o,h={x:0,y:0,x1:0,y1:0,s:0,o:null,oy:null,ox:null};s.mouseup=function(t){null!=h.o&&(2!=t.button?"vp"==r._tool&&r.stopUp():r.stopUp())},s.sobMenu=function(t,i,e){"gIndex"!=t||(r.tool=r.aTool[i.index])},s.boolUp=!1,s.startUp=function(){1!=r.boolUp&&(r.boolUp=!0,dcmParam.addFunMove(r.mouseMoveAll),console.warn(">>>>>>>>>>>>startUp********>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>"),document.addEventListener("mouseup",r.mouseup))},s.stopUp=function(){if(0!=r.boolUp){if(r.boolUp=!1,"Pol"==r._tool){o.removePoint(n);for(var t=0;t<o.array.length;t++)o.array[t].activMouse=!0;o.array.length<=2&&o.clear(),n.clear()}h.o.activMouse=!0,dcmParam.removeFunMove(r.mouseMoveAll),h.o=void 0,console.warn("<<<<<<<<<<<<<<stopUp********<<<<<<<<<<<<<<<<<"),document.addEventListener("mouseup",r.mouseup)}},s.dragVP=function(t){r._tool="vp",h.o=t,t.activMouse=!1,r.par.par.mObject.setObject(t),h.o.active=!0,r.startUp()},s.sobSP=function(t,i,e){1!=e.data.originalEvent.button?2!=e.data.originalEvent.button?(r._tool="Pol",0==r.boolUp?(n=r.p20.sp.craetVP(),a=r.p20.sp.craetVP(),r.korekt2222(),n.position.set(l.x,l.y),a.position.set(l.x,l.y),h.o=n,null!=l.ePL&&(l.ePL.targetGron.add(n).pros=l.ePL.pros,l.ePL.targetGron.add(a).pros=l.ePL.pros),(o=r.p20.sp.craetPol(r._unikName)).activMouse=!1,o.activMouse=!1,o.addPoint(a),o.addPoint(n),n.activMouse=!1,n.position.setPoint(l),r.startUp()):(n.activMouse=!0,r.korekt2222(),(n=r.p20.sp.craetVP()).activMouse=!1,h.o=n,null!=l.ePL&&(l.ePL.targetGron.add(n).pros=l.ePL.pros),o.addPoint(n),n.position.setPoint(l))):r.stopUp():r.downFont(e)},s.korekt2222=function(){r.par.par.mGridDrag.getPositPlan(l),l.ePL=null,null!=(u=r.p20.sp.metod.getPL(l,50))?(l.x=u.x,l.y=u.y,l.ePL=u):r.korektAP(l,null,!0)};var l={x:0,y:0,x1:0,y1:0,s:0,o:null,oy:null,ox:null},u=null;return s.mouseMoveAll=function(t){null!=h.o&&(r.korekt2222(),null!=h.o.gronVL&&h.o.gronVL.par.remove(h.o),null!=l.ePL&&(l.ePL.targetGron.add(h.o).pros=l.ePL.pros),h.o.position.setPoint(l))},s}var e,r,n;return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&S(t,i)}(i,s["a"]),e=i,(r=[{key:"tool",set:function(t){this._tool!=t&&(this._tool=t,this.stopUp())},get:function(){return this._tool}}])&&P(e.prototype,r),n&&P(e,n),i}(),E=e(2);function T(t,i){for(var e=0;e<i.length;e++){var s=i[e];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}e.d(i,"a",function(){return M});var M=function(){function t(i,e){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,t),this.type="MDragScane";var s=this;this.par=i,this.fun=e,this.p20=void 0,this.cont=void 0,this.cont1=void 0,this.stage=void 0,this._menuIndex=-1,this._mashtab=1,this.otstup=this.par.otstup,this.otstup1=this.par.otstup1,this.wh=this.par.wh,$(document).bind("contextmenu",function(t){return!1}),this.actAI=void 0,this.sobIndex=[],this.sobIndex[0]=new h(this),this.sobIndex[1]=new f(this),this.sobIndex[2]=new v(this),this.sobIndex[3]=new b.a(this),this.sobIndex[4]=new C(this),this.sobSP=function(t,i,e){null!=s.actAI&&s.actAI.sobSP(t,i,e)},this.sobMenu=function(t,i,e){null!=s.actAI&&s.actAI.sobMenu(t,i,e)},this.helpDP=new E.a,this.klikGoem=function(t){},this.setP20=function(t){if(null==this.p20){this.cont=t.cont2d,this.cont1=t.c2dNiz,this.p20=t,this.p20.sobSP=this.sobSP;for(var i=0;i<this.sobIndex.length;i++)this.sobIndex[i].setP20(t)}},this.sp=void 0,this.setSP=function(t){this.sp=t;for(var i=0;i<this.sobIndex.length;i++)this.sobIndex[i].setSP(t)},this.redrag=function(){this.p20.creatRect(),this.cont.x=this.p20.rectXX1.xs,this.cont.y=this.p20.rectXX1.ys,this.scale(this.p20.rectXX1.s)},this.sizeWindow=function(t,i,e){this.cont&&(this.cont.x=t/2,this.cont.y=i/2)},this.keydown=function(t){for(var i=this.sobIndex.length-1;i>=0;i--)this.sobIndex[i].keydown&&this.sobIndex[i].keydown(t)},this.keyup=function(t){for(var i=this.sobIndex.length-1;i>=0;i--)this.sobIndex[i].keyup&&this.sobIndex[i].keyup(t)}}var i,e,s;return i=t,(e=[{key:"menuIndex",set:function(t){if(this._menuIndex!=t){this._menuIndex=t;for(var i=0;i<this.sobIndex.length;i++)this.sobIndex[i].active=!1;this.actAI=void 0,null!=this.sobIndex[this._menuIndex]&&(this.actAI=this.sobIndex[this._menuIndex],this.sobIndex[this._menuIndex].active=!0)}},get:function(){return this._menuIndex}},{key:"mashtab",set:function(t){if(this._mashtab!=t){this._mashtab=t;for(var i=0;i<this.sobIndex.length;i++)this.sobIndex[i].mashtab=t}},get:function(){return this._mashtab}}])&&T(i.prototype,e),s&&T(i,s),t}()},function(t,i,e){"use strict";function s(){this.event=void 0,this.arrSobName=["up","down","move","out","over","wheel"],this.arrSob=[[],[],[],[],[],[]],this.pozSob=void 0,this.dispatcherEvent=function(t,i){for(var e=0;e<this.arrSobName.length;e++)if(this.arrSobName[e]==t){i&&(i.type=t);for(var s=0;s<this.arrSob[e].length;s++)this.arrSob[e][s](i)}},this.removeEvent=function(t,i){for(var e=0;e<this.arrSobName.length;e++)if(this.arrSobName[e]==t)for(var s=0;s<this.arrSob[e].length;s++)this.arrSob[e][s]==i&&this.arrSob[e].splice(s,1)},this.addEvent=function(t,i){for(var e=0;e<this.arrSobName.length;e++)this.arrSobName[e]==t&&this.arrSob[e].push(i)}}function r(){this.target=void 0,this.face=void 0,this.point=void 0,this.faceIndex=void 0,this.type=void 0,this.uv=void 0,this.originalEvent=void 0,this.copy=function(){var t=new r;return t.target=this.target,t.face=this.face,t.point=this.point,t.faceIndex=this.faceIndex,t.type=this.type,t.uv=this.uv,t.originalEvent=this.originalEvent,t}}function n(t,i,e,n){this.parent=t;var a,o,h=this;this.camera=i,this.raycaster=new THREE.Raycaster,this.intersects,this.devas=t.devas,this.point=new THREE.Vector2(0,0),this.pointWH=new THREE.Vector2(0,0),this.arrChild=[],this.uuid="nullMy",this.obj3d,this.eventSob=new s,this.event3D=new r,this.xzNull="xzNull",this.poiskName="xzPoisk",this.tokoName="null",this._activ=!0,this.rect={x:0,y:0,width:100,height:100},this.cont=void 0,this.div=void 0,this.setRect=function(t,i,e,s){this.rect.x=t,this.rect.y=i,this.rect.width=e,this.rect.height=s},this.removeChild=function(t){a=null;for(var i=0;i<this.arrChild.length;i++)t.uuid==this.arrChild[i].uuid&&(a=this.arrChild.splice(i,1),(i-=1)<0&&(i=0));return a},this.addChild=function(t){this.removeChild(t),this.arrChild.push(t)},this.boolNum=-1,this.boolNumOld=-1,this.event,this.mouseRay=function(){0!=this._activ&&(this.rayPusk(),this.boolNum=this.getGoodParam(),-1==this.boolNum?"nullMy"!=this.uuid&&(this.eventSob.dispatcherEvent("out",this.event3D),this.uuid="nullMy"):"nullMy"!=this.uuid?this.uuid!=this.intersects[this.boolNum].object.uuid?(this.eventSob.dispatcherEvent("out",this.event3D),this.uuid=this.intersects[this.boolNum].object.uuid,this.event3D.target=this.intersects[this.boolNum].object,this.event3D.face=this.intersects[this.boolNum].face,this.event3D.point=this.intersects[this.boolNum].point,this.event3D.faceIndex=this.intersects[this.boolNum].faceIndex,this.event3D.uv=this.intersects[this.boolNum].uv,this.event3D.originalEvent=h.event,this.eventSob.dispatcherEvent("over",this.event3D)):(this.event3D.face=this.intersects[this.boolNum].face,this.event3D.point=this.intersects[this.boolNum].point,this.event3D.faceIndex=this.intersects[this.boolNum].faceIndex,this.event3D.uv=this.intersects[this.boolNum].uv,this.event3D.originalEvent=h.event,this.eventSob.dispatcherEvent("move",this.event3D)):(this.uuid=this.intersects[this.boolNum].object.uuid,this.event3D.target=this.intersects[this.boolNum].object,this.event3D.face=this.intersects[this.boolNum].face,this.event3D.point=this.intersects[this.boolNum].point,this.event3D.faceIndex=this.intersects[this.boolNum].faceIndex,this.event3D.uv=this.intersects[this.boolNum].uv,this.event3D.originalEvent=h.event,this.eventSob.dispatcherEvent("over",this.event3D)),this.boolNumOld=this.boolNum)},this.getPosition=function(t){var i=this.poiskName;if(this.poiskName=null!=t?t:"xzPoisk",this.restartPoint(),this.rayPusk(),this.poiskName=i,0!=this.intersects.length){var e=this.intersects.length-1;return-1==e&&(e=0),this.intersects[e]}return null};var l=new r;this.getNameEvent=function(t){if(this.restartPoint(),this.rayPusk(),0!=this.intersects.length)for(var i=0;i<this.intersects.length;i++)if(null!=this.intersects[i].object.parent&&this.intersects[i].object.name==t)return l.target=this.intersects[this.boolNum].object,l.face=this.intersects[this.boolNum].face,l.point=this.intersects[this.boolNum].point,l.faceIndex=this.intersects[this.boolNum].faceIndex,l.uv=this.intersects[this.boolNum].uv,l.originalEvent=h.event,l;return null},this.testVisiParam=function(t){return 0!=t.visible&&(!t.notEvent&&(null!=t.parent?this.testVisiParam(t.parent):"Scene"==t.type))},this.getGoodParam=function(){if(0!=this.intersects.length){var t;for(t=0;t<this.intersects.length;t++)0!=this.testVisiParam(this.intersects[t].object)&&null!=this.intersects[t].object.notActiv&&(this.intersects.splice(t,1),t=0);if(0==this.intersects.length)return-1;for(t=0;t<this.intersects.length;t++)if(0!=this.testVisiParam(this.intersects[t].object)&&this.intersects[t].object.name==this.poiskName)return t;for(t=0;t<this.intersects.length;t++)if(0!=this.testVisiParam(this.intersects[t].object)&&this.intersects[t].object.name!=this.xzNull)return t}return-1},this.rayPusk=function(){(o=new THREE.Vector3).setFromMatrixPosition(this.camera.matrixWorld),this.raycaster.ray.origin.copy(o),this.raycaster.ray.direction.set(this.point.x,this.point.y,.5).unproject(this.camera).sub(o).normalize(),this.intersects=this.raycaster.intersectObjects(this.arrChild,!0)},this.naCont=!1,this.mousemove=function(t){0==h.devas&&0==h.naCont||(null!=t.data?h.event=t.data.originalEvent:h.event=t,0!=h._activ&&(h.restartPoint(t),h.mouseRay(),h.intersects.length&&0==h.devas&&h.event.preventDefault()))},this.zdvigX=0,this.scale=1,this.pV=new THREE.Vector2(0,0);var u={x:0,y:0};this.restartPoint=function(t){t&&t.target&&(u=t.target.getBoundingClientRect()),0==h.devas?(h.pV.x=t.clientX,h.pV.y=t.clientY):(h.pV.x=t.touches[0].clientX,h.pV.y=t.touches[0].clientY),h.pV.x-=u.x,h.pV.y-=u.y,1==h.isRect(h.pV)?(h.point.x=-(this.rect.x-h.pV.x)/this.rect.width*2-1,h.point.y=-(-(this.rect.y-h.pV.y)/this.rect.height*2-1)):99999!=h.point.x&&(h.point.x=99999)},this.isRect=function(t){return t.x>=this.rect.x&&t.x<=this.rect.x+this.rect.width&&t.y>=this.rect.y&&t.y<=this.rect.y+this.rect.height},this.mouseup=function(t){null!=t.data?h.event=t.data.originalEvent:h.event=t,h.intersects&&0!=h._activ&&(0==h.devas?(-1==h.boolNumOld?h.eventSob.dispatcherEvent("up",null):(h.event3D.originalEvent=h.event,h.eventSob.dispatcherEvent("up",h.event3D)),h.intersects.length&&h.event.preventDefault()):(h.mouseRay(),-1==h.boolNumOld?h.eventSob.dispatcherEvent("up",null):(h.event3D.originalEvent=h.event,h.eventSob.dispatcherEvent("up",h.event3D),h.uuid="nullMy")))},this.mousedown=function(t){null!=t.data?h.event=t.data.originalEvent:h.event=t,h.restartPoint(t),0!=h._activ&&(0==h.devas?(-1==h.boolNumOld?h.eventSob.dispatcherEvent("down",null):(h.event3D.originalEvent=h.event,h.eventSob.dispatcherEvent("down",h.event3D)),h.intersects.length&&h.event.preventDefault()):(h.mouseRay(),-1==h.boolNumOld?h.eventSob.dispatcherEvent("down",null):(h.event3D.originalEvent=h.event,h.eventSob.dispatcherEvent("down",h.event3D))))},this.mouseout=function(t){h.naCont=!1,h.restartPoint(t),h.point.x=99999,h.mouseRay()},this.mouseover=function(t){h.naCont=!0,h.restartPoint(t),h.mouseRay()},this.touchend=function(t){},this.mousewheel=function(t){null!=t.data?h.event=t.data.originalEvent:h.event=t,h.restartPoint(t),0!=h._activ&&(-1==h.boolNumOld?h.eventSob.dispatcherEvent("down",null):(h.event3D.originalEvent=h.event,h.eventSob.dispatcherEvent("wheel",t)))},this.addDragEvent=function(t,i){this.cont=t,this.div=i,0==h.devas?(window.addEventListener("mouseup",h.mouseup),i.addEventListener("mousedown",h.mousedown),i.addEventListener("mouseout",h.mouseout),i.addEventListener("mouseover",h.mouseover)):(window.addEventListener("touchend",h.mouseup),i.addEventListener("touchstart",h.mousedown))},this.sizeWindow=function(t,i){this.pointWH.x=t,this.pointWH.y=i}}e.d(i,"a",function(){return n}),n.prototype={set activ(t){this._activ!=t&&(this._activ=t)},get activ(){return this._activ}}},function(t,i,e){"use strict";var s=e(4);function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function n(t,i){return!i||"object"!==r(i)&&"function"!=typeof i?l(t):i}function a(t){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function o(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&h(t,i)}function h(t,i){return(h=Object.setPrototypeOf||function(t,i){return t.__proto__=i,t})(t,i)}function l(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function u(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function c(t,i){for(var e=0;e<i.length;e++){var s=i[e];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function p(t,i,e){return i&&c(t.prototype,i),e&&c(t,e),t}var d=function(){function t(i,e){u(this,t),this.type="MKrai";var s=this;this.par=i,this.fun=e,this.otstup=i.otstup,this.otstup1=i.otstup1,this.wh=i.wh,this.sizeMax=400,this.otMax=100,this._bool=!0,this._mashtab=1,this.otMas=this.otMax/this._mashtab,this._menuIndex=-1,this._activeMove="null",this.sp=void 0,this.dCont=new DCont(this.par.par.dCont),this.dCont.x=this.otstup,this.dCont.y=4*this.otstup+this.wh,this.init=function(){this.panVisiW=new m(this.dCont,0,0,this,this.sob),this.panVisiW.height=this.wh/2+2*this.otstup,this.panVisiH=new y(this.dCont,0,0,this,this.sob),this.panVisiH.width=this.wh/2+2*this.otstup,this.batton=new DButton(this.dCont,0,0,"",function(){s.bool=!s.bool}),this.batton.width=this.batton.height=this.wh/2};var r=!1;dcmParam.addFunMove(function(t){"null"!=s._activeMove&&("lines"==s._activeMove&&s.sp.lineWord.visiLine.visiPoint(s.par.getPositPlan(),1==r?-Math.PI/2:-Math.PI,s.par.rectScane),"linesOtstup"==s._activeMove&&s.sp.lineWord.visiLine.visiOtstup(s.par.getPositPlan(),1==r?-Math.PI/2:-Math.PI))}),this.mouseup=function(t){"linesOtstup"==s._activeMove&&s.sp.lineWord.visiLine.creatReal(),s.activeMove="null",document.body.style.pointerEvents="auto",0==dcmParam.mobile?document.removeEventListener("mouseup",s.mouseup):document.removeEventListener("touchend",s.mouseup)},this.sob=function(t,i,e){"mousewheel"!=t?(r=!1,"MKPanelVisiW"==this.type&&(r=!0),this.type,0==s._menuIndex&&("mouseover"==t&&this.startActive(),"mouseout"==t&&this.finalActive()),2==s._menuIndex&&("mouseover"==t&&(s.activeMove="lines"),"mouseout"==t&&"linesOtstup"!=s.activeMove&&(s.activeMove="null"),"mousedown"==t&&(s.sp.lineWord.visiLine.visiPoint(s.par.getPositPlan(),1==r?-Math.PI/2:-Math.PI,s.par.rectScane),s.activeMove="linesOtstup",document.body.style.pointerEvents="none",dcmParam.mobile,document.addEventListener("mouseup",s.mouseup)))):s.par.mousewheel(i)},this.init(),this.set=function(t,i){this.panVisiW.setPosition(t,i),this.panVisiH.setPosition(t,i)},this.helpDP=void 0,this.sp=void 0,this.setSP=function(t){this.sp=t,s.helpDP=s.par.par.mCont2dHelp.helpDP,this.panVisiW.setSP(t,s.helpDP),this.panVisiH.setSP(t,s.helpDP)},this.sizeWindow=function(t,i,e){this.panVisiW.width=t,this.panVisiW.y=i,this.panVisiH.height=i,this.panVisiH.x=t,this.batton.y=i+this.otstup,this.batton.x=t+this.otstup}}return p(t,[{key:"activeMove",set:function(t){this._activeMove!=t&&("lines"==this._activeMove&&this.sp.lineWord.visiLine.clear(),this._activeMove=t)},get:function(){return this._activeMove}},{key:"menuIndex",set:function(t){this._menuIndex!=t&&(this._menuIndex=t)},get:function(){return this._menuIndex}},{key:"mashtab",set:function(t){this._mashtab!=t&&(this._mashtab=t,this.otMas=this.otMax/this._mashtab)},get:function(){return this._mashtab}},{key:"bool",set:function(t){this._bool!=t&&(this._bool=t,this.panVisiW.bool=t,this.panVisiH.bool=t,this.batton.borderRadius=t?0:100)},get:function(){return this._bool}}]),t}(),f=function t(i){u(this,t),this.type="MKBlok";this.dc,this.idArr=-1,this._active=!0,this.param="x",this.posit=0,this.posit1=0,this.array=[],this.zdwih=function(t,i){for(var e=0;e<this.array.length;e++)this.array[e].position[t]+=i},this.clear=function(){this.array.length=0,this.active=!1},this.add=function(t){this.array.push(t)}},g=function(t){function i(t,e,s,r){var o;u(this,i),(o=n(this,a(i).call(this,t,e,s))).type="MPanel";l(l(o));o.fun=r,o._active=!1,o.dL=new DCont(l(l(o))),o.dL1=new DCont(o.dL),o.label=new DLabel(o.dL1,0,0,""),o.c="#aaaaaa",o.c1="#444444",o.c2="#ff0000",o.c3="#00ff00",o.a=.5,o.a1=1,o.setColor=function(t,i,e,s,r,n){this.c=t,this.c1=i,this.c2=e,this.c3=s,this.a=r,this.a1=n,this.alpha=r,this.color=t,this.label.color=i},o.bool,o.pp,o.t1,o.setParam=function(t,i,e,s,r){this.t1=r,this.pp=e,this.width=t,this.height=i,this.bool=s,this.korectParam()};var h=0;return o.korectParam=function(){this.label.text=this.pp+"",h=10*this.label._text.length,this.label.y=(this._height-18)/2,this.bool?this.label.x=(this._width-h)/2:this.label.x=this._width-h,this._width<h?this.label.visible=!1:this.label.visible=!0},o}return o(i,DPanel),p(i,[{key:"active",set:function(t){this._active!=t&&(this._active=t,t?(this.alpha=this.a1,this.color=this.c2,this.label.color=this.c3):(this.alpha=this.a,this.color=this.c,this.label.color=this.c1))},get:function(){return this._active}}]),i}(),A=function(t){function i(t,e,r,o,h){var c;u(this,i),(c=n(this,a(i).call(this))).type="MKPanelVisiW";var p=l(l(c));null!=t&&null!=t.add&&t.add(l(l(c))),c.x=e||0,c.y=r||0,c.uuid=Math.random(),c.fun=h,c._drag=!1,c._width=100,c._height=100,c.par=o,c._bool=o._bool,c.otstup=c.par.otstup,c.rectScane=c.par.par.rectScane,c.panel=new DPanel(l(l(c)),0,c.otstup),c.panel.height=c._height-2*c.otstup,c.pan=new DPanel(l(l(c)),0,c.otstup),c.pan.height=c._height-2*c.otstup,c.pan.width=c._width/2,c.pan.color="#dddddd",c.pan.alpha=.35,c.dCont=new DCont(l(l(c))),c.dCont.visible=!1,c.panEvent=new DPanel(l(l(c)),0,0),c.panEvent.alpha=.1,c.panEvent.dCont.div.uuid=c.uuid,c.panEvent.dCont.div.tttt="panel",c.pInfo=new DPanel(l(l(c)),0,0),c.input=new DInput(c.pInfo,c.otstup,c.otstup,""),c.input.width=50,c.pInfo.width=c.input.width+2*c.otstup+2,c.pInfo.height=c.input.height+2*c.otstup,c.pInfo.visible=!1,c.pInfo.alpha=.5,c.input.object.uuid=c.uuid,c.input.object.tttt="input",c.input.funEnter=function(){var t=1*this.text;0==isNaN(t)&&"number"==typeof t&&p.setPNew(t)},c.setPNew=function(t){if(p.helpDP.clear(),t<0&&(t=10),1==p.bool){if(-1!=p.inArXY){var i=t-p.arrPanel[p.inArXY].pp;i<=-(p.arrPanel[p.inArXY].pp-1)&&(i=-(p.arrPanel[p.inArXY].pp-1));for(var e=-i/2,s=0;s<p.arrX.length;s++)s<=p.inArXY?p.arrX[s].zdwih("x",e):p.arrX[s].zdwih("x",e+i);p.sp.bigDrag(),p.testPosit(),p.moveIn(),p.moveIn1()}}else if(-1!=p.inArXY){var r=t-p.arrPanel[p.inArXY].pp;r<=-(p.arrPanel[p.inArXY].pp-1)&&(r=-(p.arrPanel[p.inArXY].pp-1));if(p.arrPanel[p.inArXY-1]&&p.arrPanel[p.inArXY-1].pp>=p.arrPanel[p.inArXY].pp+r)return;for(s=0;s<p.arrX.length;s++)s<=p.inArXY&&p.arrX[s].zdwih("x",-r);p.sp.bigDrag(),p.testPosit(),p.moveIn(),p.moveIn1()}},c.panEvent.div.addEventListener("mousewheel",function(t){p.fun("mousewheel",t),1==p.boolStart&&(p.testPosit(),p.move())}),c.panEvent.div.addEventListener("DOMMouseScroll",function(t){p.fun("mousewheel",t)}),c.panEvent.div.addEventListener("mousedown",function(t){if(-1!=p.inArXY)return p.drag=!0,void p.startDragMove();p.fun("mousedown",t)}),c.panEvent.div.addEventListener("mouseover",function(t){1!=p.drag&&p.fun("mouseover",t)}),c.panEvent.div.addEventListener("mouseout",function(t){1!=p.drag&&p.fun("mouseout",t)}),c.panEvent.div.addEventListener("mouseup",function(t){1==p.drag&&p.aaaa()}),c.pos=void 0,c.pos1=void 0,c.s,c.xx,c.ww,c.pr,c.setPosition=function(t,i,e){null==e&&(this.pos=t,this.pos1=i),this.setPosition1()},c.setPosition1=function(){this.s=this.pos.w/this.pos1.w,this.xx=this.pos.x-this.pos1.x,this.ww=this.pos.w-this.pos1.w,this.pr=1,0!=this.ww&&(this.pr=-this.xx/this.ww),this.pan.width=Math.round(this.s*this._width),this.pan.x=(this._width-this.pan._width)*this.pr},c.dragWH=function(){this.panEvent.height=this._height,this.panEvent.width=this._width,this.panel.height=this._height-2*this.otstup,this.panel.width=this._width,this.pan.height=this._height-2*this.otstup,this.dCont.div.style.clip="rect(0px "+this._width+"px "+this._height+"px 0px)"},c.otMas=c.par.otMas,c.color=36026,c.color1=36026,c.color2=1145500,c.color3=15892548,c.ooo=50,c.move=function(t){if(p.helpDP.alpha=1,p.helpDP.clear(),0!=p.arrX.length&&1!=p.dragB1){!0,p.ooo=1/p.par._mashtab,p.moveIn(),p.moveIn1();var i=20*p.ooo;p.helpDP.dPoint(E,.1*p.ooo,p.color3),p.helpDP.dLineParam(E.x-i,E.y,E.x+i,E.y,p.color3,2),p.helpDP.dLineParam(E.x,E.y-i,E.x,E.y+i,p.color3,2),p.sp.render()}},c.smd={x:0,y:0,inArXY:-1,param:0},c.dragB1=!1,c.startDragMove=function(){0!=p.arrX.length&&(p.testPosit(),p.moveIn(),this.par.par.getPositPlan(this.smd),this.smd.inArXY=p.inArXY,this.smd.pp=p.arrPanel[p.inArXY].pp,p.dragB1=!0,dcmParam.addFunMove(this.move1),document.body.addEventListener("mouseup",this.funUp))},c.moveZdvig=function(t,i,e,s){for(var r=0;r<t.length;r++)r<=i?t[r].zdwih(t[r].param,e):t[r].zdwih(t[r].param,e+s);p.sp.bigDrag(),p.testPosit(),p.moveIn(),p.moveIn1()};var d,A,y=new s.a,m=!0;c.move1=function(t){if(p.helpDP.alpha=1,p.helpDP.clear(),0!=p.arrX.length){if(p.par.par.getPositPlan(y),d=y.x-p.smd.x,0!=(A=Math.floor(2*d))){var i=A;A<0&&(i=A);var e=p.smd.pp+i;m=!0,e<=1&&(m=!1),1!=p.bool&&p.arrPanel[p.smd.inArXY-1]&&p.arrPanel[p.smd.inArXY-1].pp>=p.arrPanel[p.smd.inArXY].pp+i&&(m=!1),1==m?(p.moveZdvig(p.arrX,p.smd.inArXY,-i/2,i),p.smd.pp=e,p.par.par.getPositPlan(p.smd),p.input.text=p.arrPanel[p.smd.inArXY].pp):(p.sp.bigDrag(),p.testPosit(),p.moveIn(),p.moveIn1())}}},c.funUp=function(t){p.dragB1=!1,dcmParam.removeFunMove(p.move1),document.body.removeEventListener("mouseup",p.funUp)},c.moveIn=function(){if(0!=p.arrX.length){p.poiskXY(P,"x");for(var t=0;t<P.length;t++)p.helpDP.dLineParam(P[t].array[0].position.x,P[t].array[0].position.y,P[t].array[0].position.x,p.rectScane.y1,p.color1,2*p.ooo),p.helpDP.dPoint(P[t].array[0].position,p.ooo,p.color1,p.ooo);-1!=p.inArXY&&(p.bool&&p.drawArrPoint(P[p.inArXY].array,P[p.inArXY].array[0].position.x,p.rectScane.y1,p.color1,p.color3,2*p.ooo),p.drawArrPoint(P[p.inArXY+1].array,P[p.inArXY+1].array[0].position.x,p.rectScane.y1,p.color1,p.color3,2*p.ooo))}},c.arrPanel=[],c.creatPan=function(t,i){null==this.arrPanel[t]&&(this.arrPanel[t]=null==i?new g(this.dCont):new x(this.dCont),t%2==0?this.arrPanel[t].setColor("#dddddd","#444444",dcmParam.color,dcmParam.colorText,.35,1):this.arrPanel[t].setColor("#444444","#dddddd",dcmParam.color,dcmParam.colorText,.35,1))},c.moveIn1=function(){for(var t=0;t<P.length;t++)P[t].posit1=Math.round(P[t].posit*p.par._mashtab-p.rectScane.x*p.par._mashtab);var i,e,s;s=0;for(t=0;t<P.length-1;t++)this.creatPan(t),this.arrPanel[t].x=P[t].posit1,this.arrPanel[t].y=this.otstup,i=P[t+1].posit1-P[t].posit1,s+=e=Math.round(P[t+1].posit-P[t].posit),this.arrPanel[t].setParam(i,this._height-2*this.otstup,p._bool?e:s,p._bool),this.arrPanel[t].visible=!0;for(t=P.length-1;t<this.arrPanel.length;t++)this.arrPanel[t].visible=!1;null!=this.arrPanel[p.inArXY]?(this.arrPanel[p.inArXY].active=!0,this.pInfo.visible=!0,p._bool?this.pInfo.x=this.arrPanel[p.inArXY].x+(this.arrPanel[p.inArXY].width-this.pInfo.width)/2:this.pInfo.x=this.arrPanel[p.inArXY].x+this.arrPanel[p.inArXY].width-this.pInfo.width/2,1!=this.drag&&(this.input.text=this.arrPanel[p.inArXY].pp),this.pInfo.y=-this.pInfo.height):this.pInfo.visible=!1},c.drawArrPoint=function(t,i,e,s,r,n){if(i)for(var a=0;a<t.length;a++)p.helpDP.dLineParam(t[a].position.x,t[a].position.y,i,e,s,2*n),p.helpDP.dLineParam(t[a].position.x,t[a].position.y,i,e,r,n);for(a=0;a<t.length;a++)t[a].position,p.helpDP.dPoint(t[a].position,1.5*n,s,1.5*n),p.helpDP.dPoint(t[a].position,n,r,n)},p.inArXY=-1,p.inPoXY=-1,c.corektBattonX=function(t,i){p.inArXY!=t&&null!=p.arrPanel[p.inArXY]&&(p.arrPanel[p.inArXY].active=!1),p.inArXY=t,p.inPoXY=i};var v,b,w=new s.a;c.poiskXY=function(t,i){if(1!=this.drag){this.par.par.getPositPlan(w),S=-1,v=-1,b=1e16;for(var e=0;e<t.length-1;e++)if(w[i]>=t[e].posit&&w[i]<=t[e+1].posit){S=e;break}for(e=0;e<t.length-1;e++)b>Math.abs(w[i]-t[e].posit)&&(b=Math.abs(w[i]-t[e].posit),v=e);this.corektBattonX(S,v)}},c.man="null",c.boolStart=!1,c.finalActive=function(){p.boolStart=!1,p.pInfo.visible=!1,p.drag=!1,p.helpDP.clear(),p.sp.render(),dcmParam.removeFunMove(p.move),p.dCont.visible=!1,p.pan.visible=!p.dCont.visible},c.startActive=function(t){p.boolStart=!0,p.testPosit(),dcmParam.addFunMove(p.move),p.dCont.visible=!0,p.pan.visible=!p.dCont.visible,0==P.length&&p.finalActive()},c.getBlok=function(){for(var t=0;t<C.length;t++)if(0==C[t].active)return C[t].active=!0,C[t];return C.push(new f(this.dCont)),C[C.length-1]},c.param=null,c.param1=null,c.sortBla=function(t,i){return null==p.param?t[p.param1]-i[p.param1]:t[p.param][p.param1]-i[p.param][p.param1]};var P=[],_=[];c.arrX=P,c.arrY=_;var S,I,C=[],E=new s.a;new s.a;return c.testPosit=function(){this.clear();for(var t=0;t<this.sp.arrPoint.length;t++)0!=this.sp.arrPoint[t].life&&(this.testPosit1(this.sp.arrPoint[t],"x",P),this.testPosit1(this.sp.arrPoint[t],"y",_));for(t=0;t<this.sp.avp.length;t++)0!=this.sp.avp[t].life&&null==this.sp.avp[t].gronVL&&(this.testPosit1(this.sp.avp[t],"x",P),this.testPosit1(this.sp.avp[t],"y",_));this.param=null,this.param1=null,P.sort(function(t,i){return t.posit-i.posit});for(t=0;t<P.length;t++)P[t].array.sort(function(t,i){return i.position.y-t.position.y});_.sort(function(t,i){return t.posit-i.posit});for(t=0;t<_.length;t++)_[t].array.sort(function(t,i){return i.position.x-t.position.x});0!=P.length&&(E.x=P[0].array[0].position.x,E.y=_[_.length-1].array[0].position.y,1)},c.testPosit1=function(t,i,e){S=-1;for(var s=0;s<e.length;s++)if(Math.round(e[s].posit)==Math.round(t.position[i])){S=s;break}-1!=S?e[s].add(t):((I=this.getBlok()).posit=t.position[i],I.param=i,I.add(t),e.push(I))},c.clear=function(){P.length=0,_.length=0;for(var t=0;t<C.length;t++)C[t].clear()},c.helpDP=void 0,c.sp=void 0,c.setSP=function(t,i){this.sp=t,p.helpDP=i,this.rectScane=this.par.par.rectScane},c.bbbE=!1,c.aaaa=function(){p.input.object.focus(),p.input.object.select(),setTimeout(function(){p.input.object.focus(),p.input.object.select(),0==p.bbbE&&(document.body.addEventListener("mousedown",p.moused),p.bbbE=!0)},10)},c.moused=function(t){var i="null";t&&t.target&&t.target.uuid&&t.target.uuid==p.uuid&&(i=t.target.tttt),"null"!=i?"panel"==i&&(p.drag=!1):p.finalActive()},c}return o(i,DCont),p(i,[{key:"height",set:function(t){this._height!=t&&(this._height=t,this.dragWH())},get:function(){return this._height}},{key:"width",set:function(t){this._width!=t&&(this._width=t,this.dragWH())},get:function(){return this._width}},{key:"bool",set:function(t){this._bool!=t&&(this._bool=t)},get:function(){return this._bool}},{key:"drag",set:function(t){this._drag!=t&&(this._drag=t,1==t?(this.pInfo.alpha=1,this.aaaa()):(this.pInfo.alpha=.5,1==this.bbbE&&(document.body.removeEventListener("mousedown",this.moused),this.bbbE=!1)))},get:function(){return this._drag}}]),i}(),y=function(t){function i(t,e,r,o,h){var c;u(this,i),(c=n(this,a(i).call(this,t,e,r,o,h))).type="MKPanelVisiH";var p=l(l(c));c.panel.y=0,c.panel.x=c.otstup,c.pan.x=c.otstup,c.setPosition1=function(){this.s=this.pos.h/this.pos1.h,this.xx=this.pos.y-this.pos1.y,this.ww=this.pos.h-this.pos1.h,this.pr=1,0!=this.ww&&(this.pr=-this.xx/this.ww),this.pan.height=Math.round(this.s*this._height),this.pan.y=(this._height-this.pan._height)*this.pr};var d,f,g=new s.a,A=!0;c.move1=function(t){p.helpDP.alpha=1,p.helpDP.clear();if(p.par.par.getPositPlan(g),d=g.y-p.smd.y,0!=(f=Math.floor(2*d))){var i=f;f<0&&(i=f);var e=p.smd.pp+i;A=!0,e<=1&&(A=!1),1!=p.bool&&p.arrPanel[p.smd.inArXY-1]&&p.arrPanel[p.smd.inArXY-1].pp+-i/2<=p.arrPanel[p.smd.inArXY].pp+i&&(A=!1),1!=p.bool&&p.arrPanel[p.smd.inArXY+1]&&p.arrPanel[p.smd.inArXY+1].pp+-i/2>=p.arrPanel[p.smd.inArXY].pp+i&&(A=!1),1==A?(p.moveZdvig(p.arrY,p.smd.inArXY,-i/2,i),p.smd.pp=e,p.par.par.getPositPlan(p.smd),p.input.text=p.arrPanel[p.smd.inArXY].pp):(p.sp.bigDrag(),p.testPosit(),p.moveIn(),p.moveIn1())}},c.moveIn=function(){if(0!=p.arrY.length){p.poiskXY(p.arrY,"y");for(var t=0;t<p.arrY.length;t++)p.helpDP.dLineParam(p.arrY[t].array[0].position.x,p.arrY[t].array[0].position.y,p.rectScane.x1,p.arrY[t].array[0].position.y,p.color1,2*p.ooo),p.helpDP.dPoint(p.arrY[t].array[0].position,p.ooo,p.color1,p.ooo);-1!=p.inArXY&&(p.drawArrPoint(p.arrY[p.inArXY].array,p.rectScane.x1,p.arrY[p.inArXY].array[0].position.y,p.color1,p.color3,2*p.ooo),p.bool&&p.drawArrPoint(p.arrY[p.inArXY+1].array,p.rectScane.x1,p.arrY[p.inArXY+1].array[0].position.y,p.color1,p.color3,2*p.ooo))}};A=!0;return c.setPNew=function(t){if(p.helpDP.clear(),t<0&&(t=10),1==p.bool){if(-1!=p.inArXY){var i=t-p.arrPanel[p.inArXY].pp;i<=-(p.arrPanel[p.inArXY].pp-1)&&(i=-(p.arrPanel[p.inArXY].pp-1));for(var e=-i/2,s=0;s<p.arrY.length;s++)s<=p.inArXY?p.arrY[s].zdwih("y",e):p.arrY[s].zdwih("y",e+i);p.sp.bigDrag(),p.testPosit(),p.moveIn(),p.moveIn1()}}else if(-1!=p.inArXY){var r=t-p.arrPanel[p.inArXY].pp;r<=-(p.arrPanel[p.inArXY].pp-1)&&(r=-(p.arrPanel[p.inArXY].pp-1));if(A=!0,p.arrPanel[p.inArXY-1]&&p.arrPanel[p.inArXY-1].pp>=p.arrPanel[p.inArXY].pp+r&&(A=!1),1==A)for(s=0;s<p.arrY.length;s++)s<=p.inArXY&&p.arrY[s].zdwih("y",-r);p.input.text=p.arrPanel[p.smd.inArXY].pp,p.sp.bigDrag(),p.testPosit(),p.moveIn(),p.moveIn1()}},c.moveIn1=function(){for(var t=0;t<p.arrY.length;t++)p.arrY[t].posit1=Math.round(p.arrY[t].posit*p.par._mashtab-p.rectScane.y*p.par._mashtab);var i,e,s;if(s=0,1==p._bool)for(t=0;t<p.arrY.length-1;t++)this.creatPan(t,!0),this.arrPanel[t].y=p.arrY[t].posit1,this.arrPanel[t].x=this.otstup,i=p.arrY[t+1].posit1-p.arrY[t].posit1,s+=e=Math.round(p.arrY[t+1].posit-p.arrY[t].posit),1==p._bool?(e,e):r-s,this.arrPanel[t].setParam(this._width-2*this.otstup,i,e,p._bool,e),this.arrPanel[t].visible=!0;else{var r=p.arrY[p.arrY.length-1].posit-p.arrY[0].posit;for(t=p.arrY.length-2;t>=0;t--)this.creatPan(t,!0),this.arrPanel[t].y=p.arrY[t].posit1,this.arrPanel[t].x=this.otstup,i=p.arrY[t+1].posit1-p.arrY[t].posit1,s+=e=Math.round(p.arrY[t+1].posit-p.arrY[t].posit),this.arrPanel[t].setParam(this._width-2*this.otstup,i,s,p._bool,s),this.arrPanel[t].visible=!0}for(t=p.arrY.length-1;t<this.arrPanel.length;t++)this.arrPanel[t].visible=!1;null!=this.arrPanel[p.inArXY]?(this.arrPanel[p.inArXY].active=!0,this.pInfo.visible=!0,p._bool?this.pInfo.y=this.arrPanel[p.inArXY].y+(this.arrPanel[p.inArXY].height-this.pInfo.height)/2:this.pInfo.y=this.arrPanel[p.inArXY].y-this.pInfo.height/2,1!=this.drag&&(this.input.text=this.arrPanel[p.inArXY].pp),this.pInfo.x=-this.pInfo.width):this.pInfo.visible=!1},c.dragWH=function(){this.panEvent.height=this._height,this.panEvent.width=this._width,this.panel.width=this._width-2*this.otstup,this.panel.height=this._height,this.pan.width=this._width-2*this.otstup,this.dCont.div.style.clip="rect(0px "+this._width+"px "+this._height+"px 0px)"},c}return o(i,A),i}(),x=function(t){function i(t,e,s,r){var o;u(this,i),(o=n(this,a(i).call(this,t,e,s,r))).type="MPanelH";l(l(o));o.fun=r,o.label.div;var h=0;return o.korectParam=function(){this.label.text!=this.t1+""&&(this.label.text=this.t1+""),h=10*this.label._text.length,this.dL.x=-38,this.dL.y=-32,this.label._text.length>=4&&(this.dL.y+=8*(this.label._text.length-3)),this.bool?this.dL.y+=(this._height-h)/2:this.dL.y+=7,this._height<h?this.label.visible=!1:(this.label.dCT.div.style.webkitTransform="rotate(-90deg)",this.label.dCT.div.style.mozTransform="rotate(-90deg)",this.label.dCT.div.style.msTransform="rotate(-90deg)",this.label.dCT.div.style.oTransform="rotate(-90deg)",this.label.dCT.div.style.transform="rotate(-90deg)",this.label.visible=!0)},o}return o(i,g),i}(),m=function(t){function i(t,e,s,r,o){var h;u(this,i),(h=n(this,a(i).call(this,t,e,s,r,o))).type="MKPanelVisiW";l(l(h));return h}return o(i,A),i}(),v=e(2);function b(t,i){for(var e=0;e<i.length;e++){var s=i[e];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}e.d(i,"a",function(){return w});var w=function(){function t(i,e){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,t),this.type="MGridDrag";var s=this;this.par=i,this.fun=e,this.otstup=i.otstup,this.otstup1=i.otstup1,this.wh=i.wh,this.width=100,this.height=100,this._mashtab=1,this._menuIndex=-1,this.sizeMax=i.sizeMax,this.dCont=new DCont(this.par.dCont),this.visiPixi=this.par.par.visiPixi,this.mKrai=new d(this,function(t,i){}),this.debugPixi=new v.a,this.par.par.cont2d.addChild(this.debugPixi.content2d),this.debugPixi.content2d.scale.set(.1,.1),this.panel=new DPanel(this.dCont,this.otstup,4*this.otstup+this.wh),this.panel.div.appendChild(this.visiPixi.div);var r={x:0,y:0,x1:0,y1:0,s:0,o:null};function n(t){s.cont.x=r.x+(t.clientX-r.x1),s.cont.y=r.y+(t.clientY-r.y1),s.korestPosit()}function a(t){document.removeEventListener("mouseup",a),document.removeEventListener("mousemove",n)}this.cont=this.par.par.content2d,this.p20,this.downFont=function(t){r.x1=t.data.originalEvent.clientX,r.y1=t.data.originalEvent.clientY,r.x=s.cont.x,r.y=s.cont.y,r.s=s.cont.scale.x,document.addEventListener("mouseup",a),document.addEventListener("mousemove",n)},this.klikGoem=function(t){var i={position:s.getPositPlan()};s.par.mDragScane.sobSP("downFont",i,t)};var o={x:0,y:0},h={x:0,y:0};this.getPositPlan=function(t){o=s.panel.div.getBoundingClientRect(),h.x=(dcmParam.globXY.x-o.x)/f/s.width*2-1,h.y=(dcmParam.globXY.y-o.y)/f/s.height*2-1;var i=s.width/2*h.x/s._mashtab-s.cont.x/s._mashtab,e=s.height/2*h.y/s._mashtab-s.cont.y/s._mashtab;return null!=t?(t.x=i,t.y=e,t):{x:i,y:e}};var l={x:0,y:0,w:0,h:0},u={x:0,y:0,w:this.sizeMax,h:this.sizeMax};this.rectScane={x:0,y:0,x1:0,y1:0,w:100,h:100},this.korestPosit=function(){var t=this.sizeMax*this._mashtab,i=t/l.w;if(t/l.h<i&&(i=t/l.h),i<1){this.mashtab/=i;this.sizeMax,this._mashtab}else u.h=u.w=t,u.x=s.cont.x-u.w/2,u.y=s.cont.y-u.w/2,l.x<u.x&&(s.cont.x=l.x+this.sizeMax/2*this._mashtab),l.x+l.w>u.x+u.w&&(s.cont.x=-(l.x+this.sizeMax/2*this._mashtab)),l.y<u.y&&(s.cont.y=l.y+this.sizeMax/2*this._mashtab),l.y+l.h>u.y+u.h&&(s.cont.y=-(l.y+this.sizeMax/2*this._mashtab)),u.x=s.cont.x-u.w/2,u.y=s.cont.y-u.w/2,this.mKrai.set(l,u),this.fun("render"),this.rectScane.w=l.w/this._mashtab,this.rectScane.h=l.h/this._mashtab,this.rectScane.x=-s.cont.x/this._mashtab-this.rectScane.w/2,this.rectScane.x1=-s.cont.x/this._mashtab+this.rectScane.w/2,this.rectScane.y=-s.cont.y/this._mashtab-this.rectScane.h/2,this.rectScane.y1=-s.cont.y/this._mashtab+this.rectScane.h/2},this.setRect=function(t,i,e){null==i&&(i=0);var r=l.w/(t.w+2*i);r>l.h/(t.h+2*i)&&(r=l.h/(t.h+2*i)),this.mashtab=r,s.korestPosit(),s.cont.x=-t.x*this._mashtab-t.w*this._mashtab/2,s.cont.y=-t.y*this._mashtab-t.h*this._mashtab/2,1==e&&this.setRect(t,i/this._mashtab),s.fun("mashtab",s._mashtab)};var c=null,p={x:0,y:0};this.mousewheel=function(t){var i=-1;t.delta;null==t.wheelDelta&&t.wheelDelta,t.delta&&t.delta<0&&(i=1),t.deltaY&&t.deltaY<0&&(i=1),t.detail&&t.detail<0&&(i=1),null!=t.wheelDelta&&(i=t.wheelDelta>0?-1:1);var e=-i*(.05*s._mashtab)+s._mashtab;e<.01&&(e=.01),c=s.getPositPlan(),p.x=c.x,p.y=c.y,s.mashtab=e,c=s.getPositPlan(),s.cont.x-=(p.x-c.x)*s._mashtab,s.cont.y-=(p.y-c.y)*s._mashtab,s.korestPosit(),s.fun("mashtab",s._mashtab)},this.panel.div.addEventListener("mousewheel",this.mousewheel),this.panel.div.addEventListener("DOMMouseScroll",this.mousewheel),this.setSP=function(t){this.mKrai.setSP(t)},this.setP20=function(t){this.p20=t,t.sGposition=this.sGposition,this.p20.rulimActivSP.name="xz",this.p20.rulimActivSP.graphics.on("mousedown",this.klikGoem)},this.sGposition=function(t){if(null==t){var i={};return i.x=s.cont.x,i.y=s.cont.y,i.mashtab=s._mashtab,i.visi3D=s.par.par.visi3D.getObj(),i}return s.cont.x=t.x,s.cont.y=t.y,s.mashtab=t.mashtab,null!=t.visi3D&&s.par.par.visi3D.setObj(t.visi3D),s.fun("mashtab",s._mashtab),null};var f=1;this.sizeWindow=function(t,i,e){f=e,this.panel.width=t/e-3*this.otstup-this.wh/2,this.panel.height=i/e-6*this.otstup-this.wh-this.wh/2,this.width=Math.round(this.panel.width),this.height=Math.round(this.panel.height),this.visiPixi.sizeWindow(this.width,this.panel.height),this.visiPixi.render(),l.w=this.width,l.h=this.height,l.x=-this.width/2,l.y=-this.height/2,this.par.par.cont2d.position.set(this.width/2,this.height/2),this.mKrai.sizeWindow(this.width,this.height,e),s.korestPosit()}}var i,e,s;return i=t,(e=[{key:"mashtab",set:function(t){this._mashtab!=t&&(this._mashtab=t,this.cont.scale.x=this.cont.scale.y=t,this.mKrai.mashtab=t,this.korestPosit())},get:function(){return this._mashtab}},{key:"menuIndex",set:function(t){this._menuIndex!=t&&(this._menuIndex=t,this.mKrai.menuIndex=t)},get:function(){return this._menuIndex}}])&&b(i.prototype,e),s&&b(i,s),t}()},function(t,i,e){"use strict";e.r(i),function(t){var s=e(9);e.d(i,"Main",function(){return s.a}),t.Main=s.a}.call(this,e(5))},function(t,i,e){"use strict"}]);